;-------------------------------------------------------------------------
;
; Names for stuff common to MOS 3.20 and OS 1.20 are intended to
; mostly match the ones in
; https://tobylobster.github.io/mos/mos/index.html
;
;-------------------------------------------------------------------------

; The number of sections will probably increase, as a longer term goal
; is to have a bit of flexibility here. Stuff that's got documented
; addresses ($FFxx, default font, VDU driver entry points, etc.) needs
; to stay fixed, but, space permitting, other stuff could be
; rearranged.
                
*=$8000
                .dsection terminal
                .cwarn *>$c000,'Terminal ROM is too large'
                
*=$c000
                .dsection mos
                ; there's no need for a size check here - 64tass gives
                ; you an error if the code would go past the 64 K
                ; barrier.

;-------------------------------------------------------------------------

tubeBrkHandlerAddr=$16
tubeHostAddr=$400
                
;-------------------------------------------------------------------------

stringInputBufferAddress=$f2    ;word

;-------------------------------------------------------------------------

romServiceCallAbsoluteWorkspaceClaim=$01 ; memory used only when ROM is paged in
romServiceCallPrivateWorkspaceClaim=$02 ; memory used even when ROM is not paged in
romServiceCallAutoBoot=$03              ;
romServiceCallUnrecognisedCommand=$04   ; star command not recognised
romServiceCallUnrecognisedInterrupt=$05 ;
romServiceCallBreakInstruction=$06      ;
romServiceCallUnrecognisedOSBYTE=$07    ;
romServiceCallUnrecognisedOSWORD=$08    ;
romServiceCallHelp=$09                  ;
romServiceCallClaimStaticWorkspace=$0A ; (Issued by paged ROMs, not the OS)
romServiceCallNMIRelease=$0B    ; (Issued by paged ROMs, not the OS)
romServiceCallNMIClaim=$0C      ; (Issued by paged ROMs, not the OS)
romServiceCallROMFilingSystemInitialize=$0D    ;
romServiceCallROMFilingSystemByteGet=$0E    ;
romServiceCallVectorsClaimed=$0F    ; Used when a filing system starts
romServiceCallSpoolExecClosureWarning=$10    ;
;romServiceCallFontImplosionExplosionWarning=$11    ;
romServiceCallInitialiseFilingSystem=$12    ; (Issued from paged ROMs, not the OS)
romServiceCallPollingInterrupt=$15
romServiceCallAbsoluteHAZELWorkspaceClaim=$21
romServiceCallPrivateHAZELWorkspaceClam=$22
romServiceCallTopOfHAZELWorkspace=$23
romServiceCallCountDynamicHAZELWorkspace=$24
romServiceCallRequestFSInfo=$25
romServiceCallCloseAllOpenFiles=$26
romServiceCallInformReset=$27
romServiceCallUnknownCONFIG=$28
romServiceCallUnknownSTATUS=$29
romServiceCallLanguageChange=$2a
romServiceCallTubeSystemPostInitialisation=$FE    ;
romServiceCallTubeMainInitialisation=$FF    ;


;-------------------------------------------------------------------------

bufferNumberKeyboard=0          ;
bufferNumberRS423Input=1        ;
bufferNumberRS423Output=2       ;
bufferNumberPrinter=3           ;
bufferNumberSound0=4            ; Noise channel
bufferNumberSound1=5            ;
bufferNumberSound2=6            ;
bufferNumberSound3=7            ;
; bufferNumberSpeech=8            ;
bufferNumberHighest=8           ;

;-------------------------------------------------------------------------

uservIndex=0
brkvIndex=1
irq1vIndex=2
irq2vIndex=3
clivIndex=4
bytevIndex=5
wordvIndex=6
wrchvIndex=7
rdchvIndex=8
filevIndex=9
argsvIndex=10
bgetvIndex=11
bputvIndex=12
gbpbvIndex=13
findvIndex=14
fscvIndex=15
eventvIndex=16
uptvIndex=17
netvIndex=18
vduvIndex=19
keyvIndex=20
insvIndex=21
remvIndex=22
cnpvIndex=23
ind1vIndex=24
ind2vIndex=25
ind3vIndex=26

                
vectors=$200
USERV=vectors+uservIndex*2
BRKV=vectors+brkvIndex*2
IRQ1V=vectors+irq1vIndex*2
IRQ2V=vectors+irq2vIndex*2
CLIV=vectors+clivIndex*2
BYTEV=vectors+bytevIndex*2
WORDV=vectors+wordvIndex*2
WRCHV=vectors+wrchvIndex*2
RDCHV=vectors+rdchvIndex*2
FILEV=vectors+filevIndex*2
ARGSV=vectors+argsvIndex*2
BGETV=vectors+bgetvIndex*2
BPUTV=vectors+bputvIndex*2
GBPBV=vectors+gbpbvIndex*2
FINDV=vectors+findvIndex*2
FSCV=vectors+fscvIndex*2
EVENTV=vectors+eventvIndex*2
UPTV=vectors+uptvIndex*2
NETV=vectors+netvIndex*2
VDUV=vectors+vduvIndex*2
KEYV=vectors+keyvIndex*2
INSV=vectors+insvIndex*2
REMV=vectors+remvIndex*2
CNPV=vectors+cnpvIndex*2
IND1V=vectors+ind1vIndex*2
IND2V=vectors+ind2vIndex*2
IND3V=vectors+ind3vIndex*2

extendedVectorSpace=$d9f
                
serialRegisterULACopy=$0282
                
CRTC=$FE00
ACIA=$fe08
SERPROC=$fe10
HADC=$fe18
TUBE=$fee0
ROMSEL=$fe30
;ACCCON=$fe34
VCONTROL=$fe20
VPALETTE=$fe21

key_space=$62
key_comma=$66
key_minus=$17
key_stop=$67
key_slash=$68
key_0=$27
key_1=$30
key_2=$31
key_3=$11
key_4=$12
key_5=$13
key_6=$34
key_7=$24
key_8=$15
key_9=$26
key_colon=$48
key_semicolon=$57
key_at=$47
key_a=$41
key_b=$64
key_c=$52
key_d=$32
key_e=$22
key_f=$43
key_g=$53
key_h=$54
key_i=$25
key_j=$45
key_k=$46
key_l=$56
key_m=$65
key_n=$55
key_o=$36
key_p=$37
key_q=$10
key_r=$33
key_s=$51
key_t=$23
key_u=$35
key_v=$63
key_w=$21
key_x=$42
key_y=$44
key_z=$61
key_left_square_bracket=$38
key_backslash=$78
key_right_square_bracket=$58
key_caret=$18
key_underline=$28
key_escape=$70
key_tab=$60
key_caps_lock=$40
key_ctrl=$1
key_shift_lock=$50
key_shift=$0
key_delete=$59
key_copy=$69
key_return=$49
key_up=$39
key_down=$29
key_left=$19
key_right=$79
key_f0=$20
key_f1=$71
key_f2=$72
key_f3=$73
key_f4=$14
key_f5=$74
key_f6=$75
key_f7=$16
key_f8=$76
key_f9=$77

fsInfoBlock: .struct
name: .fill 8
minHandle: .fill 1
maxHandle: .fill 1
fsNumber: .fill 1
                .ends

osgbpbBlock: .struct
handle: .fill 1
addr: .fill 4
numBytes: .fill 4
ptr: .fill 4
                .ends

                ; NAUG p260
                
                .virtual $df00
hazel: .block
currentFS:                      ;df00
                .fill 1
activeFS:                       ;df01
                .fill 1
libFS:                          ;df02
                .fill 1
currentFSROM:                   ;df03
                .fill 1
commandLinePointer:             ;df04
                .fill 2

                ; 17 info blocks in total, but everything is relative
                ; to the 0th, so there's only a need to instantiate a
                ; struct for that one. Don't think 64tass handles
                ; arrays of structs anyway.
fsInfoBlocks:   .dstruct fsInfoBlock ;df06
                .fill 16*size(fsInfoBlock)
fsInfoBlocksTerminator:         ;dfc1
                ; space reserved for the 0 terminator when the full
                ; set of info blocks are filled.
                .fill 1
fsFlags: .block                 ;dfc2
                .fill 1
useASCII=$80
isAPPEND=$80
noLineNumbers=$40
                .bend
lineNumberBCD:                  ;dfc3
                .fill 2
lastCharPrinted:                ;dfc5
                .fill 1
tempFSFlag:                     ;dfc6
                .fill 1
moveOSGBPB: .dstruct osgbpbBlock ;dfc7
moveSrcHandle:                  ;dfd4
                .fill 1
moveDestHandle:                 ;dfd5
                .fill 1
moveBufferMSB:                  ;dfd6
                .fill 1
moveNumPages:                   ;dfd7
                .fill 1
moveDestName:                   ;dfd8
                .fill 2
activeFSCV:                     ;dfda
                .fill 2
oldACCCON:                      ;dfdc
                .fill 1
hasACCCONChanged:                ;dfdd
                .fill 1
                .bend
                .endv

                .virtual $fe34
ACCCON: .block
;D=1 = display shadow RAM; D=0 = display main RAM
D=$01

;E=1 = VDU code ($c000-$dfff in MOS ROM) accesses shadow RAM; E=0 =
;VDU code accesses main RAM
E=$02

;X=1 = shadow RAM at $3000; X=0 = main RAM at $3000
X=$04

;Y=1 = HAZEL at $c000; Y=0 = MOS ROM at $c000
Y=$08

;ITU=1 = access internal Tube; ITU=0 = access external Tube
ITU=$10

;IFJ=1 = $fc00...$fdff accesses cartridge; IFJ=0 = $fc00...$fdff
;accesses 1MHz bus
IFJ=$20

; TST=1 = read MOS ROM at $fc00...$feff; TST=0 = read I/O at
; $fc00...$feff
TST=$40

;IRR=1 = IRQ to CPU
IRR=$80
                .bend
                .endv

                VIA: .struct                    ;
orb:
irb:
                .fill 1         ;0
ora:
ira:
                .fill 1         ;1
ddrb:
                .fill 1         ;2
ddra:
                .fill 1         ;3
t1cL:
                .fill 1         ;4
t1cH:
                .fill 1         ;5
t1lL:
                .fill 1         ;6
t1lH:
                .fill 1         ;7
t2cL:
                .fill 1         ;8
t2cH:
                .fill 1         ;9
sr:
                .fill 1         ;10
acr:
                .fill 1         ;11
pcr:
                .fill 1         ;12
ifr:
                .fill 1         ;13
ier:
                .fill 1         ;14
oraNoHandshake:
iraNoHandshake:
                .fill 1         ;15
                .ends

                                .virtual $fe40
systemVIA: .dstruct VIA
                .endv

                .virtual $fe60
userVIA: .dstruct VIA
                .endv

; see App Note 004 - the Tube
                
                .virtual $fee0
tube: .block
; Parasite to Host: Carries the OSWRCH call. Data register is a FIFO
; that can handle a VDU command length (10 bytes).
;
; Host to Parasite: There is a 1 byte buffer. It is used to generate
; IRQ's in the parasite from events in the host.

; write/read (clears IRQ)
status1: .block
; App Note 004 p13
Q=$01                           ;enable HIRQ from R4
I=$02                           ;enable PIRQ from R1
J=$04                           ;enable PIRQ from R3
M=$08                           ;enable PNMI from R3
V=$10                           ;2-byte R3
P=$20                           ;activate PRST
T=$40                           ;clear all Tube registers
S=$80                           ;set/clear bits
                .bend
                .fill 1

; bit 7 - data available/IRQ
; bit 6 - not full
data1:
                .fill 1

; Used to implement OS calls that take a long time or that cannot
; interrupt Host tasks. The parasite passes a byte describing the
; required task. The two processors then exchange data until the task
; is complete. OS calls handled through this register include: OSRDCH,
; OSCLI, OSBYTE, OSWORD, OSBPUT, OSBGET, OSFIND, OSARGS, OSFILE,
; OSGBPB.

; write/read
status2:
                .fill 1

; bit 7 - data available
; bit 6 - not full
data2:
                .fill 1

; Used for the background task of fast data transfer between the two
; processors.

; write/read
status3:
                .fill 1

; bit 7 - data available/NMI
; bit 6 - not full
data3:
                .fill 1

; Used as the control channel for block transfers going through
; Register 3, and also the transfer register for error strings from
; host to parasite. In both cases, the host interrupts the parasite by
; placing a byte into the Register. In the former case it is a byte
; describing the required action, in the latter it is an error code.

; write (sets IRQ)/read (clears IRQ)
status4:
                .fill 1

; bit 7 - data available/IRQ
; bit 6 - not full/IRQ
data4:
                .fill 1
                .bend
                .endv
                
; Presumed addresses in ANDY that don't happen to coincide with other
; labels.
; 
; MasRef E.4-5
;
; &8400–87FF  RAM  VDU workspace.
; &8800–07    RAM  ECF pattern 1 definition.
; &8808–0F    RAM  ECF pattern 2 definition.
; &8810–17    RAM  ECF pattern 3 definition.
; &8818–1F    RAM  ECF pattern 4 definition.
; &8820–27    RAM  Current foreground ECF pattern or solid colour.
; &8828–2F    RAM  Current background ECF pattern or solid colour.
; &8830–BF    RAM  VDU workspace.
; &88C0–FF    RAM  Reserved for future expansion.
; &8900–FF    RAM  Current definitions of characters &20–3F.
; &8A00–FF    RAM  Current definitions of characters &40–5F.
; &8B00–FF    RAM  Current definitions of characters &60–7F.
; &8C00–FF    RAM  Current definitions of characters &80–9F.
; &8D00–FF    RAM  Current definitions of characters &A0–BF.
; &8E00–FF    RAM  Current definitions of characters &C0–DF.
; &8F00–FF    RAM  Current definitions of characters &E0–FF.
                
L8001=$8001
L8002=$8002
L8004=$8004
L8010=$8010
                ;l8011=$8011
                ;l8012=$8012
L8021=$8021
L8400=$8400
L8500=$8500
L8600=$8600
L8820=$8820
L8786=$8786
L8787=$8787
L8788=$8788
L8789=$8789
L87F8=$87f8
L87FF=$87FF
L8800=$8800
L8803=$8803
L8804=$8804
L8836=$8836
L8837=$8837
L883C=$883C
L8840=$8840
L8844=$8844
L8845=$8845
L883F=$883f
L883E=$883e
L8841=$8841
L8842=$8842
L8843=$8843
L8834=$8834
L8835=$8835
L883D=$883D
L8846=$8846
L8833=$8833
L881E=$881E
L8849=$8849
L8830=$8830
L8831=$8831
L8848=$8848
L8847=$8847
L8832=$8832

                ; entry points in the View bank
XBA00=$BA00
XBA67=$BA67
XBEBE=$BEBE

                ; written to during startup
LFE8E=$fe8e

                .virtual $00
tubeLanguageHostAddr: .fill 2
                .endv
                
                .virtual $12
tubeTransferAddr: .fill 2
tubeClaimed: .fill 1            ;bit 7 clear if tube claimed
tubeClaimantID: .fill 1
                .endv

                .virtual $53
tubeLanguageParasiteAddr: .fill 4
                .endv

; MasRef E.4-4

                .virtual $d0
STATE: .block
                .fill 1
                ; D.2-32
isPrinterEnabled=$01
isScrollingDisabled=$02
isPagedScrolling=$04
isTextWindow=$08
isShadowMode=$10
isVDU5=$20
isCursorEditing=$40
isVDU21=$80
                .bend
ZMASK: .fill 1                       ;Pixel mask
ZORA: .fill 1                        ;Text OR mask
ZEOR: .fill 1                        ;Text EOR mask
ZGORA: .fill 1                       ;Graphics OR mask
ZGEOR: .fill 1                       ;Graphics EOR mask
ZMEMG: .fill 2                       ;Graphics pointer
ZMEMT: .fill 2                       ;Text pointer
ZTEMP: .fill 2                       ;Temporary space
ZTEMPB: .fill 2                      ;Temporary space
ZTEMPC: .fill 2                      ;Temporary space
ZTEMPD: .fill 2                      ;Temporary space

                .endv                

nmiEntryPoint=$d00
                
;-------------------------------------------------------------------------

beword .macro value
                .byte >\value
                .byte <\value
                .endm
                
;-------------------------------------------------------------------------

               .section terminal 
L8000:                                       ; Language entry point
                jmp LAF77
L8003:                                       ; Service entry point
                jmp L9D72
L8006:                                       ; ROM type=SERV+LANG+6502
                .byte $C2
L8007:                                       ; (C) offset
                .byte L8011-L8000
L8008:                                       ; Version 1.xx
                .byte $01
L8009:                                       ; ROM title
                .text "TERMINAL"
L8011:
                .byte 0
L8012:
                .text "(C)1984 Acorn"
                .byte 0
                
; STARTUP
; =======
reset:                          ;8020
                lda #~ACCCON.D  ;display main RAM
                trb ACCCON      
                stz hazel.hasACCCONChanged
                trb $0366
                cld
                ldx #$FF
                txs              ;reset stack
                stx userVIA.ddra ;port A all outputs
                lda #%11001111
                sta systemVIA.ddrb ;
                ldy #$20                     ; 8037= A0 20
                ldx #$0A                     ; 8039= A2 0A       ".
                jsr L98E4                    ; 803B= 20 E4 98     d.
                jsr L9729                    ; 803E= 20 29 97     ).
                lda #ACCCON.Y|ACCCON.X       ; page in HAZEL+shadow
                tsb ACCCON
                lda systemVIA.ier
                asl a
                pha
                beq +       ; branch taken if power on
                lda $0258                    ; read BREAK action flags
                                             ; (set by *FX200)
                lsr a                        ; divide by 2 to get the
                                             ; break action
                dec a                        ; Z=1 if it was 1
                bne L8073                    ; branch taken if break
                                             ; action says don't clear
                                             ; RAM
+
                tay             ;Y=0
clearRAM:
                tya             ;A=0
                stz $01
                stz $00         ;start at $0000
-
                sta ($00),y     ;clear RAM
                iny
                bne -
                inc $01
                ldx #$40          ;$40=RTI
                stx nmiEntryPoint ;restore the RTI previously written,
                                  ;as each iteration will potentially
                                  ;overwrite it
                ldx $01
                cpx #$E0        ;hit the end of RAM?
                bcc -           ;branch taken if still more to go
                lda #ACCCON.X   ;page out shadow RAM
                trb ACCCON
                bne clearRAM    ;branch taken if shadow RAM bit
                             ;previously set - i.e., that was the
                             ;first iteration, and we need to go back
                             ;to do main RAM
L8073:
                lda #<emptyCommandLine
                sta hazel.commandLinePointer+0
                lda #>emptyCommandLine
                sta hazel.commandLinePointer+1
                lda #ACCCON.Y|ACCCON.X ; page in MOS ROM, page in main
                                       ; RAM
                trb ACCCON
                lda #$0F                     ; 8084= 8D 8E 02    ...
                sta $028E
-
                dec a                        ; 8088= 8D 40 FE    .@~
                sta systemVIA.orb
                cmp #$09                     ; 808D= B0 F8       0x
                bcs -
                ldx #key_ctrl
                jsr interrogateKeyboard
                cpx #$80        ;Z=0 C=1 if CTRL+BREAK
                jsr LF735
                stz $028D                    ; 8099= 9C 8D 02    ...
                ror a                        ; 809C= 6A          j
                ldx #$9C                     ; 809D= A2 9C       ".
                ldy #$8D                     ; 809F= A0 8D        .
                pla                          ; 80A1= 68          h
                beq L80AD                    ; 80A2= F0 09       p.
                ldy #$7E                     ; 80A4= A0 7E        ~
                bcc L80DF                    ; 80A6= 90 37       .7
                ldy #$87                     ; 80A8= A0 87        .
                inc $028D                    ; 80AA= EE 8D 02    n..
L80AD:
                inc $028D                    ; 80AD= EE 8D 02    n..
                phy                          ; 80B0= 5A          Z
                jsr L8E76                    ; Read configured MODE
L80B4:
                ora #$08                     ; Store in OSBYTE 255 with boot off (b3=1)
                sta $028F
L80B9:
                jsr L98AE                    ; Read configured BOOT
                and #$10
                lsr a                        ; Reset OSBYTE 255 boot bit (b3) if BOOT
                trb $028F
                jsr L8E5A                    ; 80C2= 20 5A 8E     Z.
                sty $0290                    ; 80C5= 8C 90 02    ...
                stx $0291                    ; 80C8= 8E 91 02    ...
L80CB:
                jsr L98AE                    ; 80CB= 20 AE 98     ..
                and #$08                     ; 80CE= 29 08       ).
                beq L80D4                    ; 80D0= F0 02       p.
                lda #$01                     ; 80D2= A9 01       ).
L80D4:
                sta $0366                    ; 80D4= 8D 66 03    .f.
                jsr L927B                    ; 80D7= 20 7B 92     {.
                ply                          ; 80DA= 7A          z
                ldx #$92                     ; 80DB= A2 92       ".
                bra L80F7                    ; 80DD= 80 18       ..

L80DF:
                lda #$87                     ; Clear MODE bits from OSBYTE 255
                trb $028F
                lda $0355                    ; Get current screen MODE b0-b2
                and #$07
                tsb $028F                    ; Copy to OSBYTE 255
                lda #$10                     ; Test shadow screen bit in VDU flags
                bit STATE                      ; Not shadow screen
                beq L80F7
                lda #$80                     ; Set shadow screen bit in OSBYTE 255
                tsb $028F
L80F7:
                lda $028D
                bne L8104
                cpx #$B1
                bcs L8104
                cpx #$A1
                bcs L810E
L8104:
                stz $0200,x                  ; 8104= 9E 00 02    ...
                cpx #$CD                     ; 8107= E0 CD       `M
                bcc L810E                    ; 8109= 90 03       ..
                dec $0200,x                  ; 810B= DE 00 02    ^..
L810E:
                inx                          ; 810E= E8          h
                bne L80F7                    ; 810F= D0 E6       Pf
                ldx #$CF                     ; 8111= A2 CF       "O
L8113:
                stz $00,x                    ; 8113= 74 00       t.
                inx                          ; 8115= E8          h
                bne L8113                    ; 8116= D0 FB       P{
                lda $028D                    ; 8118= AD 8D 02    -..
                bne L813D                    ; 811B= D0 20       P
                lda $0246                    ; 8120= 48          H
                pha
                lda $024B                    ; 8124= 48          H
                pha
                lda $0244                    ; 8128= 48          H
                pha
                lda $0257                    ; 812C= 48          H
                pha
                ldx $0256                    ; 812D= AE 56 02    .V.
L8130:
                lda defaultVectorTable-1,y         ; 8130= B9 D6 E2    9Vb
                sta vectors-1,y       ; 8133= 99 FF 01    ...
                dey                   ; 8136= 88          .
                cpy #EVENTV+1-vectors ; 8137= C0 21       @!
                bcs L8130             ; 8139= B0 F5       0u
                ldy #FILEV-vectors    ; 813B= A0 12        .
L813D:
                lda defaultVectorTable-1,y   ; 813D= B9 D6 E2    9Vb
                sta vectors-1,y   ; 8140= 99 FF 01    ...
                dey                          ; 8143= 88          .
                bne L813D                    ; 8144= D0 F7       Pw
                lda $028D                    ; 8146= AD 8D 02    -..
                bne L8164                    ; 8149= D0 19       P.
                stx $0256                    ; 814B= 8E 56 02    .V.
                pla                          ; 814E= 68          h
                cmp #$04                     ; 814F= C9 04       I.
                bcs L8155                    ; 8151= B0 02       0.
                lda #$00                     ; 8153= A9 00       ).
L8155:
                sta $0257                    ; 8155= 8D 57 02    .W.
                pla                          ; 8159= 8D 44 02    .D.
                sta $0244
                pla                          ; 815D= 8D 4B 02    .K.
                sta $024B
                pla                          ; 8161= 8D 46 02    .F.
                sta $0246
L8164:
                jsr L8EAD                    ; 8164= 20 AD 8E     -.
                ldx #$20                     ; 8167= A2 20       "
                asl a                        ; 8169= 0A          .
                asl a                        ; 816A= 0A          .
                bmi L8174                    ; 816B= 30 07       0.
                ldx #$30                     ; 816D= A2 30       "0
                asl a                        ; 816F= 0A          .
                bmi L8174                    ; 8170= 30 02       0.
                ldx #$A0                     ; 8172= A2 A0       "
L8174:
                stx $025A                    ; 8174= 8E 5A 02    .Z.
                jsr selectTerminalROM                    ; 8177= 20 90 E5     .e
                jsr LF107                    ; 817A= 20 07 F1     .q
                lda $028D                    ; 817D= AD 8D 02    -..
                beq L8196                    ; 8180= F0 14       p.
                jsr L8EA8                    ; 8182= 20 A8 8E     (.
                sta $0286                    ; 8185= 8D 86 02    ...
                jsr L98AA                    ; 8188= 20 AA 98     *.
                lsr a                        ; 818B= 4A          J
                lsr a                        ; 818C= 4A          J
                ror $0246                    ; 818D= 6E 46 02    nF.
                jsr L8E8D                    ; 8190= 20 8D 8E     ..
                sta $0285                    ; 8193= 8D 85 02    ...
L8196:
                jsr L8E97                    ; 8196= 20 97 8E     ..
                asl a                        ; 8199= 0A          .
                asl a                        ; 819A= 0A          .
                ora #$42                     ; 819B= 09 42       .B
                sta $0250                    ; 819D= 8D 50 02    .P.
                jsr LA9D6                    ; 81A0= 20 D6 A9     V)
                ldx #$01                     ; 81A3= A2 01       ".
                lda #$7F                     ; 81A5= A9 7F       ).
L81A7:
                sta systemVIA.ifr,x          ; 81A7= 9D 4D FE    .M~
                sta userVIA.ifr,x            ; 81AA= 9D 6D FE    .m~
                dex                          ; 81AD= CA          J
                bpl L81A7                    ; 81AE= 10 F7       .w
                cli                          ; 81B0= 58          X
                sei                          ; 81B1= 78          x
                bit $FC                      ; 81B2= 24 FC       $|
                bvc L81B9                    ; 81B4= 50 03       P.
                jsr LF8CF                    ; 81B6= 20 CF F8     Ox
L81B9:
                ldx #$D2
                stx systemVIA.ier
                ldx #$04
                stx systemVIA.pcr
                lda #$40
                sta systemVIA.acr
                lda #$0E
                sta systemVIA.t1lL
                sta userVIA.pcr
                sta HADC+0
                lda #$27
                sta systemVIA.t1lH
                sta systemVIA.t1cH
                ldx #$08
L81DD:
                dex                          ; 81DD= CA          J
                jsr LF55D                    ; 81DE= 20 5D F5     ]u
                cpx #$04                     ; 81E1= E0 04       `.
                bne L81DD                    ; 81E3= D0 F8       Px
                jsr osbyte7A
                stx $ED                      ; 81E8= 86 ED       .m
                ldx #$00                     ; 81EA= A2 00       ".
                jsr LE97D                    ; 81EC= 20 7D E9     }i
                lda serialRegisterULACopy                    ; 81EF= AD 82 02    -..
                and #$7F                     ; 81F2= 29 7F       ).
                jsr LEC89                    ; 81F4= 20 89 EC     .l
                jsr L8E84                    ; 81F7= 20 84 8E     ..
                pha                          ; 81FA= 48          H
                tax                          ; 81FB= AA          *
                jsr osbyte08                    ; 81FC= 20 6B EC     kl
                plx                          ; 81FF= FA          z
                lda #$07                     ; 8200= A9 07       ).
                jsr osbyte07                 ; 8202= 20 6D EC     ml
                jsr L98AE                    ; 8205= 20 AE 98     ..
                bit #$02                     ; 8208= 89 02       ..
                bne L8211                    ; 820A= D0 05       P.
                lda #$F0                     ; 820C= A9 F0       )p
                sta $0264                    ; 820E= 8D 64 02    .d.
L8211:
                jsr selectTerminalROM                    ; 8211= 20 90 E5     .e
                ldx $0284                    ; 8214= AE 84 02    ...
                beq L821C                    ; 8217= F0 03       p.
                jsr osbyte12
L821C:
                lda $028D                    ; 821C= AD 8D 02    -..
                beq L8224                    ; 821F= F0 03       p.
                jmp LE3A0                    ; 8221= 4C A0 E3    L c

L8224:
                lda $028F                    ; Select startup screen MODE
                jsr LC799
                lda $028D                    ; 822A= AD 8D 02    -..
                dec a                        ; 822D= 3A          :
                bne L8284                    ; 822E= D0 54       PT
                lda $ED                      ; 8230= A5 ED       %m
                cmp #$33                     ; 8232= C9 33       I3
                bne L8284                    ; 8234= D0 4E       PN
                ldx #$31                     ; 8236= A2 31       "1
L8238:
                phx                          ; 8238= DA          Z
                ldy #$00                     ; 8239= A0 00        .
                jsr L98DC                    ; 823B= 20 DC 98     \.
                plx                          ; 823E= FA          z
                dex                          ; 823F= CA          J
                bpl L8238                    ; 8240= 10 F6       .v
                ldy #$FF                     ; 8242= A0 FF        .
                ldx #$06                     ; 8244= A2 06       ".
                jsr L98DC                    ; 8246= 20 DC 98     \.
                ldx #$07                     ; 8249= A2 07       ".
                jsr L98DC                    ; 824B= 20 DC 98     \.
                jsr LA958                    ; 824E= 20 58 A9     X)
                .byte $0D
                .byte $0A
                .text "CMOS RAM reset"
                .byte $0D
                .byte $0A
                .text "Press break to continue"
                .byte $0D
                .byte $0A
                .byte $00
                lda #$03                     ; 827D= A9 03       ).
                sta $0258                    ; 827F= 8D 58 02    .X.
L8282:
                bra L8282                    ; 8282= 80 FE       .~

L8284:
                jsr selectHAZEL                    ; 8284= 20 BA ED     :m
                stz hazel.moveSrcHandle
                stz hazel.moveDestHandle
                ldy #$CA                     ; 828D= A0 CA        J
                jsr LEA7E                    ; 828F= 20 7E EA     ~j
                jsr LF349                    ; 8292= 20 49 F3     Is
                lda $028D                    ; 8295= AD 8D 02    -..
                beq L829D                    ; 8298= F0 03       p.
                jsr LEDD0                    ; 829A= 20 D0 ED     Pm
L829D:
                jsr L98AA                    ; 829D= 20 AA 98     *.
                lsr a                        ; 82A0= 4A          J
                bcc L82D0                    ; 82A1= 90 2D       .-
                jsr L98AE                    ; 82A3= 20 AE 98     ..
                bit #$04                     ; 82A6= 89 04       ..
                php                          ; 82A8= 08          .
                lda #$10                     ; 82A9= A9 10       ).
                trb ACCCON                    ; 82AB= 1C 34 FE    .4~
                plp                          ; 82AE= 28          (
                bne L82B4                    ; 82AF= D0 03       P.
                tsb ACCCON                    ; 82B1= 0C 34 FE    .4~
L82B4:
                jsr LE375                    ; If Tube hardware present, jump to Tube PreInit
                bcs L82C6
                lda ACCCON                    ; Toggle Internal/External Tube
                eor #$10
                sta ACCCON
                jsr LE375                    ; No Tube, skip past Tube PreInit
                bcc L82D0
L82C6:
                ldx #$FF                     ; Service call &FF - Tube PreInit
                jsr makeROMServiceCall
                bne L82D0                    ; Not claimed, step past
                dec $027A                    ; Tube PreInit claimed, set TubeFlag to &FF, Tube present
L82D0:
                lda $028D                    ; Soft Break, don't ask about workspace
                beq L82FC
                ldy #$DC                     ; Start high workspace at &DC00 and work downwards
                ldx #$24                     ; Ask ROMs how much private high workspace required
                jsr makeROMServiceCall
                ldx #$21                     ; Ask ROMs for maximum shared high workspace required
                jsr makeROMServiceCall
                phy                          ; Save top of shared workspace
                ldx #$22                     ; Ask ROMs for private high workspace required
                jsr makeROMServiceCall
                ldy #$0E                     ; Start low workspace at &0E00
                ldx #$01                     ; Ask ROMs for maximum shared workspace
                jsr makeROMServiceCall
                ldx #$02                     ; Ask ROMs for private workspace
                jsr makeROMServiceCall
                sty $0244                    ; Set OSHWM - default PAGE
                ply                          ; Get top of shared high workspace
                ldx #$23                     ; Tell ROMs top of shared high workspace
                jsr makeROMServiceCall
L82FC:
                ldx #$21
L82FE:
                lda L8347-1,x                ; Copy initial FS info blocks for CFS, TAPE, ROM
                sta hazel.fsInfoBlocks-1,x
                dex
                bne L82FE
                stz $F2                      ; &F2/3=>FS Info Blocks
                lda #$DF
                sta $F3
                ldy #$27                     ; Y=>end of FS Info Blocks
                ldx #$25                     ; Ask ROMs for FS Info Blocks
                jsr makeROMServiceCall
                lda #$00                     ; Terminate FS Info blocks
                sta ($F2),y

                lda $0257                    ; Save Spool handle and disable Spooling
                pha
                stz $0257
                ldx #$FE
                ldy $027A
                jsr makeROMServiceCall                    ; Tube PostInit
                and $0267
                bpl L8340
                ldy #$FF                     ; Print <NL>"Acorn MOS"
                jsr LE7A1
                lda $028D                    ; Skip past if Soft Break
                beq L833B
                ldy #$0A                     ; Print <BELL> (space in message for "xxK")
                jsr LE7A1
L833B:
                ldy #$0F                     ; Print <NL><NL>
                jsr LE7A1
L8340:
                pla                          ; Restore Spool handle
                sta $0257
                jmp LE40E

; Default FS Info Blocks
; ======================
L8347:
                .text "CFS     "
                .byte $01
                .byte $02
                .byte $01
                .text "TAPE    "
                .byte $01
                .byte $02
                .byte $01
                .text "ROM     "
                .byte $03
                .byte $03
                .byte $03

; MOS command table
; =================

mos_command .macro name,routine,byte1,byte2
                .text \name
                .beword \routine
                .byte \byte1
                .byte \byte2
                .endm
                
L8368:

                .mos_command "CAT",callFSCV,$80,$05 ; XY=>parameters, FSC &05
                .mos_command "ADFS",L85AF,$00,$00   ;
                .mos_command "APPEND",L9014,$80,$00 ; XY=>parameters
                .mos_command "BASIC",L85A6,$00,$00  ;
                .mos_command "BUILD",L900F,$80,$00  ; XY=>parameters
                .mos_command "CLOSE",L937C,$00,$FF  ;
                .mos_command "CONFIGURE",L887A,$00,$FF ;
                .mos_command "CODE",L93EB,$00,$88 ; X,y=parameters, OSBYTE &88
                .mos_command "CREATE",L9318,$80,$07 ; XY=>parameters, OSFILE &07
                .mos_command "DUMP",L8F42,$80,$00   ; XY=>parameters
                .mos_command "DELETE",L946A,$80,$00 ; XY=>parameters
                .mos_command "EXEC",LA591,$80,$00   ; XY=>parameters
                .mos_command "EX",callFSCV,$80,$09 ; XY=>parameters, FSC &09
                .mos_command "FX",L93E5,$00,$FF ;
                .mos_command "GOIO",L92FD,$00,$FF ;
                .mos_command "GO",L92F5,$00,$FF   ;
                .mos_command "HELP",L85CA,$00,$FF ;
                .mos_command "INFO",callFSCV,$80,$0A ; XY=>parameters, FSC &0A
                .mos_command "IGNORE",L9387,$00,$FF ;
                .mos_command "INSERT",L871F,$00,$FF ;
                .mos_command "KEY",L94C7,$00,$FF    ;
                .mos_command "LOAD",L9316,$80,$00   ; XY=>parameters
                .mos_command "LIST",L8EC0,$80,$00   ; XY=>parameters
                .mos_command "LINE",callUSERV,$00,$01   ;
                .mos_command "LIBFS",LE7F6,$00,$00  ;
                .mos_command "MOTOR",L93EB,$00,$89 ; X,y=parameters, OSBYTE &89
                .mos_command "MOVE",L90B6,$80,$00  ; XY=>parameters
                .mos_command "OPT",L93EB,$80,$8B ; X,y=parameters, OSBYTE &8B
                .mos_command "PRINT",L8EB9,$80,$00 ; XY=>parameters
                .mos_command "RUN",callFSCV,$80,$04 ; XY=>parameters, FSC &04
                .mos_command "REMOVE",L9371,$80,$00 ; XY=>parameters
                .mos_command "ROM",L93EB,$00,$8D ; X,y=parameters, OSBYTE &8D
                .mos_command "ROMS",L86A6,$00,$FF ;
                .mos_command "SAVE",L9318,$80,$00 ; XY=>parameters, OSFILE &00
                .mos_command "SHADOW",L9466,$00,$FF  ;
                .mos_command "SHOW",L9488,$00,$FF    ;
                .mos_command "SHUT",LF373,$00,$00    ;
                .mos_command "SPOOL",L9433,$80,$00   ; XY=>parameters
                .mos_command "SPOOLON",L9420,$80,$00 ; XY=>parameters
                .mos_command "STATUS",L8895,$00,$FF  ;
                .mos_command "TAPE",L93EB,$00,$8C ; X,y=parameters, OSBYTE &8C
                .mos_command "TV",L93EB,$00,$90 ; X,y=parameters, OSBYTE &90
                .mos_command "TIME",L8744,$00,$00   ;
                .mos_command "TYPE",L8ECB,$80,$00   ; XY=>parameters
                .mos_command "UNPLUG",L8722,$00,$FF ;
                .mos_command "X",LE7FD,$00,$00      ;
                .mos_command "",callFSCV,$00,$03       ; FSC &03
                .byte $00
                
L84EE:
                lda ($B0)                    ; 84EE= B2 B0       20
L84F0:
                bmi L84FE                    ; 84F0= 30 0C       0.
L84F2:
                tya                          ; 84F2= 98          .
L84F3:
                clc                          ; 84F3= 18          .
                adc $F2                      ; 84F4= 65 F2       er
                tax                          ; 84F6= AA          *
                ldy $F3                      ; 84F7= A4 F3       $s
L84F9:
                bcc L84FC                    ; 84F9= 90 01       ..
                iny                          ; 84FB= C8          H
L84FC:
                lda ($B0)                    ; 84FC= B2 B0       20
L84FE:
                rts                          ; 84FE= 60          `

; Prepare OSCLI command line
; ==========================
L84FF:
                stx $F2                      ; 84FF= 86 F2       .r
                sty $F3                      ; 8501= 84 F3       .s
                lda hazel.currentFS
                jsr selectFS                    ; 8506= 20 4D FB     M{
                lda #$08                     ; 8509= A9 08       ).
                jsr callFSCV                    ; 850B= 20 E5 F1     eq
                ldy #$FF                     ; 850E= A0 FF        .
L8510:
                jsr incAndSkipSpaces                    ; 8510= 20 FE F2     ~r
                beq L84FE                    ; 8513= F0 E9       pi
                cmp #$2A                     ; 8515= C9 2A       I*
                beq L8510                    ; 8517= F0 F7       pw
                jsr skipSpacesAndCheckForCRInStringInput                    ; 8519= 20 FF F2     .r
                beq L84FE                    ; 851C= F0 E0       p`
                cmp #$7C                     ; 851E= C9 7C       I|
                beq L84FE                    ; 8520= F0 DC       p\
                stz hazel.tempFSFlag      ; 8522= 9C C6 DF    .F_
                cmp #$2D                     ; 8525= C9 2D       I-
                bne L8535                    ; 8527= D0 0C       P.
                jsr parseFileNameFS                    ; 8529= 20 A6 FA     &z
                jsr selectFS                    ; 852C= 20 4D FB     M{
                sec                          ; 852F= 38          8
                ror hazel.tempFSFlag      ; 8530= 6E C6 DF    nF_
                lda ($F2),y                  ; 8533= B1 F2       1r
L8535:
                cmp #$2F                     ; 8535= C9 2F       I/
                bne L8542                    ; 8537= D0 09       P.
                iny                          ; 8539= C8          H
                jsr L84F2                    ; 853A= 20 F2 84     r.
                lda #$02                     ; 853D= A9 02       ).
                jmp callFSCV                    ; 853F= 4C E5 F1    Leq

L8542:
                sty $E6
                lda #<L8368                  ; Point to command table
                sta $B0
                lda #>L8368
                sta $B1
                bra L8558

L854E:
                eor ($B0)                    ; 854E= 52 B0       R0
                and #$DF                     ; 8550= 29 DF       )_
                bne L8569                    ; 8552= D0 15       P.
                jsr L859B                    ; 8554= 20 9B 85     ..
                iny                          ; 8557= C8          H
L8558:
                lda ($F2),y                  ; 8558= B1 F2       1r
                jsr isLetter                    ; 855A= 20 71 EA     qj
                bcc L854E                    ; 855D= 90 EF       .o
                lda ($B0)                    ; 855F= B2 B0       20
                bmi L8582                    ; 8561= 30 1F       0.
                lda ($F2),y                  ; 8563= B1 F2       1r
                cmp #$2E                     ; 8565= C9 2E       I.
                beq L856D                    ; 8567= F0 04       p.
L8569:
                clc                          ; 8569= 18          .
                ldy $E6                      ; 856A= A4 E6       $f
                dey                          ; 856C= 88          .
L856D:
                iny                          ; 856D= C8          H
L856E:
                jsr L859B                    ; Get byte from table, update pointer
                beq L85AF                    ; Zero byte
                bpl L856E                    ; Loop until b7 set
                bcs L8585                    ; 8575= B0 0E       0.
                jsr L859B                    ; 8577= 20 9B 85     ..
                jsr L859B                    ; 857A= 20 9B 85     ..
                jsr L859B                    ; 857D= 20 9B 85     ..
                bra L8558                    ; 8580= 80 D6       .V

L8582:
                jsr L859B                    ; 8582= 20 9B 85     ..
L8585:
                pha                          ; 8585= 48          H
                jsr L859B                    ; 8586= 20 9B 85     ..
                pha                          ; 8589= 48          H
                jsr L859B                    ; 858A= 20 9B 85     ..
                bmi L8592                    ; 858D= 30 03       0.
                stz hazel.tempFSFlag      ; 858F= 9C C6 DF    .F_
L8592:
                jsr skipSpacesAndCheckForCRInStringInput                    ; 8592= 20 FF F2     .r
                clc                          ; 8595= 18          .
                php                          ; 8596= 08          .
                jsr L84EE                    ; 8597= 20 EE 84     n.
                rti                          ; 859A= 40          @

L859B:
                lda ($B0)                    ; 859B= B2 B0       20
                pha                          ; 859D= 48          H
                inc $B0                      ; 859E= E6 B0       f0
                bne L85A4                    ; 85A0= D0 02       P.
                inc $B1                      ; 85A2= E6 B1       f1
L85A4:
                pla                          ; 85A4= 68          h
L85A5:
                rts                          ; 85A5= 60          `

; *BASIC
; ======
L85A6:
                ldx $024B                    ; Get BASIC ROM number
                bmi L85AF                    ; If no BASIC ROM, jump to pass to ROMs and filing system
                sec                          ;
                jmp osbyte8E                    ; Enter ROM as a language

; *ADFS - pass straight to ROMs/Filing System
; ===========================================
L85AF:
                bit hazel.tempFSFlag      ; Check filing system flag
                bmi L85C0                    ; If ... skip ROM service call
                stz hazel.tempFSFlag      ; Clear filing system flag
                ldy $E6
                ldx #$04
                jsr osbyte8F                    ; Service call 4 - Unknown command
                beq L85A5                    ; Claimed, return
L85C0:
                lda $E6
                jsr L84F3                    ; F2toXY
                lda #$03
                jmp callFSCV                    ; Pass to FSCV,3 - Unknown command

L85CA:
                ldx #$09                     ; 85CA= A2 09       ".
                lda STATE                      ; 85CC= A5 D0       %P
                pha                          ; 85CE= 48          H
                lda #$0E                     ; 85CF= A9 0E       ).
                jsr OSWRCH                   ; 85D1= 20 EE FF     n.
                jsr makeROMServiceCall                    ; 85D4= 20 72 EE     rn
                ldx #$18                     ; 85D7= A2 18       ".
                jsr makeROMServiceCall                    ; 85D9= 20 72 EE     rn
                pla                          ; 85DC= 68          h
                bit #$04                     ; 85DD= 89 04       ..
                bne L860D                    ; 85DF= D0 2C       P,
                lda #$0F                     ; 85E1= A9 0F       ).
                jmp OSWRCH                   ; 85E3= 4C EE FF    Ln.

L85E6:
                jsr skipSpacesAndCheckForCRInStringInput                    ; 85E6= 20 FF F2     .r
                cmp #$26                     ; 85E9= C9 26       I&
                bne L860E                    ; 85EB= D0 21       P!
                iny                          ; 85ED= C8          H
                jsr L8648                    ; 85EE= 20 48 86     H.
                bcc L8646                    ; 85F1= 90 53       .S
                sta $E6                      ; 85F3= 85 E6       .f
                jsr L8648                    ; 85F5= 20 48 86     H.
                bcc L8608                    ; 85F8= 90 0E       ..
                ldx #$04                     ; 85FA= A2 04       ".
L85FC:
                asl $E6                      ; 85FC= 06 E6       .f
                dex                          ; 85FE= CA          J
                bne L85FC                    ; 85FF= D0 FB       P{
                tsb $E6                      ; 8601= 04 E6       .f
                jsr L8648                    ; 8603= 20 48 86     H.
                bcs L8631                    ; 8606= B0 29       0)
L8608:
                ldx $E6                      ; 8608= A6 E6       &f
                cmp #$0D                     ; 860A= C9 0D       I.
                sec                          ; 860C= 38          8
L860D:
                rts                          ; 860D= 60          `

L860E:
                jsr L8634                    ; 860E= 20 34 86     4.
                bcc L8646                    ; 8611= 90 33       .3
L8613:
                sta $E6                      ; 8613= 85 E6       .f
                jsr L8633                    ; 8615= 20 33 86     3.
                bcc L8608                    ; 8618= 90 EE       .n
                tax                          ; 861A= AA          *
                lda $E6                      ; 861B= A5 E6       %f
                asl a                        ; 861D= 0A          .
                bcs L8646                    ; 861E= B0 26       0&
                asl a                        ; 8620= 0A          .
                bcs L8646                    ; 8621= B0 23       0#
                adc $E6                      ; 8623= 65 E6       ef
                bcs L8646                    ; 8625= B0 1F       0.
                asl a                        ; 8627= 0A          .
                bcs L8646                    ; 8628= B0 1C       0.
                sta $E6                      ; 862A= 85 E6       .f
                txa                          ; 862C= 8A          .
                adc $E6                      ; 862D= 65 E6       ef
                bcc L8613                    ; 862F= 90 E2       .b
L8631:
                clc                          ; 8631= 18          .
                rts                          ; 8632= 60          `

L8633:
                iny                          ; 8633= C8          H
L8634:
                lda ($F2),y                  ; 8634= B1 F2       1r
                cmp #$3A                     ; 8636= C9 3A       I:
                bcs L8646                    ; 8638= B0 0C       0.
                cmp #$30                     ; 863A= C9 30       I0
                bcc L8646                    ; 863C= 90 08       ..
                and #$0F                     ; 863E= 29 0F       ).
                rts                          ; 8640= 60          `

L8641:
                jsr skipSpacesAndCheckForCRInStringInput                    ; 8641= 20 FF F2     .r
                cmp #$0D                     ; 8644= C9 0D       I.
L8646:
                clc                          ; 8646= 18          .
                rts                          ; 8647= 60          `

L8648:
                jsr L8634                    ; 8648= 20 34 86     4.
                bcs L865A                    ; 864B= B0 0D       0.
                and #$DF                     ; 864D= 29 DF       )_
                cmp #$47                     ; 864F= C9 47       IG
                bcs L8641                    ; 8651= B0 EE       0n
L8653:
                cmp #$41                     ; 8653= C9 41       IA
                bcc L8641                    ; 8655= 90 EA       .j
                eor #$48                     ; 8657= 49 48       IH
                inc a                        ; 8659= 1A          .
L865A:
                iny                          ; 865A= C8          H
                rts                          ; 865B= 60          `

; OSWORD 0 control block for *commands
; ====================================
L865C:
                .word LDC00			; address
                .byte $F0			; max # chars
                .byte $20			; min ASCII char
                .byte $7E			; max ASCII char

L8661:
                lda #<L868D     ; 8661= A9 8D       ).
                sta BRKV+0      ; 8663= 8D 02 02    ...
                lda #>L868D     ; 8666= A9 86       ).
                sta BRKV+1      ; 8668= 8D 03 02    ...
                lda #$1F        ; 866B= A9 1F       ).
                sta $028C       ; 866D= 8D 8C 02    ...
L8670:
                ldx #$FF                     ; 8670= A2 FF       ".
                txs                          ; 8672= 9A          .
                cli                          ; 8673= 58          X
                jsr selectHAZEL                    ; 8674= 20 BA ED     :m
                lda #'*'                     ; 8677= A9 2A       )*
                jsr OSWRCH                   ; 8679= 20 EE FF     n.
                jsr L869D                    ; 867C= 20 9D 86     ..
                bcc L8684                    ; 867F= 90 03       ..
                jmp LA891                    ; 8681= 4C 91 A8    L.(

L8684:
                ldx #<LDC00     ; 8684= A2 00       ".
                ldy #>LDC00     ; 8686= A0 DC        \
                jsr OSCLI      ; 8688= 20 F7 FF     w.
                bra L8670       ; 868B= 80 E3       .c

L868D:
                jsr OSNEWL                   ; 868D= 20 E7 FF     g.
                ldy #$00                     ; 8690= A0 00        .
                jsr LE7A7                    ; 8692= 20 A7 E7     'g
                jsr OSNEWL                   ; 8695= 20 E7 FF     g.
                bra L8661                    ; 8698= 80 C7       .G

L869A:
                jmp LFBED                    ; 869A= 4C ED FB    Lm{

L869D:
                lda #$00                     ; 869D= A9 00       ).
                ldx #<L865C                  ; 869F= A2 5C       "\
                ldy #>L865C                  ; 86A1= A0 86        .
                jmp OSWORD                   ; 86A3= 4C F1 FF    Lq.

L86A6:
                jsr skipSpacesAndCheckForCRInStringInput                    ; 86A6= 20 FF F2     .r
                bne L869A                    ; 86A9= D0 EF       Po
                ldy #$0F                     ; 86AB= A0 0F        .
L86AD:
                iny                          ; 86AD= C8          H
                jsr LA927                    ; 86AE= 20 27 A9     ')
                .text "ROM "
                .byte $00
                tya                          ; 86B6= 98          .
                dec a                        ; 86B7= 3A          :
                pha                          ; 86B8= 48          H
                jsr LA873                    ; 86B9= 20 73 A8     s(
                jsr L9F0C                    ; 86BC= 20 0C 9F     ..
                lda #$09                     ; 86BF= A9 09       ).
                sta $F6                      ; 86C1= 85 F6       .v
                lda #$80                     ; 86C3= A9 80       ).
                sta $F7                      ; 86C5= 85 F7       .w
                plx                          ; 86C7= FA          z
                jsr LE587                    ; 86C8= 20 87 E5     .e
                dey                          ; 86CB= 88          .
                bcc L8718                    ; 86CC= 90 4A       .J
L86CE:
                jsr osrdscEntryPoint                    ; 86CE= 20 FC F3     |s
                cmp #$20                     ; 86D1= C9 20       I
                bcc L86E4                    ; 86D3= 90 0F       ..
                cmp #$7F                     ; 86D5= C9 7F       I.
                bcs L8718                    ; 86D7= B0 3F       0?
                jsr OSWRCH                   ; 86D9= 20 EE FF     n.
                inc $F6                      ; 86DC= E6 F6       fv
                bit $F6                      ; 86DE= 24 F6       $v
                bvc L86CE                    ; 86E0= 50 EC       Pl
                bra L8718                    ; 86E2= 80 34       .4

L86E4:
                tax                          ; 86E4= AA          *
                bne L8718                    ; 86E5= D0 31       P1
                lda #$08                     ; 86E7= A9 08       ).
                sta $F6                      ; 86E9= 85 F6       .v
                lda #$80                     ; 86EB= A9 80       ).
                sta $F7                      ; 86ED= 85 F7       .w
                jsr osrdscEntryPoint                    ; 86EF= 20 FC F3     |s
                jsr LA865                    ; 86F2= 20 65 A8     e(
L86F5:
                phy                          ; 86F5= 5A          Z
                jsr LE9BB                    ; 86F6= 20 BB E9     ;i
                sta $B0                      ; 86F9= 85 B0       .0
                jsr L98B7                    ; 86FB= 20 B7 98     7.
                and $B0                      ; 86FE= 25 B0       %0
L8700:
                bne L8710                    ; 8700= D0 0E       P.
                jsr LA958                    ; 8702= 20 58 A9     X)
                .text " unplugged"
                .byte 0
;JSR &6E75        :\ 8705= 20 75 6E     un
;BVS L8776        :\ 8708= 70 6C       pl
;ADC &67,x        :\ 870A= 75 67       ug
;EQUB &67         :\ 870C= 67          g
;ADC &64          :\ 870D= 65 64       ed
;BRK              :\ 870F= 00          .
L8710:
                ply                          ; 8710= 7A          z
                jsr OSNEWL                   ; 8711= 20 E7 FF     g.
                dey                          ; 8714= 88          .
                bpl L86AD                    ; 8715= 10 96       ..
                rts                          ; 8717= 60          `

L8718:
                lda #'?'                     ; 8718= A9 3F       )?
                jsr OSWRCH                   ; 871A= 20 EE FF     n.
                bra L86F5                    ; 871D= 80 D6       .V

L871F:
                sec                          ; 871F= 38          8
                bra L8723                    ; 8720= 80 01       ..

L8722:
                clc                          ; 8722= 18          .
L8723:
                php                          ; 8723= 08          .
                jsr skipSpacesAndCheckForCRInStringInput                    ; 8724= 20 FF F2     .r
                jsr L897D                    ; 8727= 20 7D 89     }.
                tay                          ; 872A= A8          (
                jsr LE9BB                    ; 872B= 20 BB E9     ;i
                pha                          ; 872E= 48          H
                jsr L98B7                    ; 872F= 20 B7 98     7.
                sty $B0                      ; 8732= 84 B0       .0
                pla                          ; 8734= 68          h
                plp                          ; 8735= 28          (
                bcc L873C                    ; 8736= 90 04       ..
                ora $B0                      ; 8738= 05 B0       .0
                bra L8740                    ; 873A= 80 04       ..

L873C:
                eor #$FF                     ; 873C= 49 FF       I.
                and $B0                      ; 873E= 25 B0       %0
L8740:
                tay                          ; 8740= A8          (
                jmp L98E4                    ; 8741= 4C E4 98    Ld.

L8744:
                stz LDC00                    ; 8744= 9C 00 DC    ..\
                ldx #<LDC00                  ; 8747= A2 00       ".
                ldy #>LDC00                  ; 8749= A0 DC        \
                lda #$0E                     ; 874B= A9 0E       ).
                jsr OSWORD                   ; 874D= 20 F1 FF     q.
                ldx #255-24                  ; 8750= A2 E7       "g
L8752:
                lda LDC00-(255-24),x         ; 8752= BD 19 DB    =.[
                jsr OSASCI                   ; 8755= 20 E3 FF     c.
                inx                          ; 8758= E8          h
                bne L8752                    ; 8759= D0 F7       Pw
                rts                          ; 875B= 60          `

L875C:
                .text "."
                .text $80,"BAUD"
                .text $84,"BOOT"
                .text $88,"CAPS"
                .text $8c,"DATA"
                .text $90,"DELAY"
                .text $94,"DIR"
                .text $98,"EXTUBE"
                .text $9c,"FDRIVE"
                .text $a0,"FILE"
                .text $a4,"FLOPPY"
                .text $a8,"HARD"
                .text $ac,"IGNORE"
                .text $b0,"INTUBE"
                .text $b4,"LANG"
                .text $b8,"LOUD"
                .text $bc,"MODE"
                .text $c0,"NOBOOT"
                .text $c4,"NOCAPS"
                .text $c8,"NODIR"
                .text $cc,"NOSCROLL"
                .text $d0,"NOTUBE"
                .text $d4,"PRINT"
                .text $d8,"QUIET"
                .text $dc,"REPEAT"
                .text $e0,"SCROLL"
                .text $e4,"SHCAPS"
                .text $e8,"TUBE"
                .text $ec,"TV"
                .text $f0,0

_:=[]
_..=[L8BF0]
_..=[L8D7F]
_..=[L89F1]
_..=[L8B7D]
_..=[L8A28]
_..=[L8AE1]
_..=[L88E8]
_..=[L8A66]
_..=[L8A17]
_..=[L8B82]
_..=[L899F]
_..=[L8B2E]
_..=[L88BD]
_..=[L8BAA]
_..=[L8A44]
_..=[L8ABB]
_..=[L88CB]
_..=[L8B87]
_..=[L8A5F]
_..=[L8B10]
_..=[L88B5]
_..=[L8B8E]
_..=[L88AF]
_..=[L8B8E]
_..=[L89B4]
_..=[L8B44]
_..=[L8A4A]
_..=[L8ABB]
_..=[L8A52]
_..=[L8B08]
_..=[L8A0F]
_..=[L8A9F]
_..=[L88F0]
_..=[L8B25]
_..=[L8A2E]
_..=[L8AE1]
_..=[L88DC]
_..=[L8A66]
_..=[L88C3]
_..=[L8BAA]
_..=[L8A3C]
_..=[L8A89]
_..=[L89E4]
_..=[L8AF5]
_..=[L89C7]
_..=[L8B78]
_..=[L8A09]
_..=[L8A9F]
_..=[L89A1]
_..=[L8B34]
_..=[L8A36]
_..=[L8A89]
_..=[L88E2]
_..=[L8A66]
_..=[L89EE]
_..=[L8AF5]
_..=[L8906]
_..=[L8B17]
maybe_configure_routines=_

                .for i=0,i<len(maybe_configure_routines),i+=1
                .beword maybe_configure_routines[i]-1
                .next
                
L887A:
                jsr L8934                    ; 887A 20 34 89
                bcs L8889                    ; 887D= B0 0A       0.
                ldx #$28                     ; 887F= A2 28       "(
L8881:
                ldy $E6                      ; 8881= A4 E6       $f
                jsr makeROMServiceCall                    ; 8883= 20 72 EE     rn
                bne L88AC                    ; 8886= D0 24       P$
                rts                          ; 8888= 60          `

L8889:
                tax                          ; 8889= AA          *
                lda L8786,x                  ; 888A= BD 86 87    =..
                pha                          ; 888D= 48          H
                lda L8787,x                  ; 888E= BD 87 87    =..
                pha                          ; 8891= 48          H
L8892:
                jmp skipSpacesAndCheckForCRInStringInput                    ; 8892= 4C FF F2    L.r

L8895:
                jsr L8934                    ; 8895= 20 34 89     4.
                bcs L889E                    ; 8898= B0 04       0.
                ldx #$29                     ; 889A= A2 29       ")
                bra L8881                    ; 889C= 80 E3       .c

L889E:
                tax                          ; 889E= AA          *
                lda L8788,x                  ; 889F= BD 88 87    =..
                pha                          ; 88A2= 48          H
                lda L8789,x                  ; 88A3= BD 89 87    =..
                pha                          ; 88A6= 48          H
                jsr skipSpacesAndCheckForCRInStringInput                    ; 88A7= 20 FF F2     .r
                beq L8892                    ; 88AA= F0 E6       pf
L88AC:
                jmp L8976                    ; 88AC= 4C 76 89    Lv.

L88AF:
                bne L88AC                    ; 88AF= D0 FB       P{
                lda #$00                     ; 88B1= A9 00       ).
                bra L88B9                    ; 88B3= 80 04       ..

L88B5:
                bne L88AC                    ; 88B5= D0 F5       Pu
                lda #$80                     ; 88B7= A9 80       ).
L88B9:
                ldy #$7F                     ; 88B9= A0 7F        .
                bra L88D8                    ; 88BB= 80 1B       ..

L88BD:
                bne L88AC                    ; 88BD= D0 ED       Pm
                lda #$00                     ; 88BF= A9 00       ).
                bra L88C7                    ; 88C1= 80 04       ..

L88C3:
                bne L88AC                    ; 88C3= D0 E7       Pg
                lda #$40                     ; 88C5= A9 40       )@
L88C7:
                ldy #$BF                     ; 88C7= A0 BF        ?
                bra L88D8                    ; 88C9= 80 0D       ..

L88CB:
                jsr L8971                    ; 88CB= 20 71 89     q.
                jsr L8987                    ; 88CE= 20 87 89     ..
                txa                          ; 88D1= 8A          .
                cmp #$08                     ; 88D2= C9 08       I.
                bcs L88AC                    ; 88D4= B0 D6       0V
                ldy #$F8                     ; 88D6= A0 F8        x
L88D8:
                ldx #$19                     ; 88D8= A2 19       ".
                bra L892D                    ; 88DA= 80 51       .Q

L88DC:
                bne L88AC                    ; 88DC= D0 CE       PN
                lda #$10                     ; 88DE= A9 10       ).
                bra L88EC                    ; 88E0= 80 0A       ..

L88E2:
                bne L88AC                    ; 88E2= D0 C8       PH
                lda #$08                     ; 88E4= A9 08       ).
                bra L88EC                    ; 88E6= 80 04       ..

L88E8:
                bne L88AC                    ; 88E8= D0 C2       PB
                lda #$20                     ; 88EA= A9 20       )
L88EC:
                ldy #$C7                     ; 88EC= A0 C7        G
                bra L88D8                    ; 88EE= 80 E8       .h

L88F0:
                jsr L8971                    ; 88F0= 20 71 89     q.
                jsr L8987                    ; 88F3= 20 87 89     ..
                txa                          ; 88F6= 8A          .
                and #$7F                     ; 88F7= 29 7F       ).
                cmp #$08                     ; 88F9= C9 08       I.
                bcs L8911                    ; 88FB= B0 14       0.
                inx                          ; 88FD= E8          h
                bpl L8902                    ; 88FE= 10 02       ..
                ora #$08                     ; 8900= 09 08       ..
L8902:
                ldy #$F0                     ; 8902= A0 F0        p
                bra L892B                    ; 8904= 80 25       .%

L8906:
                beq L8930                    ; 8906= F0 28       p(
                jsr L8971                    ; 8908= 20 71 89     q.
                cpx #$FC                     ; 890B= E0 FC       `|
                bcs L8913                    ; 890D= B0 04       0.
                cpx #$04                     ; 890F= E0 04       `.
L8911:
                bcs L8976                    ; 8911= B0 63       0c
L8913:
                txa                          ; 8913= 8A          .
                asl a                        ; 8914= 0A          .
                sta $B1                      ; 8915= 85 B1       .1
                ldx #$00                     ; 8917= A2 00       ".
                jsr LF30A                    ; 8919= 20 0A F3     .s
                beq L8922                    ; 891C= F0 04       p.
                jsr L898F                    ; 891E= 20 8F 89     ..
                tax                          ; 8921= AA          *
L8922:
                txa                          ; 8922= 8A          .
                ora $B1                      ; 8923= 05 B1       .1
                asl a                        ; 8925= 0A          .
                asl a                        ; 8926= 0A          .
                asl a                        ; 8927= 0A          .
                asl a                        ; 8928= 0A          .
L8929:
                ldy #$0F                     ; 8929= A0 0F        .
L892B:
                ldx #$18                     ; 892B= A2 18       ".
L892D:
                jmp L89D6                    ; 892D= 4C D6 89    LV.

L8930:
                lda #$00                     ; 8930= A9 00       ).
                bra L8929                    ; 8932= 80 F5       .u

L8934:
                jsr skipSpacesAndCheckForCRInStringInput                    ; 8934= 20 FF F2     .r
                sty $E6                      ; 8937= 84 E6       .f
                beq L8979                    ; 8939= F0 3E       p>
                ldx #$00                     ; 893B= A2 00       ".
                bra L894A                    ; 893D= 80 0B       ..

L893F:
                eor L875C,x                  ; 893F= 5D 5C 87    ]\.
                and #$DF                     ; 8942= 29 DF       )_
                bne L895C                    ; 8944= D0 16       P.
                iny                          ; 8946= C8          H
L8947:
                bcs L896C                    ; 8947= B0 23       0#
                inx                          ; 8949= E8          h
L894A:
                lda ($F2),y                  ; 894A= B1 F2       1r
                jsr isLetter                    ; 894C= 20 71 EA     qj
                bcc L893F                    ; 894F= 90 EE       .n
L8951:
                lda L875C,x                  ; 8951= BD 5C 87    =\.
                bmi L896C                    ; 8954= 30 16       0.
                lda ($F2),y                  ; 8956= B1 F2       1r
                cmp #$2E                     ; 8958= C9 2E       I.
                beq L8960                    ; 895A= F0 04       p.
L895C:
                clc                          ; 895C= 18          .
                ldy $E6                      ; 895D= A4 E6       $f
                dey                          ; 895F= 88          .
L8960:
                iny                          ; 8960= C8          H
                dex                          ; 8961= CA          J
L8962:
                inx                          ; 8962= E8          h
                lda L875C,x                  ; 8963= BD 5C 87    =\.
                beq L896E                    ; 8966= F0 06       p.
                bpl L8962                    ; 8968= 10 F8       .x
                bra L8947                    ; 896A= 80 DB       .[

L896C:
                sec                          ; 896C= 38          8
                rts                          ; 896D= 60          `

L896E:
                bcs L896C                    ; 896E= B0 FC       0|
L8970:
                rts                          ; 8970= 60          `

L8971:
                jsr L85E6                    ; 8971= 20 E6 85     f.
                bcs L8970                    ; 8974= B0 FA       0z
L8976:
                jmp LFBED                    ; 8976= 4C ED FB    Lm{

L8979:
                ldx #$01                     ; 8979= A2 01       ".
                bra L8951                    ; 897B= 80 D4       .T

L897D:
                jsr L85E6                    ; 897D= 20 E6 85     f.
                bcc L8976                    ; 8980= 90 F4       .t
                txa                          ; 8982= 8A          .
                cmp #$10                     ; 8983= C9 10       I.
                bcs L8976                    ; 8985= B0 EF       0o
L8987:
                pha                          ; 8987= 48          H
                jsr skipSpacesAndCheckForCRInStringInput                    ; 8988= 20 FF F2     .r
L898B:
                bne L8976                    ; 898B= D0 E9       Pi
                pla                          ; 898D= 68          h
                rts                          ; 898E= 60          `

L898F:
                jsr L8997                    ; 898F= 20 97 89     ..
                cmp #$02                     ; 8992= C9 02       I.
                bcs L8976                    ; 8994= B0 E0       0`
                rts                          ; 8996= 60          `

L8997:
                jsr L85E6                    ; 8997= 20 E6 85     f.
                bcc L8976                    ; 899A= 90 DA       .Z
                txa                          ; 899C= 8A          .
                bra L8987                    ; 899D= 80 E8       .h

L899F:
                clc                          ; 899F= 18          .
                .byte $24                    ; BIT zp (make SEC mostly
                                             ; a NOP, in effect)
L89A1:
                sec
                php                          ; 89A2= 08          .
                jsr L8971                    ; 89A3= 20 71 89     q.
                jsr L8987                    ; 89A6= 20 87 89     ..
                plp                          ; 89A9= 28          (
                txa                          ; 89AA= 8A          .
                tay                          ; 89AB= A8          (
                lda #$1A                     ; 89AC= A9 1A       ).
                adc #$00                     ; 89AE= 69 00       i.
                tax                          ; 89B0= AA          *
L89B1:
                jmp L98E4                    ; 89B1= 4C E4 98    Ld.

L89B4:
                beq L8A03                    ; 89B4= F0 4D       pM
                jsr L8971                    ; 89B6= 20 71 89     q.
                phx                          ; 89B9= DA          Z
                jsr L8987                    ; 89BA= 20 87 89     ..
                lda #$00                     ; 89BD= A9 00       ).
                jsr L8A05                    ; 89BF= 20 05 8A     ..
                ply                          ; 89C2= 7A          z
                ldx #$1C                     ; 89C3= A2 1C       ".
                bra L89B1                    ; 89C5= 80 EA       .j

L89C7:
                jsr L8997                    ; 89C7= 20 97 89     ..
                cmp #$05                     ; 89CA= C9 05       I.
L89CC:
                bcs L8976                    ; 89CC= B0 A8       0(
                ldy #$1F                     ; 89CE= A0 1F        .
                lsr a                        ; 89D0= 4A          J
                ror a                        ; 89D1= 6A          j
                ror a                        ; 89D2= 6A          j
                ror a                        ; 89D3= 6A          j
L89D4:
                ldx #$1D                     ; 89D4= A2 1D       ".
L89D6:
                sta $B1                      ; 89D6= 85 B1       .1
                sty $B2                      ; 89D8= 84 B2       .2
                jsr L98B7                    ; 89DA= 20 B7 98     7.
                and $B2                      ; 89DD= 25 B2       %2
                ora $B1                      ; 89DF= 05 B1       .1
                tay                          ; 89E1= A8          (
                bra L89B1                    ; 89E2= 80 CD       .M

L89E4:
                clc                          ; 89E4= 18          .
L89E5:
                bne L898B                    ; 89E5= D0 A4       P$
                ldy #$FE                     ; 89E7= A0 FE        ~
                lda #$00                     ; 89E9= A9 00       ).
                rol a                        ; 89EB= 2A          *
                bra L89D4                    ; 89EC= 80 E6       .f

L89EE:
                sec                          ; 89EE= 38          8
                bra L89E5                    ; 89EF= 80 F4       .t

L89F1:
                jsr L8997                    ; 89F1= 20 97 89     ..
                bne L89F8                    ; 89F4= D0 02       P.
                lda #$07                     ; 89F6= A9 07       ).
L89F8:
                cmp #$09                     ; 89F8= C9 09       I.
                bcs L89CC                    ; 89FA= B0 D0       0P
                dec a                        ; 89FC= 3A          :
                ldy #$E3                     ; 89FD= A0 E3        c
                asl a                        ; 89FF= 0A          .
                asl a                        ; 8A00= 0A          .
                bra L89D4                    ; 8A01= 80 D1       .Q

L8A03:
                lda #$02                     ; 8A03= A9 02       ).
L8A05:
                ldy #$FD                     ; 8A05= A0 FD        }
                bra L89D4                    ; 8A07= 80 CB       .K

L8A09:
                bne L89E5                    ; 8A09= D0 DA       PZ
                lda #$00                     ; 8A0B= A9 00       ).
                bra L8A13                    ; 8A0D= 80 04       ..

L8A0F:
                bne L89E5                    ; 8A0F= D0 D4       PT
                lda #$02                     ; 8A11= A9 02       ).
L8A13:
                ldy #$FD                     ; 8A13= A0 FD        }
                bra L8A24                    ; 8A15= 80 0D       ..

L8A17:
                jsr L8997                    ; 8A17= 20 97 89     ..
                cmp #$08                     ; 8A1A= C9 08       I.
                bcs L89CC                    ; 8A1C= B0 AE       0.
                ldy #$1F                     ; 8A1E= A0 1F        .
                lsr a                        ; 8A20= 4A          J
                ror a                        ; 8A21= 6A          j
                ror a                        ; 8A22= 6A          j
                ror a                        ; 8A23= 6A          j
L8A24:
                ldx #$1E                     ; 8A24= A2 1E       ".
L8A26:
                bra L89D6                    ; 8A26= 80 AE       ..

L8A28:
                bne L89E5                    ; 8A28= D0 BB       P;
                lda #$10                     ; 8A2A= A9 10       ).
                bra L8A32                    ; 8A2C= 80 04       ..

L8A2E:
                bne L89E5                    ; 8A2E= D0 B5       P5
                lda #$00                     ; 8A30= A9 00       ).
L8A32:
                ldy #$EF                     ; 8A32= A0 EF        o
                bra L8A24                    ; 8A34= 80 EE       .n

L8A36:
                bne L89E5                    ; 8A36= D0 AD       P-
                lda #$00                     ; 8A38= A9 00       ).
                bra L8A40                    ; 8A3A= 80 04       ..

L8A3C:
                bne L89E5                    ; 8A3C= D0 A7       P'
                lda #$08                     ; 8A3E= A9 08       ).
L8A40:
                ldy #$F7                     ; 8A40= A0 F7        w
                bra L8A24                    ; 8A42= 80 E0       .`

L8A44:
                bne L89CC                    ; 8A44= D0 86       P.
                lda #$04                     ; 8A46= A9 04       ).
                bra L8A4E                    ; 8A48= 80 04       ..

L8A4A:
                bne L89CC                    ; 8A4A= D0 80       P.
                lda #$00                     ; 8A4C= A9 00       ).
L8A4E:
                ldy #$FB                     ; 8A4E= A0 FB        {
                bra L8A24                    ; 8A50= 80 D2       .R

L8A52:
                jsr L897D                    ; 8A52= 20 7D 89     }.
L8A55:
                asl a                        ; 8A55= 0A          .
                asl a                        ; 8A56= 0A          .
                asl a                        ; 8A57= 0A          .
                asl a                        ; 8A58= 0A          .
                ldy #$0F                     ; 8A59= A0 0F        .
L8A5B:
                ldx #$13                     ; 8A5B= A2 13       ".
                bra L8A26                    ; 8A5D= 80 C7       .G

L8A5F:
                jsr L897D                    ; 8A5F= 20 7D 89     }.
                ldy #$F0                     ; 8A62= A0 F0        p
                bra L8A5B                    ; 8A64= 80 F5       .u

L8A66:
                jsr L8EAD                    ; 8A66= 20 AD 8E     -.
                asl a                        ; 8A69= 0A          .
                asl a                        ; 8A6A= 0A          .
                bmi L8A7A                    ; 8A6B= 30 0D       0.
                asl a                        ; 8A6D= 0A          .
                bmi L8A84                    ; 8A6E= 30 14       0.
                jsr LA958                    ; 8A70= 20 58 A9     X)
                .text "Shift "
                .byte $00
L8A7A:
                jsr LA958                    ; 8A7A= 20 58 A9     X)
                .text "Caps"
                .byte $0D
                .byte $00
                rts
L8A84:
                jsr L8EB1                    ; 8A84= 20 B1 8E     1.
                bra L8A7A                    ; 8A87= 80 F1       .q

L8A89:
                jsr L98AE                    ; 8A89= 20 AE 98     ..
                bit #$08                     ; 8A8C= 89 08       ..
                beq L8A93                    ; 8A8E= F0 03       p.
                jsr L8EB1                    ; 8A90= 20 B1 8E     1.
L8A93:
                jsr LA958                    ; 8A93= 20 58 A9     X)
                .text "Scroll",13,0
                rts                          ; 8A9E= 60          `

L8A9F:
                jsr L98AE                    ; 8A9F= 20 AE 98     ..
                bit #$02                     ; 8AA2= 89 02       ..
                bne L8AB1                    ; 8AA4= D0 0B       P.
                jsr LA958                    ; 8AA6= 20 58 A9     X)
                .text "Quiet",13,0
                rts                          ; 8AB0= 60          `

L8AB1:
                jsr LA958                    ; 8AB1= 20 58 A9     X)
                .text "Loud",13,0
                rts                          ; 8ABA= 60          `

L8ABB:
                jsr L98AE                    ; 8ABB= 20 AE 98     ..
                bit #$04                     ; 8ABE= 89 04       ..
                bne L8ACA                    ; 8AC0= D0 08       P.
                jsr LA958                    ; 8AC2= 20 58 A9     X)
                .text "In",0
                bra L8AD0                    ; 8AC8= 80 06       ..

L8ACA:
                jsr LA958                    ; 8ACA= 20 58 A9     X)
                .text "Ex",0
L8AD0:
                jsr LA958                    ; 8AD0= 20 58 A9     X)
                .text "ternal Tube",13,0
                rts                          ; 8AE0= 60          `

L8AE1:
                jsr L98AE                    ; 8AE1= 20 AE 98     ..
                bit #$10                     ; 8AE4= 89 10       ..
                bne L8AEB                    ; 8AE6= D0 03       P.
                jsr L8EB1                    ; 8AE8= 20 B1 8E     1.
L8AEB:
                jsr LA958                    ; 8AEB= 20 58 A9     X)
                .text "Boot",13,0
                rts                          ; 8AF4= 60          `

L8AF5:
                jsr L98AA                    ; 8AF5= 20 AA 98     *.
                lsr a                        ; 8AF8= 4A          J
                bcs L8AFE                    ; 8AF9= B0 03       0.
                jsr L8EB1                    ; 8AFB= 20 B1 8E     1.
L8AFE:
                jsr LA958                    ; 8AFE= 20 58 A9     X)
                .text "Tube",13,0
                rts                          ; 8B07= 60          `

L8B08:
                jsr L8E9C                    ; 8B08= 20 9C 8E     ..
L8B0B:
                jsr L8BC4                    ; 8B0B= 20 C4 8B     D.
                bra L8B2B                    ; 8B0E= 80 1B       ..

L8B10:
                jsr L8EA4                    ; 8B10= 20 A4 8E     $.
                and #$0F                     ; 8B13= 29 0F       ).
                bra L8B0B                    ; 8B15= 80 F4       .t

L8B17:
                jsr L8E5A                    ; 8B17= 20 5A 8E     Z.
                jsr L8BC3                    ; 8B1A= 20 C3 8B     C.
                lda #$2C                     ; 8B1D= A9 2C       ),
                jsr OSWRCH                   ; 8B1F= 20 EE FF     n.
                txa                          ; 8B22= 8A          .
                bra L8B28                    ; 8B23= 80 03       ..

L8B25:
                jsr L8E76                    ; 8B25= 20 76 8E     v. Read configured MODE
L8B28:
                jsr L8BC4                    ; 8B28= 20 C4 8B     D.
L8B2B:
                jmp OSNEWL                   ; 8B2B= 4C E7 FF    Lg.

L8B2E:
                jsr L8B3A                    ; 8B2E= 20 3A 8B     :.
                tya                          ; 8B31= 98          .
                bra L8B28                    ; 8B32= 80 F4       .t

L8B34:
                jsr L8B3F                    ; 8B34= 20 3F 8B     ?.
                tya                          ; 8B37= 98          .
                bra L8B28                    ; 8B38= 80 EE       .n

L8B3A:
                ldx #$1A                     ; 8B3A= A2 1A       ".
                jmp L98B7                    ; 8B3C= 4C B7 98    L7.

L8B3F:
                ldx #$1B                     ; 8B3F= A2 1B       ".
                jmp L98B7                    ; 8B41= 4C B7 98    L7.

L8B44:
                jsr L98AA                    ; 8B44= 20 AA 98     *.
                bit #$02                     ; 8B47= 89 02       ..
                beq L8B5A                    ; 8B49= F0 0F       p.
L8B4B:
                jsr L8EB1                    ; 8B4B= 20 B1 8E     1.
                jsr LA958                    ; 8B4E= 20 58 A9     X)
                .text "Ignore",13,0
                rts                          ; 8B59= 60          `

L8B5A:
                jsr L8EA8                    ; 8B5A= 20 A8 8E     (.
                jsr L8BC4                    ; 8B5D= 20 C4 8B     D.
                bra L8B2B                    ; 8B60= 80 C9       .I

L8B62:
                jsr L98AA                    ; 8B62= 20 AA 98     *.
                bit #$02                     ; 8B65= 89 02       ..
                bne L8B4B                    ; 8B67= D0 E2       Pb
                jsr LA958                    ; 8B69= 20 58 A9     X)
                .text "Ignore   ",0
                bra L8B5A                    ; 8B76= 80 E2       .b

L8B78:
                jsr L8E8D                    ; 8B78= 20 8D 8E     ..
                bra L8B28                    ; 8B7B= 80 AB       .+

L8B7D:
                jsr L8E84                    ; 8B7D= 20 84 8E     ..
                bra L8B28                    ; 8B80= 80 A6       .&

L8B82:
                jsr L8E97                    ; 8B82= 20 97 8E     ..
                bra L8B28                    ; 8B85= 80 A1       .!

L8B87:
                jsr L8EAD                    ; 8B87= 20 AD 8E     -.
                and #$07                     ; 8B8A= 29 07       ).
                bra L8B28                    ; 8B8C= 80 9A       ..

L8B8E:
                jsr L8EAD                    ; 8B8E= 20 AD 8E     -.
                asl a                        ; 8B91= 0A          .
                bcs L8B9E                    ; 8B92= B0 0A       0.
                jsr LA958                    ; 8B94= 20 58 A9     X)
                .text "Hard",13,0
                rts                          ; 8B9D= 60          `

L8B9E:
                jsr LA958                    ; 8B9E= 20 58 A9     X)
                ; LSR $6C                    ; 8BA1= 46 6C       Fl
                ; EQUB $6F                   ; 8BA3= 6F          o
                ; BVS L8C16                  ; 8BA4= 70 70       pp
                ; ADC $000D,y                ; 8BA6= 79 0D 00    y..
                .text "Floppy"
                .byte $0D
                .byte $00
                rts                          ; 8BA9= 60          `

L8BAA:
                jsr L8EAD                    ; 8BAA= 20 AD 8E     -.
                asl a                        ; 8BAD= 0A          .
                asl a                        ; 8BAE= 0A          .
                bcc L8BB4                    ; 8BAF= 90 03       ..
                jsr L8EB1                    ; 8BB1= 20 B1 8E     1.
L8BB4:
                jsr LA958                    ; 8BB4= 20 58 A9     X)
                .text "Directory",13,0
                rts
L8BC3:
                tya                          ; 8BC3= 98          .
L8BC4:
                sec                          ; 8BC4= 38          8
                ldy #$FF                     ; 8BC5= A0 FF        .
                php                          ; 8BC7= 08          .
L8BC8:
                iny                          ; 8BC8= C8          H
                sbc #$64                     ; 8BC9= E9 64       id
                bcs L8BC8                    ; 8BCB= B0 FB       0{
                adc #$64                     ; 8BCD= 69 64       id
                plp                          ; 8BCF= 28          (
                jsr L8BE4                    ; 8BD0= 20 E4 8B     d.
                ldy #$FF                     ; 8BD3= A0 FF        .
                php                          ; 8BD5= 08          .
                sec                          ; 8BD6= 38          8
L8BD7:
                iny                          ; 8BD7= C8          H
                sbc #$0A                     ; 8BD8= E9 0A       i.
                bcs L8BD7                    ; 8BDA= B0 FB       0{
                adc #$0A                     ; 8BDC= 69 0A       i.
                plp                          ; 8BDE= 28          (
                jsr L8BE4                    ; 8BDF= 20 E4 8B     d.
                clc                          ; 8BE2= 18          .
                tay                          ; 8BE3= A8          (
L8BE4:
                pha                          ; 8BE4= 48          H
                tya                          ; 8BE5= 98          .
                bne L8BEA                    ; 8BE6= D0 02       P.
                bcs L8BEE                    ; 8BE8= B0 04       0.
L8BEA:
                jsr LA873                    ; 8BEA= 20 73 A8     s(
                clc                          ; 8BED= 18          .
L8BEE:
                pla                          ; 8BEE= 68          h
                rts                          ; 8BEF= 60          `

L8BF0:
                jsr L8987                    ; 8BF0= 20 87 89     ..
                phy                          ; 8BF3= 5A          Z
                jsr LA958                    ; 8BF4= 20 58 A9     X)
                .text "Configuration options:"
                .byte $0D
                .text "Baud     <D>"
                .byte $0D
                .text "Boot"
                .byte $0D
                .text "Caps"
                .byte $0D
                .text "Data     <D>"
                .byte $0D
                .text "Delay    <D>"
                .byte $0D
                .text "Dir"
                .byte $0D
                .text "ExTube"
                .byte $0D
                .text "FDrive   <D>",13
                .text "File     <D>",13
                .text "Floppy",13
                .text "Hard",13
                .text "Ignore   [<D>]",13
                .text "InTube",13
                .text "Lang     <D>",13
                .text "Loud",13
                .text "Mode     <D>",13
                .text "NoBoot",13
                .text "NoCaps",13
                .text "NoDir",13
                .text "NoScroll",13
                .text "NoTube",13
                .text "Print    <D>",13
                .text "Quiet",13
                .text "Repeat   <D>",13
                .text "Scroll",13
                .text "ShCaps",13
                .text "Tube",13
                .text "TV       [<D>[,<D>]]",13
                .byte 0
                ply                          ; 8D12= 7A
                ldx #$28                     ; 8D13= A2 28       "(
                jsr makeROMServiceCall                    ; 8D15= 20 72 EE     rn
                jsr LA958                    ; 8D18= 20 58 A9     X)
                .text "Where:"
                .byte $0D
                .text "D is a "
                .text "decimal number, or"
                .byte $0D
                .text "a hexadecimal number preceded by &"
                .byte $0D
                .text "Items within [ ] are optional"
                .byte $0D
                .byte $00
                rts

L8D7F:
                jsr L8987                    ; 8D7F= 20 87 89     ..
                phy                          ; 8D82= 5A          Z
                jsr LA958                    ; 8D83= 20 58 A9     X)
                .text "Configuration status:"
                .byte $0D
                .text "Baud     "
                .byte $00
                jsr L8B7D                    ; 8DA6= 20 7D 8B     }.
L8DA9:
                jsr L8AE1                    ; 8DA9= 20 E1 8A     a.
                jsr L8A66                    ; 8DAC= 20 66 8A     f.
                jsr LA958                    ; 8DAF= 20 58 A9     X)
                ; EQUB $44                   ; 8DB2= 44          D
                ; ADC ($74,x)                ; 8DB3= 61 74       at
                ; ADC ($20,x)                ; 8DB5= 61 20       a
                ; JSR $2020                  ; 8DB7= 20 20 20
                ; JSR $2000                  ; 8DBA= 20 00 20     .
                ; EQUB $82                   ; 8DBD= 82          .
                ; EQUB $8B                   ; 8DBE= 8B          .
                .text "Data     "
                .byte $00
                jsr L8B82
                jsr LA958                    ; 8DBF= 20 58 A9     X)
                .text "Delay    "
                .byte $00
                ;jsr $2000                   ; 8DCA= 20 00 20     .
                jsr L8B2E
                jsr L8BAA
                jsr L8ABB                    ; 8DD2= 20 BB 8A     ;.
                jsr LA958                    ; 8DD5= 20 58 A9     X)
                .text "FDrive   "
                .byte 0
                jsr L8B87                    ; 8DE2= 20 87 8B     ..
                jsr LA958                    ; 8DE5= 20 58 A9     X)
                .text "File     "
                .byte 0
                jsr L8B10                    ; 8DF2= 20 10 8B
                jsr L8B8E                    ; 8DF5= 20 8E 8B     ..
                jsr L8B62                    ; 8DF8= 20 62 8B     b.
                jsr LA958                    ; 8DFB= 20 58 A9     X)
                .text "Lang     "
                .byte 0
                ; JMP $6E61                  ; 8DFE= 4C 61 6E    Lan

                ; EQUB $67                   ; 8E01= 67          g
                ; JSR $2020                  ; 8E02= 20 20 20
                ; JSR $0020                  ; 8E05= 20 20 00      .
                jsr L8B08                    ; 8E08= 20 08 8B     ..
                jsr LA958                    ; 8E0B= 20 58 A9     X)
                .text "Mode     "
                .byte 0
                ; EOR $646F                  ; 8E0E= 4D 6F 64    Mod
                ; ADC $20                    ; 8E11= 65 20       e
                ; JSR $2020                  ; 8E13= 20 20 20
                ; JSR $2000                  ; 8E16= 20 00 20     .
;AND &8B          :\ 8E19= 25 8B       %.
                jsr L8B25
                jsr L8AF5                    ; 8E1B= 20 F5 8A     u.
                jsr L8A9F                    ; 8E1E= 20 9F 8A     ..
                jsr LA958                    ; 8E21= 20 58 A9     X)
                .text "Print    "
                .byte 0
                jsr L8B78                    ; 8E2E= 20 78 8B     x.
                jsr LA958                    ; 8E31= 20 58 A9     X)
                .text "Repeat   "
                .byte 0
                jsr L8B34                    ; 8E3E= 20 34 8B     4.
                jsr L8A89                    ; 8E41= 20 89 8A     ..
                jsr LA958                    ; 8E44= 20 58 A9     X)
                .text "TV       ",0
                jsr L8B17                    ; 8E51= 20 17 8B     ..
                ply                          ; 8E54= 7A          z
                ldx #$29                     ; 8E55= A2 29       ")
                jmp makeROMServiceCall                    ; 8E57= 4C 72 EE    Lrn

L8E5A:
                ldx #$18                     ; 8E5A= A2 18       ".
                jsr L98B7                    ; 8E5C= 20 B7 98     7.
                phy                          ; 8E5F= 5A          Z
                and #$E0                     ; 8E60= 29 E0       )`
                asl a                        ; 8E62= 0A          .
                rol a                        ; 8E63= 2A          *
                rol a                        ; 8E64= 2A          *
                rol a                        ; 8E65= 2A          *
                bit #$04                     ; 8E66= 89 04       ..
                beq L8E6C                    ; 8E68= F0 02       p.
                ora #$FC                     ; 8E6A= 09 FC       .|
L8E6C:
                tay                          ; 8E6C= A8          (
                pla                          ; 8E6D= 68          h
                ldx #$00                     ; 8E6E= A2 00       ".
                bit #$10                     ; 8E70= 89 10       ..
                beq L8E75                    ; 8E72= F0 01       p.
                inx                          ; 8E74= E8          h
L8E75:
                rts                          ; 8E75= 60          `

; Read configured MODE
; --------------------
L8E76:
                ldx #$18                     ; Read CMOS location 10 (&18-14)
                jsr L98B7
                and #$0F                     ; Keep MODE bits
                bit #$08                     ; Check shadow bit in b3
                beq L8E83
                eor #$88                     ; If >7, change to 128+n
L8E83:
                rts

L8E84:
                jsr L98AA                    ; 8E84= 20 AA 98     *.
                and #$1C                     ; 8E87= 29 1C       ).
                lsr a                        ; 8E89= 4A          J
                lsr a                        ; 8E8A= 4A          J
                inc a                        ; 8E8B= 1A          .
                rts                          ; 8E8C= 60          `

L8E8D:
                jsr L98AA                    ; 8E8D= 20 AA 98     *.
L8E90:
                and #$E0                     ; 8E90= 29 E0       )`
                asl a                        ; 8E92= 0A          .
                rol a                        ; 8E93= 2A          *
                rol a                        ; 8E94= 2A          *
                rol a                        ; 8E95= 2A          *
                rts                          ; 8E96= 60          `

L8E97:
                jsr L98AE                    ; 8E97= 20 AE 98     ..
                bra L8E90                    ; 8E9A= 80 F4       .t

L8E9C:
                jsr L8EA4                    ; 8E9C= 20 A4 8E     $.
                lsr a                        ; 8E9F= 4A          J
                lsr a                        ; 8EA0= 4A          J
                lsr a                        ; 8EA1= 4A          J
                lsr a                        ; 8EA2= 4A          J
                rts                          ; 8EA3= 60          `

L8EA4:
                ldx #$13                     ; 8EA4= A2 13       ".
                bra L8EAA                    ; 8EA6= 80 02       ..

L8EA8:
                ldx #$1C                     ; 8EA8= A2 1C       ".
L8EAA:
                jmp L98B7                    ; 8EAA= 4C B7 98    L7.

L8EAD:
                ldx #$19                     ; 8EAD= A2 19       ".
                bra L8EAA                    ; 8EAF= 80 F9       .y

L8EB1:
                jsr LA958                    ; 8EB1= 20 58 A9     X)
                .text "No ",0
                rts                          ; 8EB8= 60          `

L8EB9:
                lda #$C0                     ; 8EB9= A9 C0       )@
                sta hazel.fsFlags      ; 8EBB= 8D C2 DF    .B_
                bra L8ED2                    ; 8EBE= 80 12       ..

L8EC0:
                lsr hazel.fsFlags      ; 8EC0= 4E C2 DF    NB_
                stz hazel.lineNumberBCD+0      ; 8EC3= 9C C3 DF    .C_
                stz hazel.lineNumberBCD+1      ; 8EC6= 9C C4 DF    .D_
                bra L8ECF                    ; 8EC9= 80 04       ..

L8ECB:
                sec                          ; 8ECB= 38          8
                ror hazel.fsFlags      ; 8ECC= 6E C2 DF    nB_
L8ECF:
                lsr hazel.fsFlags      ; 8ECF= 4E C2 DF    NB_
L8ED2:
                stz hazel.lastCharPrinted      ; 8ED2= 9C C5 DF    .E_
                jsr LA545                    ; 8ED5= 20 45 A5     E%
L8ED8:
                bit $FF                      ; 8ED8= 24 FF       $.
                bmi L8F2E                    ; 8EDA= 30 52       0R
                jsr OSBGET                   ; 8EDC= 20 D7 FF     W.
                bcs L8F0F                    ; 8EDF= B0 2E       0.
                bit hazel.fsFlags      ; 8EE1= 2C C2 DF    ,B_
                bvs L8EEB                    ; 8EE4= 70 05       p.
                pha                          ; 8EE6= 48          H
                jsr L91EB                    ; 8EE7= 20 EB 91     k.
                pla                          ; 8EEA= 68          h
L8EEB:
                bit hazel.fsFlags      ; 8EEB= 2C C2 DF    ,B_
                bmi L8F04                    ; 8EEE= 30 14       0.
                cmp #$0D                     ; 8EF0= C9 0D       I.
                beq L8F14                    ; 8EF2= F0 20       p
                cmp #$0A                     ; 8EF4= C9 0A       I.
                beq L8F14                    ; 8EF6= F0 1C       p.
                sta hazel.lastCharPrinted      ; 8EF8= 8D C5 DF    .E_
                cmp #$22                     ; 8EFB= C9 22       I"
                beq L8F04                    ; 8EFD= F0 05       p.
                jsr L9606                    ; 8EFF= 20 06 96     ..
                bra L8F07                    ; 8F02= 80 03       ..

L8F04:
                jsr OSWRCH                   ; 8F04= 20 EE FF     n.
L8F07:
                jsr L8F3A                    ; 8F07= 20 3A 8F     :.
                bcc L8EEB                    ; 8F0A= 90 DF       ._
L8F0C:
                jsr OSNEWL                   ; 8F0C= 20 E7 FF     g.
L8F0F:
                lda #$00                     ; 8F0F= A9 00       ).
                jmp OSFIND                   ; 8F11= 4C CE FF    LN.

L8F14:
                cmp hazel.lastCharPrinted      ; 8F14= CD C5 DF    ME_
                beq L8F29                    ; 8F17= F0 10       p.
                pha                          ; 8F19= 48          H
                lda hazel.lastCharPrinted      ; 8F1A= AD C5 DF    -E_
                cmp #$0D                     ; 8F1D= C9 0D       I.
                beq L8F34                    ; 8F1F= F0 13       p.
                cmp #$0A                     ; 8F21= C9 0A       I.
                beq L8F34                    ; 8F23= F0 0F       p.
                pla                          ; 8F25= 68          h
                sta hazel.lastCharPrinted      ; 8F26= 8D C5 DF    .E_
L8F29:
                jsr OSNEWL                   ; 8F29= 20 E7 FF     g.
                bra L8ED8                    ; 8F2C= 80 AA       .*

L8F2E:
                jsr L8F0C                    ; 8F2E= 20 0C 8F     ..
                jmp LA891                    ; 8F31= 4C 91 A8    L.(

L8F34:
                pla                          ; 8F34= 68          h
                stz hazel.lastCharPrinted      ; 8F35= 9C C5 DF    .E_
                bra L8F07                    ; 8F38= 80 CD       .M

L8F3A:
                jsr OSBGET                   ; 8F3A= 20 D7 FF     W.
                bit $FF                      ; 8F3D= 24 FF       $.
                bmi L8F2E                    ; 8F3F= 30 ED       0m
                rts                          ; 8F41= 60          `

L8F42:
                stx $F2                      ; 8F42= 86 F2       .r
                sty $F3                      ; 8F44= 84 F3       .s
                ldx #$00                     ; 8F46= A2 00       ".
                jsr L92BC                    ; 8F48= 20 BC 92     <.
                ldx #$04                     ; 8F4B= A2 04       ".
                jsr L92BC                    ; 8F4D= 20 BC 92     <.
                ldy #$00                     ; 8F50= A0 00        .
                lsr hazel.tempFSFlag      ; 8F52= 4E C6 DF    NF_
                jsr LF26D                    ; 8F55= 20 6D F2     mr
L8F58:
                jsr gsreadEntryPoint                    ; 8F58= 20 7F F2     .r
                bcc L8F58                    ; 8F5B= 90 FB       .{
                beq L8F79                    ; 8F5D= F0 1A       p.
                ldx #$00                     ; 8F5F= A2 00       ".
                jsr L935B                    ; 8F61= 20 5B 93     [.
                ldx #$03                     ; 8F64= A2 03       ".
L8F66:
                lda $02ED,x                  ; 8F66= BD ED 02    =m.
                sta $02F1,x                  ; 8F69= 9D F1 02    .q.
                dex                          ; 8F6C= CA          J
                bpl L8F66                    ; 8F6D= 10 F7       .w
                jsr skipSpacesAndCheckForCRInStringInput                    ; 8F6F= 20 FF F2     .r
                beq L8F79                    ; 8F72= F0 05       p.
                ldx #$04                     ; 8F74= A2 04       ".
                jsr L935B                    ; 8F76= 20 5B 93     [.
L8F79:
                ldy $F3                      ; 8F79= A4 F3       $s
                ldx $F2                      ; 8F7B= A6 F2       &r
                asl hazel.tempFSFlag      ; 8F7D= 0E C6 DF    .F_
                jsr LA545                    ; 8F80= 20 45 A5     E%
                lda #$02                     ; 8F83= A9 02       ).
                jsr L9461                    ; 8F85= 20 61 94     a.
                ldx #$03                     ; 8F88= A2 03       ".
L8F8A:
                lda $A8,x                    ; 8F8A= B5 A8       5(
                cmp $02ED,x                  ; 8F8C= DD ED 02    ]m.
                bcc L8FFB                    ; 8F8F= 90 6A       .j
                bne L8F96                    ; 8F91= D0 03       P.
                dex                          ; 8F93= CA          J
                bpl L8F8A                    ; 8F94= 10 F4       .t
L8F96:
                ldx #$03                     ; 8F96= A2 03       ".
L8F98:
                lda $02ED,x                  ; 8F98= BD ED 02    =m.
                sta $A8,x                    ; 8F9B= 95 A8       .(
                dex                          ; 8F9D= CA          J
                bpl L8F98                    ; 8F9E= 10 F8       .x
                jsr L945F                    ; 8FA0= 20 5F 94     _.
L8FA3:
                ldx #$00                     ; 8FA3= A2 00       ".
                jsr OSBGET                   ; 8FA5= 20 D7 FF     W.
                bcs L8FF0                    ; 8FA8= B0 46       0F
                jsr L9239                    ; 8FAA= 20 39 92     9.
                pha                          ; 8FAD= 48          H
                lda $02F1                    ; 8FAE= AD F1 02    -q.
                and #$07                     ; 8FB1= 29 07       ).
                beq L8FCA                    ; 8FB3= F0 15       p.
                phy                          ; 8FB5= 5A          Z
                tay                          ; 8FB6= A8          (
L8FB7:
                phy                          ; 8FB7= 5A          Z
                jsr LA958                    ; 8FB8= 20 58 A9     X)
                .text "   ",0
                ply                          ; 8FBF= 7A          z
                lda #$20                     ; 8FC0= A9 20       )
                sta $02F5,x                  ; 8FC2= 9D F5 02    .u.
                inx                          ; 8FC5= E8          h
                dey                          ; 8FC6= 88          .
                bne L8FB7                    ; 8FC7= D0 EE       Pn
                ply                          ; 8FC9= 7A          z
L8FCA:
                pla                          ; 8FCA= 68          h
L8FCB:
                pha                          ; 8FCB= 48          H
                cmp #$20                     ; 8FCC= C9 20       I
                bcc L8FD4                    ; 8FCE= 90 04       ..
                cmp #$7F                     ; 8FD0= C9 7F       I.
                bcc L8FD6                    ; 8FD2= 90 02       ..
L8FD4:
                lda #$2E                     ; 8FD4= A9 2E       ).
L8FD6:
                sta $02F5,x                  ; 8FD6= 9D F5 02    .u.
                pla                          ; 8FD9= 68          h
                jsr LA865                    ; 8FDA= 20 65 A8     e(
                inx                          ; 8FDD= E8          h
                jsr L9248                    ; 8FDE= 20 48 92     H.
                lda $02F1                    ; 8FE1= AD F1 02    -q.
                and #$07                     ; 8FE4= 29 07       ).
                beq L8FF3                    ; 8FE6= F0 0B       p.
                jsr L8F3A                    ; 8FE8= 20 3A 8F     :.
                bcc L8FCB                    ; 8FEB= 90 DE       .^
                jsr L9257                    ; 8FED= 20 57 92     W.
L8FF0:
                jmp L8F0F                    ; 8FF0= 4C 0F 8F    L..

L8FF3:
                jsr L9257                    ; 8FF3= 20 57 92     W.
                bra L8FA3                    ; 8FF6= 80 AB       .+

L8FF8:
                jmp LA54D                    ; 8FF8= 4C 4D A5    LM%

L8FFB:
                jsr L8F0F                    ; 8FFB= 20 0F 8F     ..
                jsr LAAED                    ; 8FFE= 20 ED AA     m*
                .text $b7,"Outside file",0

; *BUILD
; ======
L900F:
                lsr hazel.fsFlags      ; 900F= 4E C2 DF    NB_
                bra L9018                    ; 9012= 80 04       ..
L9014:
                sec                          ; 9014= 38          8
                ror hazel.fsFlags      ; 9015= 6E C2 DF    nB_
L9018:
                stz hazel.lineNumberBCD+0      ; 9018= 9C C3 DF    .C_
                stz hazel.lineNumberBCD+1      ; 901B= 9C C4 DF    .D_
                lda #$80                     ; 901E= A9 80       ).
                bit hazel.fsFlags      ; 9020= 2C C2 DF    ,B_
                bpl L9027                    ; 9023= 10 02       ..
                lda #$C0                     ; 9025= A9 C0       )@
L9027:
                jsr OSFIND                   ; 9027= 20 CE FF     N.
                tay                          ; 902A= A8          (
                beq L8FF8                    ; 902B= F0 CB       pK
                sty $02ED                    ; 902D= 8C ED 02    .m.
                jsr L945A                    ; 9030= 20 5A 94     Z.
L9033:
                jsr L91EB                    ; 9033= 20 EB 91     k.
L9036:
                jsr L869D                    ; 9036= 20 9D 86     ..
                php                          ; 9039= 08          .
                bcc L904B                    ; 903A= 90 0F       ..
                jsr OSNEWL                   ; 903C= 20 E7 FF     g.
                lda #$0D                     ; 903F= A9 0D       ).
                sta LDC00,y                  ; 9041= 99 00 DC    ..\
L9044:
                phy                          ; 9044= 5A          Z
                lda #$7E                     ; 9045= A9 7E       )~
                jsr OSBYTE                   ; 9047= 20 F4 FF     t.
                ply                          ; 904A= 7A          z
L904B:
                tya                          ; 904B= 98          .
                beq L909E                    ; 904C= F0 50       pP
                jsr L90AB                    ; 904E= 20 AB 90     +.
                ldy #$00                     ; 9051= A0 00        .
                ldx #$00                     ; 9053= A2 00       ".
L9055:
                jsr LF29C                    ; 9055= 20 9C F2     .r
                sta LDC00,x                  ; 9058= 9D 00 DC    ..\
                lda #$01                     ; 905B= A9 01       ).
                bit $E4                      ; 905D= 24 E4       $d
                bne L906C                    ; 905F= D0 0B       P.
                lda #$07                     ; 9061= A9 07       ).
                jsr OSWRCH                   ; 9063= 20 EE FF     n.
                jsr L91F5                    ; 9066= 20 F5 91     u.
                plp                          ; 9069= 28          (
                bra L9036                    ; 906A= 80 CA       .J

L906C:
                inx                          ; 906C= E8          h
                bcc L9055                    ; 906D= 90 E6       .f
                plp                          ; 906F= 28          (
                bcc L9073                    ; 9070= 90 01       ..
                dex                          ; 9072= CA          J
L9073:
                php                          ; 9073= 08          .
                phx                          ; 9074= DA          Z
                ldx #$0B                     ; 9075= A2 0B       ".
L9077:
                stz $02EE,x                  ; 9077= 9E EE 02    .n.
                dex                          ; 907A= CA          J
                bpl L9077                    ; 907B= 10 FA       .z
                plx                          ; 907D= FA          z
                stx $02F2                    ; 907E= 8E F2 02    .r.
                lda #$DC                     ; 9081= A9 DC       )\
                sta $02EF                    ; 9083= 8D EF 02    .o.
                dec $02F0                    ; 9086= CE F0 02    Np.
                dec $02F1                    ; 9089= CE F1 02    Nq.
                lda #$02                     ; 908C= A9 02       ).
                ldx #$ED                     ; 908E= A2 ED       "m
                ldy #$02                     ; 9090= A0 02        .
                jsr OSGBPB                   ; 9092= 20 D1 FF     Q.
                plp                          ; 9095= 28          (
                bcc L9033                    ; 9096= 90 9B       ..
L9098:
                ldy $02ED                    ; 9098= AC ED 02    ,m.
                jmp L8F0F                    ; 909B= 4C 0F 8F    L..

L909E:
                plp                          ; 909E= 28          (
                bcs L9098                    ; 909F= B0 F7       0w
                lda #$0D                     ; 90A1= A9 0D       ).
                ldy $02ED                    ; 90A3= AC ED 02    ,m.
                jsr OSBPUT                   ; 90A6= 20 D4 FF     T.
                bra L9033                    ; 90A9= 80 88       ..

L90AB:
                lda #$41                     ; 90AB= A9 41       )A
                sta $E4                      ; 90AD= 85 E4       .d
                stz $F2                      ; 90AF= 64 F2       dr
                lda #$DC                     ; 90B1= A9 DC       )\
                sta $F3                      ; 90B3= 85 F3       .s
                rts                          ; 90B5= 60          `

; *MOVE
; =====
L90B6:
                lda ACCCON                    ; Save ACCCON
                sta hazel.oldACCCON
                pha                          ; Save ACCCON and command line pointer
                phx
                phy
                ldy #$80                     ; Top of available shadow memory at &8000
                lda STATE                      ; Get VDU status
                bit #$10                     ; Jump if not shadow screen, spare up to &8000
                beq L90CE
; Shadow screen selected
                jsr LF1C0                    ; Get screen bottom to XY
                cpy #$30                     ; Screen at &3000, no spare memory, jump to use Hazel
                beq L90E2

; Non-shadow or small shadow screen selected
; Y=top of available memory in shadow memory
L90CE:
                lda #$30                     ; &3000=start of shadow memory
                sta hazel.moveBufferMSB
                lda #$04
                tsb ACCCON
                sta hazel.hasACCCONChanged      ; set 'ACCCON changed'
                tya                          ; A=length of space in shadow memory
                sec
                sbc hazel.moveBufferMSB
                bra L90E9

; No shadow memory available, use Hazel
L90E2:
                lda #$DD                     ; Buffer at &DD00
                sta hazel.moveBufferMSB
                lda #$02                     ; Buffer length=&200

; &DFD6=high byte of buffer address
; A=high byte of buffer length
L90E9:
                sta hazel.moveNumPages      ; Store buffer length
                ply                          ; Get command line pointer
                plx
                phx
                phy
                lda #$40                     ; Open source file
                jsr OSFIND
                tay                          ; Store source handle, jump if not found
                sty hazel.moveSrcHandle
                beq L9134
                ply                          ; Get command line back again
                plx
                stx $F2
                sty $F3
                phx                          ; And save it again
                phy
                ldy #$00                     ; Step past first parameter
                jsr LF26D
L9108:
                jsr gsreadEntryPoint
                bcc L9108
                tya                          ; Save address of dest filename
                clc
                adc $F2
                sta hazel.moveDestName+0
                tax
                lda $F3
                adc #$00
                sta hazel.moveDestName+1
                tay                          ; Temporary filing system flag
                asl hazel.tempFSFlag
                lda #$80                     ; Open destination file
                jsr OSFIND
                tay                          ; Store dest handle, jump if opened
                sty hazel.moveDestHandle
                bne L9137

; Couldn't open destination
                ldy hazel.moveSrcHandle      ; Get source handle and clear it
                stz hazel.moveSrcHandle
                jsr OSFIND                   ; Close source file
L9134:
                jmp LA54D                    ; Jump to 'Not found' error

; Source and dest opened
; ----------------------
; Build OSGBPB source file control block at &02ED
; and destination control block at &DFC7
L9137:
                ldx #$07
L9139:
                stz $02EE,x                  ; Addr=0, Num=0
                stz hazel.moveOSGBPB+1,x
                dex
                bpl L9139
                lda hazel.moveSrcHandle      ; Source handle
                sta $02ED
                lda hazel.moveBufferMSB      ; Buffer address
                sta $02EF
                sta hazel.moveOSGBPB.addr+1
                lda hazel.moveNumPages
                sta $02F3
                sta hazel.moveOSGBPB.numBytes+1
                dec $02F0                    ; Source addr=&FFFFxxxx
                dec $02F1
                dec hazel.moveOSGBPB.addr+2
                dec hazel.moveOSGBPB.addr+3

; Should use &FFFExxxx and let filing system select correct memory
; Unfortunately, CFS/RFS and DFS do not recognise &FFFExxxx, so
; *MOVE has to do it itself, causing problems for filing systems
; that /do/ recognise &FFFExxxx where they have to remember to
; *do* *nothing* for &FFFFxxxx instead of select main memory as
; &FFFFxxxx implies.

                ldx #$ED                     ; XY=>source OSGBPB block
                ldy #$02
                lda #$04                     ; Read data from source
                jsr OSGBPB
                php                          ; Jump if not at end of file
                bcc L9183
; End of file, adjust destination buffer length for final part
                lda #$00
                sbc $02F2
                sta hazel.moveOSGBPB.numBytes+0
                lda hazel.moveOSGBPB.numBytes+1
                sbc $02F3
                sta hazel.moveOSGBPB.numBytes+1
L9183:
                lda hazel.moveDestHandle      ; Destination handle
                sta hazel.moveOSGBPB.handle
                lda #$02                     ; XY=>control block, A=write
                ldx #<hazel.moveOSGBPB
                ldy #>hazel.moveOSGBPB
                jsr OSGBPB
                plp                          ; Loop until end of file
                bcc L9137
                lda #$00
                ldy hazel.moveSrcHandle      ; Get and clear source handle
                stz hazel.moveSrcHandle
                phy                          ; Close source file
                jsr OSFIND
                lda #$00                     ; Get dest handle
                ldy hazel.moveDestHandle
                phy                          ; Clear dest handle and close file
                stz hazel.moveDestHandle
                jsr OSFIND
                ply                          ; Dest not CFS/RFS, jump to...
                cpy #$04
                bcs L91BD
                ply                          ; Pop source handle
L91B3:
                ply                          ; Restore XY
                plx
L91B5:
                pla                          ; Clear 'ACCCON changed', restore ACCCON
                stz hazel.hasACCCONChanged
                sta ACCCON
                rts

L91BD:
                ply                          ; Source was CFS/RFS, jump to exit
                cpy #$04
                bcc L91B3
                ply                          ; Point to first parameter
                sty $02EE
                plx
                stx $02ED
                ldx #$ED
                ldy #$02
                lda #$05                     ; Read info on source file
                jsr OSFILE
                lda hazel.moveDestName+0      ; Get address of dest filename
                sta $02ED
                lda hazel.moveDestName+1      ;  and put in control block
                sta $02EE
                lda #$F0                     ; Mask out 'public' access bits
                trb $02FB
                lda #$01                     ; Write info on dest file
                jsr OSFILE
                bra L91B5                    ; Jump to restore ACCCON and exit

L91EB:
                ldx #$00                     ; 91EB= A2 00       ".
                sec                          ; 91ED= 38          8
                jsr L922E                    ; 91EE= 20 2E 92     ..
                inx                          ; 91F1= E8          h
                jsr L922E                    ; 91F2= 20 2E 92     ..
L91F5:
                sec                          ; 91F5= 38          8
                lda hazel.lineNumberBCD+1      ; 91F6= AD C4 DF    -D_
                jsr L9211                    ; 91F9= 20 11 92     ..
                lda hazel.lineNumberBCD+0      ; 91FC= AD C3 DF    -C_
                pha                          ; 91FF= 48          H
                php                          ; 9200= 08          .
                lsr a                        ; 9201= 4A          J
                lsr a                        ; 9202= 4A          J
                lsr a                        ; 9203= 4A          J
                lsr a                        ; 9204= 4A          J
                plp                          ; 9205= 28          (
                jsr L921C                    ; 9206= 20 1C 92     ..
                pla                          ; 9209= 68          h
                clc                          ; 920A= 18          .
                jsr L921C                    ; 920B= 20 1C 92     ..
                jmp L9F0C                    ; 920E= 4C 0C 9F    L..

L9211:
                pha                          ; 9211= 48          H
                php                          ; 9212= 08          .
                lsr a                        ; 9213= 4A          J
                lsr a                        ; 9214= 4A          J
                lsr a                        ; 9215= 4A          J
                lsr a                        ; 9216= 4A          J
                plp                          ; 9217= 28          (
                jsr L921C                    ; 9218= 20 1C 92     ..
                pla                          ; 921B= 68          h
L921C:
                and #$0F                     ; 921C= 29 0F       ).
                bne L9229                    ; 921E= D0 09       P.
                bcc L9229                    ; 9220= 90 07       ..
                lda #$20                     ; 9222= A9 20       )
                jsr OSWRCH                   ; 9224= 20 EE FF     n.
                sec                          ; 9227= 38          8
                rts                          ; 9228= 60          `

L9229:
                jsr LA873                    ; 9229= 20 73 A8     s(
                clc                          ; 922C= 18          .
                rts                          ; 922D= 60          `

L922E:
                lda #$00                     ; 922E= A9 00       ).
                sed                          ; 9230= F8          x
                adc hazel.lineNumberBCD,x    ; 9231= 7D C3 DF    }C_
                sta hazel.lineNumberBCD,x    ; 9234= 9D C3 DF    .C_
                cld                          ; 9237= D8          X
L9238:
                rts                          ; 9238= 60          `

L9239:
                phx                          ; 9239= DA          Z
                pha                          ; 923A= 48          H
                ldx #$02                     ; 923B= A2 02       ".
L923D:
                lda $02F1,x                  ; 923D= BD F1 02    =q.
                jsr LA86A                    ; 9240= 20 6A A8     j(
                dex                          ; 9243= CA          J
                bpl L923D                    ; 9244= 10 F7       .w
                bra L9254                    ; 9246= 80 0C       ..

L9248:
                phx                          ; 9248= DA          Z
                pha                          ; 9249= 48          H
                ldx #$FC                     ; 924A= A2 FC       "|
L924C:
                inc $01F5,x                  ; 924C= FE F5 01    ~u.
                bne L9254                    ; 924F= D0 03       P.
                inx                          ; 9251= E8          h
                bne L924C                    ; 9252= D0 F8       Px
L9254:
                pla                          ; 9254= 68          h
                plx                          ; 9255= FA          z
                rts                          ; 9256= 60          `

L9257:
                phy                          ; 9257= 5A          Z
                phx                          ; 9258= DA          Z
L9259:
                cpx #$08                     ; 9259= E0 08       `.
                beq L9267                    ; 925B= F0 0A       p.
                jsr LA958                    ; 925D= 20 58 A9     X)
                .text "   ",0
                inx                          ; 9264= E8          h
                bra L9259                    ; 9265= 80 F2       .r

L9267:
                plx                          ; 9267= FA          z
                jsr L9F0C                    ; 9268= 20 0C 9F     ..
                ldy #$00                     ; 926B= A0 00        .
L926D:
                lda $02F5,y                  ; 926D= B9 F5 02    9u.
                jsr OSWRCH                   ; 9270= 20 EE FF     n.
                iny                          ; 9273= C8          H
                dex                          ; 9274= CA          J
                bne L926D                    ; 9275= D0 F6       Pv
                ply                          ; 9277= 7A          z
                jmp OSNEWL                   ; 9278= 4C E7 FF    Lg.

L927B:
                ldx #$07                     ; 927B= A2 07       ".
L927D:
                php                          ; 927D= 08          .
                sei                          ; 927E= 78          x
                lda #$B9                     ; 927F= A9 B9       )9
                sta $F1                      ; 9281= 85 F1       .q
                lda #$89                     ; 9283= A9 89       ).
L9285:
                sta $FB                      ; 9285= 85 FB       .{
                jsr LE598                    ; 9287= 20 98 E5     .e
                phy                          ; 928A= 5A          Z
                ldy #$00                     ; 928B= A0 00        .
                stz $FA                      ; 928D= 64 FA       dz
                stz $F0                      ; 928F= 64 F0       dp
L9291:
                lda ($F0),y                  ; 9291= B1 F0       1p
                sta ($FA),y                  ; 9293= 91 FA       .z
                iny                          ; 9295= C8          H
                bne L9291                    ; 9296= D0 F9       Py
                inc $F1                      ; 9298= E6 F1       fq
                inc $FB                      ; 929A= E6 FB       f{
                dex                          ; 929C= CA          J
                bne L9291                    ; 929D= D0 F2       Pr
                ply                          ; 929F= 7A          z
                plp                          ; 92A0= 28          (
                jmp selectTerminalROM                    ; 92A1= 4C 90 E5    L.e

L92A4:
                ldx #$03                     ; 92A4= A2 03       ".
                bra L927D                    ; 92A6= 80 D5       .U

L92A8:
                txa                          ; 92A8= 8A          .
                beq L927B                    ; 92A9= F0 D0       pP
                cmp #$08                     ; 92AB= C9 08       I.
                bcs L9238                    ; 92AD= B0 89       0.
                php                          ; 92AF= 08          .
                sei                          ; 92B0= 78          x
                adc #$B8                     ; 92B1= 69 B8       i8
                sta $F1                      ; 92B3= 85 F1       .q
                txa                          ; 92B5= 8A          .
                ldx #$01                     ; 92B6= A2 01       ".
                adc #$88                     ; 92B8= 69 88       i.
                bra L9285                    ; 92BA= 80 C9       .I

L92BC:
                stz $02ED,x                  ; 92BC= 9E ED 02    .m.
                stz $02EE,x                  ; 92BF= 9E EE 02    .n.
                stz $02EF,x                  ; 92C2= 9E EF 02    .o.
                stz $02F0,x                  ; 92C5= 9E F0 02    .p.
                rts                          ; 92C8= 60          `

L92C9:
                jsr skipSpacesAndCheckForCRInStringInput                    ; Skip spaces
                jsr L8648                    ; 92CC= 20 48 86     H.
                bcc L92F4                    ; 92CF= 90 23       .#
                jsr L92BC                    ; 92D1= 20 BC 92     <.
L92D4:
                phy                          ; 92D4= 5A          Z
                rol a                        ; 92D5= 2A          *
                rol a                        ; 92D6= 2A          *
                rol a                        ; 92D7= 2A          *
                rol a                        ; 92D8= 2A          *
                ldy #$04                     ; 92D9= A0 04        .
L92DB:
                rol a                        ; 92DB= 2A          *
                rol $02ED,x                  ; 92DC= 3E ED 02    >m.
                rol $02EE,x                  ; 92DF= 3E EE 02    >n.
                rol $02EF,x                  ; 92E2= 3E EF 02    >o.
                rol $02F0,x                  ; 92E5= 3E F0 02    >p.
                bcs L934B                    ; 92E8= B0 61       0a
                dey                          ; 92EA= 88          .
                bne L92DB                    ; 92EB= D0 EE       Pn
                ply                          ; 92ED= 7A          z
                jsr L8648                    ; 92EE= 20 48 86     H.
                bcs L92D4                    ; 92F1= B0 E1       0a
                sec                          ; 92F3= 38          8
L92F4:
                rts                          ; 92F4= 60          `

; *GO (<addr>)
; ============
L92F5:
                jsr skipSpacesAndCheckForCRInStringInput                    ; Skip spaces
                bne L92FD                    ; Jump to read parameters
                jmp L8661                    ; No parameters, enter CLICOM

; *GOIO <addr>
; ============
L92FD:
                ldx #$00                     ; Use &02ED-&02F0
                jsr L935B                    ; Read hex address
                jsr skipSpacesAndCheckForCRInStringInput                    ; Skip spaces
                php                          ; Update &F2/3 to point to any further parameters
                tya
                clc
                adc $F2
                sta $F2
                bcc L9310
                inc $F3
L9310:
                ldy #$00                     ; (&F2),y=>parameters, EQ if no parameters
                plp
                jmp ($02ED)                  ; Jump to address

L9316:
                lda #$FF                     ; 9316= A9 FF       ).
L9318:
                lsr hazel.tempFSFlag      ; 9318= 4E C6 DF    NF_
L931B:
                stx $F2                      ; 931B= 86 F2       .r
                sty $F3                      ; 931D= 84 F3       .s
                stx $02ED                    ; 931F= 8E ED 02    .m.
                sty $02EE                    ; 9322= 8C EE 02    .n.
                pha                          ; 9325= 48          H
                ldx #$02                     ; 9326= A2 02       ".
                jsr L92BC                    ; 9328= 20 BC 92     <.
                ldx #$0A                     ; 932B= A2 0A       ".
                jsr L92BC                    ; 932D= 20 BC 92     <.
                ldy #$FF                     ; 9330= A0 FF        .
                sty $02F3                    ; 9332= 8C F3 02    .s.
                iny                          ; 9335= C8          H
                jsr LF26D                    ; 9336= 20 6D F2     mr
L9339:
                jsr gsreadEntryPoint                    ; 9339= 20 7F F2     .r
                bcc L9339                    ; 933C= 90 FB       .{
                pla                          ; 933E= 68          h
                pha                          ; 933F= 48          H
                bpl L9392                    ; 9340= 10 50       .P
                ldx #$02                     ; 9342= A2 02       ".
                jsr L92C9                    ; 9344= 20 C9 92     I.
                bcs L9361                    ; 9347= B0 18       0.
                beq L9366                    ; 9349= F0 1B       p.
L934B:
                jsr LAAED                    ; 934B= 20 ED AA     m*
                .text $fc,"Bad address",0
L935B:
                jsr L92C9                    ; Read hex address
                bcc L934B                    ; Jump with bad address
                rts

L9361:
                bne L93E2                    ; 9361= D0 7F       P.
                inc $02F3                    ; 9363= EE F3 02    ns.
L9366:
                asl hazel.tempFSFlag      ; 9366= 0E C6 DF    .F_
L9369:
                ldx #$ED                     ; 9369= A2 ED       "m
                ldy #$02                     ; 936B= A0 02        .
                pla                          ; 936D= 68          h
                jmp OSFILE                   ; 936E= 4C DD FF    L].

L9371:
                stx $02ED                    ; 9371= 8E ED 02    .m.
                sty $02EE                    ; 9374= 8C EE 02    .n.
                lda #$06                     ; 9377= A9 06       ).
                pha                          ; 9379= 48          H
                bra L9369                    ; 937A= 80 ED       .m

L937C:
                jsr skipSpacesAndCheckForCRInStringInput                    ; 937C= 20 FF F2     .r
                bne L93E2                    ; 937F= D0 61       Pa
                lda #$00                     ; 9381= A9 00       ).
                tay                          ; 9383= A8          (
                jmp (FINDV)                  ; 9384= 6C 1C 02    l..

L9387:
                bne L938E                    ; 9387= D0 05       P.
                sec                          ; 9389= 38          8
                ror $0246                    ; 938A= 6E 46 02    nF.
                rts                          ; 938D= 60          `

L938E:
                lda #$06                     ; 938E= A9 06       ).
                bra L93EB                    ; 9390= 80 59       .Y

L9392:
                bne L939B                    ; 9392= D0 07       P.
                ldx #$0A                     ; 9394= A2 0A       ".
                jsr L92C9                    ; 9396= 20 C9 92     I.
                bcc L93E2                    ; 9399= 90 47       .G
L939B:
                clv                          ; 939B= B8          8
                lda ($F2),y                  ; 939C= B1 F2       1r
                cmp #$2B                     ; 939E= C9 2B       I+
                bne L93A6                    ; 93A0= D0 04       P.
                bit LE34E                    ; 93A2= 2C 4E E3    ,Nc
                iny                          ; 93A5= C8          H
L93A6:
                ldx #$0E                     ; 93A6= A2 0E       ".
                jsr L92C9                    ; 93A8= 20 C9 92     I.
                bcc L93E2                    ; 93AB= 90 35       .5
                php                          ; 93AD= 08          .
                bvc L93BF                    ; 93AE= 50 0F       P.
                ldx #$FC                     ; 93B0= A2 FC       "|
                clc                          ; 93B2= 18          .
L93B3:
                lda $01FB,x                  ; 93B3= BD FB 01    ={.
                adc $01FF,x                  ; 93B6= 7D FF 01    }..
                sta $01FF,x                  ; 93B9= 9D FF 01    ...
                inx                          ; 93BC= E8          h
                bne L93B3                    ; 93BD= D0 F4       Pt
L93BF:
                ldx #$03                     ; 93BF= A2 03       ".
L93C1:
                lda $02F7,x                  ; 93C1= BD F7 02    =w.
                sta $02F3,x                  ; 93C4= 9D F3 02    .s.
                sta $02EF,x                  ; 93C7= 9D EF 02    .o.
                dex                          ; 93CA= CA          J
                bpl L93C1                    ; 93CB= 10 F4       .t
                plp                          ; 93CD= 28          (
                beq L9366                    ; 93CE= F0 96       p.
                ldx #$06                     ; 93D0= A2 06       ".
                jsr L92C9                    ; 93D2= 20 C9 92     I.
                bcc L93E2                    ; 93D5= 90 0B       ..
                beq L9366                    ; 93D7= F0 8D       p.
                ldx #$02                     ; 93D9= A2 02       ".
                jsr L92C9                    ; 93DB= 20 C9 92     I.
                bcc L93E2                    ; 93DE= 90 02       ..
                beq L9366                    ; 93E0= F0 84       p.
L93E2:
                jmp LFBED                    ; 93E2= 4C ED FB    Lm{

L93E5:
                jsr L85E6                    ; 93E5= 20 E6 85     f.
                bcc L93E2                    ; 93E8= 90 F8       .x
                txa                          ; 93EA= 8A          .
L93EB:
                php                          ; 93EB= 08          .
                lsr hazel.tempFSFlag      ; 93EC= 4E C6 DF    NF_
                plp                          ; 93EF= 28          (
                pha                          ; 93F0= 48          H
                stz $E5                      ; 93F1= 64 E5       de
                stz $E4                      ; 93F3= 64 E4       dd
                jsr LF308                    ; 93F5= 20 08 F3     .s
                beq L9412                    ; 93F8= F0 18       p.
                jsr L85E6                    ; 93FA= 20 E6 85     f.
                bcc L93E2                    ; 93FD= 90 E3       .c
                stx $E5                      ; 93FF= 86 E5       .e
                jsr LF30A                    ; 9401= 20 0A F3     .s
                beq L9412                    ; 9404= F0 0C       p.
                jsr L85E6                    ; 9406= 20 E6 85     f.
                bcc L93E2                    ; 9409= 90 D7       .W
                stx $E4                      ; 940B= 86 E4       .d
                jsr skipSpacesAndCheckForCRInStringInput                    ; 940D= 20 FF F2     .r
                bne L93E2                    ; 9410= D0 D0       PP
L9412:
                ldy $E4                      ; 9412= A4 E4       $d
                ldx $E5                      ; 9414= A6 E5       &e
                pla                          ; 9416= 68          h
                asl hazel.tempFSFlag      ; 9417= 0E C6 DF    .F_
                jsr OSBYTE                   ; 941A= 20 F4 FF     t.
                bvs L93E2                    ; 941D= 70 C3       pC
L941F:
                rts                          ; 941F= 60          `

L9420:
                sec                          ; 9420= 38          8
                bra L9433                    ; 9421= 80 10       ..

L9423:
                ldx #$10                     ; 9423= A2 10       ".
                jsr makeROMServiceCall                    ; 9425= 20 72 EE     rn
                beq L941F                    ; 9428= F0 F5       pu
                jsr LA58B                    ; 942A= 20 8B A5     .%
                lda $0257                    ; 942D= AD 57 02    -W.
                jsr LA56B                    ; 9430= 20 6B A5     k%
L9433:
                php                          ; 9433= 08          .
                phy                          ; 9434= 5A          Z
                ldy $0257                    ; 9435= AC 57 02    ,W.
                sta $0257                    ; 9438= 8D 57 02    .W.
                beq L9440                    ; 943B= F0 03       p.
                jsr OSFIND                   ; 943D= 20 CE FF     N.
L9440:
                lsr hazel.tempFSFlag      ; 9440= 4E C6 DF    NF_
                ply                          ; 9443= 7A          z
                plp                          ; 9444= 28          (
                beq L941F                    ; 9445= F0 D8       pX
                lda #$80                     ; 9447= A9 80       ).
                bcc L944D                    ; 9449= 90 02       ..
                lda #$C0                     ; 944B= A9 C0       )@
L944D:
                asl hazel.tempFSFlag      ; 944D= 0E C6 DF    .F_
                jsr OSFIND                   ; 9450= 20 CE FF     N.
                tay                          ; 9453= A8          (
                beq L93E2                    ; 9454= F0 8C       p.
                sta $0257                    ; 9456= 8D 57 02    .W.
                tay                          ; 9459= A8          (
L945A:
                lda #$02                     ; 945A= A9 02       ).
                jsr L9461                    ; 945C= 20 61 94     a.
L945F:
                lda #$01                     ; 945F= A9 01       ).
L9461:
                ldx #$A8                     ; 9461= A2 A8       "(
                jmp OSARGS                   ; 9463= 4C DA FF    LZ.

L9466:
                lda #$72                     ; 9466= A9 72       )r
                bra L93EB                    ; 9468= 80 81       ..

L946A:
                jsr L9371                    ; 946A= 20 71 93     q.
                tay                          ; 946D= A8          (
                bne L941F                    ; 946E= D0 AF       P/
                jmp LA54D                    ; 9470= 4C 4D A5    LM%

L9473:
                jsr L85E6                    ; 9473= 20 E6 85     f.
                bcc L947C                    ; 9476= 90 04       ..
                cpx #$10                     ; 9478= E0 10       `.
                bcc L941F                    ; 947A= 90 A3       .#
L947C:
                jsr LAAED                    ; 947C= 20 ED AA     m*
                .byte $FB                    ; 947F= FB          {
                .text "Bad key"
                .byte 0

L9488:
                jsr L9473                    ; 9488 20 73 94
                jsr skipSpacesAndCheckForCRInStringInput                    ; 948B 20 FF F2
                bne L947C                    ; 948E D0 EC
                lda #$22                     ; 9490 A9 22
                jsr OSWRCH                   ; 9492= 20 EE FF     n.
                lda $F4                      ; 9495= A5 F4       %t
                pha                          ; 9497= 48          H
                jsr LE598                    ; 9498= 20 98 E5     .e
                lda L8000,x                  ; 949B= BD 00 80    =..
                sta $F2                      ; 949E= 85 F2       .r
                lda L8011,x                  ; 94A0= BD 11 80    =..
                sta $F3                      ; 94A3= 85 F3       .s
                ldy $E6                      ; 94A5= A4 E6       $f
                jsr LEB55                    ; 94A7= 20 55 EB     Uk
                tay                          ; 94AA= A8          (
                beq L94BB                    ; 94AB= F0 0E       p.
L94AD:
                lda ($F2)                    ; 94AD= B2 F2       2r
                jsr L9606                    ; 94AF= 20 06 96     ..
                inc $F2                      ; 94B2= E6 F2       fr
                bne L94B8                    ; 94B4= D0 02       P.
                inc $F3                      ; 94B6= E6 F3       fs
L94B8:
                dey                          ; 94B8= 88          .
                bne L94AD                    ; 94B9= D0 F2       Pr
L94BB:
                pla                          ; 94BB= 68          h
                jsr selectROMA                    ; 94BC= 20 92 E5     .e
                lda #$22                     ; 94BF= A9 22       )"
                jsr OSWRCH                   ; 94C1= 20 EE FF     n.
                jmp OSNEWL                   ; 94C4= 4C E7 FF    Lg.

L94C7:
                jsr L9473                    ; 94C7= 20 73 94     s.
                lda $F4                      ; 94CA= A5 F4       %t
                pha                          ; 94CC= 48          H
                jsr selectTerminalROMAndANDY                    ; 94CD= 20 7F E5     .e
                jsr skipSpacesAndCheckForCRInStringInput                    ; 94D0= 20 FF F2     .r
                stz $B0                      ; 94D3= 64 B0       d0
                beq L94EC                    ; 94D5= F0 15       p.
                ldx #$00                     ; 94D7= A2 00       ".
                sec                          ; 94D9= 38          8
                jsr gsinitEntryPoint                    ; 94DA= 20 6E F2     nr
L94DD:
                jsr gsreadEntryPoint                    ; 94DD= 20 7F F2     .r
                bcs L94E8                    ; 94E0= B0 06       0.
                sta LDC00,x                  ; 94E2= 9D 00 DC    ..\
                inx                          ; 94E5= E8          h
                bra L94DD                    ; 94E6= 80 F5       .u

L94E8:
                bne L947C                    ; 94E8= D0 92       P.
                stx $B0                      ; 94EA= 86 B0       .0
L94EC:
                ldy $E6                      ; 94EC= A4 E6       $f
                jsr LEB55                    ; 94EE= 20 55 EB     Uk
                sta $B5                      ; 94F1= 85 B5       .5
                sec                          ; 94F3= 38          8
                sbc $B0                      ; 94F4= E5 B0       e0
                bcs L950E                    ; 94F6= B0 16       0.
                eor #$FF                     ; 94F8= 49 FF       I.
                adc #$01                     ; 94FA= 69 01       i.
                adc L8010                    ; 94FC= 6D 10 80    m..
                tax                          ; 94FF= AA          *
                lda L8021                    ; 9500= AD 21 80    -!.
                adc #$00                     ; 9503= 69 00       i.
                cmp #$84                     ; 9505= C9 84       I.
                bcc L950E                    ; 9507= 90 05       ..
                bne L94E8                    ; 9509= D0 DD       P]
                txa                          ; 950B= 8A          .
                bne L94E8                    ; 950C= D0 DA       PZ
L950E:
                lda $0268                    ; 950E= AD 68 02    -h.
                beq L9545                    ; 9511= F0 32       p2
                lda $02C9                    ; 9513= AD C9 02    -I.
                cmp $E6                      ; 9516= C5 E6       Ef
                bcc L9545                    ; 9518= 90 2B       .+
                bne L952B                    ; 951A= D0 0F       P.
                jsr LAAED                    ; 951C= 20 ED AA     m*
                .text $fa,"Key in use",0
                ; EQUB $4B                   ; 9520= 4B          K
                ; ADC $79                    ; 9521= 65 79       ey
                ; JSR $6E69                  ; 9523= 20 69 6E     in
                ; JSR $7375                  ; 9526= 20 75 73     us
                ; ADC $00                    ; 9529= 65 00       e.
L952B:
                stz $B2                      ; 952B= 64 B2       d2
                sec                          ; 952D= 38          8
                lda $B0                      ; 952E= A5 B0       %0
                sbc $B5                      ; 9530= E5 B5       e5
                sta $B1                      ; 9532= 85 B1       .1
                bcs L9538                    ; 9534= B0 02       0.
                dec $B2                      ; 9536= C6 B2       F2
L9538:
                clc                          ; 9538= 18          .
                lda $F8                      ; 9539= A5 F8       %x
                adc $B1                      ; 953B= 65 B1       e1
                sta $F8                      ; 953D= 85 F8       .x
                lda $F9                      ; 953F= A5 F9       %y
                adc $B2                      ; 9541= 65 B2       e2
                sta $F9                      ; 9543= 85 F9       .y
L9545:
                dec $0284                    ; 9545= CE 84 02    N..
                ldx $E6                      ; 9548= A6 E6       &f
                lda $B5                      ; 954A= A5 B5       %5
                beq L9593                    ; 954C= F0 45       pE
                lda L8000,x                  ; 954E= BD 00 80    =..
                sta $B1                      ; 9551= 85 B1       .1
                lda L8011,x                  ; 9553= BD 11 80    =..
                sta $B2                      ; 9556= 85 B2       .2
                lda L8001,x                  ; 9558= BD 01 80    =..
                sta $B3                      ; 955B= 85 B3       .3
                lda L8012,x                  ; 955D= BD 12 80    =..
                sta $B4                      ; 9560= 85 B4       .4
L9562:
                lda ($B3)                    ; 9562= B2 B3       23
                sta ($B1)                    ; 9564= 92 B1       .1
                inc $B1                      ; 9566= E6 B1       f1
                bne L956C                    ; 9568= D0 02       P.
                inc $B2                      ; 956A= E6 B2       f2
L956C:
                inc $B3                      ; 956C= E6 B3       f3
                bne L9572                    ; 956E= D0 02       P.
                inc $B4                      ; 9570= E6 B4       f4
L9572:
                lda $B3                      ; 9572= A5 B3       %3
                cmp L8010                    ; 9574= CD 10 80    M..
                lda $B4                      ; 9577= A5 B4       %4
                sbc L8021                    ; 9579= ED 21 80    m!.
                bcc L9562                    ; 957C= 90 E4       .d
L957E:
                inx                          ; 957E= E8          h
                cpx #$11                     ; 957F= E0 11       `.
                bcs L9593                    ; 9581= B0 10       0.
                sec                          ; 9583= 38          8
                lda L8000,x                  ; 9584= BD 00 80    =..
                sbc $B5                      ; 9587= E5 B5       e5
                sta L8000,x                  ; 9589= 9D 00 80    ...
                bcs L957E                    ; 958C= B0 F0       0p
                dec L8011,x                  ; 958E= DE 11 80    ^..
                bra L957E                    ; 9591= 80 EB       .k

L9593:
                ldx $E6                      ; 9593= A6 E6       &f
                lda $B0                      ; 9595= A5 B0       %0
                beq L95FF                    ; 9597= F0 66       pf
                lda L8010                    ; 9599= AD 10 80    -..
                sta $B3                      ; 959C= 85 B3       .3
                clc                          ; 959E= 18          .
                adc $B0                      ; 959F= 65 B0       e0
                sta $B1                      ; 95A1= 85 B1       .1
                lda L8021                    ; 95A3= AD 21 80    -!.
                sta $B4                      ; 95A6= 85 B4       .4
                adc #$00                     ; 95A8= 69 00       i.
                sta $B2                      ; 95AA= 85 B2       .2
                lda $B3                      ; 95AC= A5 B3       %3
                sec                          ; 95AE= 38          8
                sbc L8000,x                  ; 95AF= FD 00 80    }..
                sta $B5                      ; 95B2= 85 B5       .5
                lda $B4                      ; 95B4= A5 B4       %4
                sbc L8011,x                  ; 95B6= FD 11 80    }..
                sta $B6                      ; 95B9= 85 B6       .6
L95BB:
                lda $B5                      ; 95BB= A5 B5       %5
                ora $B6                      ; 95BD= 05 B6       .6
                beq L95DF                    ; 95BF= F0 1E       p.
                lda $B1                      ; 95C1= A5 B1       %1
                bne L95C7                    ; 95C3= D0 02       P.
                dec $B2                      ; 95C5= C6 B2       F2
L95C7:
                dec $B1                      ; 95C7= C6 B1       F1
                lda $B3                      ; 95C9= A5 B3       %3
                bne L95CF                    ; 95CB= D0 02       P.
                dec $B4                      ; 95CD= C6 B4       F4
L95CF:
                dec $B3                      ; 95CF= C6 B3       F3
                lda ($B3)                    ; 95D1= B2 B3       23
                sta ($B1)                    ; 95D3= 92 B1       .1
                lda $B5                      ; 95D5= A5 B5       %5
                bne L95DB                    ; 95D7= D0 02       P.
                dec $B6                      ; 95D9= C6 B6       F6
L95DB:
                dec $B5                      ; 95DB= C6 B5       F5
                bra L95BB                    ; 95DD= 80 DC       .\

L95DF:
                inx                          ; 95DF= E8          h
                cpx #$11                     ; 95E0= E0 11       `.
                bcs L95F3                    ; 95E2= B0 0F       0.
                lda L8000,x                  ; 95E4= BD 00 80    =..
                adc $B0                      ; 95E7= 65 B0       e0
                sta L8000,x                  ; 95E9= 9D 00 80    ...
                bcc L95DF                    ; 95EC= 90 F1       .q
                inc L8011,x                  ; 95EE= FE 11 80    ~..
                bra L95DF                    ; 95F1= 80 EC       .l

L95F3:
                ldy #$00                     ; 95F3= A0 00        .
L95F5:
                lda LDC00,y                  ; 95F5= B9 00 DC    9.\
                sta ($B3),y                  ; 95F8= 91 B3       .3
                iny                          ; 95FA= C8          H
                dec $B0                      ; 95FB= C6 B0       F0
                bne L95F5                    ; 95FD= D0 F6       Pv
L95FF:
                inc $0284                    ; 95FF= EE 84 02    n..
                pla                          ; 9602= 68          h
                jmp selectROMA                    ; 9603= 4C 92 E5    L.e

L9606:
                tax                          ; 9606= AA          *
                bmi L9631                    ; 9607= 30 28       0(
                cmp #$20                     ; 9609= C9 20       I
                bcc L962C                    ; 960B= 90 1F       ..
                inx                          ; 960D= E8          h
                bmi L961F                    ; 960E= 30 0F       0.
                dex                          ; 9610= CA          J
                cmp #$22                     ; 9611= C9 22       I"
                beq L9626                    ; 9613= F0 11       p.
                cmp #$7C                     ; 9615= C9 7C       I|
                bne L961C                    ; 9617= D0 03       P.
                jsr OSWRCH                   ; 9619= 20 EE FF     n.
L961C:
                jmp OSWRCH                   ; 961C= 4C EE FF    Ln.

L961F:
                jsr L963C                    ; 961F= 20 3C 96     <.
                lda #$3F                     ; 9622= A9 3F       )?
                bra L961C                    ; 9624= 80 F6       .v

L9626:
                jsr L963C                    ; 9626= 20 3C 96     <.
                txa                          ; 9629= 8A          .
                bra L961C                    ; 962A= 80 F0       .p

L962C:
                ora #$40                     ; 962C= 09 40       .@
                tax                          ; 962E= AA          *
                bra L9626                    ; 962F= 80 F5       .u

L9631:
                pha                          ; 9631= 48          H
                ldx #$21                     ; 9632= A2 21       "!
                jsr L9626                    ; 9634= 20 26 96     &.
                pla                          ; 9637= 68          h
                and #$7F                     ; 9638= 29 7F       ).
                bra L9606                    ; 963A= 80 CA       .J

L963C:
                lda #$7C                     ; 963C= A9 7C       )|
                bra L961C                    ; 963E= 80 DC       .\

; Day string not matched
; ----------------------
L9640:
                pla                          ; Drop number of characters matched
                pla                          ; Get offset to string table
                ply                          ; Get start of supplied string
                clc                          ; Step to next string table entry
                adc #$04
                cmp #$1C                     ; If not checked 28/4=7 entries, keep looking
                bcc L9666
                rts                          ; Otherwise exit silently

; Month string not matched
; ------------------------
L964B:
                pla                          ; Drop number of characters matched
                pla                          ; Get offset to string table
                ply                          ; Get start of supplied string
                clc                          ; Step to next string table entry
                adc #$04
                cmp #$30                     ; If not checked 48/4=12 entries, keep looking
                bcc L9698
L9655:
                rts                          ; Otherwise exit silently

; OSWORD &0F routine
; ==================
; (&F0)=>control block
; A=length byte from (&F0),0
; Y=0
; Uses OSFILE control block at &2ED-&2FF as workspace
;
L9656:
                stz $02ED
                eor #$0F                     ; len=15, set date
                beq L9665
                eor #$07                     ; len=8, set time
                beq L96D7
                eor #$10                     ; len=24, set date+time
                bne L9655

; Set date and set date+time
; --------------------------
; (&F0),1=>"Day,00 Mon 0000"
; (&F0),1=>"Day,00 Mon 0000.00:00:00"
; A=0, Y=0
L9665:
                iny                          ; Point to supplied data
; Translate day string into day number
L9666:
                phy                          ; Push pointer to data string
                pha                          ; Push offset to match strings
                tax                          ; X=>match strings
                lda #$03                     ; A=3 characters to match
L966B:
                pha                          ; Save number of characters to match
                lda ($F0),y                  ; Get character from string
                eor L9768,x                  ; Compare with day string table
                and #$DF                     ; Force to upper case
                bne L9640                    ; No match step to check next entry
                inx                          ; Step to next character to match
                iny                          ; Step to next data character
                pla                          ; Get character count back
                dec a                        ; Decrement and loop until 3 characters matched
                bne L966B
                lda L9768,x                  ; Get translation byte from string table
                sta $02F4                    ; Store it in workspace
; Translates Sun,Mon,Tue,etc to &01,&02,&03,etc
                plx                          ; Drop char count and table offset
                plx
                lda ($F0),y                  ; Get next character
                cmp #','                     ; Not followed by a comma, so exit silently
                bne L9655
                ldx #$07                     ; Get day of month
                jsr L9730
                bcc L9655                    ; Bad number, exit silently
                iny                          ; Get next character
                lda ($F0),y
                eor #' '                     ; Not space, exit silently
                bne L9655
                iny                          ; Step to first character of month
; Translate month string into month number
; This could use the same code as the Day translation
L9698:
                phy                          ; Push pointer to data string
                pha                          ; Push offset to match strings
                tax                          ; X=>match strings
                lda #$03                     ; A=3 characters to match
L969D:
                pha                          ; 969D= 48          H
                lda ($F0),y                  ; 969E= B1 F0       1p
                eor L9784,x                  ; 96A0= 5D 84 97    ]..
                and #$DF                     ; 96A3= 29 DF       )_
                bne L964B                    ; 96A5= D0 A4       P$
                inx                          ; 96A7= E8          h
                iny                          ; 96A8= C8          H
                pla                          ; 96A9= 68          h
                dec a                        ; 96AA= 3A          :
                bne L969D                    ; 96AB= D0 F0       Pp
                lda L9784,x                  ; 96AD= BD 84 97    =..
                sta $02F6                    ; 96B0= 8D F6 02    .v.
; Translates Jan,Feb,Mar,etc to &01,&02,&03,etc..&09,&10,&11,&12
                plx                          ; Drop char count and table offset
                plx
                lda ($F0),y                  ; Get next character
                cmp #' '                     ; Not followed by space, exit silently
                bne L9655
                ldx #$09                     ; Get century number
                jsr L9730
                bcc L9655                    ; Bad number, exit silently
                jsr L9730                    ; Get year number
                bcc L9655                    ; Bad number, exit silently
                ror $02ED                    ;
                lda ($F0)                    ; Get data length
                cmp #$0F                     ; len=15, jump to just set date
                beq L96FF
; Must be len=24 to set date+time
                iny                          ; Get next character
                lda ($F0),y
                cmp #'.'                     ; If not full stop, exit silently
                bne L9753

; Set time
; --------
L96D7:
                ldx #$04                     ; 96D7= A2 04       ".
                jsr L9730                    ; 96D9= 20 30 97     0.
                bcc L9753                    ; 96DC= 90 75       .u
                iny                          ; 96DE= C8          H
                lda ($F0),y                  ; 96DF= B1 F0       1p
                cmp #$3A                     ; 96E1= C9 3A       I:
                bne L9753                    ; 96E3= D0 6E       Pn
                ldx #$02                     ; 96E5= A2 02       ".
                jsr L9730                    ; 96E7= 20 30 97     0.
                bcc L9753                    ; 96EA= 90 67       .g
                iny                          ; 96EC= C8          H
                lda ($F0),y                  ; 96ED= B1 F0       1p
                cmp #$3A                     ; 96EF= C9 3A       I:
                bne L9753                    ; 96F1= D0 60       P`
                ldx #$00                     ; 96F3= A2 00       ".
                jsr L9730                    ; 96F5= 20 30 97     0.
                bcc L9753                    ; 96F8= 90 59       .Y
                lda #$40                     ; 96FA= A9 40       )@
                tsb $02ED                    ; 96FC= 0C ED 02    .m.
L96FF:
                cli                          ; 96FF= 58          X
                sei                          ; 9700= 78          x
                ldy #$83                     ; 9701= A0 83        .
                ldx #$0B                     ; 9703= A2 0B       ".
                jsr L98E4                    ; 9705= 20 E4 98     d.
                bit $02ED                    ; 9708= 2C ED 02    ,m.
                bpl L971C                    ; 970B= 10 0F       ..
                ldx #$06                     ; 970D= A2 06       ".
L970F:
                ldy $02EE,x                  ; 970F= BC EE 02    <n.
                jsr L98E4                    ; 9712= 20 E4 98     d.
                inx                          ; 9715= E8          h
                cpx #$0A                     ; 9716= E0 0A       `.
                bcc L970F                    ; 9718= 90 F5       .u
                bvc L9729                    ; 971A= 50 0D       P.
L971C:
                ldx #$00                     ; 971C= A2 00       ".
L971E:
                ldy $02EE,x                  ; 971E= BC EE 02    <n.
                jsr L98E4                    ; 9721= 20 E4 98     d.
                inx                          ; 9724= E8          h
                cpx #$06                     ; 9725= E0 06       `.
                bcc L971E                    ; 9727= 90 F5       .u
L9729:
                ldx #$0B                     ; 9729= A2 0B       ".
                ldy #$02                     ; 972B= A0 02        .
                jmp L98E4                    ; 972D= 4C E4 98    Ld.

L9730:
                jsr L9754                    ; 9730= 20 54 97     T.
                eor #$20                     ; 9733= 49 20       I
                beq L973B                    ; 9735= F0 04       p.
                eor #$20                     ; 9737= 49 20       I
                bcc L9753                    ; 9739= 90 18       ..
L973B:
                sta $02EE,x                  ; 973B= 9D EE 02    .n.
                jsr L9754                    ; 973E= 20 54 97     T.
                bcc L9753                    ; 9741= 90 10       ..
                phy                          ; 9743= 5A          Z
                ldy #$04                     ; 9744= A0 04        .
                asl a                        ; 9746= 0A          .
                asl a                        ; 9747= 0A          .
                asl a                        ; 9748= 0A          .
                asl a                        ; 9749= 0A          .
L974A:
                asl a                        ; 974A= 0A          .
                rol $02EE,x                  ; 974B= 3E EE 02    >n.
                dey                          ; 974E= 88          .
                bne L974A                    ; 974F= D0 F9       Py
                ply                          ; 9751= 7A          z
                sec                          ; 9752= 38          8
L9753:
                rts                          ; 9753= 60          `

L9754:
                iny                          ; 9754= C8          H
                lda ($F0),y                  ; 9755= B1 F0       1p
                cmp #$3A                     ; 9757= C9 3A       I:
                bcs L9762                    ; 9759= B0 07       0.
                cmp #$30                     ; 975B= C9 30       I0
                bcc L9762                    ; 975D= 90 03       ..
                and #$0F                     ; 975F= 29 0F       ).
                rts                          ; 9761= 60          `

L9762:
                clc                          ; 9762= 18          .
                rts                          ; 9763= 60          `

L9764:
                .text "   ",0
L9768:
                .text "Sun",$01
                .text "Mon",$02
                .text "Tue",$03
                .text "Wed",$04
                .text "Thu",$05
                .text "Fri",$06
                .text "Sat",$07
L9784:
                .text "Jan",$01
                .text "Feb",$02
                .text "Mar",$03
                .text "Apr",$04
                .text "May",$05
                .text "Jun",$06
                .text "Jul",$07
                .text "Aug",$08
                .text "Sep",$09
                .text "Oct",$10
                .text "Nov",$11
                .text "Dec",$12
L97B4:
                pha
                eor #$02                     ; 97B5= 49 02       I.
                bne L97D4                    ; 97B7= D0 1B       P.
                ldy #$07                     ; 97B9= A0 07        .
                ldx #$00                     ; 97BB= A2 00       ".
L97BD:
                lda ($F0),y                  ; 97BD= B1 F0       1p
                sta $02EE,x                  ; 97BF= 9D EE 02    .n.
                dey                          ; 97C2= 88          .
                inx                          ; 97C3= E8          h
                inx                          ; 97C4= E8          h
                cpx #$06                     ; 97C5= E0 06       `.
                bcc L97BD                    ; 97C7= 90 F4       .t
L97C9:
                lda ($F0),y                  ; 97C9= B1 F0       1p
                sta $02EE,x                  ; 97CB= 9D EE 02    .n.
                inx                          ; 97CE= E8          h
                dey                          ; 97CF= 88          .
                bne L97C9                    ; 97D0= D0 F7       Pw
                bra L9804                    ; 97D2= 80 30       .0

L97D4:
                lda $F0                      ; 97D4= A5 F0       %p
                pha                          ; 97D6= 48          H
                lda $F1                      ; 97D7= A5 F1       %q
                pha                          ; 97D9= 48          H
L97DA:
                ldx #$0C                     ; 97DA= A2 0C       ".
                jsr L98B7                    ; 97DC= 20 B7 98     7.
                ldx #$09                     ; 97DF= A2 09       ".
L97E1:
                jsr L98B7                    ; 97E1= 20 B7 98     7.
                sta $02EE,x                  ; 97E4= 9D EE 02    .n.
                dex                          ; 97E7= CA          J
                bpl L97E1                    ; 97E8= 10 F7       .w
                ldx #$0A                     ; 97EA= A2 0A       ".
                jsr L98B7                    ; 97EC= 20 B7 98     7.
                bpl L97F5                    ; 97EF= 10 04       ..
L97F1:
                cli                          ; 97F1= 58          X
                sei                          ; 97F2= 78          x
                bra L97DA                    ; 97F3= 80 E5       .e

L97F5:
                ldx #$0C                     ; 97F5= A2 0C       ".
                jsr L98B7                    ; 97F7= 20 B7 98     7.
                and #$10                     ; 97FA= 29 10       ).
                bne L97F1                    ; 97FC= D0 F3       Ps
                pla                          ; 97FE= 68          h
                sta $F1                      ; 97FF= 85 F1       .q
                pla                          ; 9801= 68          h
                sta $F0                      ; 9802= 85 F0       .p
L9804:
                pla                          ; 9804= 68          h
                dec a                        ; 9805= 3A          :
                bne L9822                    ; 9806= D0 1A       P.
                ldy #$00                     ; 9808= A0 00        .
                ldx #$09                     ; 980A= A2 09       ".
L980C:
                lda $02EE,x                  ; 980C= BD EE 02    =n.
                sta ($F0),y                  ; 980F= 91 F0       .p
                iny                          ; 9811= C8          H
                dex                          ; 9812= CA          J
                cpx #$06                     ; 9813= E0 06       `.
                bcs L980C                    ; 9815= B0 F5       0u
L9817:
                lda $02ED,x                  ; 9817= BD ED 02    =m.
                sta ($F0),y                  ; 981A= 91 F0       .p
                iny                          ; 981C= C8          H
                dex                          ; 981D= CA          J
                dex                          ; 981E= CA          J
                bpl L9817                    ; 981F= 10 F6       .v
                rts                          ; 9821= 60          `

L9822:
                ldy #$18                     ; 9822= A0 18        .
                lda #$0D                     ; 9824= A9 0D       ).
                sta ($F0),y                  ; 9826= 91 F0       .p
                ldx #$00                     ; 9828= A2 00       ".
                dey                          ; 982A= 88          .
                jsr L9890                    ; 982B= 20 90 98     ..
                lda #$3A                     ; 982E= A9 3A       ):
                sta ($F0),y                  ; 9830= 91 F0       .p
                ldy #$12                     ; 9832= A0 12        .
                sta ($F0),y                  ; 9834= 91 F0       .p
                ldx #$02                     ; 9836= A2 02       ".
                ldy #$14                     ; 9838= A0 14        .
                jsr L9890                    ; 983A= 20 90 98     ..
                ldx #$04                     ; 983D= A2 04       ".
                ldy #$11                     ; 983F= A0 11        .
                jsr L9890                    ; 9841= 20 90 98     ..
                lda #$2E                     ; 9844= A9 2E       ).
                sta ($F0),y                  ; 9846= 91 F0       .p
                lda $02F4                    ; 9848= AD F4 02    -t.
                asl a                        ; 984B= 0A          .
                asl a                        ; 984C= 0A          .
                ldy #$00                     ; 984D= A0 00        .
                tax                          ; 984F= AA          *
L9850:
                lda L9764,x                  ; 9850= BD 64 97    =d.
                sta ($F0),y                  ; 9853= 91 F0       .p
                inx                          ; 9855= E8          h
                iny                          ; 9856= C8          H
                cpy #$03                     ; 9857= C0 03       @.
                bcc L9850                    ; 9859= 90 F5       .u
                lda #$2C                     ; 985B= A9 2C       ),
                sta ($F0),y                  ; 985D= 91 F0       .p
                lda $02F6                    ; 985F= AD F6 02    -v.
                cmp #$10                     ; 9862= C9 10       I.
                bcc L9868                    ; 9864= 90 02       ..
                sbc #$06                     ; 9866= E9 06       i.
L9868:
                dec a                        ; 9868= 3A          :
                asl a                        ; 9869= 0A          .
                asl a                        ; 986A= 0A          .
                tax                          ; 986B= AA          *
                ldy #$07                     ; 986C= A0 07        .
L986E:
                lda L9784,x                  ; 986E= BD 84 97    =..
                sta ($F0),y                  ; 9871= 91 F0       .p
                inx                          ; 9873= E8          h
                iny                          ; 9874= C8          H
                cpy #$0A                     ; 9875= C0 0A       @.
                bcc L986E                    ; 9877= 90 F5       .u
                ldx #$09                     ; 9879= A2 09       ".
                ldy #$0E                     ; 987B= A0 0E        .
                jsr L9890                    ; 987D= 20 90 98     ..
                lda #$19                     ; 9880= A9 19       ).
                jsr L9893                    ; 9882= 20 93 98     ..
                lda #$20                     ; 9885= A9 20       )
                sta ($F0),y                  ; 9887= 91 F0       .p
                ldy #$06                     ; 9889= A0 06        .
                sta ($F0),y                  ; 988B= 91 F0       .p
                dey                          ; 988D= 88          .
                ldx #$07                     ; 988E= A2 07       ".
L9890:
                lda $02EE,x                  ; 9890= BD EE 02    =n.
L9893:
                pha                          ; 9893= 48          H
                jsr L989C                    ; 9894= 20 9C 98     ..
                pla                          ; 9897= 68          h
                lsr a                        ; 9898= 4A          J
                lsr a                        ; 9899= 4A          J
                lsr a                        ; 989A= 4A          J
                lsr a                        ; 989B= 4A          J
L989C:
                and #$0F                     ; 989C= 29 0F       ).
                ora #$30                     ; 989E= 09 30       .0
                cmp #$3A                     ; 98A0= C9 3A       I:
                bcc L98A6                    ; 98A2= 90 02       ..
                adc #$06                     ; 98A4= 69 06       i.
L98A6:
                sta ($F0),y                  ; 98A6= 91 F0       .p
                dey                          ; 98A8= 88          .
                rts                          ; 98A9= 60          `

L98AA:
                ldx #$1D                     ; 98AA= A2 1D       ".
                bra L98B7                    ; 98AC= 80 09       ..

L98AE:
                ldx #$1E                     ; Read CMOS location 16 (&1E-14)
                bra L98B7

L98B2:
                jsr L98FD                    ; 98B2= 20 FD 98     }.
                bcs L98DB                    ; 98B5= B0 24       0$
L98B7:
                php                          ; 98B7= 08          .
                sei                          ; 98B8= 78          x
                jsr setRTCAddress                    ; 98B9= 20 06 99     ..
                lda #$49                     ; 98BC= A9 49       )I
                sta systemVIA.orb            ; 98BE= 8D 40 FE    .@~
                stz systemVIA.ddra            ; 98C1= 9C 43 FE    .C~
                lda #$4A                     ; 98C4= A9 4A       )J
                sta systemVIA.orb            ; 98C6= 8D 40 FE    .@~
                ldy systemVIA.iraNoHandshake            ; 98C9= AC 4F FE    ,O~
L98CC:
                lda #$42
                sta systemVIA.orb            ;RTC AS=0 CS=1 DS=0 R=0
                lda #$02
                sta systemVIA.orb            ;RTC AS=0 CS=0 DS=0 R=0
                stz systemVIA.ddra           ;all bits inputs
                plp
                tya
L98DB:
                rts

L98DC:
                txa                          ; 98DC= 8A          .
                beq L98DB                    ; 98DD= F0 FC       p|
                jsr L98FD                    ; 98DF= 20 FD 98     }.
                bcs L98DB                    ; 98E2= B0 F7       0w
L98E4:
                php
                sei
                jsr setRTCAddress            ;X=address
                lda #$41
                sta systemVIA.orb            ;RTC AS=0 CS=1 DS=0 R=0
                lda #$FF
                sta systemVIA.ddra           ;all bits outputs
                lda #$4A
                sta systemVIA.orb            ;RTC AS=0 CS=1 DS=0 R=1
                sty systemVIA.oraNoHandshake ;store value
                bra L98CC

L98FD:
                cpx #$32                     ; 98FD= E0 32       `2
                bcs L9905                    ; 98FF= B0 04       0.
                txa                          ; 9901= 8A          .
                adc #$0E                     ; 9902= 69 0E       i.
                tax                          ; 9904= AA          *
L9905:
                rts                          ; 9905= 60          `

;-------------------------------------------------------------------------
;
; set RTC address for future read/write operation.
;
; entry:
;
; X = address to set
;
; preserves: Y
; 
setRTCAddress:
                lda #$02
                sta systemVIA.orb            ;RTC AS=0 CS=0 DS=0 R=0
                lda #$82
                sta systemVIA.orb            ;RTC AS=1 CS=0 DS=0 R=0
                lda #$FF
                sta systemVIA.ddra           ;all bits outputs
                stx systemVIA.oraNoHandshake ;write RTC address
                lda #$c2
                sta systemVIA.orb            ;RTC AS=1 CS=1 DS=0 R=0
                lda #$42
                sta systemVIA.orb            ;RTC AS=0 CS=1 DS=0 R=0
                rts                          ; 9922= 60          `

L9923:
                lda #$03                     ; 9923= A9 03       ).
                jsr LD298                    ; 9925= 20 98 D2     .R
                bcc L993C                    ; 9928= 90 12       ..
                jsr L9930                    ; 992A= 20 30 99     0.
                jsr LD8A9                    ; 992D= 20 A9 D8     )X
L9930:
                ldx #$20                     ; 9930= A2 20       "
                jmp LE2B8                    ; 9932= 4C B8 E2    L8b

L9935:
                lda #$02                     ; 9935= A9 02       ).
                jsr LD298                    ; 9937= 20 98 D2     .R
                bcs L99A0                    ; 993A= B0 64       0d
L993C:
                jsr LD3D2                    ; 993C= 20 D2 D3     RS
                jsr L9ABF                    ; 993F= 20 BF 9A     ?.
                bra L994C                    ; 9942= 80 08       ..

L9944:
                jsr LD41A                    ; 9944= 20 1A D4     .T
                beq L99A0                    ; 9947= F0 57       pW
                jsr LD3D2                    ; 9949= 20 D2 D3     RS
L994C:
                lda $E1                      ; 994C= A5 E1       %a
                bit #$20                     ; 994E= 89 20       .
                beq L9957                    ; 9950= F0 05       p.
                pha                          ; 9952= 48          H
                jsr LD6A3                    ; 9953= 20 A3 D6     #V
                pla                          ; 9956= 68          h
L9957:
                bit #$10                     ; 9957= 89 10       ..
                beq L995E                    ; 9959= F0 03       p.
                jsr LD698                    ; 995B= 20 98 D6     .V
L995E:
                jsr L99FC                    ; 995E= 20 FC 99     |.
                php                          ; 9961= 08          .
                jsr L9A5A                    ; 9962= 20 5A 9A     Z.
                ldx #$42                     ; 9965= A2 42       "B
                ldy #$46                     ; 9967= A0 46        F
                lda #$20                     ; 9969= A9 20       )
                bit L8849                    ; 996B= 2C 49 88    ,I.
                beq L998C                    ; 996E= F0 1C       p.
                bmi L998A                    ; 9970= 30 18       0.
                lda $032C                    ; 9972= AD 2C 03    -,.
                cmp $0337                    ; 9975= CD 37 03    M7.
                bne L9982                    ; 9978= D0 08       P.
                lda $032D                    ; 997A= AD 2D 03    --.
                cmp $0338                    ; 997D= CD 38 03    M8.
                beq L9992                    ; 9980= F0 10       p.
L9982:
                ldx #$37                     ; 9982= A2 37       "7
                jsr LD24D                    ; 9984= 20 4D D2     MR
                ldx #$42                     ; 9987= A2 42       "B
                clv                          ; 9989= B8          8
L998A:
                ldy #$2C                     ; 998A= A0 2C        ,
L998C:
                bmi L9995                    ; 998C= 30 07       0.
                bvc L9992                    ; 998E= 50 02       P.
                ldx #$37                     ; 9990= A2 37       "7
L9992:
                jsr LD24D                    ; 9992= 20 4D D2     MR
L9995:
                plp                          ; 9995= 28          (
                bcc L994C                    ; 9996= 90 B4       .4
                rts                          ; 9998= 60          `

L9999:
                lda #$01                     ; 9999= A9 01       ).
                jsr LD298                    ; 999B= 20 98 D2     .R
                bcc L99A9                    ; 999E= 90 09       ..
L99A0:
                ldx #$24                     ; 99A0= A2 24       "$
                bra L99DB                    ; 99A2= 80 37       .7

L99A4:
                jsr LD41A                    ; 99A4= 20 1A D4     .T
                beq L99A0                    ; 99A7= F0 F7       pw
L99A9:
                jsr LD3D2                    ; 99A9= 20 D2 D3     RS
                jsr L99C9                    ; 99AC= 20 C9 99     I.
L99AF:
                jsr LD5E6                    ; 99AF= 20 E6 D5     fU
                jsr L99C9                    ; 99B2= 20 C9 99     I.
                lda L8830                    ; 99B5= AD 30 88    -0.
                ora L8831                    ; 99B8= 0D 31 88    .1.
                beq L99FB                    ; 99BB= F0 3E       p>
                bit L8848                    ; 99BD= 2C 48 88    ,H.
                bvs L99AF                    ; 99C0= 70 ED       pm
                ldx #$42                     ; 99C2= A2 42       "B
                jsr L99D6                    ; 99C4= 20 D6 99     V.
                bra L99AF                    ; 99C7= 80 E6       .f

L99C9:
                jsr LD334                    ; 99C9= 20 34 D3     4S
                jsr L99DE                    ; 99CC= 20 DE 99     ^.
                bit L8848                    ; 99CF= 2C 48 88    ,H.
                bmi L99FB                    ; 99D2= 30 27       0'
                ldx #$46                     ; 99D4= A2 46       "F
L99D6:
                phx                          ; 99D6= DA          Z
                jsr LD280                    ; 99D7= 20 80 D2     .R
                plx                          ; 99DA= FA          z
L99DB:
                jmp LDB4C                    ; 99DB= 4C 4C DB    LL[

L99DE:
                ldx #$03                     ; 99DE= A2 03       ".
L99E0:
                lda L8830,x                  ; 99E0= BD 30 88    =0.
                sta $0342,x                  ; 99E3= 9D 42 03    .B.
                sta $0346,x                  ; 99E6= 9D 46 03    .F.
                dex                          ; 99E9= CA          J
                bpl L99E0                    ; 99EA= 10 F4       .t
L99EC:
                ldy $0342                    ; 99EC= AC 42 03    ,B.
                lda $0343                    ; 99EF= AD 43 03    -C.
                jsr LC92E                    ; 99F2= 20 2E C9     .I
                sty $0342                    ; 99F5= 8C 42 03    .B.
                sta $0343                    ; 99F8= 8D 43 03    .C.
L99FB:
                rts                          ; 99FB= 60          `

L99FC:
                lda $E1                      ; 99FC= A5 E1       %a
                sta L8849                    ; 99FE= 8D 49 88    .I.
                jsr L99DE                    ; 9A01= 20 DE 99     ^.
                ldx #$01                     ; 9A04= A2 01       ".
L9A06:
                stz $0342,x                  ; 9A06= 9E 42 03    .B.
                stz $0346,x                  ; 9A09= 9E 46 03    .F.
                dex                          ; 9A0C= CA          J
                bpl L9A06                    ; 9A0D= 10 F7       .w
L9A0F:
                jsr L9A2E                    ; 9A0F= 20 2E 9A     ..
                lda L8830                    ; 9A12= AD 30 88    -0.
                ora L8831                    ; 9A15= 0D 31 88    .1.
                bne L9A20                    ; 9A18= D0 06       P.
                sec                          ; 9A1A= 38          8
                lda L8847                    ; 9A1B= AD 47 88    -G.
                bne L99EC                    ; 9A1E= D0 CC       PL
L9A20:
                jsr LD5E6                    ; 9A20= 20 E6 D5     fU
                lda L8832                    ; 9A23= AD 32 88    -2.
                cmp $0344                    ; 9A26= CD 44 03    MD.
                beq L9A0F                    ; 9A29= F0 E4       pd
                clc                          ; 9A2B= 18          .
                bra L99EC                    ; 9A2C= 80 BE       .>

L9A2E:
                jsr LD334                    ; 9A2E= 20 34 D3     4S
                bit L8848                    ; 9A31= 2C 48 88    ,H.
                bmi L9A3D                    ; 9A34= 30 07       0.
                php                          ; 9A36= 08          .
                ldx #$46                     ; 9A37= A2 46       "F
                jsr L9A41                    ; 9A39= 20 41 9A     A.
                plp                          ; 9A3C= 28          (
L9A3D:
                bvs L9A59                    ; 9A3D= 70 1A       p.
                ldx #$42                     ; 9A3F= A2 42       "B
L9A41:
                lda L8830                    ; 9A41= AD 30 88    -0.
                tay                          ; 9A44= A8          (
                cmp $0300,x                  ; 9A45= DD 00 03    ]..
                lda L8831                    ; 9A48= AD 31 88    -1.
                pha                          ; 9A4B= 48          H
                sbc $0301,x                  ; 9A4C= FD 01 03    }..
                pla                          ; 9A4F= 68          h
                bcc L9A59                    ; 9A50= 90 07       ..
                sta $0301,x                  ; 9A52= 9D 01 03    ...
                tya                          ; 9A55= 98          .
                sta $0300,x                  ; 9A56= 9D 00 03    ...
L9A59:
                rts                          ; 9A59= 60          `

L9A5A:
                lda $0344                    ; 9A5A= AD 44 03    -D.
                ora $0345                    ; 9A5D= 0D 45 03    .E.
                bne L9ABE                    ; 9A60= D0 5C       P\
                lda $E1                      ; 9A62= A5 E1       %a
                inc a                        ; 9A64= 1A          .
                and #$03                     ; 9A65= 29 03       ).
                bne L9ABE                    ; 9A67= D0 55       PU
                lda #$20                     ; 9A69= A9 20       )
                bit L8849                    ; 9A6B= 2C 49 88    ,I.
                bpl L9A79                    ; 9A6E= 10 09       ..
                beq L9A79                    ; 9A70= F0 07       p.
                ldx #$2C                     ; 9A72= A2 2C       ",
                ldy #$46                     ; 9A74= A0 46        F
                jsr LC91E                    ; 9A76= 20 1E C9     .I
L9A79:
                lda #$10                     ; 9A79= A9 10       ).
                bit L8849                    ; 9A7B= 2C 49 88    ,I.
                bvc L9A89                    ; 9A7E= 50 09       P.
                beq L9A89                    ; 9A80= F0 07       p.
                ldx #$37                     ; 9A82= A2 37       "7
                ldy #$42                     ; 9A84= A0 42        B
                jsr LC91E                    ; 9A86= 20 1E C9     .I
L9A89:
                jsr L9ABF                    ; 9A89= 20 BF 9A     ?.
                lda $E1                      ; 9A8C= A5 E1       %a
                eor #$3C                     ; 9A8E= 49 3C       I<
                rol a                        ; 9A90= 2A          *
                jsr LC66F                    ; 9A91= 20 6F C6     oF
                ror a                        ; 9A94= 6A          j
                sta $E1                      ; 9A95= 85 E1       .a
                bit #$20                     ; 9A97= 89 20       .
                beq L9AAB                    ; 9A99= F0 10       p.
                pha                          ; 9A9B= 48          H
                ldx #$2C                     ; 9A9C= A2 2C       ",
                ldy #$46                     ; 9A9E= A0 46        F
                jsr LD5CC                    ; 9AA0= 20 CC D5     LU
                tya                          ; 9AA3= 98          .
                tax                          ; 9AA4= AA          *
                ldy #$46                     ; 9AA5= A0 46        F
                jsr LC91E                    ; 9AA7= 20 1E C9     .I
                pla                          ; 9AAA= 68          h
L9AAB:
                bit #$10                     ; 9AAB= 89 10       ..
                beq L9ABB                    ; 9AAD= F0 0C       p.
                ldx #$37                     ; 9AAF= A2 37       "7
                ldy #$42                     ; 9AB1= A0 42        B
                jsr LD5CC                    ; 9AB3= 20 CC D5     LU
                ldy #$42                     ; 9AB6= A0 42        B
                jsr LC91E                    ; 9AB8= 20 1E C9     .I
L9ABB:
                stz L8849                    ; 9ABB= 9C 49 88    .I.
L9ABE:
                rts                          ; 9ABE= 60          `

L9ABF:
                ldx #$03                     ; 9ABF= A2 03       ".
L9AC1:
                stz $033B,x                  ; 9AC1= 9E 3B 03    .;.
                dex                          ; 9AC4= CA          J
                bpl L9AC1                    ; 9AC5= 10 FA       .z
                ldy #$28                     ; 9AC7= A0 28        (
                ldx #$1B                     ; 9AC9= A2 1B       ".
                lda #$2C                     ; 9ACB= A9 2C       ),
                jsr L9ADF                    ; 9ACD= 20 DF 9A     _.
                jsr LD6A8                    ; 9AD0= 20 A8 D6     (V
                ldy #$1B                     ; 9AD3= A0 1B        .
                ldx #$28                     ; 9AD5= A2 28       "(
                lda #$37                     ; 9AD7= A9 37       )7
                jsr L9ADF                    ; 9AD9= 20 DF 9A     _.
                jmp LD69D                    ; 9ADC= 4C 9D D6    L.V

L9ADF:
                pha                          ; 9ADF= 48          H
                lda $E1                      ; 9AE0= A5 E1       %a
                lsr a                        ; 9AE2= 4A          J
                bcc L9AF0                    ; 9AE3= 90 0B       ..
                lda L8847                    ; 9AE5= AD 47 88    -G.
                bne L9AEE                    ; 9AE8= D0 04       P.
                ldx #$3B                     ; 9AEA= A2 3B       ";
                bra L9AF0                    ; 9AEC= 80 02       ..

L9AEE:
                ldy #$3B                     ; 9AEE= A0 3B        ;
L9AF0:
                txa                          ; 9AF0= 8A          .
                plx                          ; 9AF1= FA          z
                phx                          ; 9AF2= DA          Z
                pha                          ; 9AF3= 48          H
                phy                          ; 9AF4= 5A          Z
                tay                          ; 9AF5= A8          (
                lda #$03                     ; 9AF6= A9 03       ).
                sta $DA                      ; 9AF8= 85 DA       .Z
L9AFA:
                lda $0300,y                  ; 9AFA= B9 00 03    9..
                sta L881E,x                  ; 9AFD= 9D 1E 88    ...
                iny                          ; 9B00= C8          H
                inx                          ; 9B01= E8          h
                dec $DA                      ; 9B02= C6 DA       FZ
                bpl L9AFA                    ; 9B04= 10 F4       .t
                ply                          ; 9B06= 7A          z
                pla                          ; 9B07= 68          h
                plx                          ; 9B08= FA          z
L9B09:
                pha                          ; 9B09= 48          H
                phy                          ; 9B0A= 5A          Z
                jsr L9B61                    ; 9B0B= 20 61 9B     a.
                dex                          ; 9B0E= CA          J
                ply                          ; 9B0F= 7A          z
                pla                          ; 9B10= 68          h
                phx                          ; 9B11= DA          Z
                iny                          ; 9B12= C8          H
                iny                          ; 9B13= C8          H
                inc a                        ; 9B14= 1A          .
                inc a                        ; 9B15= 1A          .
                inx                          ; 9B16= E8          h
                inx                          ; 9B17= E8          h
                jsr L9B61                    ; 9B18= 20 61 9B     a.
                plx                          ; 9B1B= FA          z
                jsr L9B90                    ; 9B1C= 20 90 9B     ..
                php                          ; 9B1F= 08          .
                pha                          ; 9B20= 48          H
                lda $0305,x                  ; 9B21= BD 05 03    =..
                asl a                        ; 9B24= 0A          .
                ror $030A,x                  ; 9B25= 7E 0A 03    ~..
                bpl L9B2D                    ; 9B28= 10 03       ..
                jsr L9B7F                    ; 9B2A= 20 7F 9B     ..
L9B2D:
                pla                          ; 9B2D= 68          h
                asl a                        ; 9B2E= 0A          .
                ror $030A,x                  ; 9B2F= 7E 0A 03    ~..
                bpl L9B3B                    ; 9B32= 10 07       ..
                inx                          ; 9B34= E8          h
                inx                          ; 9B35= E8          h
                jsr L9B7F                    ; 9B36= 20 7F 9B     ..
                dex                          ; 9B39= CA          J
                dex                          ; 9B3A= CA          J
L9B3B:
                jsr L9B90                    ; 9B3B= 20 90 9B     ..
                bpl L9B46                    ; 9B3E= 10 06       ..
                lda $0305,x                  ; 9B40= BD 05 03    =..
                ldy $0304,x                  ; 9B43= BC 04 03    <..
L9B46:
                plp                          ; 9B46= 28          (
                bmi L9B4F                    ; 9B47= 30 06       0.
                cpy #$00                     ; 9B49= C0 00       @.
                bne L9B4E                    ; 9B4B= D0 01       P.
                dec a                        ; 9B4D= 3A          :
L9B4E:
                dey                          ; 9B4E= 88          .
L9B4F:
                lsr a                        ; 9B4F= 4A          J
                pha                          ; 9B50= 48          H
                tya                          ; 9B51= 98          .
                ror a                        ; 9B52= 6A          j
                sec                          ; 9B53= 38          8
                dex                          ; 9B54= CA          J
                jsr L9B5A                    ; 9B55= 20 5A 9B     Z.
                inx                          ; 9B58= E8          h
                pla                          ; 9B59= 68          h
L9B5A:
                sbc $0307,x                  ; 9B5A= FD 07 03    }..
                sta $0309,x                  ; 9B5D= 9D 09 03    ...
                rts                          ; 9B60= 60          `

L9B61:
                pha                          ; 9B61= 48          H
                lda $0300,y                  ; 9B62= B9 00 03    9..
                sta $0300,x                  ; 9B65= 9D 00 03    ...
                lda $0301,y                  ; 9B68= B9 01 03    9..
                sta $0301,x                  ; 9B6B= 9D 01 03    ...
                ply                          ; 9B6E= 7A          z
                sec                          ; 9B6F= 38          8
                jsr L9B75                    ; 9B70= 20 75 9B     u.
                inx                          ; 9B73= E8          h
                iny                          ; 9B74= C8          H
L9B75:
                lda $0300,y                  ; 9B75= B9 00 03    9..
                sbc $0300,x                  ; 9B78= FD 00 03    }..
                sta $0304,x                  ; 9B7B= 9D 04 03    ...
                rts                          ; 9B7E= 60          `

L9B7F:
                lda $0305,x                  ; 9B7F= BD 05 03    =..
                ldy $0304,x                  ; 9B82= BC 04 03    <..
                jsr LC92E                    ; 9B85= 20 2E C9     .I
                sta $0305,x                  ; 9B88= 9D 05 03    ...
                tya                          ; 9B8B= 98          .
                sta $0304,x                  ; 9B8C= 9D 04 03    ...
                rts                          ; 9B8F= 60          `

L9B90:
                lda $0306,x                  ; 9B90= BD 06 03    =..
                tay                          ; 9B93= A8          (
                cmp $0304,x                  ; 9B94= DD 04 03    ]..
                lda $0307,x                  ; 9B97= BD 07 03    =..
                sbc $0305,x                  ; 9B9A= FD 05 03    }..
                php                          ; 9B9D= 08          .
                lda $0307,x                  ; 9B9E= BD 07 03    =..
                plp                          ; 9BA1= 28          (
                rts                          ; 9BA2= 60          `

L9BA3:
                ldx #$28                     ; 9BA3= A2 28       "(
                stx $DA                      ; 9BA5= 86 DA       .Z
                ldx #$14                     ; 9BA7= A2 14       ".
                ldy #$20                     ; 9BA9= A0 20
                lda #$24                     ; 9BAB= A9 24       )$
                jsr LD580                    ; 9BAD= 20 80 D5     .U
                ldy #$14                     ; 9BB0= A0 14        .
                ldx #$24                     ; 9BB2= A2 24       "$
                jsr LD5B7                    ; 9BB4= 20 B7 D5     7U
                stx L8830                    ; 9BB7= 8E 30 88    .0.
                ldx #$20                     ; 9BBA= A2 20       "
                jsr LD5B7                    ; 9BBC= 20 B7 D5     7U
                stx L8831                    ; 9BBF= 8E 31 88    .1.
                ldx #$28                     ; 9BC2= A2 28       "(
                jsr LD5B7                    ; 9BC4= 20 B7 D5     7U
                sty L8833                    ; 9BC7= 8C 33 88    .3.
                ldy L8831                    ; 9BCA= AC 31 88    ,1.
                jsr LD5B7                    ; 9BCD= 20 B7 D5     7U
                sty L8832                    ; 9BD0= 8C 32 88    .2.
                ldy L8830                    ; 9BD3= AC 30 88    ,0.
                jsr L9C0F                    ; 9BD6= 20 0F 9C     ..
                lda L8833                    ; 9BD9= AD 33 88    -3.
                sta $E0                      ; 9BDC= 85 E0       .`
                ldx #$2C                     ; 9BDE= A2 2C       ",
                jsr L9B09                    ; 9BE0= 20 09 9B     ..
                ldy $E1                      ; 9BE3= A4 E1       $a
                jsr L9C56                    ; 9BE5= 20 56 9C     V.
                ldy L8832                    ; 9BE8= AC 32 88    ,2.
                lda L8833                    ; 9BEB= AD 33 88    -3.
                sta $E1                      ; 9BEE= 85 E1       .a
                ldx #$37                     ; 9BF0= A2 37       "7
                jsr L9C51                    ; 9BF2= 20 51 9C     Q.
                bra L9C0C                    ; 9BF5= 80 15       ..

L9BF7;
                ldy #$14                     ; 9BF7= A0 14        .
                ldx #$24                     ; 9BF9= A2 24       "$
                jsr LD5B7                    ; 9BFB= 20 B7 D5     7U
                sty L8832                    ; 9BFE= 8C 32 88    .2.
                ldy #$20                     ; 9C01= A0 20
                jsr L9C0F                    ; 9C03= 20 0F 9C     ..
                lda L8832                    ; 9C06= AD 32 88    -2.
                jsr L9C4D                    ; 9C09= 20 4D 9C     M.
L9C0C:
                jmp LDAE4                    ; 9C0C= 4C E4 DA    LdZ

L9C0F:
                jsr LD5B7                    ; 9C0F= 20 B7 D5     7U
                stx L8830                    ; 9C12= 8E 30 88    .0.
                ldx L8832                    ; 9C15= AE 32 88    .2.
                jsr LD5B7                    ; 9C18= 20 B7 D5     7U
                sty L8832                    ; 9C1B= 8C 32 88    .2.
                stx L8831                    ; 9C1E= 8E 31 88    .1.
                ldy L8830                    ; 9C21= AC 30 88    ,0.
                ldx #$FC                     ; 9C24= A2 FC       "|
L9C26:
                lda $0300,y                  ; 9C26= B9 00 03    9..
                sta $0246,x                  ; 9C29= 9D 46 02    .F.
                sta $024A,x                  ; 9C2C= 9D 4A 02    .J.
                iny                          ; 9C2F= C8          H
                inx                          ; 9C30= E8          h
                bne L9C26                    ; 9C31= D0 F3       Ps
                ldy L8830                    ; 9C33= AC 30 88    ,0.
                lda L8832                    ; 9C36= AD 32 88    -2.
                sta $E1                      ; 9C39= 85 E1       .a
                ldx #$37                     ; 9C3B= A2 37       "7
                jsr L9B09                    ; 9C3D= 20 09 9B     ..
                ldy L8830                    ; 9C40= AC 30 88    ,0.
                lda L8831                    ; 9C43= AD 31 88    -1.
                jsr L9C4D                    ; 9C46= 20 4D 9C     M.
                ldy L8831                    ; 9C49= AC 31 88    ,1.
                rts                          ; 9C4C= 60          `

L9C4D:
                sta $E0                      ; 9C4D= 85 E0       .`
                ldx #$2C                     ; 9C4F= A2 2C       ",
L9C51:
                jsr L9B09                    ; 9C51= 20 09 9B     ..
                ldy $E0                      ; 9C54= A4 E0       $`
L9C56:
                phy                          ; 9C56= 5A          Z
                lda $0302,y                  ; 9C57= B9 02 03    9..
                cmp $0344                    ; 9C5A= CD 44 03    MD.
                bne L9C67                    ; 9C5D= D0 08       P.
                lda $0303,y                  ; 9C5F= B9 03 03    9..
                cmp $0345                    ; 9C62= CD 45 03    ME.
                beq L9CA0                    ; 9C65= F0 39       p9
L9C67:
                ldx #$2C                     ; 9C67= A2 2C       ",
                jsr L9CC0                    ; 9C69= 20 C0 9C     @.
                ldx #$37                     ; 9C6C= A2 37       "7
                jsr L9CC0                    ; 9C6E= 20 C0 9C     @.
                jsr LDAE4                    ; 9C71= 20 E4 DA     dZ
                ldx #$37                     ; 9C74= A2 37       "7
                jsr LD726                    ; 9C76= 20 26 D7     &W
                ldx #$2C                     ; 9C79= A2 2C       ",
                jsr LD726                    ; 9C7B= 20 26 D7     &W
                ldy #$37                     ; 9C7E= A0 37        7
                jsr LD5CC                    ; 9C80= 20 CC D5     LU
                phx                          ; 9C83= DA          Z
                ldx #$FC                     ; 9C84= A2 FC       "|
L9C86:
                lda $0300,y                  ; 9C86= B9 00 03    9..
                sta $024A,x                  ; 9C89= 9D 4A 02    .J.
                iny                          ; 9C8C= C8          H
                inx                          ; 9C8D= E8          h
                bne L9C86                    ; 9C8E= D0 F6       Pv
                plx                          ; 9C90= FA          z
                ldy #$FC                     ; 9C91= A0 FC        |
L9C93:
                lda $0300,x                  ; 9C93= BD 00 03    =..
                sta $0246,y                  ; 9C96= 99 46 02    .F.
                inx                          ; 9C99= E8          h
                iny                          ; 9C9A= C8          H
                bne L9C93                    ; 9C9B= D0 F6       Pv
                ply                          ; 9C9D= 7A          z
                bra L9C56                    ; 9C9E= 80 B6       .6

L9CA0:
                lda #$2C                     ; 9CA0= A9 2C       ),
                ldx $E0                      ; 9CA2= A6 E0       &`
                jsr L9CAC                    ; 9CA4= 20 AC 9C     ,.
                ply                          ; 9CA7= 7A          z
                lda #$37                     ; 9CA8= A9 37       )7
                ldx $E1                      ; 9CAA= A6 E1       &a
L9CAC:
                sta $DE                      ; 9CAC= 85 DE       .^
                lda $0302,x                  ; 9CAE= BD 02 03    =..
                cmp $0302,y                  ; 9CB1= D9 02 03    Y..
                bne L9CBE                    ; 9CB4= D0 08       P.
                lda $0303,x                  ; 9CB6= BD 03 03    =..
                cmp $0303,y                  ; 9CB9= D9 03 03    Y..
                beq L9CC3                    ; 9CBC= F0 05       p.
L9CBE:
                ldx $DE                      ; 9CBE= A6 DE       &^
L9CC0:
                jsr LD71D                    ; 9CC0= 20 1D D7     .W
L9CC3:
                lda $0300,x                  ; 9CC3= BD 00 03    =..
                cmp $0342                    ; 9CC6= CD 42 03    MB.
                lda $0301,x                  ; 9CC9= BD 01 03    =..
                sbc $0343                    ; 9CCC= ED 43 03    mC.
                bpl L9CDE                    ; 9CCF= 10 0D       ..
                lda $0300,x                  ; 9CD1= BD 00 03    =..
                sta $0342                    ; 9CD4= 8D 42 03    .B.
                lda $0301,x                  ; 9CD7= BD 01 03    =..
                sta $0343                    ; 9CDA= 8D 43 03    .C.
                rts                          ; 9CDD= 60          `

L9CDE:
                lda $0346                    ; 9CDE= AD 46 03    -F.
                cmp $0300,x                  ; 9CE1= DD 00 03    ]..
                lda $0347                    ; 9CE4= AD 47 03    -G.
                sbc $0301,x                  ; 9CE7= FD 01 03    }..
                bpl L9CF8                    ; 9CEA= 10 0C       ..
                lda $0300,x                  ; 9CEC= BD 00 03    =..
                sta $0346                    ; 9CEF= 8D 46 03    .F.
                lda $0301,x                  ; 9CF2= BD 01 03    =..
                sta $0347                    ; 9CF5= 8D 47 03    .G.
L9CF8:
                rts                          ; 9CF8= 60          `

L9CF9:
                jsr LDDA1                    ; 9CF9= 20 A1 DD     !]
                stz $0336                    ; 9CFC= 9C 36 03    .6.
                stz $0337                    ; 9CFF= 9C 37 03    .7.
                jsr LDCB0                    ; 9D02= 20 B0 DC     0\
                bne L9D56                    ; 9D05= D0 4F       PO
                jsr LDC1C                    ; 9D07= 20 1C DC     .\
L9D0A:
                bit $FF                      ; 9D0A= 24 FF       $.
                bmi L9D56                    ; 9D0C= 30 48       0H
                lda $0336                    ; 9D0E= AD 36 03    -6.
                cmp $0337                    ; 9D11= CD 37 03    M7.
                beq L9D56                    ; 9D14= F0 40       p@
                inc a                        ; 9D16= 1A          .
                sta $0336                    ; 9D17= 8D 36 03    .6.
                tax                          ; 9D1A= AA          *
                lda L8400,x                  ; 9D1B= BD 00 84    =..
                sta $0328                    ; 9D1E= 8D 28 03    .(.
                lda L8500,x                  ; 9D21= BD 00 85    =..
                sta $032C                    ; 9D24= 8D 2C 03    .,.
                lda L8600,x                  ; 9D27= BD 00 86    =..
                pha                          ; 9D2A= 48          H
                lsr a                        ; 9D2B= 4A          J
                lsr a                        ; 9D2C= 4A          J
                sta $0329                    ; 9D2D= 8D 29 03    .).
                pla                          ; 9D30= 68          h
                and #$03                     ; 9D31= 29 03       ).
                sta $032D                    ; 9D33= 8D 2D 03    .-.
                lda L8700,x                  ; 9D36= BD 00 87    =..
                stz $032B                    ; 9D39= 9C 2B 03    .+.
                cmp $0306                    ; 9D3C= CD 06 03    M..
                beq L9D4B                    ; 9D3F= F0 0A       p.
                sta $E0                      ; 9D41= 85 E0       .`
                inc a                        ; 9D43= 1A          .
                jsr LDC48                    ; 9D44= 20 48 DC     H\
                bcs L9D56                    ; 9D47= B0 0D       0.
                lda $E0                      ; 9D49= A5 E0       %`
L9D4B:
                cmp $0302                    ; 9D4B= CD 02 03    M..
                beq L9D0A                    ; 9D4E= F0 BA       p:
                dec a                        ; 9D50= 3A          :
                jsr LDC48                    ; 9D51= 20 48 DC     H\
                bcc L9D0A                    ; 9D54= 90 B4       .4
L9D56:
                rts                          ; 9D56= 60          `

L9D57:
                lda $0332                    ; 9D57= AD 32 03    -2.
                tay                          ; 9D5A= A8          (
                cmp $032C                    ; 9D5B= CD 2C 03    M,.
                lda $0333                    ; 9D5E= AD 33 03    -3.
                tax                          ; 9D61= AA          *
                sbc $032D                    ; 9D62= ED 2D 03    m-.
                bcs L9D71                    ; 9D65= B0 0A       0.
                iny                          ; 9D67= C8          H
                bne L9D6B                    ; 9D68= D0 01       P.
                inx                          ; 9D6A= E8          h
L9D6B:
                sty $032E                    ; 9D6B= 8C 2E 03    ...
                stx $032F                    ; 9D6E= 8E 2F 03    ./.
L9D71:
                rts                          ; 9D71= 60          `

L9D72:
                cmp #$FE                     ; 9D72= C9 FE       I~
                bcc L9DCC                    ; 9D74= 90 56       .V
                bne L9D8C                    ; 9D76= D0 14       P.
                cpy #$00                     ; 9D78= C0 00       @.
                beq L9DCC                    ; 9D7A= F0 50       pP
L9D7C:
                bit tube.status1                   ; 9D7C= 2C E0 FE    ,`~
                bpl L9D7C                    ; 9D7F= 10 FB       .{
                lda tube.data1                   ; 9D81= AD E1 FE    -a~
                beq L9DCA                    ; 9D84= F0 44       pD
                jsr OSWRCH                   ; 9D86= 20 EE FF     n.
                jmp L9D7C                    ; 9D89= 4C 7C 9D    L|.

L9D8C:
                lda #<tubeHost.LADE0                     ; 9D8C= A9 7B       ){
                sta EVENTV+0                    ; 9D8E= 8D 20 02    . .
                lda #>tubeHost.LADE0                     ; 9D91= A9 06       ).
                sta EVENTV+1                    ; 9D93= 8D 21 02    .!.
                lda #<tubeBrkHandlerAddr        ; 9D96= A9 16       ).
                sta BRKV+0                    ; 9D98= 8D 02 02    ...
                lda #>tubeBrkHandlerAddr      ; 9D9B= A9 00       ).
                sta BRKV+1                    ; 9D9D= 8D 03 02    ...
                lda #$8E                     ; 9DA0= A9 8E       ).
                sta tube.status1                   ; 9DA2= 8D E0 FE    .`~
                ldy #$00                     ; 9DA5= A0 00        .
L9DA7:
                lda tubeHost.codePage0,y                  ; 9DA7= B9 6E AB    9n+
                sta tubeHostAddr+0*256,y
                lda tubeHost.codePages12,y                  ; 9DAD= B9 65 AC    9e,
                sta tubeHostAddr+1*256,y
                lda tubeHost.codePages12+256,y                  ; 9DB3= B9 65 AD    9e-
                sta tubeHostAddr+2*256,y
                dey                          ; 9DB9= 88          .
                bne L9DA7                    ; 9DBA= D0 EB       Pk
                jsr tubeHost.LAB8D                    ; 9DBC= 20 1F 04     ..
                ldx #tubeHost.brkHandler.size
L9DC1:
                lda tubeHost.brkHandler,x                  ; 9DC1= BD 2D AB    =-+
                sta @wtubeBrkHandlerAddr,x                  ; 9DC4= 9D 16 00    ...
                dex                          ; 9DC7= CA          J
                bpl L9DC1                    ; 9DC8= 10 F7       .w

L9DCA:
                lda #$00                     ; Claim call and return

L9DCC:
                cmp #$12                     ; Jump if not SelectFS
                bne L9DEA
                cpy #$04                     ; Exit if not TAPE/ROM
                bcs L9E16
                cpy #$00                     ; Exit if Y=0, no FS
                beq L9E16
                ldx #$03                     ; X=ROMFS, A=FS number
                tya
                cmp #$02                     ; If A=2, ROMFS, jump to select it
                bcs L9DE3
                ldx #$00                     ; X=TAPE, A=speed+2
                adc #$02
L9DE3:
                adc #$89                     ; Convert to TAPE/ROM select value
                jsr LEDC0                    ; Call TAPE/ROM select routine
                bra L9DCA                    ; Jump to claim and return

L9DEA:
                cmp #$06                     ; Not ErrorOccured
                bne L9E17
                lda hazel.hasACCCONChanged ; Skip if ACCCON not changed
                beq L9DFC
                stz hazel.hasACCCONChanged ; Clear ACCCON changed flag
                lda hazel.oldACCCON        ; Restore ACCCON
                sta ACCCON
L9DFC:
                phy                          ; 9DFC= 5A          Z
                ldy hazel.moveSrcHandle
                beq L9E08                    ; 9E00= F0 06       p.
                stz hazel.moveSrcHandle
                jsr L8F0F                    ; 9E05= 20 0F 8F     ..
L9E08:
                ldy hazel.moveDestHandle
                beq L9E13                    ; 9E0B= F0 06       p.
                stz hazel.moveDestHandle
                jsr L8F0F                    ; 9E10= 20 0F 8F     ..
L9E13:
                ply                          ; 9E13= 7A          z
                lda #$06                     ; 9E14= A9 06       ).
L9E16:
                rts                          ; 9E16= 60          `

L9E17:
                cmp #$26                     ; 9E17= C9 26       I&
                bne L9E38                    ; 9E19= D0 1D       P.
                lda #$8D                     ; 9E1B= A9 8D       ).
                jsr L9E2C                    ; 9E1D= 20 2C 9E     ,.
                ldx #$03                     ; 9E20= A2 03       ".
                lda #$04                     ; 9E22= A9 04       ).
                bit $C6                      ; 9E24= 24 C6       $F
                beq L9E2A                    ; 9E26= F0 02       p.
                ldx #$00                     ; 9E28= A2 00       ".
L9E2A:
                lda #$8C                     ; 9E2A= A9 8C       ).
L9E2C:
                jsr LEDC0                    ; 9E2C= 20 C0 ED     @m
                lda #$00                     ; 9E2F= A9 00       ).
                tay                          ; 9E31= A8          (
                jsr LA1F9                    ; 9E32= 20 F9 A1     y!
                lda #$26                     ; 9E35= A9 26       )&
                rts                          ; 9E37= 60          `

L9E38:
                cmp #$09                     ; 9E38= C9 09       I.
                bne L9E8F                    ; 9E3A= D0 53       PS
                phy                          ; 9E3C= 5A          Z
                lda ($F2),y                  ; 9E3D= B1 F2       1r
                cmp #$0D                     ; 9E3F= C9 0D       I.
                bne L9E61                    ; 9E41= D0 1E       P.
                jsr L9EFC                    ; 9E43= 20 FC 9E     |.
                jsr LA958                    ; 9E46= 20 58 A9     X)
                .text "  MOS",13
                .text 13
                .text "TERMINAL 1.20",13
                .text 0
                bra L9E8B
L9E61:
                ldx #$02                     ; 9E61= A2 02       ".
L9E63:
                lda ($F2),y                  ; 9E63= B1 F2       1r
                cmp #$2E                     ; 9E65= C9 2E       I.
                beq L9E95                    ; 9E67= F0 2C       p,
                and #$DF                     ; 9E69= 29 DF       )_
                cmp L9E92,x                  ; 9E6B= DD 92 9E    ]..
                bne L9E7B                    ; 9E6E= D0 0B       P.
                iny                          ; 9E70= C8          H
                dex                          ; 9E71= CA          J
                bpl L9E63                    ; 9E72= 10 EF       .o
                lda ($F2),y                  ; 9E74= B1 F2       1r
                jsr isLetter                    ; 9E76= 20 71 EA     qj
                bcs L9E95                    ; 9E79= B0 1A       0.
L9E7B:
                lda ($F2),y                  ; 9E7B= B1 F2       1r
                cmp #$0D                     ; 9E7D= C9 0D       I.
                beq L9E8B                    ; 9E7F= F0 0A       p.
                iny                          ; 9E81= C8          H
                cmp #$20                     ; 9E82= C9 20       I
                bne L9E7B                    ; 9E84= D0 F5       Pu
                jsr skipSpacesAndCheckForCRInStringInput                    ; 9E86= 20 FF F2     .r
                bne L9E61                    ; 9E89= D0 D6       PV
L9E8B:
                ply                          ; 9E8B= 7A          z
                lda #$09                     ; 9E8C= A9 09       ).
                rts                          ; 9E8E= 60          `

L9E8F:
                jmp LAE19                    ; 9E8F= 4C 19 AE    L..

L9E92:
                .text "SOM"
                ; EQUB $53                   ; 9E92= 53          S
                ; EQUB $4F                   ; 9E93= 4F          O
                ; EOR LFC20                  ; 9E94= 4D 20 FC    M |
                ; STZ $68A9,x                ; 9E97= 9E A9 68    .)h

L9E95:
                jsr L9EFC                    ; 9E95= 20 FC 9E
                lda #$68                     ; 9E98= A9 68
                sta $B0                      ; 9E9A= 85 B0       .0
                lda #$83                     ; 9E9C= A9 83       ).
                sta $B1                      ; 9E9E= 85 B1       .1
L9EA0:
                lda ($B0)                    ; 9EA0= B2 B0       20
                bmi L9EF4                    ; 9EA2= 30 50       0P
                jsr L9F0C                    ; 9EA4= 20 0C 9F     ..
                jsr L9F0C                    ; 9EA7= 20 0C 9F     ..
                lda ($B0)                    ; 9EAA= B2 B0       20
L9EAC:
                jsr L9F0E                    ; 9EAC= 20 0E 9F     ..
                inc $B0                      ; 9EAF= E6 B0       f0
                bne L9EB5                    ; 9EB1= D0 02       P.
                inc $B1                      ; 9EB3= E6 B1       f1
L9EB5:
                lda ($B0)                    ; 9EB5= B2 B0       20
                bpl L9EAC                    ; 9EB7= 10 F3       .s
                lda #$04                     ; 9EB9= A9 04       ).
                clc                          ; 9EBB= 18          .
                adc $B0                      ; 9EBC= 65 B0       e0
                sta $B0                      ; 9EBE= 85 B0       .0
                bcc L9EC4                    ; 9EC0= 90 02       ..
                inc $B1                      ; 9EC2= E6 B1       f1
L9EC4:
                jsr LE25C                    ; 9EC4= 20 5C E2     \b
                cpx #$13                     ; 9EC7= E0 13       `.
                beq L9EEF                    ; 9EC9= F0 24       p$
L9ECB:
                jsr LE252                    ; 9ECB= 20 52 E2     Rb
                txa                          ; 9ECE= 8A          .
                beq L9EA0                    ; 9ECF= F0 CF       pO
                cpx #$14                     ; 9ED1= E0 14       `.
                beq L9EA0                    ; 9ED3= F0 CB       pK
                bcc L9EE4                    ; 9ED5= 90 0D       ..
                cpx #$28                     ; 9ED7= E0 28       `(
                beq L9EA0                    ; 9ED9= F0 C5       pE
                bcs L9EE9                    ; 9EDB= B0 0C       0.
                jsr LE25C                    ; 9EDD= 20 5C E2     \b
                cpx #$27                     ; 9EE0= E0 27       `'
                beq L9EEF                    ; 9EE2= F0 0B       p.
L9EE4:
                jsr L9F0C                    ; 9EE4= 20 0C 9F     ..
                bra L9ECB                    ; 9EE7= 80 E2       .b

L9EE9:
                cpx #$3C                     ; 9EE9= E0 3C       `<
                bcc L9EE4                    ; 9EEB= 90 F7       .w
                beq L9EA0                    ; 9EED= F0 B1       p1
L9EEF:
                jsr L9F1E                    ; 9EEF= 20 1E 9F     ..
                bra L9EA0                    ; 9EF2= 80 AC       .,

L9EF4:
                jsr LE252                    ; 9EF4= 20 52 E2     Rb
                txa                          ; 9EF7= 8A          .
                beq L9E8B                    ; 9EF8= F0 91       p.
                bra L9EEF                    ; 9EFA= 80 F3       .s

L9EFC:
                phy                          ; 9EFC= 5A          Z
                jsr LA958                    ; 9EFD= 20 58 A9     X)
                .text 13,"OS 3.20",13,0
                ply
                rts                          ; 9F0B= 60          `

L9F0C:
                lda #$20                     ; 9F0C= A9 20       )
L9F0E:
                phx                          ; 9F0E= DA          Z
                ldx $B0                      ; 9F0F= A6 B0       &0
                phx                          ; 9F11= DA          Z
                ldx $B1                      ; 9F12= A6 B1       &1
                jsr OSWRCH                   ; 9F14= 20 EE FF     n.
L9F17:
                stx $B1                      ; 9F17= 86 B1       .1
                plx                          ; 9F19= FA          z
                stx $B0                      ; 9F1A= 86 B0       .0
                plx                          ; 9F1C= FA          z
                rts                          ; 9F1D= 60          `

L9F1E:
                phx                          ; 9F1E= DA          Z
                ldx $B0                      ; 9F1F= A6 B0       &0
                phx                          ; 9F21= DA          Z
                ldx $B1                      ; 9F22= A6 B1       &1
                jsr OSNEWL                   ; 9F24= 20 E7 FF     g.
                bra L9F17                    ; 9F27= 80 EE       .n

; TAPE/ROM OSARGS handler
; =======================
L9F29:
                cpy #$00                     ; Handle<>0 - read/write open file info
                bne L9F3B
                ora #$00                     ; A<>0 - read/write filing system info - exit
                bne L9F3A

; A=0, Y=0 - read current filing system
; -------------------------------------
                lda #$03                     ; Prepare A=ROMFS
                bit $0247                    ; If TAPE/ROM switch
                bne L9F3A
                and $C6                      ; Mask with speed to give A=2 or A=1

; TAPE/ROM FSC 6 - shut down FS
; TAPE/ROM FSC 8 - OS command
; TAPE/ROM FSC 10 - *INFO
; -----------------------------
L9F3A:
                rts

; OSARGS handle<>0 - red/write open file info
; -------------------------------------------
L9F3B:
                cmp #$00                     ; Not =PTR, exit unsupported
                bne L9F3A
                cpy #$02                     ; =PTR#2 - read PTR on output handle
                beq L9F60

; Read PTR on CFS/RFS input file
; ------------------------------
                lda #$01                     ; Check if this is input channel and is open
                jsr LAA68
                lda $039E
                sta $00,x
                phy                          ; 9F4D= 5A          Z
                lda $03DE                    ; 9F4E= AD DE 03    -^.
                ldy $03DD                    ; 9F51= AC DD 03    ,].
                bne L9F57                    ; 9F54= D0 01       P.
                dec a                        ; 9F56= 3A          :
L9F57:
                dey                          ; 9F57= 88          .
                sty $01,x                    ; 9F58= 94 01       ..
                ply                          ; 9F5A= 7A          z
L9F5B:
                sta $02,x                    ; 9F5B= 95 02       ..
                stz $03,x                    ; 9F5D= 74 03       t.
                rts                          ; 9F5F= 60          `

; Read PTR on TAPE output file
; ----------------------------
L9F60:
                lda #$02                     ; Check if this is output channel and is open
                jsr LAA68
                lda $039D                    ; Copy PTR to control block
                sta $00,x
                lda $0394
                sta $01,x
                lda $0395
                bra L9F5B

; TAPE/ROM FSC dispatch table
; ---------------------------

_:=[]
_..=[LA422]          ;0 - *OPT
_..=[LA4F1]          ;1 - EOF
_..=[LA110]          ;2 - */
_..=[LA129]          ;3 - unknown * command
_..=[LA110]          ;4 - *RUN
_..=[LA168]          ;5 - *CAT
_..=[L9F3A]          ;6 - shut down FS
_..=[L9F9E]          ;7 - obtain file handle range
_..=[L9F3A]          ;8 - OS command
_..=[LA155]          ;9 - *EX
_..=[L9F3A]          ;10 - *INFO
_..=[LA113]          ;11 - *RUN command for library
tape_and_rom_dispatch_fsc_routines=_
                
L9F74:
                .byte <tape_and_rom_dispatch_fsc_routines-1
L9F80:
                .byte >tape_and_rom_dispatch_fsc_routines-1

; TAPE/ROM FSC
; ============
L9F8C:
                cmp #$0C                     ; function<12 - exit unchanged
                bcs L9F3A
                stx $BC                      ; Index into dispatch table
                tax
                lda L9F80,x
                pha
                lda L9F74,x
                pha
                ldx $BC
                rts

; TAPE/ROM FSC 7 - obtain file handle range
; -----------------------------------------
L9F9E:
                ldx #$03                     ; 9F9E= A2 03       ".
                ldy #$03                     ; 9FA0= A0 03        .
                lda $0247                    ; 9FA2= AD 47 02    -G.
                bne L9F3A                    ; 9FA5= D0 93       P.
                dey                          ; 9FA7= 88          .
                ldx #$01                     ; 9FA8= A2 01       ".
                rts                          ; 9FAA= 60          `

L9FAB:
                pla                          ; 9FAB= 68          h
                plp                          ; 9FAC= 28          (
                sec                          ; 9FAD= 38          8
                rts                          ; 9FAE= 60          `

L9FAF:
                php                          ; 9FAF= 08          .
                pha                          ; 9FB0= 48          H
                jsr LA9F3                    ; 9FB1= 20 F3 A9     s)
                lda $03C2                    ; 9FB4= AD C2 03    -B.
                pha                          ; 9FB7= 48          H
                jsr LA502                    ; 9FB8= 20 02 A5     .%
                pla                          ; 9FBB= 68          h
                bcs L9FAB                    ; 9FBC= B0 ED       0m
                beq L9FD9                    ; 9FBE= F0 19       p.
                ldx #$03                     ; 9FC0= A2 03       ".
                lda #$FF                     ; 9FC2= A9 FF       ).
L9FC4:
                pha                          ; 9FC4= 48          H
                lda $03BE,x                  ; 9FC5= BD BE 03    =>.
                sta $B0,x                    ; 9FC8= 95 B0       .0
                pla                          ; 9FCA= 68          h
                and $B0,x                    ; 9FCB= 35 B0       50
                dex                          ; 9FCD= CA          J
                bpl L9FC4                    ; 9FCE= 10 F4       .t
                inc a                        ; 9FD0= 1A          .
                bne L9FD9                    ; 9FD1= D0 06       P.
                jsr LA9B1                    ; 9FD3= 20 B1 A9     1)
                jmp L934B                    ; 9FD6= 4C 4B 93    LK.

L9FD9:
                lda $03CA                    ; 9FD9= AD CA 03    -J.
                lsr a                        ; 9FDC= 4A          J
                pla                          ; 9FDD= 68          h
                pha                          ; 9FDE= 48          H
                beq L9FF1                    ; 9FDF= F0 10       p.
                bcc L9FF8                    ; 9FE1= 90 15       ..
L9FE3:
                jsr LA9BB                    ; 9FE3= 20 BB A9     ;)
                jsr LAAED                    ; 9FE6= 20 ED AA     m*
                .text $d5,"Locked",0
L9FF1:
                bcc L9FF8                    ; 9FF1= 90 05       ..
                lda #$03                     ; 9FF3= A9 03       ).
                sta $0258                    ; 9FF5= 8D 58 02    .X.
L9FF8:
                lda #$30                     ; 9FF8= A9 30       )0
                and $BB                      ; 9FFA= 25 BB       %;
                beq LA002                    ; 9FFC= F0 04       p.
                lda $C1                      ; 9FFE= A5 C1       %A
LA000:
                bne LA00A                    ; A000= D0 08       P.
LA002:
                phy                          ; A002= 5A          Z
                jsr LAAA4                    ; A003= 20 A4 AA     $*
                ply                          ; A006= 7A          z
                jsr LA6D2                    ; A007= 20 D2 A6     R&
LA00A:
                jsr LA8A1                    ; A00A= 20 A1 A8     !(
                bne LA066                    ; A00D= D0 57       PW
                jsr LAA35                    ; A00F= 20 35 AA     5*
                bit $03CA                    ; A012= 2C CA 03    ,J.
                bmi LA01F                    ; A015= 30 08       0.
                jsr LA85B                    ; A017= 20 5B A8     [(
                jsr LA678                    ; A01A= 20 78 A6     x&
                bra L9FF8                    ; A01D= 80 D9       .Y

LA01F:
                pla                          ; RUN, no control block to update
                beq LA055
                ldy #$02
LA024:
                lda $03BC,y                  ; Copy load/exec to control block
                sta ($C8),y
                iny
                cpy #$0A
                bne LA024
                lda $03C8                    ; Length b0-b7=Block Length b0-b7
                sta ($C8),y
                iny
                lda $03C9
                clc
                adc $03C6                    ; Length b8-b15=Block Number+Block Length b8-b15
                sta ($C8),y
                iny
                lda #$00
                adc $03C7                    ; Length b16-b23=overflow
                sta ($C8),y
                iny                          ; Length b24-b31=&00
                lda #$00
                sta ($C8),y
                iny
LA04B:
                lda $03BD,y                  ; Attrs=&00000000
                sta ($C8),y
                iny
                cpy #$12
                bne LA04B
LA055:
                plp
LA056:
                jsr LA9B1
LA059:
                bit $BA                      ; If flag set, skip printing newline
                bmi LA064
LA05D:
                php                          ; Print inline text
                jsr LA923
                .byte 13                     ; Could just do JSR OSNEWL
                .byte 0
                plp
LA064:
                clc
                rts

LA066:
                jsr LA506                    ; A066= 20 06 A5     .%
                bne L9FF8                    ; A069= D0 8D       P.
LA06B:
                stx $F2                      ; A06B= 86 F2       .r
                sty $F3                      ; A06D= 84 F3       .s
                ldy #$00                     ; A06F= A0 00        .
                jsr LF26D                    ; A071= 20 6D F2     mr
                ldx #$00                     ; A074= A2 00       ".
LA076:
                jsr gsreadEntryPoint                    ; A076= 20 7F F2     .r
                bcs LA088                    ; A079= B0 0D       0.
                beq LA085                    ; A07B= F0 08       p.
                sta $03D2,x                  ; A07D= 9D D2 03    .R.
                inx                          ; A080= E8          h
                cpx #$0B                     ; A081= E0 0B       `.
                bne LA076                    ; A083= D0 F1       Pq
LA085:
                jmp badStringError                    ; A085= 4C 8F F2    L.r

LA088:
                stz $03D2,x                  ; A088= 9E D2 03    .R.
                rts                          ; A08B= 60          `

; CFS/RFS OSFILE
; ==============
LA08C:
                pha
                stx $C8                      ; C8/9=>control block
                sty $C9
                lda ($C8)                    ; Get XY=>filename
                tax
                ldy #$01
                lda ($C8),y
                tay
                jsr LA06B                    ; Parse filename
                ldy #$02
LA09E:
                lda ($C8),y                  ; A09E= B1 C8       1H
                sta $03BC,y                  ; A0A0= 99 BC 03    .<.
                sta $00AE,y                  ; A0A3= 99 AE 00    ...
                iny                          ; A0A6= C8          H
                cpy #$0A                     ; A0A7= C0 0A       @.
                bne LA09E                    ; A0A9= D0 F3       Ps
                pla                          ; A0AB= 68          h
                beq LA0B5                    ; A0AC= F0 07       p.
                cmp #$FF                     ; A0AE= C9 FF       I.
                bne LA064                    ; A0B0= D0 B2       P2
                jmp L9FAF                    ; A0B2= 4C AF 9F    L/.

LA0B5:
                sta $03C6                    ; A0B5= 8D C6 03    .F.
                sta $03C7                    ; A0B8= 8D C7 03    .G.
LA0BB:
                lda ($C8),y                  ; A0BB= B1 C8       1H
                sta $00A6,y                  ; A0BD= 99 A6 00    .&.
                iny                          ; A0C0= C8          H
                cpy #$12                     ; A0C1= C0 12       @.
                bne LA0BB                    ; A0C3= D0 F6       Pv
                txa                          ; A0C5= 8A          .
                beq LA085                    ; A0C6= F0 BD       p=
                jsr LA9F3                    ; A0C8= 20 F3 A9     s)
                jsr LA822                    ; A0CB= 20 22 A8     "(
                lda #$00                     ; A0CE= A9 00       ).
                jsr LAAA6                    ; A0D0= 20 A6 AA     &*
LA0D3:
                sec                          ; A0D3= 38          8
                ldx #$FD                     ; A0D4= A2 FD       "}  -3
LA0D6:
                lda $FFB7,x                  ; A0D6= BD B7 FF    =7.
                sbc $FFB3,x                  ; A0D9= FD B3 FF    }3.
                sta $02CB,x                  ; A0DC= 9D CB 02    .K.
                inx                          ; A0DF= E8          h
                bne LA0D6                    ; A0E0= D0 F4       Pt
                tay                          ; A0E2= A8          (
                bne LA0F3                    ; A0E3= D0 0E       P.
                cpx $03C8                    ; A0E5= EC C8 03    lH.
                lda #$01                     ; A0E8= A9 01       ).
                sbc $03C9                    ; A0EA= ED C9 03    mI.
                bcc LA0F3                    ; A0ED= 90 04       ..
                ldx #$80                     ; A0EF= A2 80       ".
                bra LA0FB                    ; A0F1= 80 08       ..

LA0F3:
                lda #$01                     ; A0F3= A9 01       ).
                sta $03C9                    ; A0F5= 8D C9 03    .I.
                stx $03C8                    ; A0F8= 8E C8 03    .H.
LA0FB:
                stx $03CA                    ; A0FB= 8E CA 03    .J.
                jsr LA6E9                    ; A0FE= 20 E9 A6     i&
                bmi LA17B                    ; A101= 30 78       0x
                jsr LA85B                    ; A103= 20 5B A8     [(
                inc $03C6                    ; A106= EE C6 03    nF.
                bne LA0D3                    ; A109= D0 C8       PH
                inc $03C7                    ; A10B= EE C7 03    nG.
                bra LA0D3                    ; A10E= 80 C3       .C

; TAPE/ROM FSC 2 - */
; TAPE/ROM FSC 4 - *RUN
; ---------------------
LA110:
                sec                          ; A110= 38          8
                ror $CE                      ; A111= 66 CE       fN
; TAPE/ROM FSC 11 - *RUN command for library
; ------------------------------------------
LA113:
                phx                          ; A113= DA          Z
                phy                          ; A114= 5A          Z
                jsr LA06B                    ; A115= 20 6B A0     k
                lda #$00                     ; A118= A9 00       ).
                ldx #$FF                     ; A11A= A2 FF       ".
                stx $03C2                    ; A11C= 8E C2 03    .B.
                jsr L9FAF                    ; A11F= 20 AF 9F     /.
                ply                          ; A122= 7A          z
                plx                          ; A123= FA          z
                bcc LA12E                    ; A124= 90 08       ..
                jsr LA9CA                    ; A126= 20 CA A9     J)

; TAPE/ROM FSC 3 - unknown * command
; ----------------------------------
LA129:
                lda #$0B                     ; A129= A9 0B       ).
                jmp (FSCV)                  ; A12B= 6C 1E 02    l..

LA12E:
                bit $027A                    ; A12E= 2C 7A 02    ,z.
                bpl LA13C                    ; A131= 10 09       ..
                lda $03C4                    ; A133= AD C4 03    -D.
                and $03C5                    ; A136= 2D C5 03    -E.
                inc a                        ; A139= 1A          .
                bne LA14C                    ; A13A= D0 10       P.
LA13C:
                ldx $03C2                    ; A13C= AE C2 03    .B.
                ldy $03C3                    ; A13F= AC C3 03    ,C.
                lda #$A4                     ; A142= A9 A4       )$
                jsr OSBYTE                   ; A144= 20 F4 FF     t.
                lda #$01                     ; A147= A9 01       ).
                jmp ($03C2)                  ; A149= 6C C2 03    lB.

LA14C:
                ldx #$C2                     ; A14C= A2 C2       "B
                ldy #$03                     ; A14E= A0 03        .
                lda #$04                     ; A150= A9 04       ).
                jmp LAAB0                    ; A152= 4C B0 AA    L0*

; TAPE/ROM FSC 9 - *EX
; --------------------
LA155:
                lda #$08                     ; A155= A9 08       ).
                tsb $E2                      ; A157= 04 E2       .b
                lda $E3                      ; A159= A5 E3       %c
                pha                          ; A15B= 48          H
                ora #$CC                     ; A15C= 09 CC       .L
                sta $E3                      ; A15E= 85 E3       .c
                jsr LA9F3                    ; A160= 20 F3 A9     s)
                pla                          ; A163= 68          h
                sta $E3                      ; A164= 85 E3       .c
                bra LA16F                    ; A166= 80 07       ..

; TAPE/ROM FSC 5 - *CAT
; ---------------------
LA168:
                lda #$08                     ; A168= A9 08       ).
                tsb $E2                      ; A16A= 04 E2       .b
                jsr LA9F3                    ; A16C= 20 F3 A9     s)
LA16F:
                lda #$00                     ; A16F= A9 00       ).
                jsr LA17C                    ; A171= 20 7C A1     |!
                jsr LA9CA                    ; A174= 20 CA A9     J)
LA177:
                lda #$08                     ; A177= A9 08       ).
                trb $E2                      ; A179= 14 E2       .b
LA17B:
                rts                          ; A17B= 60          `

LA17C:
                pha                          ; A17C= 48          H
                lda $0247                    ; A17D= AD 47 02    -G.
                beq LA18B                    ; A180= F0 09       p.
                jsr LF6FC                    ; A182= 20 FC F6     |v
                jsr LF701                    ; A185= 20 01 F7     .w
                clv                          ; A188= B8          8
                bcs LA1DB                    ; A189= B0 50       0P
LA18B:
                jsr LA678                    ; A18B= 20 78 A6     x&
                lda $03C6                    ; A18E= AD C6 03    -F.
                sta $B4                      ; A191= 85 B4       .4
                lda $03C7                    ; A193= AD C7 03    -G.
                sta $B5                      ; A196= 85 B5       .5
                ldx #$FF                     ; A198= A2 FF       ".
                stx $03DF                    ; A19A= 8E DF 03    ._.
                stz $BA                      ; A19D= 64 BA       d:
                bra LA1B7                    ; A19F= 80 16       ..

LA1A1:
                lda $0247                    ; A1A1= AD 47 02    -G.
                beq LA1DD                    ; A1A4= F0 37       p7
LA1A6:
                jsr LF717                    ; A1A6= 20 17 F7     .w
LA1A9:
                lda #$FF                     ; A1A9= A9 FF       ).
                sta $03C6                    ; A1AB= 8D C6 03    .F.
                sta $03C7                    ; A1AE= 8D C7 03    .G.
LA1B1:
                jsr LAA35                    ; A1B1= 20 35 AA     5*
                jsr LA678                    ; A1B4= 20 78 A6     x&
LA1B7:
                lda $0247                    ; A1B7= AD 47 02    -G.
                beq LA1BE                    ; A1BA= F0 02       p.
                bvc LA1DB                    ; A1BC= 50 1D       P.
LA1BE:
                pla                          ; A1BE= 68          h
                pha                          ; A1BF= 48          H
                beq LA1DD                    ; A1C0= F0 1B       p.
                jsr LA95C                    ; A1C2= 20 5C A9     \)
                bne LA1A1                    ; A1C5= D0 DA       PZ
                lda #$30                     ; A1C7= A9 30       )0
                and $BB                      ; A1C9= 25 BB       %;
                beq LA1DB                    ; A1CB= F0 0E       p.
                lda $03C6                    ; A1CD= AD C6 03    -F.
                cmp $B6                      ; A1D0= C5 B6       E6
                bne LA1A1                    ; A1D2= D0 CD       PM
                lda $03C7                    ; A1D4= AD C7 03    -G.
                cmp $B7                      ; A1D7= C5 B7       E7
                bne LA1A1                    ; A1D9= D0 C6       PF
LA1DB:
                pla                          ; A1DB= 68          h
                rts                          ; A1DC= 60          `

LA1DD:
                bvc LA1E4                    ; A1DD= 50 05       P.
                lda #$FF                     ; A1DF= A9 FF       ).
                jsr LA6D4                    ; A1E1= 20 D4 A6     T&
LA1E4:
                ldx #$00                     ; A1E4= A2 00       ".
                jsr LA8C4                    ; A1E6= 20 C4 A8     D(
                lda $0247                    ; A1E9= AD 47 02    -G.
                beq LA1F2                    ; A1EC= F0 04       p.
                bit $BB                      ; A1EE= 24 BB       $;
                bvc LA1A6                    ; A1F0= 50 B4       P4
LA1F2:
                bit $03CA                    ; A1F2= 2C CA 03    ,J.
                bmi LA1A9                    ; A1F5= 30 B2       02
                bra LA1B1                    ; A1F7= 80 B8       .8

; CFS/RFS OSFIND HANDLER
; ======================
LA1F9:
                sta $BC                      ; A1F9= 85 BC       .<
                phx                          ; A1FB= DA          Z
                phy                          ; A1FC= 5A          Z
                ora #$00                     ; A1FD= 09 00       ..
                bne LA220                    ; A1FF= D0 1F       P.
                tya                          ; A201= 98          .
                bne LA212                    ; A202= D0 0E       P.
                lda $0247                    ; A204= AD 47 02    -G.
                bne LA20C                    ; A207= D0 03       P.
                jsr LA29C                    ; A209= 20 9C A2     ."
LA20C:
                lda #$01                     ; A20C= A9 01       ).
                trb $E2                      ; A20E= 14 E2       .b
                bra LA21E                    ; A210= 80 0C       ..

LA212:
                lsr a                        ; A212= 4A          J
                bcs LA20C                    ; A213= B0 F7       0w
                lsr a                        ; A215= 4A          J
                bcs LA21B                    ; A216= B0 03       0.
                jmp LAA81                    ; A218= 4C 81 AA    L.*

LA21B:
                jsr LA29C                    ; A21B= 20 9C A2     ."
LA21E:
                bra LA297                    ; A21E= 80 77       .w

LA220:
                jsr LA06B                    ; A220= 20 6B A0     k
                bit $BC                      ; A223= 24 BC       $<
                bvc LA260                    ; A225= 50 39       P9
                stz $039E                    ; A227= 9C 9E 03    ...
                stz $03DD                    ; A22A= 9C DD 03    .].
                stz $03DE                    ; A22D= 9C DE 03    .^.
                lda #$C1                     ; A230= A9 C1       )A
                trb $E2                      ; A232= 14 E2       .b
                jsr LA9E6                    ; A234= 20 E6 A9     f)
                php                          ; A237= 08          .
                jsr LA502                    ; A238= 20 02 A5     .%
                jsr LA5B7                    ; A23B= 20 B7 A5     7%
                plp                          ; A23E= 28          (
                ldx #$FF                     ; A23F= A2 FF       ".
LA241:
                inx                          ; A241= E8          h
                lda $03B2,x                  ; A242= BD B2 03    =2.
                sta $03A7,x                  ; A245= 9D A7 03    .'.
                bne LA241                    ; A248= D0 F7       Pw
                inc a                        ; A24A= 1A          .
                tsb $E2                      ; A24B= 04 E2       .b
                lda $02E9                    ; A24D= AD E9 02    -i.
                ora $02EA                    ; A250= 0D EA 02    .j.
                bne LA259                    ; A253= D0 04       P.
                lda #$40                     ; A255= A9 40       )@
                tsb $E2                      ; A257= 04 E2       .b
LA259:
                lda #$01                     ; A259= A9 01       ).
                ora $0247                    ; A25B= 0D 47 02    .G.
                bne LA295                    ; A25E= D0 35       P5
LA260:
                txa                          ; A260= 8A          .
                bne LA266                    ; A261= D0 03       P.
                jmp badStringError                    ; A263= 4C 8F F2    L.r

LA266:
                ldx #$FF                     ; A266= A2 FF       ".
LA268:
                inx                          ; A268= E8          h
                lda $03D2,x                  ; A269= BD D2 03    =R.
                sta $0380,x                  ; A26C= 9D 80 03    ...
                bne LA268                    ; A26F= D0 F7       Pw
                dec a                        ; A271= 3A          :
                ldx #$08                     ; A272= A2 08       ".
LA274:
                sta $038B,x                  ; A274= 9D 8B 03    ...
                dex                          ; A277= CA          J
                bne LA274                    ; A278= D0 FA       Pz
                txa                          ; A27A= 8A          .
                ldx #$14                     ; A27B= A2 14       ".
LA27D:
                sta $0380,x                  ; A27D= 9D 80 03    ...
                inx                          ; A280= E8          h
                cpx #$1E                     ; A281= E0 1E       `.
                bne LA27D                    ; A283= D0 F8       Px
                rol $0397                    ; A285= 2E 97 03    ...
                jsr LA9F3                    ; A288= 20 F3 A9     s)
                jsr LA822                    ; A28B= 20 22 A8     "(
                jsr LA9BB                    ; A28E= 20 BB A9     ;)
                lda #$02                     ; A291= A9 02       ).
                tsb $E2                      ; A293= 04 E2       .b
LA295:
                sta $BC                      ; A295= 85 BC       .<
LA297:
                ply                          ; A297= 7A          z
                plx                          ; A298= FA          z
                lda $BC                      ; A299= A5 BC       %<
LA29B:
                rts                          ; A29B= 60          `

LA29C:
                lda #$02                     ; A29C= A9 02       ).
                and $E2                      ; A29E= 25 E2       %b
                beq LA29B                    ; A2A0= F0 F9       py
                stz $0397                    ; A2A2= 9C 97 03    ...
                lda #$80                     ; A2A5= A9 80       ).
                ldx $039D                    ; A2A7= AE 9D 03    ...
                stx $0396                    ; A2AA= 8E 96 03    ...
                sta $0398                    ; A2AD= 8D 98 03    ...
                jsr LA2B8                    ; A2B0= 20 B8 A2     8"
                lda #$02                     ; A2B3= A9 02       ).
                trb $E2                      ; A2B5= 14 E2       .b
                rts                          ; A2B7= 60          `

LA2B8:
                jsr LA9E6                    ; A2B8= 20 E6 A9     f)
                ldx #$11                     ; A2BB= A2 11       ".
LA2BD:
                lda $038C,x                  ; A2BD= BD 8C 03    =..
                sta $03BE,x                  ; A2C0= 9D BE 03    .>.
                dex                          ; A2C3= CA          J
                bpl LA2BD                    ; A2C4= 10 F7       .w
                stx $B2                      ; A2C6= 86 B2       .2
                stx $B3                      ; A2C8= 86 B3       .3
                stz $B0                      ; A2CA= 64 B0       d0
                lda #$09                     ; A2CC= A9 09       ).
                sta $B1                      ; A2CE= 85 B1       .1
                ldx #$7F                     ; A2D0= A2 7F       ".
                jsr LAA4D                    ; A2D2= 20 4D AA     M*
                sta $03DF                    ; A2D5= 8D DF 03    ._.
                jsr LAA5A                    ; A2D8= 20 5A AA     Z*
                jsr LAAA0                    ; A2DB= 20 A0 AA      *
                jsr LA6E9                    ; A2DE= 20 E9 A6     i&
                inc $0394                    ; A2E1= EE 94 03    n..
                bne LA2E9                    ; A2E4= D0 03       P.
                inc $0395                    ; A2E6= EE 95 03    n..
LA2E9:
                rts                          ; A2E9= 60          `

LA2EA:
                phx                          ; A2EA= DA          Z
                phy                          ; A2EB= 5A          Z
                lda #$01                     ; A2EC= A9 01       ).
LA2EE:
                jsr LAA68                    ; A2EE= 20 68 AA     h*
                lda $E2                      ; A2F1= A5 E2       %b
                asl a                        ; A2F3= 0A          .
                bcs LA343                    ; A2F4= B0 4D       0M
                asl a                        ; A2F6= 0A          .
                bcc LA301                    ; A2F7= 90 08       ..
                lda #$80                     ; A2F9= A9 80       ).
                tsb $E2                      ; A2FB= 04 E2       .b
                lda #$FE                     ; A2FD= A9 FE       )~
                bcs LA33B                    ; A2FF= B0 3A       0:
LA301:
                ldx $039E                    ; A301= AE 9E 03    ...
                inx                          ; A304= E8          h
                cpx $02E9                    ; A305= EC E9 02    li.
                bne LA336                    ; A308= D0 2C       P,
                bit $02EB                    ; A30A= 2C EB 02    ,k.
                bmi LA332                    ; A30D= 30 23       0#
                lda $02EC                    ; A30F= AD EC 02    -l.
                pha                          ; A312= 48          H
                jsr LA9E6                    ; A313= 20 E6 A9     f)
                php                          ; A316= 08          .
                jsr LA5AF                    ; A317= 20 AF A5     /%
                plp                          ; A31A= 28          (
                pla                          ; A31B= 68          h
                sta $BC                      ; A31C= 85 BC       .<
                clc                          ; A31E= 18          .
                bit $02EB                    ; A31F= 2C EB 02    ,k.
                bpl LA33D                    ; A322= 10 19       ..
                lda $02E9                    ; A324= AD E9 02    -i.
                ora $02EA                    ; A327= 0D EA 02    .j.
                bne LA33D                    ; A32A= D0 11       P.
                lda #$40                     ; A32C= A9 40       )@
                tsb $E2                      ; A32E= 04 E2       .b
                bra LA33D                    ; A330= 80 0B       ..

LA332:
                lda #$40                     ; A332= A9 40       )@
                tsb $E2                      ; A334= 04 E2       .b
LA336:
                dex                          ; A336= CA          J
                clc                          ; A337= 18          .
                lda $0A00,x                  ; A338= BD 00 0A    =..
LA33B:
                sta $BC                      ; A33B= 85 BC       .<
LA33D:
                inc $039E                    ; A33D= EE 9E 03    n..
                jmp LA297                    ; A340= 4C 97 A2    L."

LA343:
                jsr LAAED                    ; A343= 20 ED AA     m*
                .text $df,"EOF",0
LA34B:
                sta $C4                      ; A34B= 85 C4       .D
                phx                          ; A34D= DA          Z
                phy                          ; A34E= 5A          Z
                lda #$02                     ; A34F= A9 02       ).
                jsr LAA68                    ; A351= 20 68 AA     h*
                ldx $039D                    ; A354= AE 9D 03    ...
                lda $C4                      ; A357= A5 C4       %D
                sta $0900,x                  ; A359= 9D 00 09    ...
                inx                          ; A35C= E8          h
                bne LA365                    ; A35D= D0 06       P.
                jsr LA2B8                    ; A35F= 20 B8 A2     8"
                jsr LA9BB                    ; A362= 20 BB A9     ;)
LA365:
                inc $039D                    ; A365= EE 9D 03    n..
                lda $C4                      ; A368= A5 C4       %D
                jmp LA295                    ; A36A= 4C 95 A2    L."

; TAPE/ROM OSGBPB handler
; =======================
LA36D:
                lsr a                        ; Odd numbered calls - change PTR - exit with A=changed, SEC
                bcs LA376
                beq LA376                    ; OSGBPB 0 - exit with A=unchanged, SEC
                cmp #$03                     ; function/2<3 - function<6 - function 2 and 4 - jump to do
                bcc LA378
LA376:
                sec
                rts
; Call Return
;  0    A=0   SEC                        - unsupported
;  1    A=0   SEC  Write using new PTR   - unsupported
;  2    A=         Write with current PTR
;  3    A=1   SEC  Read with new PTR     - unsupported
;  4    A=         Read with current PTR
;  5+   A=A/2 SEC                        - unsupported

; TAPE/ROM OSGBPB 2 and 4 - read/write with current PTR
; -----------------------------------------------------
LA378:
                lsr a                        ; A378= 4A          J
                stx $CC                      ; A379= 86 CC       .L
                sty $CD                      ; A37B= 84 CD       .M
                ldy #$01                     ; A37D= A0 01        .
LA37F:
                lda ($CC),y                  ; A37F= B1 CC       1L
                sta $C8                      ; A381= 85 C8       .H
                iny                          ; A383= C8          H
                lda ($CC),y                  ; A384= B1 CC       1L
                sta $C9                      ; A386= 85 C9       .I
                iny                          ; A388= C8          H
                lda ($CC),y                  ; A389= B1 CC       1L
                iny                          ; A38B= C8          H
                and ($CC),y                  ; A38C= 31 CC       1L
                inc a                        ; A38E= 1A          .
                and $027A                    ; A38F= 2D 7A 02    -z.
                pha                          ; A392= 48          H
                php                          ; A393= 08          .
                beq LA3A7                    ; A394= F0 11       p.
                ldx $CC                      ; A396= A6 CC       &L
                ldy $CD                      ; A398= A4 CD       $M
                inx                          ; A39A= E8          h
                bne LA39E                    ; A39B= D0 01       P.
                iny                          ; A39D= C8          H
LA39E:
                lda #$00                     ; A39E= A9 00       ).
                plp                          ; A3A0= 28          (
                php                          ; A3A1= 08          .
                adc #$00                     ; A3A2= 69 00       i.
                jsr LAAB0                    ; A3A4= 20 B0 AA     0*
LA3A7:
                lda ($CC)                    ; A3A7= B2 CC       2L
                tay                          ; A3A9= A8          (
                lda #$01                     ; A3AA= A9 01       ).
                plp                          ; A3AC= 28          (
                php                          ; A3AD= 08          .
                adc #$00                     ; A3AE= 69 00       i.
                jsr LAA8D                    ; A3B0= 20 8D AA     .*
                bcs LA3C1                    ; A3B3= B0 0C       0.
                plp                          ; A3B5= 28          (
                pla                          ; A3B6= 68          h
                beq LA3BE                    ; A3B7= F0 05       p.
                lda #$80                     ; A3B9= A9 80       ).
                jsr tubeHost.entryPoint                    ; A3BB= 20 06 04     ..
LA3BE:
                jmp LAA81                    ; A3BE= 4C 81 AA    L.*

LA3C1:
                plp                          ; A3C1= 28          (
                bcs LA401                    ; A3C2= B0 3D       0=
                bit $E2                      ; A3C4= 24 E2       $b
                bpl LA3D3                    ; A3C6= 10 0B       ..
                pla                          ; A3C8= 68          h
                beq LA3D0                    ; A3C9= F0 05       p.
                lda #$80                     ; A3CB= A9 80       ).
                jsr tubeHost.entryPoint                    ; A3CD= 20 06 04     ..
LA3D0:
                jmp LA343                    ; A3D0= 4C 43 A3    LC#

LA3D3:
                jsr LAAE0                    ; A3D3= 20 E0 AA     `*
                beq LA3F6                    ; A3D6= F0 1E       p.
                lda ($CC)                    ; A3D8= B2 CC       2L
                tay                          ; A3DA= A8          (
                jsr LA2EA                    ; A3DB= 20 EA A2     j"
                bcs LA3F6                    ; A3DE= B0 16       0.
                plx                          ; A3E0= FA          z
                phx                          ; A3E1= DA          Z
                beq LA3E9                    ; A3E2= F0 05       p.
                sta tube.data3                   ; A3E4= 8D E5 FE    .e~
                bra LA3F1                    ; A3E7= 80 08       ..

LA3E9:
                sta ($C8)                    ; A3E9= 92 C8       .H
                inc $C8                      ; A3EB= E6 C8       fH
                bne LA3F1                    ; A3ED= D0 02       P.
                inc $C9                      ; A3EF= E6 C9       fI
LA3F1:
                jsr LAACA                    ; A3F1= 20 CA AA     J*
                bra LA3D3                    ; A3F4= 80 DD       .]

LA3F6:
                pla                          ; A3F6= 68          h
                php                          ; A3F7= 08          .
                beq LA3FF                    ; A3F8= F0 05       p.
                lda #$80                     ; A3FA= A9 80       ).
                jsr tubeHost.entryPoint                    ; A3FC= 20 06 04     ..
LA3FF:
                plp                          ; A3FF= 28          (
                rts                          ; A400= 60          `

LA401:
                jsr LAAE0                    ; A401= 20 E0 AA     `*
                beq LA3F6                    ; A404= F0 F0       pp
                lda ($CC)                    ; A406= B2 CC       2L
                tay                          ; A408= A8          (
                pla                          ; A409= 68          h
                pha                          ; A40A= 48          H
                beq LA412                    ; A40B= F0 05       p.
                lda tube.data3                   ; A40D= AD E5 FE    -e~
                bra LA41A                    ; A410= 80 08       ..

LA412:
                lda ($C8)                    ; A412= B2 C8       2H
                inc $C8                      ; A414= E6 C8       fH
                bne LA41A                    ; A416= D0 02       P.
                inc $C9                      ; A418= E6 C9       fI
LA41A:
                jsr LA34B                    ; A41A= 20 4B A3     K#
                jsr LAACA                    ; A41D= 20 CA AA     J*
                bra LA401                    ; A420= 80 DF       ._

; TAPE/ROM FSC 0 - *OPT
; ---------------------
LA422:
                txa                          ; *OPT 0
                beq LA453
                cpx #$03                     ; *OPT 3
                beq LA448
                cpy #$03                     ; *OPT n,3+ - error Bad command (*BUG* should be Bad option)
                bcs LA433
                dex                          ; *OPT 1
                beq LA436
                dex                          ; *OPT 2
                beq LA43D
LA433:
                jmp LFBED                    ; *OPT 4+ - error Bad command (*BUG* should be Bad option)

; *OPT 1 - set message level
; --------------------------
LA436:
                lda #$33                     ; A436= A9 33       )3
                iny                          ; A438= C8          H
                iny                          ; A439= C8          H
                iny                          ; A43A= C8          H
                bra LA43F                    ; A43B= 80 02       ..

; *OPT 2 - set error response level
; ---------------------------------
LA43D:
                lda #$CC                     ; A43D= A9 CC       )L
LA43F:
                iny                          ; A43F= C8          H
                and $E3                      ; A440= 25 E3       %c
LA442:
                ora LA456,y                  ; A442= 19 56 A4    .V$
                sta $E3                      ; A445= 85 E3       .c
                rts                          ; A447= 60          `

; *OPT 3 - set interblock gap
; ---------------------------
LA448:
                tya                          ; *OPT 3,128+ - set to default
                bmi LA44D    ;
                bne LA44F                    ; *OPT 3,<>0 - use setting
LA44D:
                lda #$19                     ; *OPT 3,0 or *OPT 3,128+ - use default of 2.5 sec
LA44F:
                sta $03D1                    ; Set inter-block gap
                rts

LA453:
                tay                          ; A453= A8          (
                bra LA442                    ; A454= 80 EC       .l

LA456:
                ; LDA ($00,x)                ; A456= A1 00       !.
                ; EQUB $22                   ; A458= 22          "
                ; ORA ($00),y                ; A459= 11 00       ..
                ; DEY                        ; A45B= 88          .
                ; CPY LC0C6                  ; A45C= CC C6 C0    LF@
                .byte $A1
                .byte $00
                .byte $22
                .byte $11
                .byte $00
                .byte $88
                .byte $CC
LA45D:
                dec $C0
                lda $0247                    ; A45F= AD 47 02    -G.
                beq LA46B                    ; A462= F0 07       p.
                jsr LF710                    ; A464= 20 10 F7     .w
                tay                          ; A467= A8          (
                clc                          ; A468= 18          .
                bra LA485                    ; A469= 80 1A       ..

LA46B:
                lda ACIA+0                    ; A46B= AD 08 FE    -.~
                pha                          ; A46E= 48          H
                and #$02                     ; A46F= 29 02       ).
                beq LA47E                    ; A471= F0 0B       p.
                ldy $CA                      ; A473= A4 CA       $J
                beq LA47E                    ; A475= F0 07       p.
                pla                          ; A477= 68          h
                lda $BD                      ; A478= A5 BD       %=
                sta ACIA+1                    ; A47A= 8D 09 FE    ..~
                rts                          ; A47D= 60          `

LA47E:
                ldy ACIA+1                    ; A47E= AC 09 FE    ,.~
                pla                          ; A481= 68          h
                lsr a                        ; A482= 4A          J
                lsr a                        ; A483= 4A          J
                lsr a                        ; A484= 4A          J
LA485:
                ldx $C2                      ; A485= A6 C2       &B
                beq LA4F0                    ; A487= F0 67       pg
                dex                          ; A489= CA          J
                bne LA492                    ; A48A= D0 06       P.
                bcc LA4F0                    ; A48C= 90 62       .b
                ldy #$02                     ; A48E= A0 02        .
                bra LA4EE                    ; A490= 80 5C       .\

LA492:
                dex                          ; A492= CA          J
                bne LA4A8                    ; A493= D0 13       P.
                bcs LA4F0                    ; A495= B0 59       0Y
                tya                          ; A497= 98          .
                jsr LAA44                    ; A498= 20 44 AA     D*
                ldy #$03                     ; A49B= A0 03        .
                cmp #$2A                     ; A49D= C9 2A       I*
                beq LA4EE                    ; A49F= F0 4D       pM
                jsr LAA1C                    ; A4A1= 20 1C AA     .*
                ldy #$01                     ; A4A4= A0 01        .
                bra LA4EE                    ; A4A6= 80 46       .F

LA4A8:
                dex                          ; A4A8= CA          J
                bne LA4B5                    ; A4A9= D0 0A       P.
                bcs LA4B0                    ; A4AB= B0 03       0.
                sty $BD                      ; A4AD= 84 BD       .=
                rts                          ; A4AF= 60          `

LA4B0:
                lda #$80                     ; A4B0= A9 80       ).
                sta $C0                      ; A4B2= 85 C0       .@
                rts                          ; A4B4= 60          `

LA4B5:
                dex                          ; A4B5= CA          J
                bne LA4E1                    ; A4B6= D0 29       P)
                bcs LA4E9                    ; A4B8= B0 2F       0/
                tya                          ; A4BA= 98          .
                jsr LA6A9                    ; A4BB= 20 A9 A6     )&
                ldy $BC                      ; A4BE= A4 BC       $<
                inc $BC                      ; A4C0= E6 BC       f<
                bit $BD                      ; A4C2= 24 BD       $=
                bmi LA4D3                    ; A4C4= 30 0D       0.
                jsr LAABC                    ; A4C6= 20 BC AA     <*
                beq LA4D0                    ; A4C9= F0 05       p.
                stx tube.data3                   ; A4CB= 8E E5 FE    .e~
                bra LA4D3                    ; A4CE= 80 03       ..

LA4D0:
                txa                          ; A4D0= 8A          .
                sta ($B0),y                  ; A4D1= 91 B0       .0
LA4D3:
                iny                          ; A4D3= C8          H
                cpy $03C8                    ; A4D4= CC C8 03    LH.
                bne LA4F0                    ; A4D7= D0 17       P.
                lda #$01                     ; A4D9= A9 01       ).
                sta $BC                      ; A4DB= 85 BC       .<
                ldy #$05                     ; A4DD= A0 05        .
                bra LA4EE                    ; A4DF= 80 0D       ..

LA4E1:
                tya                          ; A4E1= 98          .
                jsr LA6A9                    ; A4E2= 20 A9 A6     )&
                dec $BC                      ; A4E5= C6 BC       F<
                bpl LA4F0                    ; A4E7= 10 07       ..
LA4E9:
                jsr LAA12                    ; A4E9= 20 12 AA     .*
                ldy #$00                     ; A4EC= A0 00        .
LA4EE:
                sty $C2                      ; A4EE= 84 C2       .B
LA4F0:
                rts                          ; A4F0= 60          `

; TAPE/ROM FSC 1 - =EOF
; ---------------------
LA4F1:
                pha
                phy
                txa
                tay
                lda #$03                     ; Check if this channel is open for anything
                jsr LAA68
                lda $E2                      ; Get EOF flag
                and #$40
                tax                          ; Return in X
                ply
                pla
                rts

LA502:
                stz $B4                      ; A502= 64 B4       d4
                stz $B5                      ; A504= 64 B5       d5
LA506:
                lsr $CE                      ; A506= 46 CE       FN
                lda $B4                      ; A508= A5 B4       %4
                pha                          ; A50A= 48          H
                sta $B6                      ; A50B= 85 B6       .6
                lda $B5                      ; A50D= A5 B5       %5
                pha                          ; A50F= 48          H
                sta $B7                      ; A510= 85 B7       .7
                jsr LA923                    ; A512= 20 23 A9     #)
                .text "Searching",13,0
                lda #$ff
                jsr LA17C                    ; A522= 20 7C A1     |!
                pla                          ; A525= 68          h
                sta $B5                      ; A526= 85 B5       .5
                pla                          ; A528= 68          h
                sta $B4                      ; A529= 85 B4       .4
                lda $B6                      ; A52B= A5 B6       %6
                ora $B7                      ; A52D= 05 B7       .7
                bne LA564                    ; A52F= D0 33       P3
                stz $B4                      ; A531= 64 B4       d4
                stz $B5                      ; A533= 64 B5       d5
                lda $0247                    ; A535= AD 47 02    -G.
                beq LA55B                    ; A538= F0 21       p!
                bvs LA55B                    ; A53A= 70 1F       p.
                jsr LA9CA                    ; A53C= 20 CA A9     J)
                bit $CE                      ; A53F= 24 CE       $N
                bvc LA54D                    ; A541= 50 0A       P.
                sec                          ; A543= 38          8
LA544:
                rts                          ; A544= 60          `

LA545:
                lda #$40                     ; A545= A9 40       )@
                jsr OSFIND                   ; A547= 20 CE FF     N.
                tay                          ; A54A= A8          (
                bne LA544                    ; A54B= D0 F7       Pw
LA54D:
                jsr LAAED                    ; A54D= 20 ED AA     m*
                .text $d6,"Not found",0
LA55B:
                lda $C1                      ; A55B= A5 C1       %A
                bne LA564                    ; A55D= D0 05       P.
                ldx #$B1                     ; A55F= A2 B1       "1
                jsr LAA4D                    ; A561= 20 4D AA     M*
LA564:
                ldy #$FF                     ; A564= A0 FF        .
                sty $03DF                    ; A566= 8C DF 03    ._.
                clc                          ; A569= 18          .
                rts                          ; A56A= 60          `

LA56B:
                beq LA584                    ; A56B= F0 17       p.
                pha                          ; A56D= 48          H
                lda #$07                     ; A56E= A9 07       ).
                jsr callFSCV                    ; A570= 20 E5 F1     eq
                pla                          ; A573= 68          h
                clc                          ; A574= 18          .
                php                          ; A575= 08          .
                sei                          ; A576= 78          x
                sta $FA                      ; A577= 85 FA       .z
                cpy $FA                      ; A579= C4 FA       Dz
                bcc LA583                    ; A57B= 90 06       ..
                cpx $FA                      ; A57D= E4 FA       dz
                bcc LA587                    ; A57F= 90 06       ..
                beq LA587                    ; A581= F0 04       p.
LA583:
                plp                          ; A583= 28          (
LA584:
                pla                          ; A584= 68          h
                pla                          ; A585= 68          h
                rts                          ; A586= 60          `

LA587:
                plp                          ; A587= 28          (
                lda #$00                     ; A588= A9 00       ).
                rts                          ; A58A= 60          `

LA58B:
                lda $0256                    ; A58B= AD 56 02    -V.
                jsr LA56B                    ; A58E= 20 6B A5     k%
LA591:
                php                          ; A591= 08          .
                phy                          ; A592= 5A          Z
                ldy $0256                    ; A593= AC 56 02    ,V.
                sta $0256                    ; A596= 8D 56 02    .V.
                beq LA59E                    ; A599= F0 03       p.
                jsr OSFIND                   ; A59B= 20 CE FF     N.
LA59E:
                lsr hazel.tempFSFlag      ; A59E= 4E C6 DF    NF_
                ply                          ; A5A1= 7A          z
                plp                          ; A5A2= 28          (
                beq LA5AE                    ; A5A3= F0 09       p.
                asl hazel.tempFSFlag      ; A5A5= 0E C6 DF    .F_
                jsr LA545                    ; A5A8= 20 45 A5     E%
                sta $0256                    ; A5AB= 8D 56 02    .V.
LA5AE:
                rts                          ; A5AE= 60          `

LA5AF:
                ldx #$A6                     ; A5AF= A2 A6       "&
                jsr LAA4D                    ; A5B1= 20 4D AA     M*
                jsr LA678                    ; A5B4= 20 78 A6     x&
LA5B7:
                lda $03CA                    ; A5B7= AD CA 03    -J.
                lsr a                        ; A5BA= 4A          J
                bcc LA5C0                    ; A5BB= 90 03       ..
                jmp L9FE3                    ; A5BD= 4C E3 9F    Lc.

LA5C0:
                lda $03DD                    ; A5C0= AD DD 03    -].
                sta $B4                      ; A5C3= 85 B4       .4
                lda $03DE                    ; A5C5= AD DE 03    -^.
                sta $B5                      ; A5C8= 85 B5       .5
                stz $B0                      ; A5CA= 64 B0       d0
                lda #$0A                     ; A5CC= A9 0A       ).
                sta $B1                      ; A5CE= 85 B1       .1
                lda #$FF                     ; A5D0= A9 FF       ).
                sta $B2                      ; A5D2= 85 B2       .2
                sta $B3                      ; A5D4= 85 B3       .3
                jsr LA6D2                    ; A5D6= 20 D2 A6     R&
                jsr LA8A1                    ; A5D9= 20 A1 A8     !(
                bne LA603                    ; A5DC= D0 25       P%
                lda $0AFF                    ; A5DE= AD FF 0A    -..
                sta $02EC                    ; A5E1= 8D EC 02    .l.
                jsr LAA35                    ; A5E4= 20 35 AA     5*
                stx $03DD                    ; A5E7= 8E DD 03    .].
                sty $03DE                    ; A5EA= 8C DE 03    .^.
                ldx #$02                     ; A5ED= A2 02       ".
LA5EF:
                lda $03C8,x                  ; A5EF= BD C8 03    =H.
                sta $02E9,x                  ; A5F2= 9D E9 02    .i.
                dex                          ; A5F5= CA          J
                bpl LA5EF                    ; A5F6= 10 F7       .w
                bit $02EB                    ; A5F8= 2C EB 02    ,k.
                bpl LA600                    ; A5FB= 10 03       ..
                jsr LA059                    ; A5FD= 20 59 A0     Y
LA600:
                jmp LA9C5                    ; A600= 4C C5 A9    LE)

LA603:
                jsr LA506                    ; A603= 20 06 A5     .%
                bra LA5B7                    ; A606= 80 AF       ./

LA608:
                cmp #$2A                     ; A608= C9 2A       I*
                beq LA643                    ; A60A= F0 37       p7
                cmp #$23                     ; A60C= C9 23       I#
                bne LA61F                    ; A60E= D0 0F       P.
                inc $03C6                    ; A610= EE C6 03    nF.
                bne LA618                    ; A613= D0 03       P.
                inc $03C7                    ; A615= EE C7 03    nG.
LA618:
                ldx #$FF                     ; A618= A2 FF       ".
                bit LE34E                    ; A61A= 2C 4E E3    ,Nc
                bra LA670                    ; A61D= 80 51       .Q

LA61F:
                jsr LA177                    ; A61F= 20 77 A1     w!
                jsr LAAED                    ; A622= 20 ED AA     m*
                .byte $D7
                .text "Bad ROM"
                .byte 0
                ; EQUB $D7                   ; A625= D7          W
                ; EQUB $42                   ; A626= 42          B
                ; ADC ($64,x)                ; A627= 61 64       ad
                ; JSR $4F52                  ; A629= 20 52 4F     RO
                ; EOR LA000                  ; A62C= 4D 00 A0    M.
                ; EQUB $FF                   ; A62F= FF          .

LA62E:
                ldy #$FF
                jsr LAA5C                    ; A630= 20 5C AA     \*
                lda #$01                     ; A633= A9 01       ).
                sta $C2                      ; A635= 85 C2       .B
                jsr LAA1C                    ; A637= 20 1C AA     .*
LA63A:
                jsr LA880                    ; A63A= 20 80 A8     .(
                lda #$03                     ; A63D= A9 03       ).
                cmp $C2                      ; A63F= C5 C2       EB
                bne LA63A                    ; A641= D0 F7       Pw
LA643:
                jsr LAA46                    ; A643= 20 46 AA     F*
LA646:
                jsr LA694                    ; A646= 20 94 A6     .&
                bvc LA665                    ; A649= 50 1A       P.
                sta $03B2,y                  ; A64B= 99 B2 03    .2.
                beq LA656                    ; A64E= F0 06       p.
                iny                          ; A650= C8          H
                cpy #$0B                     ; A651= C0 0B       @.
                bne LA646                    ; A653= D0 F1       Pq
                dey                          ; A655= 88          .
LA656:
                ldx #$0C                     ; A656= A2 0C       ".
LA658:
                jsr LA694                    ; A658= 20 94 A6     .&
                bvc LA665                    ; A65B= 50 08       P.
                sta $03B2,x                  ; A65D= 9D B2 03    .2.
                inx                          ; A660= E8          h
                cpx #$1F                     ; A661= E0 1F       `.
                bne LA658                    ; A663= D0 F3       Ps
LA665:
                tya                          ; A665= 98          .
                tax                          ; A666= AA          *
                stz $03B2,x                  ; A667= 9E B2 03    .2.
                lda $BE                      ; A66A= A5 BE       %>
                ora $BF                      ; A66C= 05 BF       .?
                sta $C1                      ; A66E= 85 C1       .A
LA670:
                jsr LAA44                    ; A670= 20 44 AA     D*
                sty $C2                      ; A673= 84 C2       .B
                txa                          ; A675= 8A          .
                bne LA6CC                    ; A676= D0 54       PT
LA678:
                lda $0247                    ; A678= AD 47 02    -G.
                beq LA62E                    ; A67B= F0 B1       p1
LA67D:
                jsr LF710                    ; A67D= 20 10 F7     .w
                cmp #$2B                     ; A680= C9 2B       I+
                bne LA608                    ; A682= D0 84       P.
                lda #$08                     ; A684= A9 08       ).
                and $E2                      ; A686= 25 E2       %b
                beq LA68D                    ; A688= F0 03       p.
                jsr LA05D                    ; A68A= 20 5D A0     ]
LA68D:
                jsr LF701                    ; A68D= 20 01 F7     .w
                bcc LA67D                    ; A690= 90 EB       .k
                clv                          ; A692= B8          8
                rts                          ; A693= 60          `

LA694:
                lda $0247                    ; A694= AD 47 02    -G.
                beq LA6A6                    ; A697= F0 0D       p.
                phx                          ; A699= DA          Z
                phy                          ; A69A= 5A          Z
                jsr LF710                    ; A69B= 20 10 F7     .w
                sta $BD                      ; A69E= 85 BD       .=
                lda #$FF                     ; A6A0= A9 FF       ).
                sta $C0                      ; A6A2= 85 C0       .@
                ply                          ; A6A4= 7A          z
                plx                          ; A6A5= FA          z
LA6A6:
                jsr LA778                    ; A6A6= 20 78 A7     x'
LA6A9:
                php                          ; A6A9= 08          .
                pha                          ; A6AA= 48          H
                sec                          ; A6AB= 38          8
                ror $CB                      ; A6AC= 66 CB       fK
                eor $BF                      ; A6AE= 45 BF       E?
                sta $BF                      ; A6B0= 85 BF       .?
LA6B2:
                lda $BF                      ; A6B2= A5 BF       %?
                clc                          ; A6B4= 18          .
                bpl LA6C2                    ; A6B5= 10 0B       ..
                eor #$08                     ; A6B7= 49 08       I.
                sta $BF                      ; A6B9= 85 BF       .?
                lda $BE                      ; A6BB= A5 BE       %>
                eor #$10                     ; A6BD= 49 10       I.
                sta $BE                      ; A6BF= 85 BE       .>
                sec                          ; A6C1= 38          8
LA6C2:
                rol $BE                      ; A6C2= 26 BE       &>
                rol $BF                      ; A6C4= 26 BF       &?
                lsr $CB                      ; A6C6= 46 CB       FK
                bne LA6B2                    ; A6C8= D0 E8       Ph
                pla                          ; A6CA= 68          h
                plp                          ; A6CB= 28          (
LA6CC:
                rts                          ; A6CC= 60          `

LA6CD:
                jsr LA776                    ; A6CD= 20 76 A7     v'
                bra LA6A9                    ; A6D0= 80 D7       .W

LA6D2:
                lda #$00                     ; A6D2= A9 00       ).
LA6D4:
                sta $BD                      ; A6D4= 85 BD       .=
                ldx #$00                     ; A6D6= A2 00       ".
                stz $BC                      ; A6D8= 64 BC       d<
                bvc LA6E6                    ; A6DA= 50 0A       P.
                lda $03C8                    ; A6DC= AD C8 03    -H.
                ora $03C9                    ; A6DF= 0D C9 03    .I.
                beq LA6E6                    ; A6E2= F0 02       p.
                ldx #$04                     ; A6E4= A2 04       ".
LA6E6:
                stx $C2                      ; A6E6= 86 C2       .B
                rts                          ; A6E8= 60          `

LA6E9:
                php                          ; A6E9= 08          .
                ldx #$03                     ; A6EA= A2 03       ".
LA6EC:
                stz $03CB,x                  ; A6EC= 9E CB 03    .K.
                dex                          ; A6EF= CA          J
                bpl LA6EC                    ; A6F0= 10 FA       .z
                lda $03C6                    ; A6F2= AD C6 03    -F.
                ora $03C7                    ; A6F5= 0D C7 03    .G.
                bne LA6FF                    ; A6F8= D0 05       P.
                jsr LA784                    ; A6FA= 20 84 A7     .'
                bra LA702                    ; A6FD= 80 03       ..

LA6FF:
                jsr LA788                    ; A6FF= 20 88 A7     .'
LA702:
                lda #$2A                     ; A702= A9 2A       )*
                sta $BD                      ; A704= 85 BD       .=
                jsr LAA44                    ; A706= 20 44 AA     D*
                jsr LAA16                    ; A709= 20 16 AA     .*
                jsr LA778                    ; A70C= 20 78 A7     x'
                dey                          ; A70F= 88          .
LA710:
                iny                          ; A710= C8          H
                lda $03D2,y                  ; A711= B9 D2 03    9R.
                sta $03B2,y                  ; A714= 99 B2 03    .2.
                jsr LA6CD                    ; A717= 20 CD A6     M&
                bne LA710                    ; A71A= D0 F4       Pt
                ldx #$0C                     ; A71C= A2 0C       ".
LA71E:
                lda $03B2,x                  ; A71E= BD B2 03    =2.
                jsr LA6CD                    ; A721= 20 CD A6     M&
                inx                          ; A724= E8          h
                cpx #$1D                     ; A725= E0 1D       `.
                bne LA71E                    ; A727= D0 F5       Pu
                jsr LA76F                    ; A729= 20 6F A7     o'
                lda $03C8                    ; A72C= AD C8 03    -H.
                ora $03C9                    ; A72F= 0D C9 03    .I.
                beq LA74F                    ; A732= F0 1B       p.
                jsr LAA46                    ; A734= 20 46 AA     F*
LA737:
                jsr LAABC                    ; A737= 20 BC AA     <*
                beq LA741                    ; A73A= F0 05       p.
                lda tube.data3                   ; A73C= AD E5 FE    -e~
                bra LA743                    ; A73F= 80 02       ..

LA741:
                lda ($B0),y                  ; A741= B1 B0       10
LA743:
                jsr LA6CD                    ; A743= 20 CD A6     M&
                iny                          ; A746= C8          H
                cpy $03C8                    ; A747= CC C8 03    LH.
                bne LA737                    ; A74A= D0 EB       Pk
                jsr LA76F                    ; A74C= 20 6F A7     o'
LA74F:
                jsr LA778                    ; A74F= 20 78 A7     x'
                jsr LA778                    ; A752= 20 78 A7     x'
                jsr LAA12                    ; A755= 20 12 AA     .*
                lda #$01                     ; A758= A9 01       ).
                jsr LA78A                    ; A75A= 20 8A A7     .'
                plp                          ; A75D= 28          (
                jsr LA7AB                    ; A75E= 20 AB A7     +'
                bit $03CA                    ; A761= 2C CA 03    ,J.
                bpl LA76E                    ; A764= 10 08       ..
                php                          ; A766= 08          .
                jsr LA784                    ; A767= 20 84 A7     .'
                jsr LA056                    ; A76A= 20 56 A0     V
                plp                          ; A76D= 28          (
LA76E:
                rts                          ; A76E= 60          `

LA76F:
                lda $BF                      ; A76F= A5 BF       %?
                jsr LA776                    ; A771= 20 76 A7     v'
                lda $BE                      ; A774= A5 BE       %>
LA776:
                sta $BD                      ; A776= 85 BD       .=
LA778:
                jsr LA880                    ; A778= 20 80 A8     .(
                bit $C0                      ; A77B= 24 C0       $@
                bpl LA778                    ; A77D= 10 F9       .y
                stz $C0                      ; A77F= 64 C0       d@
                lda $BD                      ; A781= A5 BD       %=
                rts                          ; A783= 60          `

LA784:
                lda #$32                     ; A784= A9 32       )2
                bra LA78A                    ; A786= 80 02       ..

LA788:
                lda $C7                      ; A788= A5 C7       %G
LA78A:
                ldx #$05                     ; A78A= A2 05       ".
LA78C:
                sta $0240                    ; A78C= 8D 40 02    .@.
LA78F:
                jsr LA880                    ; A78F= 20 80 A8     .(
                bit $0240                    ; A792= 2C 40 02    ,@.
                bpl LA78F                    ; A795= 10 F8       .x
                dex                          ; A797= CA          J
                bne LA78C                    ; A798= D0 F2       Pr
                rts                          ; A79A= 60          `

LA79B:
                lda $03C6                    ; A79B= AD C6 03    -F.
                ora $03C7                    ; A79E= 0D C7 03    .G.
                beq LA7A8                    ; A7A1= F0 05       p.
                bit $03DF                    ; A7A3= 2C DF 03    ,_.
                bpl LA7AB                    ; A7A6= 10 03       ..
LA7A8:
                jsr LA059                    ; A7A8= 20 59 A0     Y
LA7AB:
                ldy #$00                     ; A7AB= A0 00        .
                stz $BA                      ; A7AD= 64 BA       d:
                lda $03CA                    ; A7AF= AD CA 03    -J.
                sta $03DF                    ; A7B2= 8D DF 03    ._.
                jsr LEF1B                    ; A7B5= 20 1B EF     .o
                beq LA821                    ; A7B8= F0 67       pg
                lda #$0D                     ; A7BA= A9 0D       ).
                jsr OSWRCH                   ; A7BC= 20 EE FF     n.
LA7BF:
                lda $03B2,y                  ; A7BF= B9 B2 03    92.
                beq LA7D4                    ; A7C2= F0 10       p.
                cmp #$20                     ; A7C4= C9 20       I
                bcc LA7CC                    ; A7C6= 90 04       ..
                cmp #$7F                     ; A7C8= C9 7F       I.
                bcc LA7CE                    ; A7CA= 90 02       ..
LA7CC:
                lda #$3F                     ; A7CC= A9 3F       )?
LA7CE:
                jsr OSWRCH                   ; A7CE= 20 EE FF     n.
                iny                          ; A7D1= C8          H
                bne LA7BF                    ; A7D2= D0 EB       Pk
LA7D4:
                lda $0247                    ; A7D4= AD 47 02    -G.
                beq LA7DD                    ; A7D7= F0 04       p.
                bit $BB                      ; A7D9= 24 BB       $;
                bvc LA821                    ; A7DB= 50 44       PD
LA7DD:
                jsr L9F0C                    ; A7DD= 20 0C 9F     ..
                iny                          ; A7E0= C8          H
                cpy #$0B                     ; A7E1= C0 0B       @.
                bcc LA7D4                    ; A7E3= 90 EF       .o
                lda $03C6                    ; A7E5= AD C6 03    -F.
                tax                          ; A7E8= AA          *
                jsr LA86A                    ; A7E9= 20 6A A8     j(
                bit $03CA                    ; A7EC= 2C CA 03    ,J.
                bpl LA821                    ; A7EF= 10 30       .0
                txa                          ; A7F1= 8A          .
                clc                          ; A7F2= 18          .
                adc $03C9                    ; A7F3= 6D C9 03    mI.
                jsr LA865                    ; A7F6= 20 65 A8     e(
LA7F9:
                lda $03C8                    ; A7F9= AD C8 03    -H.
                jsr LA86A                    ; A7FC= 20 6A A8     j(
                bit $BB                      ; A7FF= 24 BB       $;
                bvc LA821                    ; A801= 50 1E       P.
                ldx #$04                     ; A803= A2 04       ".
LA805:
                jsr L9F0C                    ; A805= 20 0C 9F     ..
                dex                          ; A808= CA          J
                bne LA805                    ; A809= D0 FA       Pz
                ldx #$0F                     ; A80B= A2 0F       ".
                jsr LA815                    ; A80D= 20 15 A8     .(
                jsr L9F0C                    ; A810= 20 0C 9F     ..
                ldx #$13                     ; A813= A2 13       ".
LA815:
                ldy #$04                     ; A815= A0 04        .
LA817:
                lda $03B2,x                  ; A817= BD B2 03    =2.
                jsr LA86A                    ; A81A= 20 6A A8     j(
                dex                          ; A81D= CA          J
                dey                          ; A81E= 88          .
                bne LA817                    ; A81F= D0 F6       Pv
LA821:
                rts                          ; A821= 60          `

LA822:
                lda $0247                    ; A822= AD 47 02    -G.
                beq LA82D                    ; A825= F0 06       p.
                jsr LA9CA                    ; A827= 20 CA A9     J)
                jmp LFBED                    ; A82A= 4C ED FB    Lm{

LA82D:
                jsr LAA5A                    ; A82D= 20 5A AA     Z*
                jsr LAAA0                    ; A830= 20 A0 AA      *
                jsr LEF1B                    ; A833= 20 1B EF     .o
                beq LA821                    ; A836= F0 E9       pi
                jsr LA923                    ; A838= 20 23 A9     #)
                ; EOR ($45)                  ; A83B= 52 45       RE
                ; EQUB $43                   ; A83D= 43          C
                ; EQUB $4F                   ; A83E= 4F          O
                ; EOR ($44)                  ; A83F= 52 44       RD
                ; JSR $6874                  ; A841= 20 74 68     th
                ; ADC $6E                    ; A844= 65 6E       en
                ; JSR $4552                  ; A846= 20 52 45     RE
                ; EQUB $54                   ; A849= 54          T
                ; EOR $52,x                  ; A84A= 55 52       UR
                ; LSR $2000                  ; A84C= 4E 00 20    N.
                ; BRA LA7F9                  ; A84F= 80 A8       .(
                .text "RECORD then RETURN"
                .byte $00

LA84E:
                jsr LA880
                jsr OSRDCH                   ; A851= 20 E0 FF     `.
                cmp #$0D                     ; A854= C9 0D       I.
                bne LA84E                    ; A856= D0 F6       Pv
                jmp OSNEWL                   ; A858= 4C E7 FF    Lg.

LA85B:
                ldx #$FD                     ; A85B= A2 FD       "}
LA85D:
                inc $B4,x                    ; A85D= F6 B4       v4
                bne LA864                    ; A85F= D0 03       P.
                inx                          ; A861= E8          h
                bne LA85D                    ; A862= D0 F9       Py
LA864:
                rts                          ; A864= 60          `

LA865:
                pha                          ; A865= 48          H
                jsr L9F0C                    ; A866= 20 0C 9F     ..
                pla                          ; A869= 68          h
LA86A:
                pha                          ; A86A= 48          H
                lsr a                        ; A86B= 4A          J
                lsr a                        ; A86C= 4A          J
                lsr a                        ; A86D= 4A          J
                lsr a                        ; A86E= 4A          J
                jsr LA873                    ; A86F= 20 73 A8     s(
                pla                          ; A872= 68          h
LA873:
                and #$0F                     ; A873= 29 0F       ).
                ora #$30                     ; A875= 09 30       .0
                cmp #$3A                     ; A877= C9 3A       I:
                bcc LA87D                    ; A879= 90 02       ..
                adc #$06                     ; A87B= 69 06       i.
LA87D:
                jmp OSWRCH                   ; A87D= 4C EE FF    Ln.

LA880:
                php                          ; A880= 08          .
                bit $EB                      ; A881= 24 EB       $k
                bmi LA889                    ; A883= 30 04       0.
                bit $FF                      ; A885= 24 FF       $.
                bmi LA88B                    ; A887= 30 02       0.
LA889:
                plp                          ; A889= 28          (
                rts                          ; A88A= 60          `

LA88B:
                jsr LA177                    ; A88B= 20 77 A1     w!
                jsr LA9BB                    ; A88E= 20 BB A9     ;)
LA891:
                lda #$7E                     ; A891= A9 7E       )~
                jsr OSBYTE                   ; A893= 20 F4 FF     t.
                jsr LAAED                    ; A896= 20 ED AA     m*
                .byte $11
                .text "Escape"
                .byte $00
                ; ORA ($45),y                ; A899= 11 45       .E
                ; EQUB $73                   ; A89B= 73          s
                ; EQUB $63                   ; A89C= 63          c
                ; ADC ($70,x)                ; A89D= 61 70       ap
                ; ADC $00                    ; A89F= 65 00       e.
LA8A1:
                tya                          ; A8A1= 98          .
                beq LA8B1                    ; A8A2= F0 0D       p.
                jsr LA923                    ; A8A4= 20 23 A9     #)
                .byte $0D
                .text "Loading"
                .byte $0D
                .byte $00
                ; ORA $6F4C                  ; A8A7= 0D 4C 6F    .Lo
                ; ADC ($64,x)                ; A8AA= 61 64       ad
                ; ADC #$6E                   ; A8AC= 69 6E       in
                ; EQUB $67                   ; A8AE= 67          g
                ; ORA $6400                  ; A8AF= 0D 00 64    ..d
LA8B1:
                stz $BA                      ; A8B1= 64 BA          :
                ldx #$FF                     ; A8B3= A2 FF       ".
                lda $C1                      ; A8B5= A5 C1       %A
                bne LA8C4                    ; A8B7= D0 0B       P.
                jsr LA95C                    ; A8B9= 20 5C A9     \)
                php                          ; A8BC= 08          .
                ldx #$FF                     ; A8BD= A2 FF       ".
                ldy #$11                     ; A8BF= A0 11        .
                plp                          ; A8C1= 28          (
                bne LA8DA                    ; A8C2= D0 16       P.
LA8C4:
                ldy #$04                     ; A8C4= A0 04        .
                lda $C1                      ; A8C6= A5 C1       %A
                bne LA8DA                    ; A8C8= D0 10       P.
                lda $03C6                    ; A8CA= AD C6 03    -F.
                cmp $B4                      ; A8CD= C5 B4       E4
                bne LA8D8                    ; A8CF= D0 07       P.
                lda $03C7                    ; A8D1= AD C7 03    -G.
                cmp $B5                      ; A8D4= C5 B5       E5
                beq LA8E3                    ; A8D6= F0 0B       p.
LA8D8:
                ldy #$1E                     ; A8D8= A0 1E        .
LA8DA:
                phy                          ; A8DA= 5A          Z
                phx                          ; A8DB= DA          Z
                jsr LA7A8                    ; A8DC= 20 A8 A7     ('
                plx                          ; A8DF= FA          z
                ply                          ; A8E0= 7A          z
                bra LA8F3                    ; A8E1= 80 10       ..

LA8E3:
                phx                          ; A8E3= DA          Z
                jsr LA79B                    ; A8E4= 20 9B A7     .'
                jsr LA9A0                    ; A8E7= 20 A0 A9      )
                plx                          ; A8EA= FA          z
                lda $BE                      ; A8EB= A5 BE       %>
                ora $BF                      ; A8ED= 05 BF       .?
                beq LA96A                    ; A8EF= F0 79       py
                ldy #$04                     ; A8F1= A0 04        .
LA8F3:
                lda #$AB                     ; A8F3= A9 AB       )+
                dec $BA                      ; A8F5= C6 BA       F:
                pha                          ; A8F7= 48          H
                bit $EB                      ; A8F8= 24 EB       $k
                bmi LA909                    ; A8FA= 30 0D       0.
                txa                          ; A8FC= 8A          .
                and $0247                    ; A8FD= 2D 47 02    -G.
LA900:
                bne LA909                    ; A900= D0 07       P.
                txa                          ; A902= 8A          .
                and #$11                     ; A903= 29 11       ).
                and $BB                      ; A905= 25 BB       %;
                beq LA918                    ; A907= F0 0F       p.
LA909:
                pla                          ; A909= 68          h
                sta $B9                      ; A90A= 85 B9       .9
                sty $B8                      ; A90C= 84 B8       .8
                jsr LA58B                    ; A90E= 20 8B A5     .%
                lsr $EB                      ; A911= 46 EB       Fk
                jsr LA9B1                    ; A913= 20 B1 A9     1)
                bra LA955                    ; A916= 80 3D       .=

LA918:
                tya                          ; A918= 98          .
                clc                          ; A919= 18          .
                adc #$03                     ; A91A= 69 03       i.
                tay                          ; A91C= A8          (
                bcc LA922                    ; A91D= 90 03       ..
                pla                          ; A91F= 68          h
                inc a                        ; A920= 1A          .
                pha                          ; A921= 48          H
LA922:
                phy                          ; A922= 5A          Z
LA923:
                jsr LEF1B                    ; A923= 20 1B EF     .o
                tay                          ; A926= A8          (
LA927:
                pla                          ; A927= 68          h
                sta $B8                      ; A928= 85 B8       .8
                pla                          ; A92A= 68          h
                sta $B9                      ; A92B= 85 B9       .9
                phy                          ; A92D= 5A          Z
                tya                          ; A92E= 98          .
                php                          ; A92F= 08          .
LA930:
                inc $B8                      ; A930= E6 B8       f8
                bne LA936                    ; A932= D0 02       P.
                inc $B9                      ; A934= E6 B9       f9
LA936:
                lda ($B8)                    ; A936= B2 B8       28
                beq LA94D                    ; A938= F0 13       p.
                plp                          ; A93A= 28          (
                php                          ; A93B= 08          .
                beq LA930                    ; A93C= F0 F2       pr
                ldy $B8                      ; A93E= A4 B8       $8
                phy                          ; A940= 5A          Z
                ldy $B9                      ; A941= A4 B9       $9
                jsr OSASCI                   ; A943= 20 E3 FF     c.
                sty $B9                      ; A946= 84 B9       .9
                ply                          ; A948= 7A          z
                sty $B8                      ; A949= 84 B8       .8
                bra LA930                    ; A94B= 80 E3       .c

LA94D:
                plp                          ; A94D= 28          (
                inc $B8                      ; A94E= E6 B8       f8
                bne LA954                    ; A950= D0 02       P.
                inc $B9                      ; A952= E6 B9       f9
LA954:
                ply                          ; A954= 7A          z
LA955:
                jmp ($00B8)                  ; A955= 6C B8 00    l8.

LA958:
                ldy #$01                     ; A958= A0 01        .
                bra LA927                    ; A95A= 80 CB       .K

LA95C:
                ldx #$FF                     ; A95C= A2 FF       ".
LA95E:
                inx                          ; A95E= E8          h
                lda $03D2,x                  ; A95F= BD D2 03    =R.
                bne LA96B                    ; A962= D0 07       P.
                txa                          ; A964= 8A          .
                beq LA96A                    ; A965= F0 03       p.
                lda $03B2,x                  ; A967= BD B2 03    =2.
LA96A:
                rts                          ; A96A= 60          `

LA96B:
                jsr isLetter                    ; A96B= 20 71 EA     qj
                eor $03B2,x                  ; A96E= 5D B2 03    ]2.
                bcs LA975                    ; A971= B0 02       0.
                and #$DF                     ; A973= 29 DF       )_
LA975:
                beq LA95E                    ; A975= F0 E7       pg
LA977:
                rts                          ; A977= 60          `

LA978:
                lda $BA                      ; A978= A5 BA       %:
                beq LA99D                    ; A97A= F0 21       p!
                txa                          ; A97C= 8A          .
                beq LA99D                    ; A97D= F0 1E       p.
                lda #$22                     ; A97F= A9 22       )"
                bit $BB                      ; A981= 24 BB       $;
                beq LA99D                    ; A983= F0 18       p.
                jsr LAA12                    ; A985= 20 12 AA     .*
                tay                          ; A988= A8          (
                jsr LA927                    ; A989= 20 27 A9     ')
                .byte $0D
                .byte $07
                .text "Rewind tape"
                .byte $0D
                .byte $0D
                .byte $00
                rts                          ; A99C= 60          `

LA99D:
                jsr LA05D                    ; A99D= 20 5D A0     ]
LA9A0:
                lda $C2                      ; A9A0= A5 C2       %B
                beq LA977                    ; A9A2= F0 D3       pS
                jsr LA880                    ; A9A4= 20 80 A8     .(
                lda $0247                    ; A9A7= AD 47 02    -G.
                beq LA9A0                    ; A9AA= F0 F4       pt
                jsr LA45D                    ; A9AC= 20 5D A4     ]$
                bra LA9A0                    ; A9AF= 80 EF       .o

LA9B1:
                jsr LEF1B                    ; A9B1= 20 1B EF     .o
                beq LA9BB                    ; A9B4= F0 05       p.
LA9B6:
                lda #$07                     ; A9B6= A9 07       ).
                jsr OSWRCH                   ; A9B8= 20 EE FF     n.
LA9BB:
                lda $027A                    ; A9BB= AD 7A 02    -z.
                beq LA9C5                    ; A9BE= F0 05       p.
                lda #$80                     ; A9C0= A9 80       ).
                jsr tubeHost.entryPoint                    ; A9C2= 20 06 04     ..
LA9C5:
                ldx #$00                     ; A9C5= A2 00       ".
                jsr LAA61                    ; A9C7= 20 61 AA     a*
LA9CA:
                php                          ; A9CA= 08          .
                sei                          ; A9CB= 78          x
                lda serialRegisterULACopy                    ; A9CC= AD 82 02    -..
                sta SERPROC+0                    ; A9CF= 8D 10 FE    ..~
                stz $EA                      ; A9D2= 64 EA       dj
                bra LA9D7                    ; A9D4= 80 01       ..

LA9D6:
                php                          ; A9D6= 08          .
LA9D7:
                jsr LAA12                    ; A9D7= 20 12 AA     .*
                lda $0250                    ; A9DA= AD 50 02    -P.
                jmp LE921                    ; A9DD= 4C 21 E9    L!i

LA9E0:
                plp                          ; A9E0= 28          (
                bit $FF                      ; A9E1= 24 FF       $.
                bpl LA9FD                    ; A9E3= 10 18       ..
                rts                          ; A9E5= 60          `

LA9E6:
                lda $E3                      ; A9E6= A5 E3       %c
                asl a                        ; A9E8= 0A          .
                asl a                        ; A9E9= 0A          .
                asl a                        ; A9EA= 0A          .
                asl a                        ; A9EB= 0A          .
                sta $BB                      ; A9EC= 85 BB       .;
                lda $03D1                    ; A9EE= AD D1 03    -Q.
                bra LA9FB                    ; A9F1= 80 08       ..

LA9F3:
                lda $E3                      ; A9F3= A5 E3       %c
                and #$F0                     ; A9F5= 29 F0       )p
                sta $BB                      ; A9F7= 85 BB       .;
                lda #$06                     ; A9F9= A9 06       ).
LA9FB:
                sta $C7                      ; A9FB= 85 C7       .G
LA9FD:
                cli                          ; A9FD= 58          X
LA9FE:
                php                          ; A9FE= 08          .
                sei                          ; A9FF= 78          x
LAA00:
                bit $024F                    ; AA00= 2C 4F 02    ,O.
                bpl LA9E0                    ; AA03= 10 DB       .[
                lda $EA                      ; AA05= A5 EA       %j
                bmi LA9E0                    ; AA07= 30 D7       0W
                lda #$01                     ; AA09= A9 01       ).
                sta $EA                      ; AA0B= 85 EA       .j
                jsr LAA12                    ; AA0D= 20 12 AA     .*
                plp                          ; AA10= 28          (
                rts                          ; AA11= 60          `

LAA12:
                lda #$03                     ; AA12= A9 03       ).
                bra LAA31                    ; AA14= 80 1B       ..

LAA16:
                lda #$30                     ; AA16= A9 30       )0
                sta $CA                      ; AA18= 85 CA       .J
                bra LAA2F                    ; AA1A= 80 13       ..

LAA1C:
                lda #$05                     ; AA1C= A9 05       ).
                sta SERPROC+0                    ; AA1E= 8D 10 FE    ..~
                ldx #$FF                     ; AA21= A2 FF       ".
LAA23:
                dex                          ; AA23= CA          J
                bne LAA23                    ; AA24= D0 FD       P}
                stz $CA                      ; AA26= 64 CA       dJ
                lda #$D0                     ; AA28= A9 D0       )P
LAA2A:
                ldy #$85                     ; AA2A= A0 85        .
                sty SERPROC+0                    ; AA2C= 8C 10 FE    ..~
LAA2F:
                ora $C6                      ; AA2F= 05 C6       .F
LAA31:
                sta ACIA+0                    ; AA31= 8D 08 FE    ..~
                rts                          ; AA34= 60          `

LAA35:
                ldx $03C6                    ; AA35= AE C6 03    .F.
                ldy $03C7                    ; AA38= AC C7 03    ,G.
                inx                          ; AA3B= E8          h
                stx $B4                      ; AA3C= 86 B4       .4
                bne LAA41                    ; AA3E= D0 01       P.
                iny                          ; AA40= C8          H
LAA41:
                sty $B5                      ; AA41= 84 B5       .5
                rts                          ; AA43= 60          `

LAA44:
                stz $C0                      ; AA44= 64 C0       d@
LAA46:
                ldy #$00                     ; AA46= A0 00        .
                stz $BE                      ; AA48= 64 BE       d>
                stz $BF                      ; AA4A= 64 BF       d?
                rts                          ; AA4C= 60          `

LAA4D:
                ldy #$FF                     ; AA4D= A0 FF        .
LAA4F:
                iny                          ; AA4F= C8          H
                inx                          ; AA50= E8          h
                lda $0300,x                  ; AA51= BD 00 03    =..
                sta $03D2,y                  ; AA54= 99 D2 03    .R.
                bne LAA4F                    ; AA57= D0 F6       Pv
                rts                          ; AA59= 60          `

LAA5A:
                ldy #$00                     ; AA5A= A0 00        .
LAA5C:
                cli                          ; AA5C= 58          X
                ldx #$01                     ; AA5D= A2 01       ".
                sty $C3                      ; AA5F= 84 C3       .C
LAA61:
                lda #$89                     ; AA61= A9 89       ).
                ldy $C3                      ; AA63= A4 C3       $C
                jmp OSBYTE                   ; AA65= 4C F4 FF    Lt.

; Check if TAPE/ROM channel is open
; ---------------------------------
; Y=handle to check, A=status mask to use
LAA68:
                phy
                jsr LAA8D
                ply
                bcs LAAC9                    ; Channel open, exit
                cpy $0257                    ; Not SPOOL handle
                bne LAA79
                stz $0257                    ; Clear the SPOOL handle
                bra LAA81
LAA79:
                cpy $0256                    ; Not EXEC handle
                bne LAA81
                stz $0256                    ; Clear the EXEC handle
LAA81:
                jsr LAAED                    ; Generate error
                .byte $DE
                .text "Channel"
                brk

LAA8D:
                pha                          ; Toggle channel with CFS/RFS switch
                tya
                eor $0247
                tay                          ; If CFS=unchanged, if RFS 1/2/3->3/0/1
                pla
                and $E2                      ; Mask with open channels bitmask
                lsr a                        ; Move 'input open if tested' into Carry
                dey                          ; Exit if testing CFS#1 or RFS#3
                beq LAA9F
                lsr a                        ; Move 'output open if tested' into Carry
                dey                          ; Exit if testing CFS#2
                beq LAA9F
                clc                          ; Otherwise, Carry=Not Open
LAA9F:
                rts

LAAA0:
                lda #$10                     ; AAA0= A9 10       ).
                bra LAA2A                    ; AAA2= 80 86       ..

LAAA4:
                lda #$01                     ; AAA4= A9 01       ).
LAAA6:
                jsr LAABC                    ; AAA6= 20 BC AA     <*
                beq LAAC9                    ; AAA9= F0 1E       p.
                txa                          ; AAAB= 8A          .
                ldx #$B0                     ; AAAC= A2 B0       "0
                ldy #$00                     ; AAAE= A0 00        .
LAAB0:
                pha                          ; AAB0= 48          H
                lda #$C0                     ; AAB1= A9 C0       )@
LAAB3:
                jsr tubeHost.entryPoint                    ; AAB3= 20 06 04     ..
                bcc LAAB3                    ; AAB6= 90 FB       .{
                pla                          ; AAB8= 68          h
                jmp tubeHost.entryPoint                    ; AAB9= 4C 06 04    L..

LAABC:
                tax                          ; AABC= AA          *
                lda $B2                      ; AABD= A5 B2       %2
                and $B3                      ; AABF= 25 B3       %3
                inc a                        ; AAC1= 1A          .
                beq LAAC9                    ; AAC2= F0 05       p.
                lda $027A                    ; AAC4= AD 7A 02    -z.
                and #$80                     ; AAC7= 29 80       ).
LAAC9:
                rts                          ; AAC9= 60          `

LAACA:
                ldy #$05                     ; AACA= A0 05        .
LAACC:
                lda ($CC),y                  ; AACC= B1 CC       1L
                bne LAAD7                    ; AACE= D0 07       P.
                iny                          ; AAD0= C8          H
                cpy #$08                     ; AAD1= C0 08       @.
                bcc LAACC                    ; AAD3= 90 F7       .w
LAAD5:
                lda ($CC),y                  ; AAD5= B1 CC       1L
LAAD7:
                dec a                        ; AAD7= 3A          :
                sta ($CC),y                  ; AAD8= 91 CC       .L
                dey                          ; AADA= 88          .
                cpy #$05                     ; AADB= C0 05       @.
                bcs LAAD5                    ; AADD= B0 F6       0v
                rts                          ; AADF= 60          `

LAAE0:
                ldy #$08                     ; AAE0= A0 08        .
                lda #$00                     ; AAE2= A9 00       ).
LAAE4:
                ora ($CC),y                  ; AAE4= 11 CC       .L
                dey                          ; AAE6= 88          .
                cpy #$05                     ; AAE7= C0 05       @.
                bcs LAAE4                    ; AAE9= B0 F9       0y
                tax                          ; AAEB= AA          *
                rts                          ; AAEC= 60          `

LAAED:
                sei                          ; AAED= 78          x
                pla                          ; AAEE= 68          h
                sta $FA                      ; AAEF= 85 FA       .z
                pla                          ; AAF1= 68          h
                sta $FB                      ; AAF2= 85 FB       .{
                stz $0100                    ; AAF4= 9C 00 01    ...
                ldy #$00                     ; AAF7= A0 00        .
LAAF9:
                iny                          ; AAF9= C8          H
                lda ($FA),y                  ; AAFA= B1 FA       1z
                sta $0100,y                  ; AAFC= 99 00 01    ...
LAAFF:
                bne LAAF9                    ; AAFF= D0 F8       Px
                jmp $0100                    ; AB01= 4C 00 01    L..

                jsr LAAED                    ; AB04= 20 ED AA     m*
                .text $d8,13,"Data?",0
                bra LAB2A                    ; AB0F= 80 19       ..

                jsr LAAED                    ; AB11= 20 ED AA     m*
                .text $db,13,"File?",0
                bra LAB2A                    ; AB1C= 80 0C       ..

                jsr LAAED                    ; AB1E= 20 ED AA     m*
                .text $da,13,"Block?",0
LAB2A:
                jmp LA978                    ; AB2A= 4C 78 A9    Lx)

;-------------------------------------------------------------------------
;
; Tube host code
;
; See http://mdfs.net/Software/Tube/M128/Host320.lst
;
; I mostly just copied JGH's comments here.

tubeHost: .block          ;tube code
                
brkHandler: .block
                .logical tubeBrkHandlerAddr
                lda #$FF
                jsr sendR4       ;send $ff via R4 to interrupt copro
                lda tube.data2   ;get ACK byte from copro
                lda #$00
                jsr sendR2A       ;send $00 via R2 to specify ERROR
                tay               ;Y=0
                lda ($FD),y       ;get error number
                jsr sendR2A       ;send error number via R2
-
                iny             ;next char
                lda ($FD),y     ;fetch error string char
                jsr sendR2A     ;send via R2
                tax             ;set N/Z as per error string char
                bne -           ;repeat until terminating $00 sent
idleStartup:
                ldx #$FF
                txs             ;clear stack
                cli
idleLoop:
                bit tube.status1 ;is there a char in R1?
                bpl LAB58        ;branch taken if no char in R1
handleOSWRCH:
                lda tube.data1  ;get char from R1
                jsr OSWRCH      ;pass to OSWRCH
LAB58:
                bit tube.status2 ;is there a command in R2?
                bpl idleLoop     ;branch taken if no command in R2
                bit tube.status1 ;is there a char in R1?
                bmi handleOSWRCH ;branch taken if char in R1
                ldx tube.data2   ;get command from R2
                stx callCommandRoutine+1 ;use as index into command
                                         ;table
callCommandRoutine:
                ; not sure why this can't be jmp
                ; (tubeHost.commandRoutines,x)? - and then the table
                ; wouldn't have to be page-aligned.
                jmp (tubeHost.commandRoutines)

                ; ???
                .dword $8000
                .here
size=*-brkHandler
                .bend

; Slightly ugly aliases for inner symbol :(
idleStartup=brkHandler.idleStartup
idleLoop=brkHandler.idleLoop

codePage0:
                .logical tubeHostAddr
copyLanguage:
                jmp LAC30

copyEscapeStatus:
                jmp LADDA

; Tube transfer/claim/release
entryPoint:
                cmp #$80
                bcc dataTransfer
                cmp #$C0
                bcs claim
                ora #$40
                cmp $15
                bne done
release:
                php                          ; AB82= 08          .
                sei                          ; AB83= 78          x
                lda #$05                     ; AB84= A9 05       ).
                jsr sendR4
                jsr sendR4TubeClaimantID
                plp                          ; AB8C= 28          (
LAB8D:
                lda #$80                     ; AB8D= A9 80       ).
                sta $15                      ; AB8F= 85 15       ..
                sta $14                      ; AB91= 85 14       ..
                rts                          ; AB93= 60          `

claim:
                asl tubeClaimed    ;test if Tube free
                bcs claim2         ;taken if Tube free - with C=1 and
                                   ;tube marked as claimed
                cmp tubeClaimantID
                beq done       ;taken with C=1 if already claimed
                clc            ;signal claim failure
                rts

claim2:
                sta tubeClaimantID ; store claimant ID
done:
                rts

dataTransfer:
                php
                sei
                sty tubeTransferAddr+1
                stx tubeTransferAddr+0
                jsr sendR4      ;send reason code to interrupt copro
                tax             ;save reason code
                ldy #$03        ;will send 4 bytes
                jsr sendR4TubeClaimantID ;send Tube claimant ID
-
                lda (tubeTransferAddr),y
                jsr sendR4
                dey
                bpl -

                ; disable R3 FIFO, disable R3 NMI
                ldy #tube.status1.V|tube.status1.M
                sty tube.status1

                ; disable/enable other per-transfer type flags as
                ; appropriate.
                lda dataTransferFlags,x
                sta tube.status1 ;STPVMJIQ

                lsr a           ;0STPVMJI Q
                lsr a           ;00STPVMJ I
                bcc +           ;branch taken if CoPro->I/O transfer

                ; Read R3 twice to delay and empty FIFO
                bit tube.data3
                bit tube.data3
+
                jsr sendR4      ;send value to synchronize
-
                bit tube.status4
                bvc -
                bcs LABE4       ;branch taken if I/O->CoPro transfer
                cpx #$04        ;$04 = execute in CoPro
                bne LABEC       ;taken if not execute in CoPro
LABDB:
                jsr release                    ; ABDB= 20 14 04     ..
                jsr sendR2A                    ; ABDE= 20 61 06     a.
                jmp idleStartup                ; ABE1= 4C 32 00    L2.

LABE4:
                lsr a            ;000STPVM J
                bcc LABEC        ;branch taken if J=0
                ldy #tube.status1.S|tube.status1.M
                sty tube.status1
LABEC:
                plp                          ; ABEC= 28          (
                rts                          ; ABED= 60          `

LABEE:
                ldx $028D   ;get last BREAK type
                beq LABDB   ;if soft break, release Tube, send $80 via
                            ;R2, and enter idle loop.

; The current language is not copied across the Tube on soft Break,
; only on Power-On Break and Hard Break, or when entered explicitly
; with OSBYTE 142.
                
enterNewLanguage: .proc
                lda #$FF
                jsr tubeHost.entryPoint ;claim with ID=$3f
                bcc enterNewLanguage    ;repeat until claimed
                jsr getLanguageParasiteAddr ;sort out addresses
                
transferPage:
                php
                sei

                ; initiate I/O->CoPro 256 bytes, then transfer the
                ; next 256 bytes of the language ROM.
                lda #$07
                jsr doTube
                
                ldy #$00
                stz tubeLanguageHostAddr+0
-
                lda (tubeLanguageHostAddr),y
                sta tube.data3
                nop
                nop
                nop
                iny
                bne -
                plp

                ; advance to next dest page.
                inc tubeLanguageParasiteAddr+1
                bne +
                inc tubeLanguageParasiteAddr+2
                bne +
                inc tubeLanguageParasiteAddr+3
+
                
                inc tubeLanguageHostAddr+1 ;next source page
                bit tubeLanguageHostAddr+1
                bvc transferPage ;branch taken if source page $c0 not
                                 ;reached yet

                ; copy done - execute language in parasite
                jsr getLanguageParasiteAddr
                lda #$04        ;execute in copro

                ; call Tube entry point with whatever reason code,
                ; supplying language parasite address as the parasite
                ; address.
doTube:
                ldy #>tubeLanguageParasiteAddr
                ldx #<tubeLanguageParasiteAddr
                jmp tubeHost.entryPoint
                .pend
                
LAC30:
                cli                          ; AC30= 58          X
                bcs enterNewLanguage         ; AC31= B0 C0       0@
                bne LABEE                    ; AC33= D0 B9       P9
                bra LAC8F                    ; AC35= 80 61       .a

getLanguageParasiteAddr: .proc
                lda #$80                     ; AC37= A9 80       ).
                sta tubeLanguageParasiteAddr+1 ;$xxxx80xx
                sta tubeLanguageHostAddr+1     ;$80xx
                lda #$20
                and $8006  ;test parasite address flag
                tay        ;Y=0 if $8000, Y=$20 if parasite address
                sty tubeLanguageParasiteAddr+0
                beq LAC60       ;branch taken if good to go with A=0
                                ;and Y=0

                ldx $8007       ;get copyright offset
                ; skip copyright message
-
                inx
                lda $8000,x
                bne -
                
                lda $8001,x
                sta tubeLanguageParasiteAddr+0
                lda $8002,x
                sta tubeLanguageParasiteAddr+1
                ldy L8003,x                  
                lda L8004,x
LAC60:
                sta tubeLanguageParasiteAddr+3
                sty tubeLanguageParasiteAddr+2
                rts
                .pend
                .here

codePages12:
                .logical tubeHostAddr+256

; names of the indexes here come from app note 004
commandRoutines:
                .cerror (*&$ff)!=0,"commandRoutines must be paged aligned"
                .word doRDCH    ;RDCHNO = $00
                .word doCLI     ;CLINO = $02
                .word doSBYT    ;SBYTNO = $04
                .word doBYTE    ;BYTENO = $06
                .word doWORD    ;WORDNO = $08
                .word doRDLN    ;RDLNNO = $0a
                .word doARGS     ;ARGSNO = $0c
                .word doBGET     ;BGETNO = $0e
                .word doBPUT     ;BPUTNO = $10
                .word doFIND     ;FINDNO = $12
                .word doFILE    ;FILENO = $14
                .word doGBPB     ;GBPBNO = $16

                ; Tube data transfer flags
dataTransferFlags:
                ; 0 - CoPro->I/O bytes
                ;
                ; Enable: PIRQ from R3, PIRQ from R1
                .byte tube.status1.S|tube.status1.J|tube.status1.I

                ; 1 - I/O->CoPro bytes
                ;
                ; Enable: PNMI from R3
                .byte tube.status1.S|tube.status1.M

                ; 2 - CoPro->I/O words
                ;
                ; Enable: 2-byte R3, PIRQ from R2, PIRQ from R1
                .byte tube.status1.S|tube.status1.V|tube.status1.J|tube.status1.I

                ; 3 - I/O->CoPro words
                ;
                ; Enable: 2-byte R3, PNMI from R3
                .byte tube.status1.S|tube.status1.V|tube.status1.M

                ; 4 - Execute in CoPro
                ;
                ; Disable: 2-byte R3, PNMI from R3
                .byte tube.status1.V|tube.status1.M

                ; 5 - Reserved
                ;
                ; Disable: 2-byte R3, PNMI from R3
                .byte tube.status1.V|tube.status1.M

                ; 6 - CoPro->I/O 256 bytes
                ;
                ; Enable: PIRQ from R1
                .byte tube.status1.S|tube.status1.I

                ; 7 - I/O->CoPro 256 bytes
                ;
                ; Disable: 2-byte R3, PNMI from R3
                .byte tube.status1.V|tube.status1.M

doBPUT:
                jsr recvR2      ;Receive file handle
                tay             ;Y = file handle
                jsr recvR2      ;Receive byte
                jsr OSBPUT      ;Do OSBPUT
LAC8F:
                bra sendR27FThenGoIdle

doBGET:
                jsr recvR2      ;Receive file handle
                tay             ;Y = file handle
                jsr OSBGET      ;Do OSBGET
LAC98:
                bra sendR2CAThenGoIdle

doRDCH:
                jsr OSRDCH      ;Do OSRDCH
sendR2CAThenGoIdle:
                ror a           ;set A bit 7 as per carry
                jsr sendR2A     ;send via R2
                rol a           ;restore A
                bra sendR2AThenGoIdle

doFIND: .proc
                jsr recvR2            ;Receive reason code
                beq close             ;taken if A=$00 - CLOSE#
                pha                   ;save reason code
                jsr recvR2String      ;receive file name
                pla                   ;restore reason code
                jsr OSFIND            ;call OSFIND
                bra sendR2AThenGoIdle

close:
                jsr recvR2      ;Receive file handle
                tay             ;Y = file handle
                lda #$00        ;A = $00 - CLOSE#
                jsr OSFIND      ;call OSFIND
                bra sendR27FThenGoIdle
                .pend
                
doARGS:
                jsr recvR2                    ; ACBE= 20 A1 06     !.
                tay                          ; ACC1= A8          (
                ldx #$04                     ; ACC2= A2 04       ".
                jsr LADF8                    ; ACC4= 20 93 06     ..
                jsr OSARGS                   ; ACC7= 20 DA FF     Z.
                jsr sendR2A                    ; ACCA= 20 61 06     a.
                ldx #$03                     ; ACCD= A2 03       ".
LACCF:
                lda $00,x                    ; ACCF= B5 00       5.
                jsr sendR2A                    ; ACD1= 20 61 06     a.
                dex                          ; ACD4= CA          J
                bpl LACCF                    ; ACD5= 10 F8       .x
                bra goIdle_0

;-------------------------------------------------------------------------
;
; Receive a CR-terminated string over the Tube via R2.
;
; exit:
; YX = pointer to received string (here, always $0700)
;
recvR2String: .proc
                ldx #$00
                ldy #$00        ;index
-
                jsr recvR2      ;get next string char
                sta $0700,y     ;store in string buffer
                iny
                beq +           ;taken if too many bytes received
                cmp #$0D
                bne -           ;taken if end of string data not reached
+
                ldy #$07        ;on exit, YX=$0700
                rts                          
                .pend

;-------------------------------------------------------------------------
;
; Handle a Tube OSCLI request.
;
; See App Note 004 p22
;
doCLI:
                jsr recvR2String
                jsr OSCLI
sendR27FThenGoIdle:
                lda #$7F                     ; ACF3= A9 7F       ).
sendR2AThenGoIdle:
-
                bit tube.status2
                bvc -
                sta tube.data2
goIdle_0:
                bra goIdle_1

doGBPB:
                ldx #$0D                     ; ACFF= A2 0D       ".
                jsr LADF8                    ; AD01= 20 93 06     ..
                ldy #$00                     ; AD04= A0 00        .
                jsr OSGBPB                   ; AD06= 20 D1 FF     Q.
                pha                          ; AD09= 48          H
                ldx #$0C                     ; AD0A= A2 0C       ".
LAD0C:
                lda $00,x                    ; AD0C= B5 00       5.
                jsr sendR2A                    ; AD0E= 20 61 06     a.
                dex                          ; AD11= CA          J
                bpl LAD0C                    ; AD12= 10 F8       .x
                pla                          ; AD14= 68          h
                bra sendR2CAThenGoIdle
                
doFILE: .proc
                ldx #$10                     ; AD17= A2 10       ".
-
                jsr recvR2                    ; AD19= 20 A1 06     !.
                sta $01,x                    ; AD1C= 95 01       ..
                dex                          ; AD1E= CA          J
                bne -
                jsr recvR2String                    ; AD21= 20 74 05     t.
                stx $00                      ; AD24= 86 00       ..
                sty $01                      ; AD26= 84 01       ..
                ldy #$00                     ; AD28= A0 00        .
                jsr recvR2                    ; AD2A= 20 A1 06     !.
                jsr OSFILE                   ; AD2D= 20 DD FF     ].
                jsr sendR2A                    ; AD30= 20 61 06     a.
                ldx #$10                     ; AD33= A2 10       ".
-
                lda $01,x                    ; AD35= B5 01       5.
                jsr sendR2A                    ; AD37= 20 61 06     a.
                dex                          ; AD3A= CA          J
                bne -
                bra goIdle_1
                .pend

;-------------------------------------------------------------------------
;
; Do a small (A<$80) OSBYTE 
;
doSBYT:
                jsr recvR2XA    ;receive X and A arguments
                jsr OSBYTE
sendR2X:
                bit tube.status2                   ; AD45= 2C E2 FE    ,b~
                bvc sendR2X
                stx tube.data2                   ; AD4A= 8E E3 FE    .c~
goIdle_1:
                jmp idleLoop                    ; AD4D= 4C 36 00    L6.

doBYTE:
                jsr recvR2XA                    ; AD50= 20 9D 06     ..
                tay                          ; AD53= A8          (
                jsr recvR2                    ; AD54= 20 A1 06     !.
                jsr OSBYTE                   ; AD57= 20 F4 FF     t.
                eor #$9D                     ; AD5A= 49 9D       I.
                beq goIdle_1
                ror a                        ; AD5E= 6A          j
                jsr sendR2A                    ; AD5F= 20 61 06     a.
LAD62:
                bit tube.status2                   ; AD62= 2C E2 FE    ,b~
                bvc LAD62                    ; AD65= 50 FB       P{
                sty tube.data2                   ; AD67= 8C E3 FE    .c~
                bra sendR2X

doWORD:
                jsr recvR2                    ; AD6C= 20 A1 06     !.
                tay                          ; AD6F= A8          (
                jsr LAE0F                    ; AD70= 20 AA 06     *.
                bmi LAD7F                    ; AD73= 30 0A       0.
LAD75:
                jsr recvR2                    ; AD75= 20 A1 06     !.
                sta $0128,x                  ; AD78= 9D 28 01    .(.
                dex                          ; AD7B= CA          J
                bpl LAD75                    ; AD7C= 10 F7       .w
                tya                          ; AD7E= 98          .
LAD7F:
                ldx #$28                     ; AD7F= A2 28       "(
                ldy #$01                     ; AD81= A0 01        .
                jsr OSWORD                   ; AD83= 20 F1 FF     q.
                jsr LAE0F                    ; AD86= 20 AA 06     *.
                bmi goIdle_1
LAD8B:
                ldy $0128,x                  ; AD8B= BC 28 01    <(.
LAD8E:
                bit tube.status2                   ; AD8E= 2C E2 FE    ,b~
                bvc LAD8E                    ; AD91= 50 FB       P{
                sty tube.data2                   ; AD93= 8C E3 FE    .c~
                dex                          ; AD96= CA          J
                bpl LAD8B                    ; AD97= 10 F2       .r
LAD99:
                bra goIdle_1
                
doRDLN:
                ldx #$04                     ; AD9B= A2 04       ".
LAD9D:
                jsr recvR2                    ; AD9D= 20 A1 06     !.
                sta $00,x                    ; ADA0= 95 00       ..
                dex                          ; ADA2= CA          J
                bpl LAD9D                    ; ADA3= 10 F8       .x
                inx                          ; ADA5= E8          h
                txa                          ; ADA6= 8A          .
                tay                          ; ADA7= A8          (
                jsr OSWORD                   ; ADA8= 20 F1 FF     q.
                bcc LADB2                    ; ADAB= 90 05       ..
                lda #$FF                     ; ADAD= A9 FF       ).
                jmp sendR2AThenGoIdle                    ; ADAF= 4C 90 05    L..

LADB2:
                ldx #$00                     ; ADB2= A2 00       ".
                lda #$7F                     ; ADB4= A9 7F       ).
                jsr sendR2A                    ; ADB6= 20 61 06     a.
LADB9:
                lda $0700,x                  ; ADB9= BD 00 07    =..
                jsr sendR2A                    ; ADBC= 20 61 06     a.
                inx                          ; ADBF= E8          h
                cmp #$0D                     ; ADC0= C9 0D       I.
                bne LADB9                    ; ADC2= D0 F5       Pu
                bra LAD99                    ; ADC4= 80 D3       .S

sendR2A:                          ;adc6/0661
                bit tube.status2                   ; ADC6= 2C E2 FE    ,b~
                bvc sendR2A                    ; ADC9= 50 FB       P{
                sta tube.data2                   ; ADCB= 8D E3 FE    .c~
                rts                          ; ADCE= 60          `
                
sendR4TubeClaimantID:              ;adcf
                lda tubeClaimantID ;get Tube ID
sendR4:                          ;add1/066c
                bit tube.status4 ;check R4 status
                bvc sendR4       ;branch taken if FIFO full
                sta tube.data4   ;put byte in FIFO
                rts

LADDA:
                lda $FF                      ; ADDA= A5 FF       %.
                sec                          ; ADDC= 38          8
                ror a                        ; ADDD= 6A          j
                bra LADEF                    ; ADDE= 80 0F       ..

LADE0:
                pha                          ; ADE0= 48          H
                lda #$00                     ; ADE1= A9 00       ).
                jsr LADEF                    ; ADE3= 20 8A 06     ..
                tya                          ; ADE6= 98          .
                jsr LADEF                    ; ADE7= 20 8A 06     ..
                txa                          ; ADEA= 8A          .
                jsr LADEF                    ; ADEB= 20 8A 06     ..
                pla                          ; ADEE= 68          h
LADEF:
                bit tube.status1                   ; ADEF= 2C E0 FE    ,`~
                bvc LADEF                    ; ADF2= 50 FB       P{
                sta tube.data1                   ; ADF4= 8D E1 FE    .a~
                rts                          ; ADF7= 60          `

LADF8:
                jsr recvR2                    ; ADF8= 20 A1 06     !.
                sta $ff,x                    ; ADFB= 95 FF       ..
                dex                          ; ADFD= CA          J
                bne LADF8                    ; ADFE= D0 F8       Px
                bra recvR2                    ; AE00= 80 04       ..

recvR2XA:
                jsr recvR2                    ; AE02= 20 A1 06     !.
                tax                          ; AE05= AA          *
recvR2:
                bit tube.status2                   ; AE06= 2C E2 FE    ,b~
                bpl recvR2                    ; AE09= 10 FB       .{
                lda tube.data2                   ; AE0B= AD E3 FE    -c~
                rts                          ; AE0E= 60          `

LAE0F:
                bit tube.status2                   ; AE0F= 2C E2 FE    ,b~
                bpl LAE0F                    ; AE12= 10 FB       .{
                ldx tube.data2                   ; AE14= AE E3 FE    .c~
                dex                          ; AE17= CA          J
                rts                          ; AE18= 60          `
                .here
                .bend

LAE19:
                php                          ; AE19= 08          .
                phy                          ; AE1A= 5A          Z
                phx                          ; AE1B= DA          Z
                pha                          ; AE1C= 48          H
                cmp #$04                     ; AE1D= C9 04       I.
                beq LAE2E                    ; AE1F= F0 0D       p.
                cmp #$07                     ; AE21= C9 07       I.
                beq LAE4A                    ; AE23= F0 25       p%
                cmp #$2A                     ; AE25= C9 2A       I*
                beq LAE9D                    ; AE27= F0 74       pt
LAE29:
                pla                          ; AE29= 68          h
                plx                          ; AE2A= FA          z
                ply                          ; AE2B= 7A          z
                plp                          ; AE2C= 28          (
                rts                          ; AE2D= 60          `

LAE2E:
                jsr LB832                    ; AE2E= 20 32 B8     28
                cmp #$0B                     ; AE31= C9 0B       I.
                bne LAE29                    ; AE33= D0 F4       Pt
                pla                          ; AE35= 68          h
                plx                          ; AE36= FA          z
                lda #$8E                     ; AE37= A9 8E       ).
                jsr OSBYTE                   ; AE39= 20 F4 FF     t.
LAE3C:
                ldx #$04                     ; AE3C= A2 04       ".
LAE3E:
                lda $0229,x                  ; AE3E= BD 29 02    =).
                cmp LAE93-1,x                ; AE41= DD 92 AE    ]..
                bne LAE49                    ; AE44= D0 03       P.
                dex                          ; AE46= CA          J
                bne LAE3E                    ; AE47= D0 F5       Pu
LAE49:
                rts                          ; AE49= 60          `
                
LAE4A:
                phy                          ; AE4A= 5A          Z
                ply                          ; AE4B= 7A          z
                bne LAE29                    ; AE4C= D0 DB       P[
                lda $EF                      ; AE4E= A5 EF       %o
                cmp #$60                     ; AE50= C9 60       I`
                bne LAE29                    ; AE52= D0 D5       PU
                pla                          ; AE54= 68          h
                phy                          ; AE55= 5A          Z
                sei                          ; AE56= 78          x
                lda $F0                      ; AE57= A5 F0       %p
                bmi LAE6C                    ; AE59= 30 11       0.
                lsr a                        ; AE5B= 4A          J
                bne LAE66                    ; AE5C= D0 08       P.
                lda #$11                     ; AE5E= A9 11       ).
                sta $76                      ; AE60= 85 76       .v
                ror $74                      ; AE62= 66 74       ft
                bra LAE29                    ; AE64= 80 C3       .C

LAE66:
                
                stz $78                      ; AE66= 64 78       dx
                ror $77                      ; AE68= 66 77       fw
                
LAE6A:
                bra LAE29                    ; AE6A= 80 BD       .=

LAE6C:
                lsr a                        ; AE6C= 4A          J
                bcc LAE9D                    ; AE6D= 90 2E       ..
                stz $75                      ; AE6F= 64 75       du
                jsr LAE3C                    ; AE71= 20 3C AE     <.
                beq LAE29                    ; AE74= F0 B3       p3
                ldx #$04                     ; AE76= A2 04       ".
LAE78:
                lda INSV-1,x                  ; AE78= BD 29 02    =).
                sta $6F,x                    ; AE7B= 95 6F       .o
                lda LAE93-1,x                ; AE7D= BD 92 AE    =..
                sta INSV-1,x                  ; AE80= 9D 29 02    .).
                dex                          ; AE83= CA          J
                bne LAE78                    ; AE84= D0 F2       Pr
                ldx #$06                     ; AE86= A2 06       ".
LAE88:
                lda LAE97-1,x                  ; AE88= BD 96 AE    =..
                sta extendedVectorSpace+insvIndex*3-1,x
                dex                          ; AE8E= CA          J
                bne LAE88                    ; AE8F= D0 F7       Pw
                bra LAE6A                    ; AE91= 80 D7       .W

LAE93:
                .word E_INSV
                .word E_REMV
LAE97:
                .word LAED4
                .byte $0f
                .word LAF13
                .byte $0F                    ; AE9C= 0F          .
LAE9D:
                sei                          ; AE9D= 78          x
                jsr LAE3C                    ; AE9E= 20 3C AE     <.
                bne LAE6A                    ; AEA1= D0 C7       PG
                ldx #$06                     ; AEA3= A2 06       ".
LAEA5:
                lda extendedVectorSpace+insvIndex*3-1,x
                cmp LAE97-1,x                  ; AEA8= DD 96 AE    ]..
                bne LAE6A                    ; AEAB= D0 BD       P=
                dex                          ; AEAD= CA          J
                bne LAEA5                    ; AEAE= D0 F5       Pu
                ldx #$04                     ; AEB0= A2 04       ".
LAEB2:
                lda $6F,x                    ; AEB2= B5 6F       5o
                sta $0229,x                  ; AEB4= 9D 29 02    .).
                dex                          ; AEB7= CA          J
                bne LAEB2                    ; AEB8= D0 F8       Px
                lda #$E6                     ; AEBA= A9 E6       )f
                jsr LB823                    ; AEBC= 20 23 B8     #8
                lda #$CB                     ; AEBF= A9 CB       )K
                ldx #$09                     ; AEC1= A2 09       ".
                jsr LB825                    ; AEC3= 20 25 B8     %8
                jsr LB11A                    ; AEC6= 20 1A B1     .1
                inc a                        ; AEC9= 1A          .
LAECA:
                jsr LB823                    ; AECA= 20 23 B8     #8
                dec a                        ; AECD= 3A          :
                cmp #$01                     ; AECE= C9 01       I.
                bne LAECA                    ; AED0= D0 F8       Px
                bra LAE6A                    ; AED2= 80 96       ..

LAED4:
                php                          ; AED4= 08          .
                sei                          ; AED5= 78          x
                cpx #$01                     ; AED6= E0 01       `.
                bne LAF0B                    ; AED8= D0 31       P1
                bit $77                      ; AEDA= 24 77       $w
                bpl LAEEC                    ; AEDC= 10 0E       ..
                cmp #$13                     ; AEDE= C9 13       I.
                beq LAEE7                    ; AEE0= F0 05       p.
                cmp #$11                     ; AEE2= C9 11       I.
                bne LAEEC                    ; AEE4= D0 06       P.
                clc                          ; AEE6= 18          .
LAEE7:
                ror $78                      ; AEE7= 66 78       fx
LAEE9:
                plp                          ; AEE9= 28          (
                clc                          ; AEEA= 18          .
                rts                          ; AEEB= 60          `

LAEEC:
                bit $74                      ; AEEC= 24 74       $t
                bpl LAF0B                    ; AEEE= 10 1B       ..
                pha                          ; AEF0= 48          H
                sec                          ; AEF1= 38          8
                jsr LAF0F                    ; AEF2= 20 0F AF     ./
                tya                          ; AEF5= 98          .
                bne LAF08                    ; AEF6= D0 10       P.
                cpx #$20                     ; AEF8= E0 20       `
                bcs LAF08                    ; AEFA= B0 0C       0.
                lda #$13                     ; AEFC= A9 13       ).
                cpx #$10                     ; AEFE= E0 10       `.
                bcc LAF06                    ; AF00= 90 04       ..
                cmp $76                      ; AF02= C5 76       Ev
                beq LAF08                    ; AF04= F0 02       p.
LAF06:
                sta $75                      ; AF06= 85 75       .u
LAF08:
                pla                          ; AF08= 68          h
                ldx #$01                     ; AF09= A2 01       ".
LAF0B:
                plp                          ; AF0B= 28          (
                jmp ($0070)                  ; AF0C= 6C 70 00    lp.

LAF0F:
                clv                          ; AF0F= B8          8
                jmp (CNPV)                  ; AF10= 6C 2E 02    l..

LAF13:
                php                          ; AF13= 08          .
                sei                          ; AF14= 78          x
                cpx #$01                     ; AF15= E0 01       `.
                bne LAF37                    ; AF17= D0 1E       P.
                bit $74                      ; AF19= 24 74       $t
                bpl LAF33                    ; AF1B= 10 16       ..
                clc                          ; AF1D= 18          .
                jsr LAF0F                    ; AF1E= 20 0F AF     ./
                cpy #$00                     ; AF21= C0 00       @.
                bne LAF31                    ; AF23= D0 0C       P.
                cpx #$20                     ; AF25= E0 20       `
                bcs LAF31                    ; AF27= B0 08       0.
                lda #$11                     ; AF29= A9 11       ).
                cmp $76                      ; AF2B= C5 76       Ev
                beq LAF31                    ; AF2D= F0 02       p.
                sta $75                      ; AF2F= 85 75       .u
LAF31:
                ldx #$01                     ; AF31= A2 01       ".
LAF33:
                plp                          ; AF33= 28          (
                jmp ($0072)                  ; AF34= 6C 72 00    lr.

LAF37:
                cpx #$02                     ; AF37= E0 02       `.
                bne LAF33                    ; AF39= D0 F8       Px
                lda $75                      ; AF3B= A5 75       %u
                tay                          ; AF3D= A8          (
                beq LAF48                    ; AF3E= F0 08       p.
                bvs LAEE9                    ; AF40= 70 A7       p'
                stz $75                      ; AF42= 64 75       du
                sta $76                      ; AF44= 85 76       .v
                bra LAEE9                    ; AF46= 80 A1       .!

LAF48:
                lda $78                      ; AF48= A5 78       %x
                bpl LAF33                    ; AF4A= 10 E7       .g
                plp                          ; AF4C= 28          (
                sec                          ; AF4D= 38          8
LAF4E:
                rts                          ; AF4E= 60          `

LAF4F:
                lda #$DA                     ; AF4F= A9 DA       )Z
                jsr LB823                    ; AF51= 20 23 B8     #8
                jsr LB634                    ; AF54= 20 34 B6     46
                ldy #$00                     ; AF57= A0 00        .
                lda ($FD),y                  ; AF59= B1 FD       1}
                bne LAF63                    ; AF5B= D0 06       P.
                stz $20                      ; AF5D= 64 20       d
                lda #$16                     ; AF5F= A9 16       ).
                sta $6F                      ; AF61= 85 6F       .o
LAF63:
                lda #$0D                     ; AF63= A9 0D       ).
LAF65:
                jsr OSASCI                   ; AF65= 20 E3 FF     c.
                iny                          ; AF68= C8          H
                lda ($FD),y                  ; AF69= B1 FD       1}
                bne LAF65                    ; AF6B= D0 F8       Px
                jsr OSNEWL                   ; AF6D= 20 E7 FF     g.
                sec                          ; AF70= 38          8
                ror $19                      ; AF71= 66 19       f.
                lda $1A                      ; AF73= A5 1A       %.
                bne LAFF4                    ; AF75= D0 7D       P}
LAF77:
                dec a                        ; AF77= 3A          :
                bne LAF4E                    ; AF78= D0 D4       PT
                lda #$01                     ; AF7A= A9 01       ).
                sta $6F                      ; AF7C= 85 6F       .o
LAF7E:
                sei                          ; AF7E= 78          x
                ldx #$FE                     ; AF7F= A2 FE       "~
                txs                          ; AF81= 9A          .
                lda #<LAF4F                     ; AF82= A9 4F       )O
                sta BRKV+0
                lda #>LAF4F
                sta BRKV+1
                lda #<LB7B1
                sta IND1V+0
                lda #>LB7B1
                sta IND1V+1
                lda #<LB7B1
                sta IND2V+0
                lda #>LB7B1
                sta IND2V+1
                ldx #$6E                     ; AFA0= A2 6E       "n
LAFA2:
                stz $00,x                    ; AFA2= 74 00       t.
                dex                          ; AFA4= CA          J
                bpl LAFA2                    ; AFA5= 10 FB       .{
                dec $21                      ; AFA7= C6 21       F!
                dec $34                      ; AFA9= C6 34       F4
                dec $36                      ; AFAB= C6 36       F6
                cli                          ; AFAD= 58          X
                lda #$0B                     ; AFAE= A9 0B       ).
                jsr LB690                    ; AFB0= 20 90 B6     .6
                lda #$87                     ; AFB3= A9 87       ).
                jsr OSBYTE                   ; AFB5= 20 F4 FF     t.
                tya                          ; AFB8= 98          .
                jsr LB579                    ; AFB9= 20 79 B5     y5
                ldy #$FF                     ; AFBC= A0 FF        .
LAFBE:
                iny                          ; AFBE= C8          H
                lda LAFCE,y                  ; AFBF= B9 CE AF    9N/
                beq LAFF4                    ; AFC2= F0 30       p0
                ldx LAFE1,y                  ; AFC4= BE E1 AF    >a/
                phy                          ; AFC7= 5A          Z
                jsr LB825                    ; AFC8= 20 25 B8     %8
                ply                          ; AFCB= 7A          z
                bra LAFBE                    ; AFCC= 80 F0       .p

LAFCE:
                .byte $CB                    ; AFCE= CB          K
                rts                          ; AFCF= 60          `

                rts                          ; AFD0= 60          `

                rts                          ; AFD1= 60          `

                .byte $0F                    ; AFD2= 0F          .
                .byte $0F                    ; AFD3= 0F          .
                cmp LDFDE,x                  ; AFD4= DD DE DF    ]^_
                cpx #$E1                     ; AFD7= E0 E1       `a
                .byte $E2                    ; AFD9= E2          b
                .byte $E3                    ; AFDA= E3          c
                cpx $E5                      ; AFDB= E4 E5       de
                tsb $7E                      ; AFDD= 04 7E       .~
                inc $02                      ; AFDF= E6 02       f.
LAFE1:
                brk                          ; AFE1= 00          .
                ora ($03,x)                  ; AFE2= 01 03       ..
                .byte $FF                    ; AFE4= FF          .
                ora ($02,x)                  ; AFE5= 01 02       ..
                cpy #$D0                     ; AFE7= C0 D0       @P
                cpx #$F0                     ; AFE9= E0 F0       `p
                ora ($90,x)                  ; AFEB= 01 90       ..
                ldy #$A0                     ; AFED= A0 A0
                ora ($00,x)                  ; AFEF= 01 00       ..
                brk                          ; AFF1= 00          .
                ora ($02,x)                  ; AFF2= 01 02       ..
LAFF4:
                ldx #$FE                     ; AFF4= A2 FE       "~
                txs                          ; AFF6= 9A          .
                sec                          ; AFF7= 38          8
                ror $1A                      ; AFF8= 66 1A       f.
                stz $1D                      ; AFFA= 64 1D       d.
                jsr LB004                    ; AFFC= 20 04 B0     .0
                jsr LB004                    ; AFFF= 20 04 B0     .0
                bra LB030                    ; B002= 80 2C       .,

LB004:
                jsr LB041                    ; B004= 20 41 B0     A0
                ldy #$01                     ; B007= A0 01        .
                sta ($1B),y                  ; B009= 91 1B       ..
                iny                          ; B00B= C8          H
                txa                          ; B00C= 8A          .
                sta ($1B),y                  ; B00D= 91 1B       ..
                iny                          ; B00F= C8          H
                tya                          ; B010= 98          .
                sta ($1B),y                  ; B011= 91 1B       ..
                asl a                        ; B013= 0A          .
                sta ($1B)                    ; B014= 92 1B       ..
                rts                          ; B016= 60          `

LB017:
                php                          ; B017= 08          .
                pha                          ; B018= 48          H
                phx                          ; B019= DA          Z
                phy                          ; B01A= 5A          Z
                tsx                          ; B01B= BA          :
                inx                          ; B01C= E8          h
                txa                          ; B01D= 8A          .
                eor #$FF                     ; B01E= 49 FF       I.
                sta ($1B)                    ; B020= 92 1B       ..
                tay                          ; B022= A8          (
LB023:
                pla                          ; B023= 68          h
                sta ($1B),y                  ; B024= 91 1B       ..
                dey                          ; B026= 88          .
                bne LB023                    ; B027= D0 FA       Pz
                lda #$20                     ; B029= A9 20       )
                sta $1E                      ; B02B= 85 1E       ..
                jsr LB041                    ; B02D= 20 41 B0     A0
LB030:
                lda ($1B)                    ; B030= B2 1B       2.
                tax                          ; B032= AA          *
                ldy #$00                     ; B033= A0 00        .
LB035:
                iny                          ; B035= C8          H
                lda ($1B),y                  ; B036= B1 1B       1.
                pha                          ; B038= 48          H
                dex                          ; B039= CA          J
                bne LB035                    ; B03A= D0 F9       Py
                ply                          ; B03C= 7A          z
                plx                          ; B03D= FA          z
                pla                          ; B03E= 68          h
                plp                          ; B03F= 28          (
                rts                          ; B040= 60          `

LB041:
                ldy #$04                     ; B041= A0 04        .
                sty $1C                      ; B043= 84 1C       ..
                ldy #$20                     ; B045= A0 20
                ldx #$50                     ; B047= A2 50       "P
                lda #$B6                     ; B049= A9 B6       )6
                lsr $1D                      ; B04B= 46 1D       F.
                bcs LB05B                    ; B04D= B0 0C       0.
                inc $1D                      ; B04F= E6 1D       f.
                ldy #$04                     ; B051= A0 04        .
                sty $1C                      ; B053= 84 1C       ..
                ldy #$00                     ; B055= A0 00        .
                ldx #$5D                     ; B057= A2 5D       "]
                lda #$B0                     ; B059= A9 B0       )0
LB05B:
                sty $1B                      ; B05B= 84 1B       ..
                rts                          ; B05D= 60          `

LB05E:
                jsr LB063                    ; B05E= 20 63 B0     c0
                bra LB05E                    ; B061= 80 FB       .{

LB063:
                bit $20                      ; B063= 24 20       $
                bpl LB06C                    ; B065= 10 05       ..
                jsr LB096                    ; B067= 20 96 B0     .0
                bcc LB083                    ; B06A= 90 17       ..
LB06C:
                bra LB017                    ; B06C= 80 A9       .)

LB06E:
                cmp #$0A                     ; B06E= C9 0A       I.
                bcc LB081                    ; B070= 90 0F       ..
                ldx #$00                     ; B072= A2 00       ".
LB074:
                inx                          ; B074= E8          h
                sbc #$0A                     ; B075= E9 0A       i.
                cmp #$0A                     ; B077= C9 0A       I.
                bcs LB074                    ; B079= B0 F9       0y
                pha                          ; B07B= 48          H
                txa                          ; B07C= 8A          .
                jsr LB06E                    ; B07D= 20 6E B0     n0
                pla                          ; B080= 68          h
LB081:
                ora #$30                     ; B081= 09 30       .0
LB083:
                pha                          ; B083= 48          H
                phy                          ; B084= 5A          Z
                tay                          ; B085= A8          (
                lda #$8A                     ; B086= A9 8A       ).
                ldx #$02                     ; B088= A2 02       ".
                jsr OSBYTE                   ; B08A= 20 F4 FF     t.
                ply                          ; B08D= 7A          z
                pla                          ; B08E= 68          h
                bcc LB0B0                    ; B08F= 90 1F       ..
                jsr LB017                    ; B091= 20 17 B0     .0
                bra LB083                    ; B094= 80 ED       .m

LB096:
                ldy $6F                      ; B096= A4 6F       $o
                beq LB0B1                    ; B098= F0 17       p.
                inc $6F                      ; B09A= E6 6F       fo
                lda LB14C-1,y                ; B09C= B9 4B B1    9K1
                bpl LB0AE                    ; B09F= 10 0D       ..
                stz $6F                      ; B0A1= 64 6F       do
                pha                          ; B0A3= 48          H
                lda #$D9                     ; B0A4= A9 D9       )Y
                jsr LB823                    ; B0A6= 20 23 B8     #8
                pla                          ; B0A9= 68          h
                ldy #$18                     ; B0AA= A0 18        .
                sty $1F                      ; B0AC= 84 1F       ..
LB0AE:
                asl a                        ; B0AE= 0A          .
                lsr a                        ; B0AF= 4A          J
LB0B0:
                rts                          ; B0B0= 60          `

LB0B1:
                lda #$81                     ; B0B1= A9 81       ).
                jsr LB823                    ; B0B3= 20 23 B8     #8
                txa                          ; B0B6= 8A          .
                bcs LB0B0                    ; B0B7= B0 F7       0w
                bpl LB0B0                    ; B0B9= 10 F5       .u
                cmp #$E0                     ; B0BB= C9 E0       I`
                bcs LB0B0                    ; B0BD= B0 F1       0q
                jsr LB0C4                    ; B0BF= 20 C4 B0     D0
                sec                          ; B0C2= 38          8
LB0C3:
                rts                          ; B0C3= 60          `

LB0C4:
                cmp #$99                     ; B0C4= C9 99       I.
                beq LB12A                    ; B0C6= F0 62       pb
                and #$0F                     ; B0C8= 29 0F       ).
                beq LB0E9                    ; B0CA= F0 1D       p.
                cmp #$02                     ; B0CC= C9 02       I.
                bcc LB0EE                    ; B0CE= 90 1E       ..
                beq LB0C3                    ; B0D0= F0 F1       pq
                cmp #$04                     ; B0D2= C9 04       I.
                bcc LB116                    ; B0D4= 90 40       .@
                beq LB11A                    ; B0D6= F0 42       pB
                cmp #$06                     ; B0D8= C9 06       I.
                bcc LB10A                    ; B0DA= 90 2E       ..
                beq LB0F5                    ; B0DC= F0 17       p.
                cmp #$08                     ; B0DE= C9 08       I.
                bcc LB0C3                    ; B0E0= 90 E1       .a
                beq LB11E                    ; B0E2= F0 3A       p:
                cmp #$09                     ; B0E4= C9 09       I.
                beq LB12E                    ; B0E6= F0 46       pF
                rts                          ; B0E8= 60          `

LB0E9:
                lda #$0C                     ; B0E9= A9 0C       ).
LB0EB:
                jmp OSWRCH                   ; B0EB= 4C EE FF    Ln.

LB0EE:
                lda #$16                     ; B0EE= A9 16       ).
                sta $6F                      ; B0F0= 85 6F       .o
                stz $20                      ; B0F2= 64 20       d
                rts                          ; B0F4= 60          `

LB0F5:
                ldx #$10                     ; B0F5= A2 10       ".
                jsr LB101                    ; B0F7= 20 01 B1     .1
                and #$10                     ; B0FA= 29 10       ).
                bne LB113                    ; B0FC= D0 15       P.
LB0FE:
                jmp LB7B6                    ; B0FE= 4C B6 B7    L67

LB101:
                lda #$EC                     ; B101= A9 EC       )l
                ldy #$FF                     ; B103= A0 FF        .
                jsr OSBYTE                   ; B105= 20 F4 FF     t.
                txa                          ; B108= 8A          .
                rts                          ; B109= 60          `

LB10A:
                ldx #$40                     ; B10A= A2 40       "@
                jsr LB101                    ; B10C= 20 01 B1     .1
                and #$40                     ; B10F= 29 40       )@
                beq LB0FE                    ; B111= F0 EB       pk
LB113:
                jmp LB7E2                    ; B113= 4C E2 B7    Lb7

LB116:
                lda #$02                     ; B116= A9 02       ).
                bra LB0EB                    ; B118= 80 D1       .Q

LB11A:
                lda #$03                     ; B11A= A9 03       ).
                bra LB0EB                    ; B11C= 80 CD       .M

LB11E:
                lda #$FF                     ; B11E= A9 FF       ).
                eor $21                      ; B120= 45 21       E!
                sta $21                      ; B122= 85 21       .!
                sta $20                      ; B124= 85 20       .
                bne LB0FE                    ; B126= D0 D6       PV
                bra LB113                    ; B128= 80 E9       .i

LB12A:
                ldx #$0C                     ; B12A= A2 0C       ".
                bra LB130                    ; B12C= 80 02       ..

LB12E:
                ldx #$AF                     ; B12E= A2 AF       "/
LB130:
                phx                          ; B130= DA          Z
                ldx #$60                     ; B131= A2 60       "`
                jsr LB82A                    ; B133= 20 2A B8     *8
                plx                          ; B136= FA          z
LB137:
                phx                          ; B137= DA          Z
                lda #$13                     ; B138= A9 13       ).
                jsr OSBYTE                   ; B13A= 20 F4 FF     t.
                plx                          ; B13D= FA          z
                dex                          ; B13E= CA          J
                bne LB137                    ; B13F= D0 F6       Pv
                ldx #$00                     ; B141= A2 00       ".
                jsr LB82A                    ; B143= 20 2A B8     *8
LB146:
                jsr LB198                    ; B146= 20 98 B1     .1
                bcc LB146                    ; B149= 90 FB       .{
                rts                          ; B14B= 60          `

LB14C:
                .byte $1B                    ; B14C= 1B          .
                lsr $4B2A,x                  ; B14D= 5E 2A 4B    ^*K
                eor $59                      ; B150= 45 59       EY
                and $217C,y                  ; B152= 39 7C 21    9|!
                jmp ($1B59,x)                ; B155= 7C 59 1B    |Y.

                .byte $5C                    ; B158= 5C          \
                .byte $54                    ; B159= 54          T
                eor $52                      ; B15A= 45 52       ER
                eor $4E49                    ; B15C= 4D 49 4E    MIN
                eor ($4C,x)                  ; B15F= 41 4C       AL
                ora $3D0A                    ; B161= 0D 0A 3D    ..=
                .byte $1B                    ; B164= 1B          .
;BNE LB187        :\ B165= D0 20       P
;BVS LB11A        :\ B167= 70 B1       p1
                .byte $D0
LB166:
                jsr LB170
                bcs LB1C4                    ; B169= B0 59       0Y
                cmp #$1B                     ; B16B= C9 1B       I.
                bne LB166                    ; B16D= D0 F7       Pw
                rts                          ; B16F= 60          `

LB170:
                jsr LB17A                    ; B170= 20 7A B1     z1
                cmp #$7F                     ; B173= C9 7F       I.
                beq LB170                    ; B175= F0 F9       py
                cmp #$20                     ; B177= C9 20       I
                rts                          ; B179= 60          `

LB17A:
                phx                          ; B17A= DA          Z
                phy                          ; B17B= 5A          Z
LB17C:
                jsr LB189                    ; B17C= 20 89 B1     .1
                bcs LB184                    ; B17F= B0 03       0.
                ply                          ; B181= 7A          z
                plx                          ; B182= FA          z
                rts                          ; B183= 60          `

LB184:
                jsr LB017                    ; B184= 20 17 B0     .0
LB187:
                bra LB17C                    ; B187= 80 F3       .s

LB189:
                bit $20                      ; B189= 24 20       $
                bmi LB190                    ; B18B= 30 03       0.
                jmp LB096                    ; B18D= 4C 96 B0    L.0

LB190:
                bit $25                      ; B190= 24 25       $%
                bmi LB1E0                    ; B192= 30 4C       0L
                bit $23                      ; B194= 24 23       $#
                bmi LB1A3                    ; B196= 30 0B       0.
LB198:
                lda #$91                     ; B198= A9 91       ).
                ldx #$01                     ; B19A= A2 01       ".
                jsr OSBYTE                   ; B19C= 20 F4 FF     t.
                tya                          ; B19F= 98          .
                and $22                      ; B1A0= 25 22       %"
LB1A2:
                rts                          ; B1A2= 60          `

LB1A3:
                jsr LB198                    ; B1A3= 20 98 B1     .1
                bcs LB1A2                    ; B1A6= B0 FA       0z
                jsr LB1D0                    ; B1A8= 20 D0 B1     P1
                bcc LB201                    ; B1AB= 90 54       .T
                asl a                        ; B1AD= 0A          .
                asl a                        ; B1AE= 0A          .
                asl a                        ; B1AF= 0A          .
                asl a                        ; B1B0= 0A          .
                sta $24                      ; B1B1= 85 24       .$
LB1B3:
                jsr LB198                    ; B1B3= 20 98 B1     .1
                bcc LB1BD                    ; B1B6= 90 05       ..
                jsr LB017                    ; B1B8= 20 17 B0     .0
                bra LB1B3                    ; B1BB= 80 F6       .v

LB1BD:
                jsr LB1D0                    ; B1BD= 20 D0 B1     P1
                bcc LB1B3                    ; B1C0= 90 F1       .q
                ora $24                      ; B1C2= 05 24       .$
LB1C4:
                clc                          ; B1C4= 18          .
                rts                          ; B1C5= 60          `

LB1C6:
                jsr LB166                    ; B1C6= 20 66 B1     f1
                bcc LB1D0                    ; B1C9= 90 05       ..
                plx                          ; B1CB= FA          z
                plx                          ; B1CC= FA          z
                jmp LB389                    ; B1CD= 4C 89 B3    L.3

LB1D0:
                cmp #$3A                     ; B1D0= C9 3A       I:
                bcs LB1D7                    ; B1D2= B0 03       0.
                sbc #$2F                     ; B1D4= E9 2F       i/
                rts                          ; B1D6= 60          `

LB1D7:
                sbc #$37                     ; B1D7= E9 37       i7
                cmp #$10                     ; B1D9= C9 10       I.
                bcs LB1C4                    ; B1DB= B0 E7       0g
                cmp #$0A                     ; B1DD= C9 0A       I.
LB1DF:
                rts                          ; B1DF= 60          `

LB1E0:
                stz $26                      ; B1E0= 64 26       d&
                jsr LB198                    ; B1E2= 20 98 B1     .1
                bcs LB1DF                    ; B1E5= B0 F8       0x
                cmp #$7F                     ; B1E7= C9 7F       I.
                bcs LB1DF                    ; B1E9= B0 F4       0t
                cmp #$20                     ; B1EB= C9 20       I
                bcs LB203                    ; B1ED= B0 14       0.
                bit $27                      ; B1EF= 24 27       $'
                bmi LB201                    ; B1F1= 30 0E       0.
                cmp #$07                     ; B1F3= C9 07       I.
                bcc LB201                    ; B1F5= 90 0A       ..
                beq LB240                    ; B1F7= F0 47       pG
                cmp #$0B                     ; B1F9= C9 0B       I.
                bcc LB240                    ; B1FB= 90 43       .C
                cmp #$0D                     ; B1FD= C9 0D       I.
                beq LB240                    ; B1FF= F0 3F       p?
LB201:
                sec                          ; B201= 38          8
                rts                          ; B202= 60          `

LB203:
                stz $27                      ; B203= 64 27       d'
                cmp #$7C                     ; B205= C9 7C       I|
                bne LB23E                    ; B207= D0 35       P5
LB209:
                jsr LB198                    ; B209= 20 98 B1     .1
                bcc LB213                    ; B20C= 90 05       ..
                jsr LB017                    ; B20E= 20 17 B0     .0
                bra LB209                    ; B211= 80 F6       .v

LB213:
                cmp #$20                     ; B213= C9 20       I
                bcc LB242                    ; B215= 90 2B       .+
                cmp #$21                     ; B217= C9 21       I!
                bne LB22F                    ; B219= D0 14       P.
                lda #$80                     ; B21B= A9 80       ).
                sta $26                      ; B21D= 85 26       .&
LB21F:
                jsr LB198                    ; B21F= 20 98 B1     .1
                bcc LB229                    ; B222= 90 05       ..
                jsr LB017                    ; B224= 20 17 B0     .0
                bra LB21F                    ; B227= 80 F6       .v

LB229:
                cmp #$20                     ; B229= C9 20       I
                bcc LB21F                    ; B22B= 90 F2       .r
                bra LB203                    ; B22D= 80 D4       .T

LB22F:
                cmp #$3F                     ; B22F= C9 3F       I?
                bne LB236                    ; B231= D0 03       P.
                lda #$7F                     ; B233= A9 7F       ).
                clc                          ; B235= 18          .
LB236:
                bcc LB23E                    ; B236= 90 06       ..
                cmp #$7C                     ; B238= C9 7C       I|
                beq LB23E                    ; B23A= F0 02       p.
                and #$9F                     ; B23C= 29 9F       ).
LB23E:
                ora $26                      ; B23E= 05 26       .&
LB240:
                clc                          ; B240= 18          .
                rts                          ; B241= 60          `

LB242:
                sec                          ; B242= 38          8
                ror $27                      ; B243= 66 27       f'
                sec                          ; B245= 38          8
                rts                          ; B246= 60          `

LB247:
                lda #$00                     ; B247= A9 00       ).
                sta $F2                      ; B249= 85 F2       .r
                lda #$05                     ; B24B= A9 05       ).
                sta $F3                      ; B24D= 85 F3       .s
                ldy #$00                     ; B24F= A0 00        .
LB251:
                jsr LB17A                    ; B251= 20 7A B1     z1
                ldx $1F                      ; B254= A6 1F       &.
                beq LB296                    ; B256= F0 3E       p>
                stz $2B                      ; B258= 64 2B       d+
                cmp #$1B                     ; B25A= C9 1B       I.
                bne LB262                    ; B25C= D0 04       P.
                ldy #$00                     ; B25E= A0 00        .
                bra LB266                    ; B260= 80 04       ..

LB262:
                cmp #$0D                     ; B262= C9 0D       I.
                bne LB273                    ; B264= D0 0D       P.
LB266:
                lda #$0D                     ; B266= A9 0D       ).
                sta ($F2),y                  ; B268= 91 F2       .r
                bit $2B                      ; B26A= 24 2B       $+
                bmi LB271                    ; B26C= 30 03       0.
                jsr OSASCI                   ; B26E= 20 E3 FF     c.
LB271:
                clc                          ; B271= 18          .
                rts                          ; B272= 60          `

LB273:
                cmp #$7F                     ; B273= C9 7F       I.
                bne LB27E                    ; B275= D0 07       P.
                cpy #$00                     ; B277= C0 00       @.
                beq LB251                    ; B279= F0 D6       pV
                dey                          ; B27B= 88          .
                bra LB291                    ; B27C= 80 13       ..

LB27E:
                cmp #$7F                     ; B27E= C9 7F       I.
                bcs LB251                    ; B280= B0 CF       0O
                cmp #$20                     ; B282= C9 20       I
                bcc LB251                    ; B284= 90 CB       .K
                cpy #$FF                     ; B286= C0 FF       @.
                bcs LB251                    ; B288= B0 C7       0G
                sta ($F2),y                  ; B28A= 91 F2       .r
                iny                          ; B28C= C8          H
                bit $2B                      ; B28D= 24 2B       $+
                bmi LB251                    ; B28F= 30 C0       0@
LB291:
                jsr LB728                    ; B291= 20 28 B7     (7
                bra LB251                    ; B294= 80 BB       .;

LB296:
                cmp #$1B                     ; B296= C9 1B       I.
                bne LB27E                    ; B298= D0 E4       Pd
                jsr LB166                    ; B29A= 20 66 B1     f1
                cmp #$5C                     ; B29D= C9 5C       I\
                beq LB266                    ; B29F= F0 C5       pE
                sec                          ; B2A1= 38          8
                rts                          ; B2A2= 60          `

LB2A3:
                ldx #$19                     ; B2A3= A2 19       ".
LB2A5:
                dex                          ; B2A5= CA          J
                stz $00,x                    ; B2A6= 74 00       t.
                bne LB2A5                    ; B2A8= D0 FB       P{
LB2AA:
                stz $3A                      ; B2AA= 64 3A       d:
                stz $3B                      ; B2AC= 64 3B       d;
LB2AE:
                jsr LB166                    ; B2AE= 20 66 B1     f1
                bcs LB2E0                    ; B2B1= B0 2D       0-
                jsr LB8AD                    ; B2B3= 20 AD B8     -8
                bcc LB2E5                    ; B2B6= 90 2D       .-
                pha                          ; B2B8= 48          H
                lda $3A                      ; B2B9= A5 3A       %:
                sta $02,x                    ; B2BB= 95 02       ..
                lda $3B                      ; B2BD= A5 3B       %;
                sta $03,x                    ; B2BF= 95 03       ..
                pla                          ; B2C1= 68          h
                cmp #$40                     ; B2C2= C9 40       I@
                bcs LB2F5                    ; B2C4= B0 2F       0/
                cmp #$30                     ; B2C6= C9 30       I0
                bcc LB2D7                    ; B2C8= 90 0D       ..
                cmp #$3C                     ; B2CA= C9 3C       I<
                bcs LB2E3                    ; B2CC= B0 15       0.
                inc $00                      ; B2CE= E6 00       f.
                inx                          ; B2D0= E8          h
                inx                          ; B2D1= E8          h
                inx                          ; B2D2= E8          h
                cpx #$18                     ; B2D3= E0 18       `.
                bcc LB2AA                    ; B2D5= 90 D3       .S
LB2D7:
                cmp #$40                     ; B2D7= C9 40       I@
                bcs LB2F5                    ; B2D9= B0 1A       0.
                jsr LB166                    ; B2DB= 20 66 B1     f1
                bcc LB2D7                    ; B2DE= 90 F7       .w
LB2E0:
                jmp LB389                    ; B2E0= 4C 89 B3    L.3

LB2E3:
                sta $01,x                    ; B2E3= 95 01       ..
LB2E5:
                lda $00                      ; B2E5= A5 00       %.
                bne LB2AE                    ; B2E7= D0 C5       PE
                inc $00                      ; B2E9= E6 00       f.
                bra LB2AE                    ; B2EB= 80 C1       .A

LB2ED:
                lda #$01                     ; B2ED= A9 01       ).
                sta $02                      ; B2EF= 85 02       ..
                stz $01                      ; B2F1= 64 01       d.
                stz $03                      ; B2F3= 64 03       d.
LB2F5:
                rts                          ; B2F5= 60          `

LB2F6:
                lda #$03                     ; B2F6= A9 03       ).
                bra LB2FC                    ; B2F8= 80 02       ..

LB2FA:
                lda #$00                     ; B2FA= A9 00       ).
LB2FC:
                phx                          ; B2FC= DA          Z
                tax                          ; B2FD= AA          *
                lda $01,x                    ; B2FE= B5 01       5.
                cmp #$01                     ; B300= C9 01       I.
                lda $03,x                    ; B302= B5 03       5.
                beq LB307                    ; B304= F0 01       p.
                sec                          ; B306= 38          8
LB307:
                lda $02,x                    ; B307= B5 02       5.
                plx                          ; B309= FA          z
                and #$FF                     ; B30A= 29 FF       ).
                rts                          ; B30C= 60          `

LB30D:
                pla                          ; B30D= 68          h
                sta $28                      ; B30E= 85 28       .(
                pla                          ; B310= 68          h
                sta $29                      ; B311= 85 29       .)
                lda $01                      ; B313= A5 01       %.
                bne LB338                    ; B315= D0 21       P!
                lda $02                      ; B317= A5 02       %.
                ora $03                      ; B319= 05 03       ..
                bne LB31F                    ; B31B= D0 02       P.
                inc $02                      ; B31D= E6 02       f.
LB31F:
                lda $02                      ; B31F= A5 02       %.
                bne LB325                    ; B321= D0 02       P.
                dec $03                      ; B323= C6 03       F.
LB325:
                dec $02                      ; B325= C6 02       F.
                bne LB32D                    ; B327= D0 04       P.
                lda $03                      ; B329= A5 03       %.
                beq LB332                    ; B32B= F0 05       p.
LB32D:
                jsr LB332                    ; B32D= 20 32 B3     23
                bra LB31F                    ; B330= 80 ED       .m

LB332:
                lda $29                      ; B332= A5 29       %)
                pha                          ; B334= 48          H
                lda $28                      ; B335= A5 28       %(
                pha                          ; B337= 48          H
LB338:
                rts                          ; B338= 60          `

LB339:
                dec $1E                      ; B339= C6 1E       F.
                bne LB340                    ; B33B= D0 03       P.
                jsr LB017                    ; B33D= 20 17 B0     .0
LB340:
                lda $6F                      ; B340= A5 6F       %o
                bne LB348                    ; B342= D0 04       P.
                lda $21                      ; B344= A5 21       %!
                sta $20                      ; B346= 85 20       .
LB348:
                rts                          ; B348= 60          `

LB349:
                jsr LB34E                    ; B349= 20 4E B3     N3
                bra LB349                    ; B34C= 80 FB       .{

LB34E:
                jsr LB339                    ; B34E= 20 39 B3     93
                jsr LB170                    ; B351= 20 70 B1     p1
LB354:
                cmp #$20                     ; B354= C9 20       I
                bcc LB361                    ; B356= 90 09       ..
                jmp LB728                    ; B358= 4C 28 B7    L(7

LB35B:
                jmp LB46C                    ; B35B= 4C 6C B4    Ll4

LB35E:
                jmp LB493                    ; B35E= 4C 93 B4    L.4

LB361:
                pha                          ; B361= 48          H
                jsr LB2ED                    ; B362= 20 ED B2     m2
                pla                          ; B365= 68          h
                cmp #$07                     ; B366= C9 07       I.
                bcc LB3BB                    ; B368= 90 51       .Q
                beq LB3E9                    ; B36A= F0 7D       p}
                cmp #$09                     ; B36C= C9 09       I.
                bcc LB35B                    ; B36E= 90 EB       .k
                beq LB35E                    ; B370= F0 EC       pl
                cmp #$0B                     ; B372= C9 0B       I.
                bcc LB3EE                    ; B374= 90 78       .x
                cmp #$0D                     ; B376= C9 0D       I.
                beq LB3E9                    ; B378= F0 6F       po
                cmp #$1B                     ; B37A= C9 1B       I.
                bne LB3BB                    ; B37C= D0 3D       P=
LB37E:
                ldx $6F                      ; B37E= A6 6F       &o
                bne LB386                    ; B380= D0 04       P.
                bit $2D                      ; B382= 24 2D       $-
                bmi LB3BB                    ; B384= 30 35       05
LB386:
                jsr LB166                    ; B386= 20 66 B1     f1
LB389:
                cmp #$1B                     ; B389= C9 1B       I.
                beq LB37E                    ; B38B= F0 F1       pq
                cmp #$25                     ; B38D= C9 25       I%
                beq LB401                    ; B38F= F0 70       pp
                cmp #$28                     ; B391= C9 28       I(
                beq LB404                    ; B393= F0 6F       po
                cmp #$44                     ; B395= C9 44       ID
                beq LB3EE                    ; B397= F0 55       pU
                cmp #$45                     ; B399= C9 45       IE
                beq LB3EB                    ; B39B= F0 4E       pN
                cmp #$4D                     ; B39D= C9 4D       IM
                beq LB3E7                    ; B39F= F0 46       pF
                cmp #$50                     ; B3A1= C9 50       IP
                beq LB3C5                    ; B3A3= F0 20       p
                cmp #$5B                     ; B3A5= C9 5B       I[
                beq LB407                    ; B3A7= F0 5E       p^
                cmp #$5D                     ; B3A9= C9 5D       I]
                stz $2B                      ; B3AB= 64 2B       d+
                beq LB3F6                    ; B3AD= F0 47       pG
                cmp #$5E                     ; B3AF= C9 5E       I^
                beq LB3F3                    ; B3B1= F0 40       p@
                cmp #$5F                     ; B3B3= C9 5F       I_
                beq LB3BC                    ; B3B5= F0 05       p.
                cmp #$63                     ; B3B7= C9 63       Ic
                beq LB3FE                    ; B3B9= F0 43       pC
LB3BB:
                rts                          ; B3BB= 60          `

LB3BC:
                jsr LB247                    ; B3BC= 20 47 B2     G2
                bcs LB389                    ; B3BF= B0 C8       0H
LB3C1:
                sec                          ; B3C1= 38          8
                jmp (IND2V)                  ; B3C2= 6C 32 02    l2.

LB3C5:
                sec                          ; B3C5= 38          8
                ror $2B                      ; B3C6= 66 2B       f+
                jsr LB247                    ; B3C8= 20 47 B2     G2
                bcs LB389                    ; B3CB= B0 BC       0<
                ldx $1F                      ; B3CD= A6 1F       &.
                stz $1F                      ; B3CF= 64 1F       d.
                beq LB3E4                    ; B3D1= F0 11       p.
                ldy #$00                     ; B3D3= A0 00        .
                jsr LB89E                    ; B3D5= 20 9E B8     .8
                beq LB3BB                    ; B3D8= F0 E1       pa
                stx $6F                      ; B3DA= 86 6F       .o
                cmp #$2A                     ; B3DC= C9 2A       I*
                beq LB3FB                    ; B3DE= F0 1B       p.
                cmp #$21                     ; B3E0= C9 21       I!
                beq LB3C1                    ; B3E2= F0 DD       p]
LB3E4:
                jmp LB4F2                    ; B3E4= 4C F2 B4    Lr4

LB3E7:
                lda #$0B                     ; B3E7= A9 0B       ).
LB3E9:
                bra LB3F0                    ; B3E9= 80 05       ..

LB3EB:
                jmp OSNEWL                   ; B3EB= 4C E7 FF    Lg.

LB3EE:
                lda #$0A                     ; B3EE= A9 0A       ).
LB3F0:
                jmp OSWRCH                   ; B3F0= 4C EE FF    Ln.

LB3F3:
                sec                          ; B3F3= 38          8
                ror $2B                      ; B3F4= 66 2B       f+
LB3F6:
                jsr LB247                    ; B3F6= 20 47 B2     G2
                bcs LB389                    ; B3F9= B0 8E       0.
LB3FB:
                jmp LB61F                    ; B3FB= 4C 1F B6    L.6

LB3FE:
                jmp LAF7E                    ; B3FE= 4C 7E AF    L~/

LB401:
                jmp LB640                    ; B401= 4C 40 B6    L@6

LB404:
                jmp LB68B                    ; B404= 4C 8B B6    L.6

LB407:
                jsr LB2A3                    ; B407= 20 A3 B2     #2
                ldx #$0E                     ; B40A= A2 0E       ".
LB40C:
                cmp LB41E-1,x                ; B40C= DD 1D B4    ].4
                beq LB418                    ; B40F= F0 07       p.
                dex                          ; B411= CA          J
                bne LB40C                    ; B412= D0 F8       Px
                sec                          ; B414= 38          8
                jmp (IND1V)                  ; B415= 6C 30 02    l0.

LB418:
                txa                          ; B418= 8A          .
                asl a                        ; B419= 0A          .
                tax                          ; B41A= AA          *
                jmp (LB42C-2,x)                ; B41B= 7C 2A B4    |*4
LB41E:
                .byte $41,$42   ; B41E= 41 42       AB
                .byte $43       ; B420= 43          C
                .byte $44       ; B421= 44          D
                .byte $48       ; B422= 48          H
                .byte $4a       ; B423= 4A          J
                .byte $4B       ; B424= 4B          K
                .byte $53       ; B425= 53          S
                .byte $58       ; B426= 58          X
                .byte $68       ; B427= 68          h
                .byte $6C       ; B428= 6C
                .byte $6E       ; B429= 6E
                .byte $66
                .byte $63
LB42C:
                .word LB4C5
                .word LB485
                .word LB493
                .word LB46C
                .word LB4A7
                .word LB5FD
                .word LB60D
                .word LB720
                .word LB5E1
                .word LB6B1
                .word LB6AD
                .word LB5A9
                .word LB4A7
                .word LB4D1
LB448:
                jsr LB44D
                bra LB448
LB44D:
                jsr LB339                    ; B44D= 20 39 B3     93
                jsr LB17A                    ; B450= 20 7A B1     z1
                cmp #$1B                     ; B453= C9 1B       I.
                bne LB466                    ; B455= D0 0F       P.
                lda #$DA                     ; B457= A9 DA       )Z
                ldy #$FF                     ; B459= A0 FF        .
                ldx #$00                     ; B45B= A2 00       ".
                jsr OSBYTE                   ; B45D= 20 F4 FF     t.
                lda #$1B                     ; B460= A9 1B       ).
                cpx #$00                     ; B462= E0 00       `.
                beq LB469                    ; B464= F0 03       p.
LB466:
                jmp OSWRCH                   ; B466= 4C EE FF    Ln.

LB469:
                jmp LB37E                    ; B469= 4C 7E B3    L~3

LB46C:
                lda #$08                     ; B46C= A9 08       ).
                sta $2C                      ; B46E= 85 2C       .,
                jsr LB30D                    ; B470= 20 0D B3     .3
                jsr LB821                    ; B473= 20 21 B8     !8
                txa                          ; B476= 8A          .
                bne LB480                    ; B477= D0 07       P.
                bit $34                      ; B479= 24 34       $4
                bpl LB4E2                    ; B47B= 10 65       .e
LB47D:
                tya                          ; B47D= 98          .
LB47E:
                beq LB4E2                    ; B47E= F0 62       pb
LB480:
                lda $2C                      ; B480= A5 2C       %,
LB482:
                jmp OSWRCH                   ; B482= 4C EE FF    Ln.

LB485:
                lda #$0A                     ; B485= A9 0A       ).
                sta $2C                      ; B487= 85 2C       .,
                jsr LB30D                    ; B489= 20 0D B3     .3
                jsr LB821                    ; B48C= 20 21 B8     !8
LB48F:
                cpy $39                      ; B48F= C4 39       D9
                bra LB47E                    ; B491= 80 EB       .k

LB493:
                lda #$09                     ; B493= A9 09       ).
                sta $2C                      ; B495= 85 2C       .,
                jsr LB30D                    ; B497= 20 0D B3     .3
                jsr LB821                    ; B49A= 20 21 B8     !8
                cpx $37                      ; B49D= E4 37       d7
LB49F:
                bcc LB480                    ; B49F= 90 DF       ._
                lda $34                      ; B4A1= A5 34       %4
                beq LB4E2                    ; B4A3= F0 3D       p=
                bra LB48F                    ; B4A5= 80 E8       .h

LB4A7:
                jsr LB2FA                    ; B4A7= 20 FA B2     z2
                bcs LB4E2                    ; B4AA= B0 36       06
                tay                          ; B4AC= A8          (
                beq LB4B0                    ; B4AD= F0 01       p.
                dey                          ; B4AF= 88          .
LB4B0:
                jsr LB2F6                    ; B4B0= 20 F6 B2     v2
                bcs LB4E2                    ; B4B3= B0 2D       0-
                tax                          ; B4B5= AA          *
                beq LB4B9                    ; B4B6= F0 01       p.
                dex                          ; B4B8= CA          J
LB4B9:
                lda #$1F                     ; B4B9= A9 1F       ).
                jsr OSWRCH                   ; B4BB= 20 EE FF     n.
                txa                          ; B4BE= 8A          .
                jsr OSWRCH                   ; B4BF= 20 EE FF     n.
                tya                          ; B4C2= 98          .
                bra LB482                    ; B4C3= 80 BD       .=

LB4C5:
                lda #$0B                     ; B4C5= A9 0B       ).
                sta $2C                      ; B4C7= 85 2C       .,
                jsr LB30D                    ; B4C9= 20 0D B3     .3
                jsr LB821                    ; B4CC= 20 21 B8     !8
                bra LB47D                    ; B4CF= 80 AC       .,

LB4D1:
                jsr LB2FA                    ; B4D1= 20 FA B2     z2
                bne LB4E2                    ; B4D4= D0 0C       P.
                tay                          ; B4D6= A8          (
LB4D7:
                lda #$1B                     ; B4D7= A9 1B       ).
LB4D9:
                iny                          ; B4D9= C8          H
                jsr LB083                    ; B4DA= 20 83 B0     .0
                lda LB4E2,y                  ; B4DD= B9 E2 B4    9b4
                bne LB4D9                    ; B4E0= D0 F7       Pw
LB4E2:
                rts                          ; B4E2= 60          `

                .byte $5B                    ; B4E3= 5B          [
                .byte $3e,$35,$63            ; B4E4= 3E 35 63    >5c
                .byte $00                    ; B4E7= 00          .
                .byte $5B                    ; B4E8= 5B          [
                .byte $30,$6e                ; B4E9= 30 6E       0n
                .byte $00                    ; B4EB= 00          .
                .byte $5B                    ; B4EC= 5B          [
                .byte $33                    ; B4ED= 33          3
                .byte $6e,$00,$5b            ; B4EE= 6E 00 5B    n.[
                .byte $00                    ; B4F1= 00          .
LB4F2:
                jsr LB830                    ; B4F2= 20 30 B8     08
                bcs LB547                    ; B4F5= B0 50       0P
                cmp #$07                     ; B4F7= C9 07       I.
                bcs LB518                    ; B4F9= B0 1D       0.
                pha                          ; B4FB= 48          H
                jsr LB832                    ; B4FC= 20 32 B8     28
                stz $2E                      ; B4FF= 64 2E       d.
                cmp #$0A                     ; B501= C9 0A       I.
                beq LB50B                    ; B503= F0 06       p.
                dec $2E                      ; B505= C6 2E       F.
                cmp #$09                     ; B507= C9 09       I.
                bne LB546                    ; B509= D0 3B       P;
LB50B:
                ply                          ; B50B= 7A          z
                cpy #$06                     ; B50C= C0 06       @.
                bne LB515                    ; B50E= D0 05       P.
                lda $2E                      ; B510= A5 2E       %.
                sta $34                      ; B512= 85 34       .4
LB514:
                rts                          ; B514= 60          `

LB515:
                jmp LB6E0                    ; B515= 4C E0 B6    L`6

LB518:
                cmp #$08                     ; B518= C9 08       I.
                beq LB53A                    ; B51A= F0 1E       p.
                bcs LB54A                    ; B51C= B0 2C       0,
LB51E:
                jsr LB89E                    ; B51E= 20 9E B8     .8
                beq LB514                    ; B521= F0 F1       pq
                jsr LB565                    ; B523= 20 65 B5     e5
                jsr LB89E                    ; B526= 20 9E B8     .8
                beq LB535                    ; B529= F0 0A       p.
                cmp #$2C                     ; B52B= C9 2C       I,
                bne LB547                    ; B52D= D0 18       P.
                iny                          ; B52F= C8          H
                jsr LB535                    ; B530= 20 35 B5     55
                bra LB51E                    ; B533= 80 E9       .i

LB535:
                lda $3A                      ; B535= A5 3A       %:
                jmp OSWRCH                   ; B537= 4C EE FF    Ln.

LB53A:
                jsr LB89E                    ; B53A= 20 9E B8     .8
                jsr LB565                    ; B53D= 20 65 B5     e5
                bcs LB547                    ; B540= B0 05       0.
                lda $3A                      ; B542= A5 3A       %:
                bra LB579                    ; B544= 80 33       .3

LB546:
                pla                          ; B546= 68          h
LB547:
                jmp LB7B3                    ; B547= 4C B3 B7    L37

LB54A:
                ldy #$00                     ; B54A= A0 00        .
                cmp #$0B                     ; B54C= C9 0B       I.
                bcc LB547                    ; B54E= 90 F7       .w
                beq LB561                    ; B550= F0 0F       p.
                iny                          ; B552= C8          H
                cmp #$0E                     ; B553= C9 0E       I.
                beq LB561                    ; B555= F0 0A       p.
                bcs LB547                    ; B557= B0 EE       0n
                ldy #$04                     ; B559= A0 04        .
                cmp #$0C                     ; B55B= C9 0C       I.
                beq LB561                    ; B55D= F0 02       p.
                ldy #$05                     ; B55F= A0 05        .
LB561:
                tya                          ; B561= 98          .
                jmp LB64F                    ; B562= 4C 4F B6    LO6

LB565:
                jsr LB8A9                    ; B565= 20 A9 B8     )8
                bcs LB573                    ; B568= B0 09       0.
LB56A:
                iny                          ; B56A= C8          H
                lda ($F2),y                  ; B56B= B1 F2       1r
                jsr LB8AD                    ; B56D= 20 AD B8     -8
                bcc LB56A                    ; B570= 90 F8       .x
                clc                          ; B572= 18          .
LB573:
                rts                          ; B573= 60          `

                jsr LB2FA                    ; B574= 20 FA B2     z2
                bcs LB547                    ; B577= B0 CE       0N
LB579:
                tay                          ; B579= A8          (
                and #$7F                     ; B57A= 29 7F       ).
                cmp #$08                     ; B57C= C9 08       I.
                bcs LB547                    ; B57E= B0 C7       0G
                tax                          ; B580= AA          *
                lda LB5A1,x                  ; B581= BD A1 B5    =!5
                lsr a                        ; B584= 4A          J
                ldx #$1F                     ; B585= A2 1F       ".
                bcs LB58B                    ; B587= B0 02       0.
                ldx #$18                     ; B589= A2 18       ".
LB58B:
                stx $39                      ; B58B= 86 39       .9
                sta $37                      ; B58D= 85 37       .7
                inc a                        ; B58F= 1A          .
                sta $38                      ; B590= 85 38       .8
                lda #$16                     ; B592= A9 16       ).
                jsr OSWRCH                   ; B594= 20 EE FF     n.
                tya                          ; B597= 98          .
                jsr OSWRCH                   ; B598= 20 EE FF     n.
                asl a                        ; B59B= 0A          .
                cmp #$0E                     ; B59C= C9 0E       I.
                ror $30                      ; B59E= 66 30       f0
                rts                          ; B5A0= 60          `

LB5A1:
                .byte $9F                    ; B5A1= 9F          .
                .byte $4F                    ; B5A2= 4F          O
                .byte $27                    ; B5A3= 27          '
                .byte $9e,$4f,$27            ; B5A4= 9E 4F 27    .O'
                .byte $4e,$4e                ; B5A7= 4E 4E

LB5A9:
                jsr LB2FA                    ; B5A9= 20 FA B2
                bcs LB606                    ; B5AC= B0 58
                cmp #$05                     ; B5AE= C9 05       I.
                beq LB5D4                    ; B5B0= F0 22       p"
                cmp #$06                     ; B5B2= C9 06       I.
LB5B4:
                bne LB606                    ; B5B4= D0 50       PP
                jsr LB821                    ; B5B6= 20 21 B8     !8
                inx                          ; B5B9= E8          h
                phx                          ; B5BA= DA          Z
                iny                          ; B5BB= C8          H
                phy                          ; B5BC= 5A          Z
                ldy #$0D                     ; B5BD= A0 0D        .
                jsr LB4D7                    ; B5BF= 20 D7 B4     W4
                pla                          ; B5C2= 68          h
                jsr LB06E                    ; B5C3= 20 6E B0     n0
                lda #$3B                     ; B5C6= A9 3B       );
                jsr LB083                    ; B5C8= 20 83 B0     .0
                pla                          ; B5CB= 68          h
                jsr LB06E                    ; B5CC= 20 6E B0     n0
                lda #$52                     ; B5CF= A9 52       )R
                jmp LB083                    ; B5D1= 4C 83 B0    L.0

LB5D4:
                ldy #$05                     ; B5D4= A0 05        .
                bit $19                      ; B5D6= 24 19       $.
                stz $19                      ; B5D8= 64 19       d.
                bpl LB5DE                    ; B5DA= 10 02       ..
                ldy #$09                     ; B5DC= A0 09        .
LB5DE:
                jmp LB4D7                    ; B5DE= 4C D7 B4    LW4

LB5E1:
                jsr LB821                    ; B5E1= 20 21 B8     !8
                phx                          ; B5E4= DA          Z
                phy                          ; B5E5= 5A          Z
                lda #$20                     ; B5E6= A9 20       )
                sta $2C                      ; B5E8= 85 2C       .,
                jsr LB5F2                    ; B5EA= 20 F2 B5     r5
                ply                          ; B5ED= 7A          z
                plx                          ; B5EE= FA          z
                jmp LB4B9                    ; B5EF= 4C B9 B4    L94

LB5F2:
                jsr LB30D                    ; B5F2= 20 0D B3     .3
                jsr LB821                    ; B5F5= 20 21 B8     !8
                cpx $38                      ; B5F8= E4 38       d8
                jmp LB49F                    ; B5FA= 4C 9F B4    L.4

LB5FD:
                jsr LB2FA                    ; B5FD= 20 FA B2     z2
                bcs LB606                    ; B600= B0 04       0.
                cmp #$03                     ; B602= C9 03       I.
                bcc LB618                    ; B604= 90 12       ..
LB606:
                rts                          ; B606= 60          `

LB607:
                .byte $0F                    ; B607= 0F          .
                .byte $13                    ; B608= 13          .
                inc a                        ; B609= 1A          .
                brk                          ; B60A= 00          .
                tsb $0B                      ; B60B= 04 0B       ..
LB60D:
                jsr LB2FA                    ; B60D= 20 FA B2     z2
                bcs LB606                    ; B610= B0 F4       0t
                cmp #$03                     ; B612= C9 03       I.
                bcs LB606                    ; B614= B0 F0       0p
                adc #$03                     ; B616= 69 03       i.
LB618:
                tax                          ; B618= AA          *
                lda LB607,x                  ; B619= BD 07 B6    =.6
                jmp LB7E6                    ; B61C= 4C E6 B7    Lf7

LB61F:
                lda $20                      ; B61F= A5 20       %
                and $36                      ; B621= 25 36       %6
                bpl LB628                    ; B623= 10 03       ..
                jmp LB7B3                    ; B625= 4C B3 B7    L37

LB628:
                lda #$E5                     ; B628= A9 E5       )e
                jsr LB823                    ; B62A= 20 23 B8     #8
                ldx #$00                     ; B62D= A2 00       ".
                ldy #$05                     ; B62F= A0 05        .
                jsr OSCLI                   ; B631= 20 F7 FF     w.
LB634:
                lda #$E5                     ; B634= A9 E5       )e
                ldx #$01                     ; B636= A2 01       ".
                jsr LB825                    ; B638= 20 25 B8     %8
                lda #$7E                     ; B63B= A9 7E       )~
                jmp OSBYTE                   ; B63D= 4C F4 FF    Lt.

LB640:
                jsr LB1C6                    ; B640= 20 C6 B1     F1
                cmp #$07                     ; B643= C9 07       I.
                bcc LB64F                    ; B645= 90 08       ..
                bne LB606                    ; B647= D0 BD       P=
                jsr LB166                    ; B649= 20 66 B1     f1
                jmp LB354                    ; B64C= 4C 54 B3    LT3

LB64F:
                sta $2A                      ; B64F= 85 2A       .*
                stz $25                      ; B651= 64 25       d%
                stz $23                      ; B653= 64 23       d#
                ldx #$FE                     ; B655= A2 FE       "~
                txs                          ; B657= 9A          .
                inx                          ; B658= E8          h
                stx $22                      ; B659= 86 22       ."
                lda $2A                      ; B65B= A5 2A       %*
                cmp #$06                     ; B65D= C9 06       I.
                bcc LB665                    ; B65F= 90 04       ..
                ror $23                      ; B661= 66 23       f#
                bra LB66D                    ; B663= 80 08       ..

LB665:
                cmp #$04                     ; B665= C9 04       I.
                bcc LB67B                    ; B667= 90 12       ..
                beq LB671                    ; B669= F0 06       p.
                ror $25                      ; B66B= 66 25       f%
LB66D:
                stz $27                      ; B66D= 64 27       d'
                lsr $22                      ; B66F= 46 22       F"
LB671:
                ror $30                      ; B671= 66 30       f0
                lda #$21                     ; B673= A9 21       )!
                jsr LB7E6                    ; B675= 20 E6 B7     f7
                jmp LB448                    ; B678= 4C 48 B4    LH4

LB67B:
                stz $30                      ; B67B= 64 30       d0
                lsr a                        ; B67D= 4A          J
                ror $2D                      ; B67E= 66 2D       f-
                lsr a                        ; B680= 4A          J
                ror $22                      ; B681= 66 22       f"
                lda #$1E                     ; B683= A9 1E       ).
                jsr LB7E6                    ; B685= 20 E6 B7     f7
                jmp LB349                    ; B688= 4C 49 B3    LI3

LB68B:
                jsr LB1C6                    ; B68B= 20 C6 B1     F1
                bcc LB69B                    ; B68E= 90 0B       ..
LB690:
                lsr a                        ; B690= 4A          J
                and #$04                     ; B691= 29 04       ).
                bne LB69C                    ; B693= D0 07       P.
                ror a                        ; B695= 6A          j
                lsr a                        ; B696= 4A          J
                adc #$40                     ; B697= 69 40       i@
                sta $33                      ; B699= 85 33       .3
LB69B:
                rts                          ; B69B= 60          `

LB69C:
                stz $33                      ; B69C= 64 33       d3
                ldx #$60                     ; B69E= A2 60       "`
                ldy #$23                     ; B6A0= A0 23        #
                bcc LB6A8                    ; B6A2= 90 04       ..
                phx                          ; B6A4= DA          Z
                phy                          ; B6A5= 5A          Z
                plx                          ; B6A6= FA          z
                ply                          ; B6A7= 7A          z
LB6A8:
                stx $31                      ; B6A8= 86 31       .1
                sty $32                      ; B6AA= 84 32       .2
                rts                          ; B6AC= 60          `

LB6AD:
                lda #$00                     ; B6AD= A9 00       ).
                bra LB6B3                    ; B6AF= 80 02       ..
                
LB6B1:
                lda #$FF                     ; B6B1= A9 FF       ).
LB6B3:
                sta $2E                      ; B6B3= 85 2E       ..
                stz $2F                      ; B6B5= 64 2F       d/
LB6B7:
                ldx $2F                      ; B6B7= A6 2F       &/
                inx                          ; B6B9= E8          h
                inx                          ; B6BA= E8          h
                inx                          ; B6BB= E8          h
                cpx #$1B                     ; B6BC= E0 1B       `.
                beq LB6DF                    ; B6BE= F0 1F       p.
                stx $2F                      ; B6C0= 86 2F       ./
                jsr LB6C7                    ; B6C2= 20 C7 B6     G6
                bra LB6B7                    ; B6C5= 80 F0       .p

LB6C7:
                ldy $FFFF,x                  ; B6C7= BC FF FF    <..
                lda $00,x                    ; B6CA= B5 00       5.
                bne LB6DF                    ; B6CC= D0 11       P.
                lda LFFFE,x                  ; B6CE= BD FE FF    =~.
                cmp #$3E                     ; B6D1= C9 3E       I>
                bcc LB6DF                    ; B6D3= 90 0A       ..
                beq LB6E0                    ; B6D5= F0 09       p.
                lda $2E                      ; B6D7= A5 2E       %.
                cpy #$07                     ; B6D9= C0 07       @.
                bne LB6DF                    ; B6DB= D0 02       P.
                sta $34                      ; B6DD= 85 34       .4
LB6DF:
                rts                          ; B6DF= 60          `

LB6E0:
                lda $2E                      ; B6E0= A5 2E       %.
                cpy #$01                     ; B6E2= C0 01       @.
                bcs LB6ED                    ; B6E4= B0 07       0.
                inc a                        ; B6E6= 1A          .
                asl a                        ; B6E7= 0A          .
                tax                          ; B6E8= AA          *
                lda #$04                     ; B6E9= A9 04       ).
                bra LB6F6                    ; B6EB= 80 09       ..

LB6ED:
                bne LB6F9                    ; B6ED= D0 0A       P.
                tax                          ; B6EF= AA          *
                beq LB6F4                    ; B6F0= F0 02       p.
                ldx #$21                     ; B6F2= A2 21       "!
LB6F4:
                lda #$CB                     ; B6F4= A9 CB       )K
LB6F6:
                jmp LB825                    ; B6F6= 4C 25 B8    L%8

LB6F9:
                cpy #$03                     ; B6F9= C0 03       @.
                bcs LB707                    ; B6FB= B0 0A       0.
                bit $20                      ; B6FD= 24 20       $
                bpl LB704                    ; B6FF= 10 03       ..
                tay                          ; B701= A8          (
                beq LB6DF                    ; B702= F0 DB       p[
LB704:
                sta $36                      ; B704= 85 36       .6
LB706:
                rts                          ; B706= 60          `

LB707:
                bne LB712                    ; B707= D0 09       P.
                rol a                        ; B709= 2A          *
                lda #$00                     ; B70A= A9 00       ).
LB70C:
                rol a                        ; B70C= 2A          *
                tax                          ; B70D= AA          *
                lda #$60                     ; B70E= A9 60       )`
                bra LB6F6                    ; B710= 80 E4       .d

LB712:
                cpy #$05                     ; B712= C0 05       @.
                bcs LB71B                    ; B714= B0 05       0.
                rol a                        ; B716= 2A          *
                lda #$01                     ; B717= A9 01       ).
                bra LB70C                    ; B719= 80 F1       .q

LB71B:
                bne LB706                    ; B71B= D0 E9       Pi
                sta $35                      ; B71D= 85 35       .5
                rts                          ; B71F= 60          `

LB720:
                jsr LB30D                    ; B720= 20 0D B3     .3
                lda #$23                     ; B723= A9 23       )#
                jmp LB7E6                    ; B725= 4C E6 B7    Lf7

LB728:
                phy                          ; B728= 5A          Z
                phx                          ; B729= DA          Z
                pha                          ; B72A= 48          H
                bit $30                      ; B72B= 24 30       $0
                bmi LB74C                    ; B72D= 30 1D       0.
                cmp #$40                     ; B72F= C9 40       I@
                bcc LB739                    ; B731= 90 06       ..
                tay                          ; B733= A8          (
                bmi LB739                    ; B734= 30 03       0.
                clc                          ; B736= 18          .
                adc $33                      ; B737= 65 33       e3
LB739:
                tay                          ; B739= A8          (
                cpy #$60                     ; B73A= C0 60       @`
                bne LB740                    ; B73C= D0 02       P.
                lda #$BB                     ; B73E= A9 BB       );
LB740:
                cpy #$BB                     ; B740= C0 BB       @;
                bne LB746                    ; B742= D0 02       P.
                lda $32                      ; B744= A5 32       %2
LB746:
                cpy #$23                     ; B746= C0 23       @#
                bne LB74C                    ; B748= D0 02       P.
                lda $31                      ; B74A= A5 31       %1
LB74C:
                pha                          ; B74C= 48          H
                jsr LB821                    ; B74D= 20 21 B8     !8
                cpx $38                      ; B750= E4 38       d8
                beq LB75E                    ; B752= F0 0A       p.
LB754:
                pla                          ; B754= 68          h
                jsr OSWRCH                   ; B755= 20 EE FF     n.
                pha                          ; B758= 48          H
LB759:
                pla                          ; B759= 68          h
                pla                          ; B75A= 68          h
                plx                          ; B75B= FA          z
                ply                          ; B75C= 7A          z
                rts                          ; B75D= 60          `

LB75E:
                bit $34                      ; B75E= 24 34       $4
                bpl LB759                    ; B760= 10 F7       .w
                bit $35                      ; B762= 24 35       $5
                bpl LB754                    ; B764= 10 EE       .n
                pla                          ; B766= 68          h
                pha                          ; B767= 48          H
                cmp #$20                     ; B768= C9 20       I
                bcc LB754                    ; B76A= 90 E8       .h
                bne LB773                    ; B76C= D0 05       P.
                jsr OSNEWL                   ; B76E= 20 E7 FF     g.
                bra LB759                    ; B771= 80 E6       .f

LB773:
                lda #$0D                     ; B773= A9 0D       ).
                jsr OSWRCH                   ; B775= 20 EE FF     n.
                jsr LB4B9                    ; B778= 20 B9 B4     94
                ldy #$00                     ; B77B= A0 00        .
LB77D:
                phy                          ; B77D= 5A          Z
                lda #$08                     ; B77E= A9 08       ).
                jsr OSWRCH                   ; B780= 20 EE FF     n.
                lda #$87                     ; B783= A9 87       ).
                jsr OSBYTE                   ; B785= 20 F4 FF     t.
                ply                          ; B788= 7A          z
                txa                          ; B789= 8A          .
                cmp #$20                     ; B78A= C9 20       I
                beq LB79B                    ; B78C= F0 0D       p.
                sta $0440,y                  ; B78E= 99 40 04    .@.
                iny                          ; B791= C8          H
                cpy $38                      ; B792= C4 38       D8
                bne LB77D                    ; B794= D0 E7       Pg
                jsr OSNEWL                   ; B796= 20 E7 FF     g.
                bra LB754                    ; B799= 80 B9       .9

LB79B:
                phy                          ; B79B= 5A          Z
                lda #$00                     ; B79C= A9 00       ).
                jsr LB7E6                    ; B79E= 20 E6 B7     f7
                jsr OSNEWL                   ; B7A1= 20 E7 FF     g.
                ply                          ; B7A4= 7A          z
                iny                          ; B7A5= C8          H
LB7A6:
                dey                          ; B7A6= 88          .
                beq LB754                    ; B7A7= F0 AB       p+
                lda $043F,y                  ; B7A9= B9 3F 04    9?.
                jsr OSWRCH                   ; B7AC= 20 EE FF     n.
                bra LB7A6                    ; B7AF= 80 F5       .u

LB7B1:
                bcc LB7F9                    ; B7B1= 90 46       .F
LB7B3:
                sec                          ; B7B3= 38          8
                ror $19                      ; B7B4= 66 19       f.
LB7B6:
                ldx #$32                     ; B7B6= A2 32       "2
LB7B8:
                lda #$D5                     ; B7B8= A9 D5       )U
                jsr LB825                    ; B7BA= 20 25 B8     %8
                phx                          ; B7BD= DA          Z
                ldx #$01                     ; B7BE= A2 01       ".
                lda #$D6                     ; B7C0= A9 D6       )V
                jsr LB825                    ; B7C2= 20 25 B8     %8
                phx                          ; B7C5= DA          Z
                lda #$EC                     ; B7C6= A9 EC       )l
                ldx #$14                     ; B7C8= A2 14       ".
                jsr LB825                    ; B7CA= 20 25 B8     %8
                lda #$07                     ; B7CD= A9 07       ).
                jsr OSWRCH                   ; B7CF= 20 EE FF     n.
                lda #$EC                     ; B7D2= A9 EC       )l
                jsr LB825                    ; B7D4= 20 25 B8     %8
                plx                          ; B7D7= FA          z
                lda #$D6                     ; B7D8= A9 D6       )V
                jsr LB825                    ; B7DA= 20 25 B8     %8
                plx                          ; B7DD= FA          z
                lda #$D5                     ; B7DE= A9 D5       )U
                bra LB825                    ; B7E0= 80 43       .C

LB7E2:
                ldx #$8C                     ; B7E2= A2 8C       ".
                bra LB7B8                    ; B7E4= 80 D2       .R

LB7E6:
                tay                          ; B7E6= A8          (
                ldx #$0A                     ; B7E7= A2 0A       ".
                lda #$97                     ; B7E9= A9 97       ).
LB7EB:
                asl a                        ; B7EB= 0A          .
                bcs LB7EF                    ; B7EC= B0 01       0.
                iny                          ; B7EE= C8          H
LB7EF:
                lsr a                        ; B7EF= 4A          J
                jsr OSWRCH                   ; B7F0= 20 EE FF     n.
                lda LB7FA,y                  ; B7F3= B9 FA B7    9z7
                dex                          ; B7F6= CA          J
                bne LB7EB                    ; B7F7= D0 F2       Pr
LB7F9:
                rts                          ; B7F9= 60          `

LB7FA:
                ; PHP                        ; B7FA= 08          .
                ; ORA $06                    ; B7FB= 05 06       ..
                ; BRA LB807                  ; B7FD= 80 08       ..

                ; TSB $05                    ; B7FF= 04 05       ..
                ; BRK                        ; B801= 00          .
                ; BRK                        ; B802= 00          .
                ; ORA ($80,x)                ; B803= 01 80       ..
                ; PHP                        ; B805= 08          .
                ; TSB $06                    ; B806= 04 06       ..
                ; BRA LB812                  ; B808= 80 08       ..

                ; ORA $0A                    ; B80A= 05 0A       ..
                ; BRA LB816                  ; B80C= 80 08       ..

                ; BRK                        ; B80E= 00          .
                ; ORA $00                    ; B80F= 05 00       ..
                ; BRK                        ; B811= 00          .
                .byte $08
                .byte $05
                .byte $06
                .byte $80
                .byte $08
                .byte $04
                .byte $05
                .byte $00
                .byte $00
                .byte $01
                .byte $80
                .byte $08
                .byte $04
                .byte $06
                .byte $80
                .byte $08
                .byte $05
                .byte $0A
                .byte $80
                .byte $08
                .byte $00
                .byte $05
                .byte $00
                .byte $00

LB812:
;ORA (&80,x)      :\ B812= 01 80       ..
                .byte $01
                .byte $80
;PHP              :\ B814= 08          .
                .byte $08
;BRK              :\ B815= 00          .
                .byte $00
;.LB816
;ASL A            :\ B816= 0A          .
                .byte $0A
;BRA LB829        :\ B817= 80 10       ..
                .byte $80
                .byte $10
;ORA (&80,x)      :\ B819= 01 80       ..
                .byte $01
                .byte $80
;BPL LB79D        :\ B81B= 10 80       ..
                .byte $10
                .byte $80
                .byte $07                    ; B81D= 07          .
                .byte $00                    ; B81E= 00          .
                .byte $03                    ; B81F= 03          .
;BRA LB7CB        :\ B820= 80 A9       .)
; LDA &A2          :\ B822= A5 A2       %"
; BRK              :\ B824= 00          .
                .byte $80
LB821:
                lda #$A5
LB823:
                ldx #$00
LB825:
                ldy #$00                     ; B825= A0 00        .
LB827:
                jmp OSBYTE                   ; B827= 4C F4 FF    Lt.

LB82A:
                lda #$9C                     ; B82A= A9 9C       ).
                ldy #$9F                     ; B82C= A0 9F        .
                bra LB827                    ; B82E= 80 F7       .w

LB830:
                ldy #$00                     ; B830= A0 00        .
LB832:
                ldx #$FF                     ; B832= A2 FF       ".
                phx                          ; B834= DA          Z
LB835:
                pla                          ; B835= 68          h
                inc a                        ; B836= 1A          .
                pha                          ; B837= 48          H
                phy                          ; B838= 5A          Z
                jsr LB89E                    ; B839= 20 9E B8     .8
LB83C:
                cmp #$2E                     ; B83C= C9 2E       I.
                beq LB858                    ; B83E= F0 18       p.
                cmp #$40                     ; B840= C9 40       I@
                bcs LB846                    ; B842= B0 02       0.
                lda #$00                     ; B844= A9 00       ).
LB846:
                and #$5F                     ; B846= 29 5F       )_
                inx                          ; B848= E8          h
                eor LB86B,x                  ; B849= 5D 6B B8    ]k8
                beq LB853                    ; B84C= F0 05       p.
                asl a                        ; B84E= 0A          .
                beq LB858                    ; B84F= F0 07       p.
                bra LB85D                    ; B851= 80 0A       ..

LB853:
                iny                          ; B853= C8          H
                lda ($F2),y                  ; B854= B1 F2       1r
                bra LB83C                    ; B856= 80 E4       .d

LB858:
                iny                          ; B858= C8          H
                pla                          ; B859= 68          h
                pla                          ; B85A= 68          h
                clc                          ; B85B= 18          .
                rts                          ; B85C= 60          `

LB85D:
                ply                          ; B85D= 7A          z
LB85E:
                lda LB86B,x                  ; B85E= BD 6B B8    =k8
                bne LB866                    ; B861= D0 03       P.
                sec                          ; B863= 38          8
                pla                          ; B864= 68          h
                rts                          ; B865= 60          `

LB866:
                bmi LB835                    ; B866= 30 CD       0M
                inx                          ; B868= E8          h
                bra LB85E                    ; B869= 80 F3       .s

LB86B:
                .byte $43                    ; B86B= 43          C
                .byte $4B                    ; B86C= 4B          K
                .byte $cc,$4d,$43            ; B86D= CC 4D 43    LMC
                .byte $cc,$50,$52            ; B870= CC 50 52    LPR
                .byte $4F                    ; B873= 4F          O
                .byte $D4                    ; B874= D4          T
                .byte $52,$46                ; B875= 52 46       RF
                .byte $C3                    ; B877= C3          C
                .byte $54                    ; B878= 54          T
                .byte $46,$c3                ; B879= 46 C3       FC
                .byte $57                    ; B87B= 57          W
                .byte $57                    ; B87C= 57          W
                .byte $cd,$41,$57            ; B87D= CD 41 57    MAW
                .byte $cd,$56,$44            ; B880= CD 56 44    MVD
                .byte $d5,$4d                ; B883= D5 4D       UM
                .byte $4F                    ; B885= 4F          O
                .byte $44                    ; B886= 44          D
                .byte $c5,$4f                ; B887= C5 4F       EO
                .byte $ce,$4f,$46            ; B889= CE 4F 46    NOF
                .byte $c6,$54                ; B88C= C6 54       FT
                .byte $45,$52                ; B88E= 45 52       ER
                .byte $4d,$49,$4e            ; B890= 4D 49 4E    MIN
                .byte $41,$cc                ; B893= 41 CC       AL
                .byte $42                    ; B895= 42          B
                .byte $42                    ; B896= 42          B
                .byte $C3                    ; B897= C3          C
                .byte $47                    ; B898= 47          G
                .byte $D3                    ; B899= D3          S
                .byte $54                    ; B89A= 54          T
                .byte $54                    ; B89B= 54          T
                .byte $D9
                .byte $00
LB89E:
                dey
LB89F:
                iny                          ; B89F= C8          H
                lda ($F2),y                  ; B8A0= B1 F2       1r
                cmp #$20                     ; B8A2= C9 20       I
                beq LB89F                    ; B8A4= F0 F9       py
                cmp #$0D                     ; B8A6= C9 0D       I.
                rts                          ; B8A8= 60          `

LB8A9:
                stz $3A                      ; B8A9= 64 3A       d:
                stz $3B                      ; B8AB= 64 3B       d;
LB8AD:
                cmp #$30                     ; B8AD= C9 30       I0
                bcc LB8B5                    ; B8AF= 90 04       ..
                cmp #$3A                     ; B8B1= C9 3A       I:
                bcc LB8B7                    ; B8B3= 90 02       ..
LB8B5:
                sec                          ; B8B5= 38          8
                rts                          ; B8B6= 60          `

LB8B7:
                sbc #$2F                     ; B8B7= E9 2F       i/
                pha                          ; B8B9= 48          H
                lda $3B                      ; B8BA= A5 3B       %;
                pha                          ; B8BC= 48          H
                lda $3A                      ; B8BD= A5 3A       %:
                asl a                        ; B8BF= 0A          .
                rol $3B                      ; B8C0= 26 3B       &;
                asl a                        ; B8C2= 0A          .
                rol $3B                      ; B8C3= 26 3B       &;
                clc                          ; B8C5= 18          .
                adc $3A                      ; B8C6= 65 3A       e:
                sta $3A                      ; B8C8= 85 3A       .:
                pla                          ; B8CA= 68          h
                adc $3B                      ; B8CB= 65 3B       e;
                sta $3B                      ; B8CD= 85 3B       .;
                asl $3A                      ; B8CF= 06 3A       .:
                rol $3B                      ; B8D1= 26 3B       &;
                pla                          ; B8D3= 68          h
                clc                          ; B8D4= 18          .
                adc $3A                      ; B8D5= 65 3A       e:
                sta $3A                      ; B8D7= 85 3A       .:
                bcc LB8DE                    ; B8D9= 90 03       ..
                inc $3B                      ; B8DB= E6 3B       f;
                clc                          ; B8DD= 18          .
LB8DE:
                rts                          ; B8DE= 60          `

; Unused space
; ============
                .byte $FF                    ; B8DF= FF          .
                .byte $FF                    ; B8E0= FF          .
                .byte $FF                    ; B8E1= FF          .
                .byte $FF                    ; B8E2= FF          .
                .byte $FF                    ; B8E3= FF          .
                .byte $FF                    ; B8E4= FF          .
                .byte $FF                    ; B8E5= FF          .
                .byte $FF                    ; B8E6= FF          .
                .byte $FF                    ; B8E7= FF          .
                .byte $FF                    ; B8E8= FF          .
                .byte $FF                    ; B8E9= FF          .
                .byte $FF                    ; B8EA= FF          .
                .byte $FF                    ; B8EB= FF          .
                .byte $FF                    ; B8EC= FF          .
                .byte $FF                    ; B8ED= FF          .
                .byte $FF                    ; B8EE= FF          .
                .byte $FF                    ; B8EF= FF          .
                .byte $FF                    ; B8F0= FF          .
                .byte $FF                    ; B8F1= FF          .
                .byte $FF                    ; B8F2= FF          .
                .byte $FF                    ; B8F3= FF          .
                .byte $FF                    ; B8F4= FF          .
                .byte $FF                    ; B8F5= FF          .
                .byte $FF                    ; B8F6= FF          .
                .byte $FF                    ; B8F7= FF          .
                .byte $FF                    ; B8F8= FF          .
                .byte $FF                    ; B8F9= FF          .
                .byte $FF                    ; B8FA= FF          .
LB8FB:
                .byte $FF                    ; B8FB= FF          .
                .byte $FF                    ; B8FC= FF          .
                .byte $FF                    ; B8FD= FF          .
                .byte $FF                    ; B8FE= FF          .
                .byte $FF                    ; B8FF= FF          .

; Default font
; ============
LB900:
                ; CHR$32 -  
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$33 - !
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00000000
                .byte %00011000
                .byte %00000000

                ; CHR$34 - "
                .byte %01101100
                .byte %01101100
                .byte %01101100
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$35 - #
                .byte %00110110
                .byte %00110110
                .byte %01111111
                .byte %00110110
                .byte %01111111
                .byte %00110110
                .byte %00110110
                .byte %00000000

                ; CHR$36 - $
                .byte %00001100
                .byte %00111111
                .byte %01101000
                .byte %00111110
                .byte %00001011
                .byte %01111110
                .byte %00011000
                .byte %00000000

                ; CHR$37 - %
                .byte %01100000
                .byte %01100110
                .byte %00001100
                .byte %00011000
                .byte %00110000
                .byte %01100110
                .byte %00000110
                .byte %00000000

                ; CHR$38 - &
                .byte %00111000
                .byte %01101100
                .byte %01101100
                .byte %00111000
                .byte %01101101
                .byte %01100110
                .byte %00111011
                .byte %00000000

                ; CHR$39 - '
                .byte %00001100
                .byte %00011000
                .byte %00110000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$40 - (
                .byte %00001100
                .byte %00011000
                .byte %00110000
                .byte %00110000
                .byte %00110000
                .byte %00011000
                .byte %00001100
                .byte %00000000

                ; CHR$41 - )
                .byte %00110000
                .byte %00011000
                .byte %00001100
                .byte %00001100
                .byte %00001100
                .byte %00011000
                .byte %00110000
                .byte %00000000

                ; CHR$42 - *
                .byte %00000000
                .byte %00011000
                .byte %01111110
                .byte %00111100
                .byte %01111110
                .byte %00011000
                .byte %00000000
                .byte %00000000

                ; CHR$43 - +
                .byte %00000000
                .byte %00011000
                .byte %00011000
                .byte %01111110
                .byte %00011000
                .byte %00011000
                .byte %00000000
                .byte %00000000

                ; CHR$44 - ,
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00011000
                .byte %00011000
                .byte %00110000

                ; CHR$45 - -
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %01111110
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$46 - .
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00011000
                .byte %00011000
                .byte %00000000

                ; CHR$47 - /
                .byte %00000000
                .byte %00000110
                .byte %00001100
                .byte %00011000
                .byte %00110000
                .byte %01100000
                .byte %00000000
                .byte %00000000

                ; CHR$48 - 0
                .byte %00111100
                .byte %01100110
                .byte %01101110
                .byte %01111110
                .byte %01110110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$49 - 1
                .byte %00011000
                .byte %00111000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %01111110
                .byte %00000000

                ; CHR$50 - 2
                .byte %00111100
                .byte %01100110
                .byte %00000110
                .byte %00001100
                .byte %00011000
                .byte %00110000
                .byte %01111110
                .byte %00000000

                ; CHR$51 - 3
                .byte %00111100
                .byte %01100110
                .byte %00000110
                .byte %00011100
                .byte %00000110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$52 - 4
                .byte %00001100
                .byte %00011100
                .byte %00111100
                .byte %01101100
                .byte %01111110
                .byte %00001100
                .byte %00001100
                .byte %00000000

                ; CHR$53 - 5
                .byte %01111110
                .byte %01100000
                .byte %01111100
                .byte %00000110
                .byte %00000110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$54 - 6
                .byte %00011100
                .byte %00110000
                .byte %01100000
                .byte %01111100
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$55 - 7
                .byte %01111110
                .byte %00000110
                .byte %00001100
                .byte %00011000
                .byte %00110000
                .byte %00110000
                .byte %00110000
                .byte %00000000

                ; CHR$56 - 8
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$57 - 9
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %00111110
                .byte %00000110
                .byte %00001100
                .byte %00111000
                .byte %00000000

                ; CHR$58 - :
                .byte %00000000
                .byte %00000000
                .byte %00011000
                .byte %00011000
                .byte %00000000
                .byte %00011000
                .byte %00011000
                .byte %00000000

                ; CHR$59 - ;
                .byte %00000000
                .byte %00000000
                .byte %00011000
                .byte %00011000
                .byte %00000000
                .byte %00011000
                .byte %00011000
                .byte %00110000

                ; CHR$60 - <
                .byte %00001100
                .byte %00011000
                .byte %00110000
                .byte %01100000
                .byte %00110000
                .byte %00011000
                .byte %00001100
                .byte %00000000

                ; CHR$61 - =
                .byte %00000000
                .byte %00000000
                .byte %01111110
                .byte %00000000
                .byte %01111110
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$62 - >
                .byte %00110000
                .byte %00011000
                .byte %00001100
                .byte %00000110
                .byte %00001100
                .byte %00011000
                .byte %00110000
                .byte %00000000

                ; CHR$63 - ?
                .byte %00111100
                .byte %01100110
                .byte %00001100
                .byte %00011000
                .byte %00011000
                .byte %00000000
                .byte %00011000
                .byte %00000000

                ; CHR$64 - @
                .byte %00111100
                .byte %01100110
                .byte %01101110
                .byte %01101010
                .byte %01101110
                .byte %01100000
                .byte %00111100
                .byte %00000000

                ; CHR$65 - A
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %01111110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00000000

                ; CHR$66 - B
                .byte %01111100
                .byte %01100110
                .byte %01100110
                .byte %01111100
                .byte %01100110
                .byte %01100110
                .byte %01111100
                .byte %00000000

                ; CHR$67 - C
                .byte %00111100
                .byte %01100110
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$68 - D
                .byte %01111000
                .byte %01101100
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01101100
                .byte %01111000
                .byte %00000000

                ; CHR$69 - E
                .byte %01111110
                .byte %01100000
                .byte %01100000
                .byte %01111100
                .byte %01100000
                .byte %01100000
                .byte %01111110
                .byte %00000000

                ; CHR$70 - F
                .byte %01111110
                .byte %01100000
                .byte %01100000
                .byte %01111100
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %00000000

                ; CHR$71 - G
                .byte %00111100
                .byte %01100110
                .byte %01100000
                .byte %01101110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$72 - H
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01111110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00000000

                ; CHR$73 - I
                .byte %01111110
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %01111110
                .byte %00000000

                ; CHR$74 - J
                .byte %00111110
                .byte %00001100
                .byte %00001100
                .byte %00001100
                .byte %00001100
                .byte %01101100
                .byte %00111000
                .byte %00000000

                ; CHR$75 - K
                .byte %01100110
                .byte %01101100
                .byte %01111000
                .byte %01110000
                .byte %01111000
                .byte %01101100
                .byte %01100110
                .byte %00000000

                ; CHR$76 - L
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %01111110
                .byte %00000000

                ; CHR$77 - M
                .byte %01100011
                .byte %01110111
                .byte %01111111
                .byte %01101011
                .byte %01101011
                .byte %01100011
                .byte %01100011
                .byte %00000000

                ; CHR$78 - N
                .byte %01100110
                .byte %01100110
                .byte %01110110
                .byte %01111110
                .byte %01101110
                .byte %01100110
                .byte %01100110
                .byte %00000000

                ; CHR$79 - O
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$80 - P
                .byte %01111100
                .byte %01100110
                .byte %01100110
                .byte %01111100
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %00000000

                ; CHR$81 - Q
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01101010
                .byte %01101100
                .byte %00110110
                .byte %00000000

                ; CHR$82 - R
                .byte %01111100
                .byte %01100110
                .byte %01100110
                .byte %01111100
                .byte %01101100
                .byte %01100110
                .byte %01100110
                .byte %00000000

                ; CHR$83 - S
                .byte %00111100
                .byte %01100110
                .byte %01100000
                .byte %00111100
                .byte %00000110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$84 - T
                .byte %01111110
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00000000

                ; CHR$85 - U
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$86 - V
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00011000
                .byte %00000000

                ; CHR$87 - W
                .byte %01100011
                .byte %01100011
                .byte %01101011
                .byte %01101011
                .byte %01111111
                .byte %01110111
                .byte %01100011
                .byte %00000000

                ; CHR$88 - X
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00011000
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %00000000

                ; CHR$89 - Y
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00000000

                ; CHR$90 - Z
                .byte %01111110
                .byte %00000110
                .byte %00001100
                .byte %00011000
                .byte %00110000
                .byte %01100000
                .byte %01111110
                .byte %00000000

                ; CHR$91 - [
                .byte %01111100
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %01111100
                .byte %00000000

                ; CHR$92 - \
                .byte %00000000
                .byte %01100000
                .byte %00110000
                .byte %00011000
                .byte %00001100
                .byte %00000110
                .byte %00000000
                .byte %00000000

                ; CHR$93 - ]
                .byte %00111110
                .byte %00000110
                .byte %00000110
                .byte %00000110
                .byte %00000110
                .byte %00000110
                .byte %00111110
                .byte %00000000

                ; CHR$94 - ^
                .byte %00011000
                .byte %00111100
                .byte %01100110
                .byte %01000010
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$95 - _
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %11111111

                ; CHR$96
                .byte %00011100
                .byte %00110110
                .byte %00110000
                .byte %01111100
                .byte %00110000
                .byte %00110000
                .byte %01111110
                .byte %00000000

                ; CHR$97 - a
                .byte %00000000
                .byte %00000000
                .byte %00111100
                .byte %00000110
                .byte %00111110
                .byte %01100110
                .byte %00111110
                .byte %00000000

                ; CHR$98 - b
                .byte %01100000
                .byte %01100000
                .byte %01111100
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01111100
                .byte %00000000

                ; CHR$99 - c
                .byte %00000000
                .byte %00000000
                .byte %00111100
                .byte %01100110
                .byte %01100000
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$100 - d
                .byte %00000110
                .byte %00000110
                .byte %00111110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111110
                .byte %00000000

                ; CHR$101 - e
                .byte %00000000
                .byte %00000000
                .byte %00111100
                .byte %01100110
                .byte %01111110
                .byte %01100000
                .byte %00111100
                .byte %00000000

                ; CHR$102 - f
                .byte %00011100
                .byte %00110000
                .byte %00110000
                .byte %01111100
                .byte %00110000
                .byte %00110000
                .byte %00110000
                .byte %00000000

                ; CHR$103 - g
                .byte %00000000
                .byte %00000000
                .byte %00111110
                .byte %01100110
                .byte %01100110
                .byte %00111110
                .byte %00000110
                .byte %00111100

                ; CHR$104 - h
                .byte %01100000
                .byte %01100000
                .byte %01111100
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00000000

                ; CHR$105 - i
                .byte %00011000
                .byte %00000000
                .byte %00111000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00111100
                .byte %00000000

                ; CHR$106 - j
                .byte %00011000
                .byte %00000000
                .byte %00111000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %01110000

                ; CHR$107 - k
                .byte %01100000
                .byte %01100000
                .byte %01100110
                .byte %01101100
                .byte %01111000
                .byte %01101100
                .byte %01100110
                .byte %00000000

                ; CHR$108 - l
                .byte %00111000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00111100
                .byte %00000000

                ; CHR$109 - m
                .byte %00000000
                .byte %00000000
                .byte %00110110
                .byte %01111111
                .byte %01101011
                .byte %01101011
                .byte %01100011
                .byte %00000000

                ; CHR$110 - n
                .byte %00000000
                .byte %00000000
                .byte %01111100
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00000000

                ; CHR$111 - o
                .byte %00000000
                .byte %00000000
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$112 - p
                .byte %00000000
                .byte %00000000
                .byte %01111100
                .byte %01100110
                .byte %01100110
                .byte %01111100
                .byte %01100000
                .byte %01100000

                ; CHR$113 - q
                .byte %00000000
                .byte %00000000
                .byte %00111110
                .byte %01100110
                .byte %01100110
                .byte %00111110
                .byte %00000110
                .byte %00000111

                ; CHR$114 - r
                .byte %00000000
                .byte %00000000
                .byte %01101100
                .byte %01110110
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %00000000

                ; CHR$115 - s
                .byte %00000000
                .byte %00000000
                .byte %00111110
                .byte %01100000
                .byte %00111100
                .byte %00000110
                .byte %01111100
                .byte %00000000

                ; CHR$116 - t
                .byte %00110000
                .byte %00110000
                .byte %01111100
                .byte %00110000
                .byte %00110000
                .byte %00110000
                .byte %00011100
                .byte %00000000

                ; CHR$117 - u
                .byte %00000000
                .byte %00000000
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111110
                .byte %00000000

                ; CHR$118 - v
                .byte %00000000
                .byte %00000000
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00011000
                .byte %00000000

                ; CHR$119 - w
                .byte %00000000
                .byte %00000000
                .byte %01100011
                .byte %01101011
                .byte %01101011
                .byte %01111111
                .byte %00110110
                .byte %00000000

                ; CHR$120 - x
                .byte %00000000
                .byte %00000000
                .byte %01100110
                .byte %00111100
                .byte %00011000
                .byte %00111100
                .byte %01100110
                .byte %00000000

                ; CHR$121 - y
                .byte %00000000
                .byte %00000000
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111110
                .byte %00000110
                .byte %00111100

                ; CHR$122 - z
                .byte %00000000
                .byte %00000000
                .byte %01111110
                .byte %00001100
                .byte %00011000
                .byte %00110000
                .byte %01111110
                .byte %00000000

                ; CHR$123 - {
                .byte %00001100
                .byte %00011000
                .byte %00011000
                .byte %01110000
                .byte %00011000
                .byte %00011000
                .byte %00001100
                .byte %00000000

                ; CHR$124 - |
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00000000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00000000

                ; CHR$125 - }
                .byte %00110000
                .byte %00011000
                .byte %00011000
                .byte %00001110
                .byte %00011000
                .byte %00011000
                .byte %00110000
                .byte %00000000

                ; CHR$126 - ~
                .byte %00110001
                .byte %01101011
                .byte %01000110
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$127
                .byte %11111111
                .byte %11111111
                .byte %11111111
                .byte %11111111
                .byte %11111111
                .byte %11111111
                .byte %11111111
                .byte %11111111

                ; CHR$128
                .byte %01100110
                .byte %00000000
                .byte %00111100
                .byte %01100110
                .byte %01111110
                .byte %01100110
                .byte %01100110
                .byte %00000000

                ; CHR$129
                .byte %00111100
                .byte %01100110
                .byte %00111100
                .byte %01100110
                .byte %01111110
                .byte %01100110
                .byte %01100110
                .byte %00000000

                ; CHR$130
                .byte %00111111
                .byte %01100110
                .byte %01100110
                .byte %01111111
                .byte %01100110
                .byte %01100110
                .byte %01100111
                .byte %00000000

                ; CHR$131
                .byte %00111100
                .byte %01100110
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %01100110
                .byte %00111100
                .byte %01100000

                ; CHR$132
                .byte %00001100
                .byte %00011000
                .byte %01111110
                .byte %01100000
                .byte %01111100
                .byte %01100000
                .byte %01111110
                .byte %00000000

                ; CHR$133
                .byte %01100110
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$134
                .byte %01100110
                .byte %00000000
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$135
                .byte %01111110
                .byte %11000011
                .byte %10011101
                .byte %10110001
                .byte %10011101
                .byte %11000011
                .byte %01111110
                .byte %00000000

                ; CHR$136
                .byte %00000000
                .byte %00011000
                .byte %00111000
                .byte %01111111
                .byte %00111000
                .byte %00011000
                .byte %00000000
                .byte %00000000

                ; CHR$137
                .byte %00000000
                .byte %00011000
                .byte %00011100
                .byte %11111110
                .byte %00011100
                .byte %00011000
                .byte %00000000
                .byte %00000000

                ; CHR$138
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %01111110
                .byte %00111100
                .byte %00011000
                .byte %00000000

                ; CHR$139
                .byte %00000000
                .byte %00011000
                .byte %00111100
                .byte %01111110
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000

                ; CHR$140
                .byte %00110000
                .byte %00011000
                .byte %00111100
                .byte %00000110
                .byte %00111110
                .byte %01100110
                .byte %00111110
                .byte %00000000

                ; CHR$141
                .byte %00110000
                .byte %00011000
                .byte %00111100
                .byte %01100110
                .byte %01111110
                .byte %01100000
                .byte %00111100
                .byte %00000000

                ; CHR$142
                .byte %01100110
                .byte %00000000
                .byte %00111100
                .byte %01100110
                .byte %01111110
                .byte %01100000
                .byte %00111100
                .byte %00000000

                ; CHR$143
                .byte %00111100
                .byte %01100110
                .byte %00111100
                .byte %01100110
                .byte %01111110
                .byte %01100000
                .byte %00111100
                .byte %00000000

                ; CHR$144
                .byte %01100110
                .byte %00000000
                .byte %00111100
                .byte %00000110
                .byte %00111110
                .byte %01100110
                .byte %00111110
                .byte %00000000

                ; CHR$145
                .byte %00111100
                .byte %01100110
                .byte %00111100
                .byte %00000110
                .byte %00111110
                .byte %01100110
                .byte %00111110
                .byte %00000000

                ; CHR$146
                .byte %00000000
                .byte %00000000
                .byte %00111111
                .byte %00001101
                .byte %00111111
                .byte %01101100
                .byte %00111111
                .byte %00000000

                ; CHR$147
                .byte %00000000
                .byte %00000000
                .byte %00111100
                .byte %01100110
                .byte %01100000
                .byte %01100110
                .byte %00111100
                .byte %01100000

                ; CHR$148
                .byte %00001100
                .byte %00011000
                .byte %00111100
                .byte %01100110
                .byte %01111110
                .byte %01100000
                .byte %00111100
                .byte %00000000

                ; CHR$149
                .byte %01100110
                .byte %00000000
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$150
                .byte %01100110
                .byte %00000000
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111110
                .byte %00000000

                ; CHR$151
                .byte %00110000
                .byte %00011000
                .byte %00000000
                .byte %00111000
                .byte %00011000
                .byte %00011000
                .byte %00111100
                .byte %00000000

                ; CHR$152
                .byte %00111100
                .byte %01100110
                .byte %00000000
                .byte %00111000
                .byte %00011000
                .byte %00011000
                .byte %00111100
                .byte %00000000

                ; CHR$153
                .byte %00110000
                .byte %00011000
                .byte %00000000
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$154
                .byte %00111100
                .byte %01100110
                .byte %00000000
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$155
                .byte %00110000
                .byte %00011000
                .byte %00000000
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111110
                .byte %00000000

                ; CHR$156
                .byte %00111100
                .byte %01100110
                .byte %00000000
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111110
                .byte %00000000

                ; CHR$157
                .byte %01100110
                .byte %00000000
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111110
                .byte %00000110
                .byte %00111100

                ; CHR$158
                .byte %00000000
                .byte %01100110
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %01100110
                .byte %00000000

                ; CHR$159
                .byte %00111100
                .byte %01100000
                .byte %00111100
                .byte %01100110
                .byte %00111100
                .byte %00000110
                .byte %00111100
                .byte %00000000

                ; CHR$160
                .byte %00111100
                .byte %01100110
                .byte %00111100
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$161
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000

                ; CHR$162
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00011111
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$163
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00011111
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000

                ; CHR$164
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %11111000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$165
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %11111000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000

                ; CHR$166
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %11111111
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$167
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %11111111
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000

                ; CHR$168
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$169
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000

                ; CHR$170
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011111
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$171
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011111
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000

                ; CHR$172
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %11111000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$173
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %11111000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000

                ; CHR$174
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %11111111
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$175
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %11111111
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000

                ; CHR$176
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000111
                .byte %00001100
                .byte %00011000
                .byte %00011000
                .byte %00011000

                ; CHR$177
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %11100000
                .byte %00110000
                .byte %00011000
                .byte %00011000
                .byte %00011000

                ; CHR$178
                .byte %00011000
                .byte %00011000
                .byte %00001100
                .byte %00000111
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$179
                .byte %00011000
                .byte %00011000
                .byte %00110000
                .byte %11100000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$180
                .byte %00011000
                .byte %00000000
                .byte %00011000
                .byte %00011000
                .byte %00110000
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$181
                .byte %00011000
                .byte %00000000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00000000

                ; CHR$182
                .byte %00110110
                .byte %01101100
                .byte %00000000
                .byte %01100110
                .byte %01110110
                .byte %01101110
                .byte %01100110
                .byte %00000000

                ; CHR$183
                .byte %00110110
                .byte %01101100
                .byte %00000000
                .byte %01111100
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00000000

                ; CHR$184
                .byte %00011000
                .byte %01111110
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00000000

                ; CHR$185
                .byte %00011000
                .byte %01111110
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %01111110
                .byte %00011000
                .byte %00000000

                ; CHR$186
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$187
                .byte %00110000
                .byte %00011000
                .byte %00001100
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$188
                .byte %00111111
                .byte %01111011
                .byte %01111011
                .byte %00111011
                .byte %00011011
                .byte %00011011
                .byte %00011111
                .byte %00000000

                ; CHR$189
                .byte %00000000
                .byte %00000000
                .byte %00000000
                .byte %00011000
                .byte %00011000
                .byte %00000000
                .byte %00000000
                .byte %00000000

                ; CHR$190
                .byte %00000011
                .byte %00000011
                .byte %00000110
                .byte %00000110
                .byte %01110110
                .byte %00011100
                .byte %00001100
                .byte %00000000

                ; CHR$191
                .byte %10101010
                .byte %01010101
                .byte %10101010
                .byte %01010101
                .byte %10101010
                .byte %01010101
                .byte %10101010
                .byte %01010101

                ; CHR$192
                .byte %00111110
                .byte %01100011
                .byte %01100111
                .byte %01101011
                .byte %01110011
                .byte %01100011
                .byte %00111110
                .byte %00000000

                ; CHR$193
                .byte %00011100
                .byte %00110110
                .byte %01100011
                .byte %01100011
                .byte %01111111
                .byte %01100011
                .byte %01100011
                .byte %00000000

                ; CHR$194
                .byte %01111110
                .byte %00110011
                .byte %00110011
                .byte %00111110
                .byte %00110011
                .byte %00110011
                .byte %01111110
                .byte %00000000

                ; CHR$195
                .byte %01111111
                .byte %01100011
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %01100000
                .byte %00000000

                ; CHR$196
                .byte %00011100
                .byte %00011100
                .byte %00110110
                .byte %00110110
                .byte %01100011
                .byte %01100011
                .byte %01111111
                .byte %00000000

                ; CHR$197
                .byte %01111111
                .byte %00110011
                .byte %00110000
                .byte %00111110
                .byte %00110000
                .byte %00110011
                .byte %01111111
                .byte %00000000

                ; CHR$198
                .byte %01111110
                .byte %01100110
                .byte %00001100
                .byte %00011000
                .byte %00110000
                .byte %01100110
                .byte %01111110
                .byte %00000000

                ; CHR$199
                .byte %01110111
                .byte %00110011
                .byte %00110011
                .byte %00111111
                .byte %00110011
                .byte %00110011
                .byte %01110111
                .byte %00000000

                ; CHR$200
                .byte %00111110
                .byte %01100011
                .byte %01100011
                .byte %01111111
                .byte %01100011
                .byte %01100011
                .byte %00111110
                .byte %00000000

                ; CHR$201
                .byte %00111100
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00111100
                .byte %00000000

                ; CHR$202
                .byte %01100011
                .byte %01100110
                .byte %01101100
                .byte %01111000
                .byte %01101100
                .byte %01100110
                .byte %01100011
                .byte %00000000

                ; CHR$203
                .byte %00011100
                .byte %00011100
                .byte %00110110
                .byte %00110110
                .byte %01100011
                .byte %01100011
                .byte %01100011
                .byte %00000000

                ; CHR$204
                .byte %01100011
                .byte %01110111
                .byte %01111111
                .byte %01101011
                .byte %01100011
                .byte %01100011
                .byte %01100011
                .byte %00000000

                ; CHR$205
                .byte %01100011
                .byte %01110011
                .byte %01111011
                .byte %01101111
                .byte %01100111
                .byte %01100011
                .byte %01100011
                .byte %00000000

                ; CHR$206
                .byte %01111110
                .byte %00000000
                .byte %00000000
                .byte %00111100
                .byte %00000000
                .byte %00000000
                .byte %01111110
                .byte %00000000

                ; CHR$207
                .byte %00111110
                .byte %01100011
                .byte %01100011
                .byte %01100011
                .byte %01100011
                .byte %01100011
                .byte %00111110
                .byte %00000000

                ; CHR$208
                .byte %01111111
                .byte %00110110
                .byte %00110110
                .byte %00110110
                .byte %00110110
                .byte %00110110
                .byte %00110110
                .byte %00000000

                ; CHR$209
                .byte %01111110
                .byte %00110011
                .byte %00110011
                .byte %00111110
                .byte %00110000
                .byte %00110000
                .byte %01111000
                .byte %00000000

                ; CHR$210
                .byte %01111111
                .byte %01100011
                .byte %00110000
                .byte %00011000
                .byte %00110000
                .byte %01100011
                .byte %01111111
                .byte %00000000

                ; CHR$211
                .byte %01111110
                .byte %01011010
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00000000

                ; CHR$212
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00011000
                .byte %00011000
                .byte %00111100
                .byte %00000000

                ; CHR$213
                .byte %00111110
                .byte %00001000
                .byte %00111110
                .byte %01101011
                .byte %00111110
                .byte %00001000
                .byte %00111110
                .byte %00000000

                ; CHR$214
                .byte %01100011
                .byte %01100011
                .byte %00110110
                .byte %00011100
                .byte %00110110
                .byte %01100011
                .byte %01100011
                .byte %00000000

                ; CHR$215
                .byte %00111110
                .byte %00001000
                .byte %01101011
                .byte %01101011
                .byte %00111110
                .byte %00001000
                .byte %00111110
                .byte %00000000

                ; CHR$216
                .byte %00111110
                .byte %01100011
                .byte %01100011
                .byte %01100011
                .byte %00110110
                .byte %00110110
                .byte %01100011
                .byte %00000000

                ; CHR$217
                .byte %01111111
                .byte %01100011
                .byte %01100011
                .byte %00110110
                .byte %00110110
                .byte %00011100
                .byte %00011100
                .byte %00000000

                ; CHR$218
                .byte %00011000
                .byte %00011000
                .byte %01111110
                .byte %00011000
                .byte %00011000
                .byte %00000000
                .byte %01111110
                .byte %00000000

                ; CHR$219
                .byte %00000000
                .byte %01111110
                .byte %00000000
                .byte %00011000
                .byte %00011000
                .byte %01111110
                .byte %00011000
                .byte %00011000

                ; CHR$220
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00000000

                ; CHR$221
                .byte %00110110
                .byte %00110110
                .byte %00110110
                .byte %00110110
                .byte %00110110
                .byte %00110110
                .byte %00110110
                .byte %00000000

                ; CHR$222
                .byte %00000000
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$223
                .byte %00000000
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00000000

                ; CHR$224
                .byte %00000000
                .byte %00000011
                .byte %00111110
                .byte %01100111
                .byte %01101011
                .byte %01110011
                .byte %00111110
                .byte %01100000

                ; CHR$225
                .byte %00000000
                .byte %00000000
                .byte %00111011
                .byte %01101110
                .byte %01100110
                .byte %01101110
                .byte %00111011
                .byte %00000000

                ; CHR$226
                .byte %00011110
                .byte %00110011
                .byte %00110011
                .byte %00111110
                .byte %00110011
                .byte %00110011
                .byte %00111110
                .byte %01100000

                ; CHR$227
                .byte %00000000
                .byte %00000000
                .byte %01100110
                .byte %00110110
                .byte %00011100
                .byte %00011000
                .byte %00110000
                .byte %00110000

                ; CHR$228
                .byte %00111100
                .byte %01100000
                .byte %00110000
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$229
                .byte %00000000
                .byte %00000000
                .byte %00011110
                .byte %00110000
                .byte %00011100
                .byte %00110000
                .byte %00011110
                .byte %00000000

                ; CHR$230
                .byte %00111110
                .byte %00001100
                .byte %00011000
                .byte %00110000
                .byte %01100000
                .byte %01100000
                .byte %00111110
                .byte %00000110

                ; CHR$231
                .byte %00000000
                .byte %00000000
                .byte %01111100
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00000110
                .byte %00000110

                ; CHR$232
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %01111110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$233
                .byte %00000000
                .byte %00000000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00001100
                .byte %00000000

                ; CHR$234
                .byte %00000000
                .byte %00000000
                .byte %01100110
                .byte %01101100
                .byte %01111000
                .byte %01101100
                .byte %01100110
                .byte %00000000

                ; CHR$235
                .byte %01100000
                .byte %00110000
                .byte %00011000
                .byte %00011100
                .byte %00110110
                .byte %01100011
                .byte %01100011
                .byte %00000000

                ; CHR$236
                .byte %00000000
                .byte %00000000
                .byte %00110011
                .byte %00110011
                .byte %00110011
                .byte %00110011
                .byte %00111110
                .byte %01100000

                ; CHR$237
                .byte %00000000
                .byte %00000000
                .byte %01100011
                .byte %00110011
                .byte %00011011
                .byte %00011110
                .byte %00011100
                .byte %00000000

                ; CHR$238
                .byte %00111100
                .byte %01100000
                .byte %01100000
                .byte %00111100
                .byte %01100000
                .byte %01100000
                .byte %00111110
                .byte %00000110

                ; CHR$239
                .byte %00000000
                .byte %00000000
                .byte %00111110
                .byte %01100011
                .byte %01100011
                .byte %01100011
                .byte %00111110
                .byte %00000000

                ; CHR$240
                .byte %00000000
                .byte %00000000
                .byte %01111111
                .byte %00110110
                .byte %00110110
                .byte %00110110
                .byte %00110110
                .byte %00000000

                ; CHR$241
                .byte %00000000
                .byte %00000000
                .byte %00111100
                .byte %01100110
                .byte %01100110
                .byte %01111100
                .byte %01100000
                .byte %01100000

                ; CHR$242
                .byte %00000000
                .byte %00000000
                .byte %00111111
                .byte %01100110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$243
                .byte %00000000
                .byte %00000000
                .byte %01111110
                .byte %00011000
                .byte %00011000
                .byte %00011000
                .byte %00001100
                .byte %00000000

                ; CHR$244
                .byte %00000000
                .byte %00000000
                .byte %01110011
                .byte %00110011
                .byte %00110011
                .byte %00110011
                .byte %00011110
                .byte %00000000

                ; CHR$245
                .byte %00000000
                .byte %00000000
                .byte %00111110
                .byte %01101011
                .byte %01101011
                .byte %00111110
                .byte %00011000
                .byte %00011000

                ; CHR$246
                .byte %00000000
                .byte %00000000
                .byte %01100110
                .byte %00110110
                .byte %00011100
                .byte %00011100
                .byte %00110110
                .byte %00110011

                ; CHR$247
                .byte %00000000
                .byte %00000000
                .byte %01100011
                .byte %01101011
                .byte %01101011
                .byte %00111110
                .byte %00011000
                .byte %00011000

                ; CHR$248
                .byte %00000000
                .byte %00000000
                .byte %00110110
                .byte %01100011
                .byte %01101011
                .byte %01111111
                .byte %00110110
                .byte %00000000

                ; CHR$249
                .byte %00111000
                .byte %00001100
                .byte %00000110
                .byte %00111110
                .byte %01100110
                .byte %01100110
                .byte %00111100
                .byte %00000000

                ; CHR$250
                .byte %00000000
                .byte %00110001
                .byte %01101011
                .byte %01000110
                .byte %00000000
                .byte %01111111
                .byte %00000000
                .byte %00000000

                ; CHR$251
                .byte %00000000
                .byte %01111110
                .byte %00000000
                .byte %01111110
                .byte %00000000
                .byte %01111110
                .byte %00000000
                .byte %00000000

                ; CHR$252
                .byte %00000111
                .byte %00011100
                .byte %01110000
                .byte %00011100
                .byte %00000111
                .byte %00000000
                .byte %01111111
                .byte %00000000

                ; CHR$253
                .byte %00000110
                .byte %00001100
                .byte %01111110
                .byte %00011000
                .byte %01111110
                .byte %00110000
                .byte %01100000
                .byte %00000000

                ; CHR$254
                .byte %01110000
                .byte %00011100
                .byte %00000111
                .byte %00011100
                .byte %01110000
                .byte %00000000
                .byte %01111111
                .byte %00000000

                ; CHR$255
                .byte %11111111
                .byte %11111111
                .byte %11111111
                .byte %11111111
                .byte %11111111
                .byte %11111111
                .byte %11111111
                .byte %11111111

                .send terminal

;-------------------------------------------------------------------------

                .section mos

; VDU driver entry block
; ======================
LC000:                                       ; Read from VDU memory
                lda (ZMEMG),y
                rts
LC003:                                       ; Write to VDU memory
                sta (ZMEMG),y
                rts

; MasRef E.4-6
;
; JSR PLBYTE plots the mask held in ZMASK into the byte pointed to by
; (ZMEMG),y, using ZGORA and ZGEOR as colour masks. See GADDR below
; for an example of its use.
;
; PLBYTE uses ZTEMP as workspace and preserves X, Y, V and C.
PLBYTE: 
                jmp LDB51

; MasRef E.4-6
;
; JSR HPLOT plots a fast horizontal line in the current graphics
; colour or ECF and the current graphics mode (all as set by VDU 18)
; between two specified points. It is the low level primitive used by
; all the MOS area fill commands.
;
; On entry, two 4 byte areas at &300+X and &300+Y contain the
; coordinates of the two endpoints, in the standard
; lowX,highX,lowY,highY order. Should the Y coordinates differ, the Y
; coordinate of the line plotted is taken from the leftmost of the two
; points specified.
;
; Only portions of the line inside the graphics window are plotted.
; Subject to this, both endpoints of the line are plotted.
;
; HPLOT uses ZGORA, ZGEOR, ZMASK, ZMEMG, ZTEMP (but not ZTEMP+1),
; ZTEMPB, ZTEMPB+1, ZTEMPC and ZTEMPC+1 as workspace. No registers or
; flags are preserved.
HPLOT:                          
                jmp LDAE8

; MasRef E.4-6
;
; JSR EIGABS converts the 4 byte pair of external coordinates at
; &300+X (in standard lowX,highX,lowY,highY order) into the
; corresponding pair of pixel coordinates by offsetting by the
; graphics origin, then dividing by an appropriate power of 2.
;
; EIGABS uses ZTEMP as workspace, and corrupts all registers and
; flags.
EIGABS:
                jmp LD1DE

; MasRef E.4-7
;
; JSR WIND windows the 4 byte pair of pixel coordinates (in standard
; lowX,highX,lowY,highY order) at &300+X, and returns a result in A
; according to its position with respect to the window:

; 9 | 8 | 10
; --+---+---
; 1 | 0 | 2
; --+---+---
; 5 | 4 | 6

; WIND uses ZTEMP as workspace, preserves X and sets N and Z according
; to A.
WIND:
                jmp LD1A8

; MasRef E.4-7
;
; JSR GADDR addresses the pixel whose 4 byte pair of pixel coordinates
; (in standard lowX,highX,lowY,highY order) is at &300+X. GADDR should
; not be called without first ensuring (typically by means of WIND)
; that the point concerned does lie within the screen.
;
; GADDR initialises the following variables:
;
; . ZMEMG to the start of the page of memory containing the pixel.
;
; . Y and VDU variable &1A (i.e. location &31A) to contain the offset
; of the byte containing the pixel within this page – i.e. (ZMEMG),y
; points to the byte containing the pixel.
;
; . ZMASK to a mask indicating which bits of this byte constitute the
; pixel.
;
; . ZGORA and ZGEOR to the correct colour masks for the current
; graphics plot mode (found in VDU variable &5A) and colour/ECF
;
; . X to Y MOD 7, i.e. the scan line within a character row of the
; pixel.
;
; Additionally, GADDR uses ZTEMP as workspace and returns A=0, Z=1.
;
; An example of the use of PLBYTE, WIND and GADDR is the following
; code, which effectively re-implements the VDU 25 64–71 (plot a
; point) calls. It assumes that the routine addresses have been
; previously defined and that the graphics plot mode, etc. were set up
; by the VDU 25 code before the unknown PLOT codes vector was entered:

; .POINT
;  LDX #&20   ;Addresses new point within VDU queue, as
;             ;left on entry to the unknown PLOT codes
;             ;vector.
;  JSR WIND   ;Is the point inside the window?
;  BNE END    ;Return if not.
;  JSR GADDR  ;Address the point now we know it's on
;             ;screen.
;  JSR PLBYTE ;And plot the point.
; .END
;  RTS
GADDR:
                jmp LDEC8

; MasRef E.4-8
;
; JSR IEG takes the internal pixel coordinates of the graphics cursor
; (in VDU variables &24–&27), converts it back to external coordinates
; and stores the result in VDU variables &10–&13.
;
; It should be called whenever the graphics code generates a new
; graphics cursor position (e.g. in the VDU drivers, it is called
; after a character is printed in VDU 5 mode). Its purpose is to make
; the two versions of the graphics cursor agree again, and thus
; prevent errors occurring with relative plots.
;
; IEG uses no page zero locations and corrupts all registers and
; flags.
IEG:
                jmp LC4DF
LC018:                                       ; Fetch byte from ROM Y
                ldx $F4                      ; Get current ROM
                sty $F4                      ; Select ROM in Y
                sty ROMSEL
                lda ($F6)                    ; Get byte with ROM Y paged in
                jmp selectROMX                    ; Page in ROM X and return

LC024:
                jmp ($035D)                  ; C024= 6C 5D 03    l].

                ; VDU DRIVER ENTRY POINT
                ; ======================
LC027:
                ldx $026A                    ; C027= AE 6A 02    .j.
                beq LC059                    ; C02A= F0 2D       p-
                sta $0224,x                  ; C02C= 9D 24 02    .$.
                inc $026A                    ; C02F= EE 6A 02    nj.
                beq LC036                    ; C032= F0 02       p.
LC034:
                clc                          ; C034= 18          .
LC035:
                rts                          ; C035= 60          `

LC036:
                bit STATE                      ; C036= 24 D0       $P
                bpl LC053                    ; C038= 10 19       ..
                ldy $035E                    ; C03A= AC 5E 03    ,^.
                cpy #$C0                     ; C03D= C0 C0       @@
LC03F:
                bne LC034                    ; C03F= D0 F3       Ps
                ldy $035D                    ; C041= AC 5D 03    ,].
                cpy #$E2                     ; C044= C0 E2       @b
                bne LC034                    ; C046= D0 EC       Pl
LC048:
                tax                          ; C048= AA          *
                lda STATE                      ; C049= A5 D0       %P
                lsr a                        ; C04B= 4A          J
                bcc LC035                    ; C04C= 90 E7       .g
                txa                          ; C04E= 8A          .
LC04F:
                clc                          ; C04F= 18          .
                jmp LE8B9                    ; C050= 4C B9 E8    L9h

LC053:
                jsr LC0FA                    ; C053= 20 FA C0     z@
                clc                          ; C056= 18          .
                bra LC0C0                    ; C057= 80 67       .g

LC059:
                jsr LC0FA                    ; C059= 20 FA C0     z@
                bvc LC06D                    ; C05C= 50 0F       P.
                bmi LC06D                    ; C05E= 30 0D       0.
                cmp #$0D                     ; C060= C9 0D       I.
                bne LC06D                    ; C062= D0 09       P.
                pha                          ; C064= 48          H
                lda #$42                     ; C065= A9 42       )B
                trb STATE                      ; C067= 14 D0       .P
                jsr LCF50                    ; C069= 20 50 CF     PO
                pla                          ; C06C= 68          h
LC06D:
                cmp #$20                     ; C06D= C9 20       I
                bcc LC077                    ; C06F= 90 06       ..
                cmp #$7F                     ; C071= C9 7F       I.
                bne LC096                    ; C073= D0 21       P!
                lda #$20                     ; C075= A9 20       )
LC077:
                tay                          ; C077= A8
                lda LE027,y                  ; Get routine LSB
                sta $035D                    ; Store jump address LSB (see MasRef E.4-3)
                lda LE048,y                  ; Get routine MSB
                bmi LC0B3                    ; Branch taken if bit 7 set
                tax                          ; Save original MSB value
                ora #$F0                     ; 
                sta $026A                    ; 
                txa                          ; Restore original MSB value
                lsr a                        ; 
                lsr a                        ; 
                lsr a                        ; 
                lsr a                        ; Extract value in top 4 bits
                clc                          ; 
                adc #$C0                     ; Add $C0 to value from top 4 bits
                sta $035E                    ; Store jump address MSB
                bra LC0CA                    ; Continue

LC096:
                bit STATE                      ; C096= 24 D0       $P
                bmi LC0C7                    ; C098= 30 2D       0-
                jsr LCE0C                    ; C09A= 20 0C CE     .N
                lda #$20                     ; C09D= A9 20       )
                bit $0366                    ; C09F= 2C 66 03    ,f.
                bne LC0C7                    ; C0A2= D0 23       P#
                jsr LC276                    ; C0A4= 20 76 C2     vB
                bra LC0C7                    ; C0A7= 80 1E       ..

LC0A9:
                eor #$06                     ; C0A9= 49 06       I.
                bne LC0C5                    ; C0AB= D0 18       P.
                lda #$80                     ; C0AD= A9 80       ).
                trb STATE                      ; C0AF= 14 D0       .P
                bra LC0CA                    ; C0B1= 80 17       ..

LC0B3:
                sta $035E                    ; Store jump address MSB
                tya                          ; C0B6= 98          .
                eor #$F7                     ; C0B7= 49 F7       Iw
                cmp #$FA                     ; C0B9= C9 FA       Iz
                tya                          ; C0BB= 98          .
                bit STATE                      ; C0BC= 24 D0       $P
                bmi LC0A9                    ; C0BE= 30 E9       0i
LC0C0:
                php                          ; C0C0= 08          .
                jsr LC024                    ; C0C1= 20 24 C0     $@
                plp                          ; C0C4= 28          (
LC0C5:
                bcc LC0CA                    ; C0C5= 90 03       ..
LC0C7:
                lda STATE                      ; C0C7= A5 D0       %P
                lsr a                        ; C0C9= 4A          J
LC0CA:
                bit STATE                      ; C0CA= 24 D0       $P
                bvc LC0E1                    ; C0CC= 50 13       P.
                jsr LC105                    ; C0CE= 20 05 C1     .A
LC0D1:
                php                          ; C0D1= 08          .
                pha                          ; C0D2= 48          H
                lda STATE                      ; C0D3= A5 D0       %P
                eor #$02                     ; C0D5= 49 02       I.
                sta STATE                      ; C0D7= 85 D0       .P
                jsr LE2AE                    ; C0D9= 20 AE E2     .b
                jsr LC6D8                    ; C0DC= 20 D8 C6     XF
                pla                          ; C0DF= 68          h
LC0E0:
                plp                          ; C0E0= 28          (
LC0E1:
                rts                          ; C0E1= 60          `

LC0E2:
                jsr LC0CA                    ; C0E2= 20 CA C0     J@
                jsr LC048                    ; C0E5= 20 48 C0     H@
                bra LC0FA                    ; C0E8= 80 10       ..
                
LC0EA:
                pha                          ; C0EA= 48          H
                jsr LC0CA                    ; C0EB= 20 CA C0     J@
                jsr LE93A                    ; C0EE= 20 3A E9     :i
                lda #$01                     ; C0F1= A9 01       ).
                tsb STATE                      ; C0F3= 04 D0       .P
                pla                          ; C0F5= 68          h
                and #$01                     ; C0F6= 29 01       ).
                trb STATE                      ; C0F8= 14 D0       .P
LC0FA:
                bit STATE                      ; C0FA= 24 D0       $P
                bvc LC0E1                    ; C0FC= 50 E3       Pc
                jsr LC0D1                    ; C0FE= 20 D1 C0     Q@
                php                          ; C101= 08          .
                sec                          ; C102= 38          8
                bra LC107                    ; C103= 80 02       ..

LC105:
                php                          ; C105= 08          .
                clc                          ; C106= 18          .
LC107:
                pha                          ; C107= 48          H
                lda $D8                      ; C108= A5 D8       %X
                sta $E0                      ; C10A= 85 E0       .`
                lda $D9                      ; C10C= A5 D9       %Y
                sta $E1                      ; C10E= 85 E1       .a
                ldy $034F                    ; C110= AC 4F 03    ,O.
                dey                          ; C113= 88          .
                bne LC124                    ; C114= D0 0E       P.
                lda $0338                    ; C116= AD 38 03    -8.
                bcs LC132                    ; C119= B0 17       0.
                lda ($D8)                    ; C11B= B2 D8       2X
                sta $0338                    ; C11D= 8D 38 03    .8.
                lda #$7F                     ; C120= A9 7F       ).
                bra LC132                    ; C122= 80 0E       ..

LC124:
                lda #$FF                     ; C124= A9 FF       ).
                cpy #$1F                     ; C126= C0 1F       @.
                bne LC12C                    ; C128= D0 02       P.
                lda #$3F                     ; C12A= A9 3F       )?
LC12C:
                sta $DA                      ; C12C= 85 DA       .Z
LC12E:
                lda ($E0)                    ; C12E= B2 E0       2`
                eor $DA                      ; C130= 45 DA       EZ
LC132:
                sta ($E0)                    ; C132= 92 E0       .`
                inc $E0                      ; C134= E6 E0       f`
                bne LC141                    ; C136= D0 09       P.
                inc $E1                      ; C138= E6 E1       fa
                bpl LC141                    ; C13A= 10 05       ..
LC13C:
                lda $034E                    ; C13C= AD 4E 03    -N.
                sta $E1                      ; C13F= 85 E1       .a
LC141:
                dey                          ; C141= 88          .
                bpl LC12E                    ; C142= 10 EA       .j
                pla                          ; C144= 68          h
                plp                          ; C145= 28          (
                rts                          ; C146= 60          `

LC147:
                .word LC1BE                  ; C147= BE C1       ..
                .word LC1B1                  ; C149= B1 C1       ..
                .word LC1BE                  ; C14B= BE C1       ..
                .word LC1B1                  ; C14D= B1 C1       ..
                .word LC195                  ; C14F= 95 C1       ..
                .word LC195                  ; C151= 95 C1       ..
                .word LC1A2                  ; C153= A2 C1       ..
                .word LC1A2                  ; C155= A2 C1       ..
LC157:
                .word LC201                  ; C157= 01 C2       ..
                .word LC1EE                  ; C159= EE C1       ..
                .word LC201                  ; C15B= 01 C2       ..
                .word LC1EE                  ; C15D= EE C1       ..
                .word LC221                  ; C15F= 21 C2       !.
                .word LC221                  ; C161= 21 C2       !.
                .word LC210                  ; C163= 10 C2       ..
                .word LC210                  ; C165= 10 C2       ..
LC167:
                .word LC2D3                  ; C167= D3 C2       ..
                .word LC2CB                  ; C169= CB C2       ..
                .word LC2D3                  ; C16B= D3 C2       ..
                .word LC2CB                  ; C16D= CB C2       ..
                .word LC2E2                  ; C16F= E2 C2       ..
                .word LC2E2                  ; C171= E2 C2       ..
                .word LC2DA                  ; C173= DA C2       ..
                .word LC2DA                  ; C175= DA C2       ..
LC177:
                .word LC310                  ; C177= 10 C3       ..
                .word LC2F2                  ; C179= F2 C2       ..
                .word LC310                  ; C17B= 10 C3       ..
                .word LC2F2                  ; C17D= F2 C2       ..
                .word LC35A                  ; C17F= 5A C3       Z.
                .word LC35A                  ; C181= 5A C3       Z.
                .word LC338                  ; C183= 38 C3       8.
                .word LC338                  ; C185= 38 C3       8.
LC187:
                eor $0366                    ; C187= 4D 66 03    Mf.
                and #$0E                     ; C18A= 29 0E       ).
                pha                          ; C18C= 48          H
                jsr LD1A6                    ; C18D= 20 A6 D1     &Q
                plx                          ; C190= FA          z
                sec                          ; C191= 38          8
                jmp (LC147,x)                ; C192= 7C 47 C1    |GA

LC195:
                lda $0326                    ; C195= AD 26 03    -&.
                sbc #$08                     ; C198= E9 08       i.
                sta $0326                    ; C19A= 8D 26 03    .&.
                dec $0327                    ; C19D= CE 27 03    N'.
                bra LC1AA                    ; C1A0= 80 08       ..

LC1A2:
                lda $0326                    ; C1A2= AD 26 03    -&.
                adc #$07                     ; C1A5= 69 07       i.
                sta $0326                    ; C1A7= 8D 26 03    .&.
LC1AA:
                bcc LC1CB                    ; C1AA= 90 1F       ..
                inc $0327                    ; C1AC= EE 27 03    n'.
                bra LC1CB                    ; C1AF= 80 1A       ..

LC1B1:
                lda $0324                    ; C1B1= AD 24 03    -$.
                sbc #$08                     ; C1B4= E9 08       i.
                sta $0324                    ; C1B6= 8D 24 03    .$.
                dec $0325                    ; C1B9= CE 25 03    N%.
                bra LC1C6                    ; C1BC= 80 08       ..

LC1BE:
                lda $0324                    ; C1BE= AD 24 03    -$.
                adc #$07                     ; C1C1= 69 07       i.
                sta $0324                    ; C1C3= 8D 24 03    .$.
LC1C6:
                bcc LC1CB                    ; C1C6= 90 03       ..
                inc $0325                    ; C1C8= EE 25 03    n%.
LC1CB:
                lda $DA                      ; C1CB= A5 DA       %Z
                bne LC1DB                    ; C1CD= D0 0C       P.
                bit $0366                    ; C1CF= 2C 66 03    ,f.
                bvs LC1DB                    ; C1D2= 70 07       p.
                phx                          ; C1D4= DA          Z
                jsr LD1A6                    ; C1D5= 20 A6 D1     &Q
                plx                          ; C1D8= FA          z
                tay                          ; C1D9= A8          (
                rts                          ; C1DA= 60          `

LC1DB:
                lda #$00                     ; C1DB= A9 00       ).
                rts                          ; C1DD= 60          `

LC1DE:
                lda #$00                     ; C1DE= A9 00       ).
LC1E0:
                stz $DA                      ; C1E0= 64 DA       dZ
                asl a                        ; C1E2= 0A          .
                rol $DA                      ; C1E3= 26 DA       &Z
                asl a                        ; C1E5= 0A          .
                rol $DA                      ; C1E6= 26 DA       &Z
                asl a                        ; C1E8= 0A          .
                rol $DA                      ; C1E9= 26 DA       &Z
                jmp (LC157,x)                ; C1EB= 7C 57 C1    |WA

LC1EE:
                eor #$F9                     ; C1EE= 49 F9       Iy
                adc $0304                    ; C1F0= 6D 04 03    m..
                sta $0324                    ; C1F3= 8D 24 03    .$.
                lda $DA                      ; C1F6= A5 DA       %Z
                eor #$FF                     ; C1F8= 49 FF       I.
                adc $0305                    ; C1FA= 6D 05 03    m..
                sta $0325                    ; C1FD= 8D 25 03    .%.
                rts                          ; C200= 60          `

LC201:
                adc $0300                    ; C201= 6D 00 03    m..
                sta $0324                    ; C204= 8D 24 03    .$.
                lda $DA                      ; C207= A5 DA       %Z
                adc $0301                    ; C209= 6D 01 03    m..
                sta $0325                    ; C20C= 8D 25 03    .%.
                rts                          ; C20F= 60          `

LC210:
                eor #$07                     ; C210= 49 07       I.
                adc $0302                    ; C212= 6D 02 03    m..
                sta $0326                    ; C215= 8D 26 03    .&.
                lda $DA                      ; C218= A5 DA       %Z
                adc $0303                    ; C21A= 6D 03 03    m..
                sta $0327                    ; C21D= 8D 27 03    .'.
                rts                          ; C220= 60          `

LC221:
                sec                          ; C221= 38          8
                eor #$FF                     ; C222= 49 FF       I.
                adc $0306                    ; C224= 6D 06 03    m..
                sta $0326                    ; C227= 8D 26 03    .&.
                lda $DA                      ; C22A= A5 DA       %Z
                eor #$FF                     ; C22C= 49 FF       I.
                adc $0307                    ; C22E= 6D 07 03    m..
                sta $0327                    ; C231= 8D 27 03    .'.
                rts                          ; C234= 60          `

LC235:
                lda #$00                     ; C235= A9 00       ).
                jsr LC187                    ; C237= 20 87 C1     .A
                beq LC249                    ; C23A= F0 0D       p.
                jsr LC1DE                    ; C23C= 20 DE C1     ^A
LC23F:
                lda #$08                     ; C23F= A9 08       ).
LC241:
                jsr LC187                    ; C241= 20 87 C1     .A
                beq LC249                    ; C244= F0 03       p.
                jsr LC1DE                    ; C246= 20 DE C1     ^A
LC249:
                jmp LC4DF                    ; C249= 4C DF C4    L_D

LC24C:
                jsr LD12D                    ; C24C= 20 2D D1     -Q
                bcs LC235                    ; C24F= B0 E4       0d
                lda #$00                     ; C251= A9 00       ).
                jsr LC2E9                    ; C253= 20 E9 C2     iB
                bcc LC273                    ; C256= 90 1B       ..
LC258:
                jsr LC38F                    ; C258= 20 8F C3     .C
LC25B:
                jsr LE2D2                    ; C25B= 20 D2 E2     Rb
                bne LC23F                    ; C25E= D0 DF       P_
                clc                          ; C260= 18          .
                jsr LC88E                    ; C261= 20 8E C8     .H
                lda #$08                     ; C264= A9 08       ).
                jsr LC2E9                    ; C266= 20 E9 C2     iB
LC269:
                bcc LC273                    ; C269= 90 08       ..
                jsr LC37B                    ; C26B= 20 7B C3     {C
                bcc LC273                    ; C26E= 90 03       ..
                jmp LD051                    ; C270= 4C 51 D0    LQP

LC273:
                jmp LC6ED                    ; C273= 4C ED C6    LmF

LC276:
                jsr LE2D2                    ; C276= 20 D2 E2     Rb
                bne LC235                    ; C279= D0 BA       P:
                jsr LC2E9                    ; C27B= 20 E9 C2     iB
                bcc LC273                    ; C27E= 90 F3       .s
                lda #$01                     ; C280= A9 01       ).
                bit $0366                    ; C282= 2C 66 03    ,f.
                beq LC258                    ; C285= F0 D1       pQ
                sec                          ; C287= 38          8
                ror $036C                    ; C288= 6E 6C 03    nl.
LC28B:
                rts                          ; C28B= 60          `

LC28C:
                lda #$06                     ; C28C= A9 06       ).
                jsr LC187                    ; C28E= 20 87 C1     .A
                beq LC249                    ; C291= F0 B6       p6
                jsr LC1DE                    ; C293= 20 DE C1     ^A
LC296:
                lda #$0E                     ; C296= A9 0E       ).
                bra LC241                    ; C298= 80 A7       .'

LC29A:
                jsr LE2D2                    ; C29A= 20 D2 E2     Rb
                bne LC28C                    ; C29D= D0 ED       Pm
                lsr $036C                    ; C29F= 4E 6C 03    Nl.
                bit $036C                    ; C2A2= 2C 6C 03    ,l.
                bvs LC28B                    ; C2A5= 70 E4       pd
                lda #$06                     ; C2A7= A9 06       ).
                jsr LC2E9                    ; C2A9= 20 E9 C2     iB
                bcc LC273                    ; C2AC= 90 C5       .E
                jsr LC38F                    ; C2AE= 20 8F C3     .C
LC2B1:
                jsr LE2D2                    ; C2B1= 20 D2 E2     Rb
                bne LC296                    ; C2B4= D0 E0       P`
                dec $0269                    ; C2B6= CE 69 02    Ni.
                bpl LC2BE                    ; C2B9= 10 03       ..
                inc $0269                    ; C2BB= EE 69 02    ni.
LC2BE:
                lda #$0E                     ; C2BE= A9 0E       ).
                jsr LC2E9                    ; C2C0= 20 E9 C2     iB
                bra LC269                    ; C2C3= 80 A4       .$

LC2C5:
                lda #$00                     ; C2C5= A9 00       ).
LC2C7:
                clc                          ; C2C7= 18          .
                jmp (LC167,x)                ; C2C8= 7C 67 C1    |gA

LC2CB:
                sec                          ; C2CB= 38          8
                eor #$FF                     ; C2CC= 49 FF       I.
                adc $030A                    ; C2CE= 6D 0A 03    m..
                bra LC2D6                    ; C2D1= 80 03       ..

LC2D3:
                adc $0308                    ; C2D3= 6D 08 03    m..
LC2D6:
                sta $0318                    ; C2D6= 8D 18 03    ...
                rts                          ; C2D9= 60          `

LC2DA:
                sec                          ; C2DA= 38          8
                eor #$FF                     ; C2DB= 49 FF       I.
                adc $0309                    ; C2DD= 6D 09 03    m..
                bra LC2E5                    ; C2E0= 80 03       ..

LC2E2:
                adc $030B                    ; C2E2= 6D 0B 03    m..
LC2E5:
                sta $0319                    ; C2E5= 8D 19 03    ...
                rts                          ; C2E8= 60          `

LC2E9:
                eor $0366                    ; C2E9= 4D 66 03    Mf.
                and #$0E                     ; C2EC= 29 0E       ).
                tax                          ; C2EE= AA          *
LC2EF:
                jmp (LC177,x)                ; C2EF= 7C 77 C1    |wA

LC2F2:
                lda $0308                    ; C2F2= AD 08 03    -..
                cmp $0318                    ; C2F5= CD 18 03    M..
                bcs LC337                    ; C2F8= B0 3D       0=
                dec $0318                    ; C2FA= CE 18 03    N..
                sec                          ; C2FD= 38          8
                lda $034A                    ; C2FE= AD 4A 03    -J.
                sbc $034F                    ; C301= ED 4F 03    mO.
                sta $034A                    ; C304= 8D 4A 03    .J.
                sta $D8                      ; C307= 85 D8       .X
                bcs LC336                    ; C309= B0 2B       0+
                dec $034B                    ; C30B= CE 4B 03    NK.
                bra LC32B                    ; C30E= 80 1B       ..

LC310:
                lda $0318                    ; C310= AD 18 03    -..
                cmp $030A                    ; C313= CD 0A 03    M..
                bcs LC337                    ; C316= B0 1F       0.
                inc $0318                    ; C318= EE 18 03    n..
                lda $034A                    ; C31B= AD 4A 03    -J.
                adc $034F                    ; C31E= 6D 4F 03    mO.
                sta $034A                    ; C321= 8D 4A 03    .J.
                sta $D8                      ; C324= 85 D8       .X
                bcc LC337                    ; C326= 90 0F       ..
                inc $034B                    ; C328= EE 4B 03    nK.
LC32B:
                lda $034B                    ; C32B= AD 4B 03    -K.
LC32E:
                bpl LC334                    ; C32E= 10 04       ..
                sec                          ; C330= 38          8
                sbc $0354                    ; C331= ED 54 03    mT.
LC334:
                sta $D9                      ; C334= 85 D9       .Y
LC336:
                clc                          ; C336= 18          .
LC337:
                rts                          ; C337= 60          `

LC338:
                lda $030B                    ; C338= AD 0B 03    -..
                cmp $0319                    ; C33B= CD 19 03    M..
                bcs LC337                    ; C33E= B0 F7       0w
                dec $0319                    ; C340= CE 19 03    N..
                sec                          ; C343= 38          8
                lda $034A                    ; C344= AD 4A 03    -J.
                sbc $0352                    ; C347= ED 52 03    mR.
                sta $034A                    ; C34A= 8D 4A 03    .J.
                sta $D8                      ; C34D= 85 D8       .X
                lda $034B                    ; C34F= AD 4B 03    -K.
                sbc $0353                    ; C352= ED 53 03    mS.
                sta $034B                    ; C355= 8D 4B 03    .K.
                bra LC32E                    ; C358= 80 D4       .T

LC35A:
                lda $0319                    ; C35A= AD 19 03    -..
                cmp $0309                    ; C35D= CD 09 03    M..
                bcs LC337                    ; C360= B0 D5       0U
                inc $0319                    ; C362= EE 19 03    n..
                lda $034A                    ; C365= AD 4A 03    -J.
                adc $0352                    ; C368= 6D 52 03    mR.
                sta $034A                    ; C36B= 8D 4A 03    .J.
                sta $D8                      ; C36E= 85 D8       .X
                lda $034B                    ; C370= AD 4B 03    -K.
                adc $0353                    ; C373= 6D 53 03    mS.
                sta $034B                    ; C376= 8D 4B 03    .K.
                bra LC32E                    ; C379= 80 B3       .3

LC37B:
                lda #$10                     ; C37B= A9 10       ).
                bit $0366                    ; C37D= 2C 66 03    ,f.
                bne LC38F                    ; C380= D0 0D       P.
                txa                          ; C382= 8A          .
                eor #$06                     ; C383= 49 06       I.
                pha                          ; C385= 48          H
                lda #$42                     ; C386= A9 42       )B
                bit STATE                      ; C388= 24 D0       $P
                beq LC3A2                    ; C38A= F0 16       p.
                bvs LC397                    ; C38C= 70 09       p.
                pla                          ; C38E= 68          h
LC38F:
                jsr LC2C5                    ; C38F= 20 C5 C2     EB
                jsr LCCFA                    ; C392= 20 FA CC     zL
                clc                          ; C395= 18          .
                rts                          ; C396= 60          `

LC397:
                jsr LE2AE                    ; C397= 20 AE E2     .b
                plx                          ; C39A= FA          z
                phx                          ; C39B= DA          Z
                jsr LC2EF                    ; C39C= 20 EF C2     oB
                jsr LE2AE                    ; C39F= 20 AE E2     .b
LC3A2:
                plx                          ; C3A2= FA          z
                sec                          ; C3A3= 38          8
LC3A4:
                rts                          ; C3A4= 60          `

LC3A5:
                ldx $0355                    ; C3A5= AE 55 03    .U.
                lda $0321                    ; C3A8= AD 21 03    -!.
                cmp $0323                    ; C3AB= CD 23 03    M#.
                bcc LC3A4                    ; C3AE= 90 F4       .t
                cmp LE101,x                  ; C3B0= DD 01 E1    ].a
                beq LC3B7                    ; C3B3= F0 02       p.
                bcs LC3A4                    ; C3B5= B0 ED       0m
LC3B7:
                lda $0322                    ; C3B7= AD 22 03    -".
                cmp LE109,x                  ; C3BA= DD 09 E1    ].a
                beq LC3C2                    ; C3BD= F0 03       p.
                bcs LC3A4                    ; C3BF= B0 E3       0c
                sec                          ; C3C1= 38          8
LC3C2:
                sbc $0320                    ; C3C2= ED 20 03    m .
                bcc LC3A4                    ; C3C5= 90 DD       .]
                jsr LC780                    ; C3C7= 20 80 C7     .G
                lda #$08                     ; C3CA= A9 08       ).
                tsb STATE                      ; C3CC= 04 D0       .P
                ldx #$20                     ; C3CE= A2 20       "
                ldy #$08                     ; C3D0= A0 08        .
                jsr LC91E                    ; C3D2= 20 1E C9     .I
                jsr LE2AE                    ; C3D5= 20 AE E2     .b
                jsr LCCDA                    ; C3D8= 20 DA CC     ZL
                bcc LC3E0                    ; C3DB= 90 03       ..
                jsr LC3E8                    ; C3DD= 20 E8 C3     hC
LC3E0:
                jsr LE2AE                    ; C3E0= 20 AE E2     .b
                jsr LCCDA                    ; C3E3= 20 DA CC     ZL
                bcc LC407                    ; C3E6= 90 1F       ..
LC3E8:
                lda STATE                      ; C3E8= A5 D0       %P
                pha                          ; C3EA= 48          H
                and #$DF                     ; C3EB= 29 DF       )_
                sta STATE                      ; C3ED= 85 D0       .P
                jsr LC47C                    ; C3EF= 20 7C C4     |D
                pla                          ; C3F2= 68          h
                sta STATE                      ; C3F3= 85 D0       .P
                rts                          ; C3F5= 60          `

LC3F6:
                lda $0366                    ; C3F6= AD 66 03    -f.
                and #$0E                     ; C3F9= 29 0E       ).
                tax                          ; C3FB= AA          *
                jsr LE2D2                    ; C3FC= 20 D2 E2     Rb
                bne LC40A                    ; C3FF= D0 09       P.
                lsr $036C                    ; C401= 4E 6C 03    Nl.
                jsr LC38F                    ; C404= 20 8F C3     .C
LC407:
                jmp LC6ED                    ; C407= 4C ED C6    LmF

LC40A:
                jsr LC1DE                    ; C40A= 20 DE C1     ^A
                jmp LC4DF                    ; C40D= 4C DF C4    L_D

LC410:
                jsr LC47C                    ; C410= 20 7C C4     |D
LC413:
                lda $0361                    ; C413= AD 61 03    -a.
                beq LC3A4                    ; C416= F0 8C       p.
                ldx #$00                     ; C418= A2 00       ".
                jsr LC902                    ; C41A= 20 02 C9     .I
                jsr LC951                    ; C41D= 20 51 C9     QI
LC420:
                ldx #$2A                     ; C420= A2 2A       "*
                ldy #$2E                     ; C422= A0 2E        .
                jsr LE2B2                    ; C424= 20 B2 E2     2b
LC427:
                ldx #$28                     ; C427= A2 28       "(
                ldy #$2C                     ; C429= A0 2C        ,
                jsr LDAE8                    ; C42B= 20 E8 DA     hZ
                lda $032A                    ; C42E= AD 2A 03    -*.
                bne LC436                    ; C431= D0 03       P.
                dec $032B                    ; C433= CE 2B 03    N+.
LC436:
                dec $032A                    ; C436= CE 2A 03    N*.
                lda $032A                    ; C439= AD 2A 03    -*.
                cmp $032E                    ; C43C= CD 2E 03    M..
                lda $032B                    ; C43F= AD 2B 03    -+.
                sbc $032F                    ; C442= ED 2F 03    m/.
                bpl LC427                    ; C445= 10 E0       .`
                rts                          ; C447= 60          `

LC448:
                ldx #$20                     ; C448= A2 20       "
                jsr LC8E6                    ; C44A= 20 E6 C8     fH
                bra LC420                    ; C44D= 80 D1       .Q

                ; VDU 12 - CLS
                ; ============
LC44F:
                lda #$20
                bit STATE
                bne LC410                    ; VDU 5 mode
                lda #$08
                bit STATE
                bne LC45E                    ; Software CLS (window defined)
                jmp LC866                    ; Do a hardware CLS

                ; Clear screen within text window
                ; -------------------------------
LC45E:
                jsr LC908                    ; C45E= 20 08 C9     .I
                ldx $0308                    ; C461= AE 08 03    ...
                stx $0318                    ; C464= 8E 18 03    ...
                ldx $030B                    ; C467= AE 0B 03    ...
LC46A:
                stx $0319                    ; C46A= 8E 19 03    ...
                jsr LCCFA                    ; C46D= 20 FA CC     zL
                jsr LCAE8                    ; C470= 20 E8 CA     hJ
                ldx $0319                    ; C473= AE 19 03    ...
                cpx $0309                    ; C476= EC 09 03    l..
                inx                          ; C479= E8          h
                bcc LC46A                    ; C47A= 90 EE       .n
LC47C:
                stz $0323                    ; C47C= 9C 23 03    .#.
                stz $0322                    ; C47F= 9C 22 03    .".
LC482:
                lda $0366                    ; C482= AD 66 03    -f.
                and #$0E                     ; C485= 29 0E       ).
                tax                          ; C487= AA          *
LC488:
                jsr LE2D2                    ; C488= 20 D2 E2     Rb
                bne LC4CF                    ; C48B= D0 42       PB
                lda $0318                    ; C48D= AD 18 03    -..
                pha                          ; C490= 48          H
                lda $0319                    ; C491= AD 19 03    -..
                pha                          ; C494= 48          H
                lda $0322                    ; C495= AD 22 03    -".
                jsr LC2C7                    ; C498= 20 C7 C2     GB
                phx                          ; C49B= DA          Z
                txa                          ; C49C= 8A          .
                eor #$08                     ; C49D= 49 08       I.
                tax                          ; C49F= AA          *
                lda $0323                    ; C4A0= AD 23 03    -#.
                jsr LCCD7                    ; C4A3= 20 D7 CC     WL
                plx                          ; C4A6= FA          z
                bcc LC4BA                    ; C4A7= 90 11       ..
                lda #$01                     ; C4A9= A9 01       ).
                bit $0366                    ; C4AB= 2C 66 03    ,f.
                beq LC4C1                    ; C4AE= F0 11       p.
                lda $0322                    ; C4B0= AD 22 03    -".
                dec a                        ; C4B3= 3A          :
                jsr LCCD7                    ; C4B4= 20 D7 CC     WL
                bcs LC4C1                    ; C4B7= B0 08       0.
                sec                          ; C4B9= 38          8
LC4BA:
                ror $036C                    ; C4BA= 6E 6C 03    nl.
                pla                          ; C4BD= 68          h
                pla                          ; C4BE= 68          h
                bra LC4CC                    ; C4BF= 80 0B       ..

LC4C1:
                pla                          ; C4C1= 68          h
                sta $0319                    ; C4C2= 8D 19 03    ...
                pla                          ; C4C5= 68          h
                sta $0318                    ; C4C6= 8D 18 03    ...
                jsr LCCFA                    ; C4C9= 20 FA CC     zL
LC4CC:
                jmp LC6ED                    ; C4CC= 4C ED C6    LmF

LC4CF:
                lda $0322                    ; C4CF= AD 22 03    -".
                jsr LC1E0                    ; C4D2= 20 E0 C1     `A
                txa                          ; C4D5= 8A          .
                eor #$08                     ; C4D6= 49 08       I.
                tax                          ; C4D8= AA          *
                lda $0323                    ; C4D9= AD 23 03    -#.
                jsr LC1E0                    ; C4DC= 20 E0 C1     `A
LC4DF:
                ldy #$10                     ; C4DF= A0 10        .
                jsr LC91C                    ; C4E1= 20 1C C9     .I
                ldx #$02                     ; C4E4= A2 02       ".
                ldy #$02                     ; C4E6= A0 02        .
                jsr LC4FC                    ; C4E8= 20 FC C4     |D
                ldx #$00                     ; C4EB= A2 00       ".
                ldy #$04                     ; C4ED= A0 04        .
                lda $0361                    ; C4EF= AD 61 03    -a.
LC4F2:
                dey                          ; C4F2= 88          .
                lsr a                        ; C4F3= 4A          J
                bne LC4F2                    ; C4F4= D0 FC       P|
                lda $0356                    ; C4F6= AD 56 03    -V.
                beq LC4FC                    ; C4F9= F0 01       p.
                iny                          ; C4FB= C8          H
LC4FC:
                asl $0310,x                  ; C4FC= 1E 10 03    ...
                rol $0311,x                  ; C4FF= 3E 11 03    >..
                dey                          ; C502= 88          .
                bne LC4FC                    ; C503= D0 F7       Pw
                sec                          ; C505= 38          8
                jsr LC50A                    ; C506= 20 0A C5     .E
                inx                          ; C509= E8          h
LC50A:
                lda $0310,x                  ; C50A= BD 10 03    =..
                sbc $030C,x                  ; C50D= FD 0C 03    }..
                sta $0310,x                  ; C510= 9D 10 03    ...
                rts                          ; C513= 60          `
                
LC514:
                stz $0269                    ; C514= 9C 69 02    .i.
                lda #$91                     ; C517= A9 91       ).
LC519:
                eor #$95                     ; C519= 49 95       I.
LC51B:
                tsb STATE                      ; C51B= 04 D0       .P
                rts                          ; C51D= 60          `
                
LC51E:
                lda $0361                    ; C51E= AD 61 03    -a.
                beq LC52C                    ; C521= F0 09       p.
                jsr LCF50                    ; C523= 20 50 CF     PO
                lda #$2B                     ; C526= A9 2B       )+
LC528:
                eor #$0B                     ; C528= 49 0B       I.
                trb STATE                      ; C52A= 14 D0       .P
LC52C:
                rts                          ; C52C= 60          `

LC52D:
                lda $0361                    ; C52D= AD 61 03    -a.
                beq LC52C                    ; C530= F0 FA       pz
                lda #$20                     ; C532= A9 20       )
                jsr LCF53                    ; C534= 20 53 CF     SO
                bra LC51B                    ; C537= 80 E2       .b
                
LC539:
                ldy #$00                     ; C539= A0 00        .
                lda $0323                    ; C53B= AD 23 03    -#.
                bpl LC541                    ; C53E= 10 01       ..
                iny                          ; C540= C8          H
LC541:
                and $0360                    ; C541= 2D 60 03    -`.
                sta $DA                      ; C544= 85 DA       .Z
                lda $0360                    ; C546= AD 60 03    -`.
                beq LC563                    ; C549= F0 18       p.
                and #$07                     ; C54B= 29 07       ).
                clc                          ; C54D= 18          .
                adc $DA                      ; C54E= 65 DA       eZ
                tax                          ; C550= AA          *
                lda LE14B,x                  ; C551= BD 4B E1    =Ka
                sta $0357,y                  ; C554= 99 57 03    .W.
                lda $0357                    ; C557= AD 57 03    -W.
                eor #$FF                     ; C55A= 49 FF       I.
                sta ZEOR                      ; C55C= 85 D3       .S
                eor $0358                    ; C55E= 4D 58 03    MX.
                sta ZORA                      ; C561= 85 D2       .R
LC563:
                rts                          ; C563= 60          `
                
LC564:
                ldy #$00                     ; C564= A0 00        .
                lda $0323                    ; C566= AD 23 03    -#.
                bpl LC56C                    ; C569= 10 01       ..
LC56B:
                iny                          ; C56B= C8          H
LC56C:
                and $0360                    ; C56C= 2D 60 03    -`.
                sta $036D,y                  ; C56F= 99 6D 03    .m.
                lda $0322                    ; C572= AD 22 03    -".
                sta $035B,y                  ; C575= 99 5B 03    .[.
                and #$F0                     ; C578= 29 F0       )p
                sta $036A,y                  ; C57A= 99 6A 03    .j.
LC57D:
                lda $035B                    ; C57D= AD 5B 03    -[.
                ldx $036D                    ; C580= AE 6D 03    .m.
                ldy #$00                     ; C583= A0 00        .
                jsr LC590                    ; C585= 20 90 C5     .E
                lda $035C                    ; C588= AD 5C 03    -\.
                ldx $036E                    ; C58B= AE 6E 03    .n.
                ldy #$08                     ; C58E= A0 08        .
LC590:
                and #$F0                     ; C590= 29 F0       )p
                bne LC5AC                    ; C592= D0 18       P.
                stx $DA                      ; C594= 86 DA       .Z
                lda $0360                    ; C596= AD 60 03    -`.
                and #$07                     ; C599= 29 07       ).
                clc                          ; C59B= 18          .
                adc $DA                      ; C59C= 65 DA       eZ
                tax                          ; C59E= AA          *
                lda LE14B,x                  ; C59F= BD 4B E1    =Ka
                ldx #$07                     ; C5A2= A2 07       ".
LC5A4:
                sta L8820,y                  ; C5A4= 99 20 88    . .
                iny                          ; C5A7= C8          H
                dex                          ; C5A8= CA          J
                bpl LC5A4                    ; C5A9= 10 F9       .y
                rts                          ; C5AB= 60          `

LC5AC:
                lsr a                        ; C5AC= 4A          J
                tax                          ; C5AD= AA          *
                lda #$07                     ; C5AE= A9 07       ).
                sta $DA                      ; C5B0= 85 DA       .Z
LC5B2:
                lda L87F8,x                  ; C5B2= BD F8 87    =x.
                sta L8820,y                  ; C5B5= 99 20 88    . .
                inx                          ; C5B8= E8          h
                iny                          ; C5B9= C8          H
                dec $DA                      ; C5BA= C6 DA       FZ
                bpl LC5B2                    ; C5BC= 10 F4       .t
                rts                          ; C5BE= 60          `

LC5BF:
                lda #$20                     ; C5BF= A9 20       )
                sta $0358                    ; C5C1= 8D 58 03    .X.
                rts                          ; C5C4= 60          `

LC5C5:
                ldx #$05                     ; C5C5= A2 05       ".
LC5C7:
                stz $0357,x                  ; C5C7= 9E 57 03    .W.
                dex                          ; C5CA= CA          J
                bpl LC5C7                    ; C5CB= 10 FA       .z
                stz $036E                    ; C5CD= 9C 6E 03    .n.
                stz $036B                    ; C5D0= 9C 6B 03    .k.
                lda #$FF                     ; C5D3= A9 FF       ).
                ldx $0360                    ; C5D5= AE 60 03    .`.
                beq LC5BF                    ; C5D8= F0 E5       pe
                cpx #$0F                     ; C5DA= E0 0F       `.
                bne LC5E0                    ; C5DC= D0 02       P.
                lda #$3F                     ; C5DE= A9 3F       )?
LC5E0:
                sta $0357                    ; C5E0= 8D 57 03    .W.
                eor #$FF                     ; C5E3= 49 FF       I.
                sta ZORA                      ; C5E5= 85 D2       .R
                sta ZEOR                      ; C5E7= 85 D3       .S
                txa                          ; C5E9= 8A          .
                and #$07                     ; C5EA= 29 07       ).
                sta $036D                    ; C5EC= 8D 6D 03    .m.
                stz $036A                    ; C5EF= 9C 6A 03    .j.
                phx                          ; C5F2= DA          Z
                jsr LC57D                    ; C5F3= 20 7D C5     }E
                plx                          ; C5F6= FA          z
                stx $031F                    ; C5F7= 8E 1F 03    ...
                cpx #$03                     ; C5FA= E0 03       `.
                beq LC60F                    ; C5FC= F0 11       p.
                bcc LC620                    ; C5FE= 90 20       .
                stx $0320                    ; C600= 8E 20 03    . .
LC603:
                jsr LC62D                    ; C603= 20 2D C6     -F
                dec $0320                    ; C606= CE 20 03    N .
                dec $031F                    ; C609= CE 1F 03    N..
                bpl LC603                    ; C60C= 10 F5       .u
                rts                          ; C60E= 60          `

LC60F:
                ldx #$07                     ; C60F= A2 07       ".
                stx $0320                    ; C611= 8E 20 03    . .
LC614:
                jsr LC62D                    ; C614= 20 2D C6     -F
                lsr $0320                    ; C617= 4E 20 03    N .
                dec $031F                    ; C61A= CE 1F 03    N..
                bpl LC614                    ; C61D= 10 F5       .u
                rts                          ; C61F= 60          `

LC620:
                ldx #$07                     ; C620= A2 07       ".
                jsr LC62A                    ; C622= 20 2A C6     *F
                ldx #$00                     ; C625= A2 00       ".
                stz $031F                    ; C627= 9C 1F 03    ...
LC62A:
                stx $0320                    ; C62A= 8E 20 03    . .
LC62D:
                php                          ; C62D= 08          .
                sei                          ; C62E= 78          x
                lda $031F                    ; C62F= AD 1F 03    -..
                and $0360                    ; C632= 2D 60 03    -`.
                tax                          ; C635= AA          *
                lda $0320                    ; C636= AD 20 03    - .
LC639:
                and #$0F                     ; C639= 29 0F       ).
                sta $036F,x                  ; C63B= 9D 6F 03    .o.
                tay                          ; C63E= A8          (
                lda $0360                    ; C63F= AD 60 03    -`.
                sta $FA                      ; C642= 85 FA       .z
                cmp #$03                     ; C644= C9 03       I.
                php                          ; C646= 08          .
                txa                          ; C647= 8A          .
LC648:
                lsr a                        ; C648= 4A          J
                ror $FA                      ; C649= 66 FA       fz
                bcs LC648                    ; C64B= B0 FB       0{
                asl $FA                      ; C64D= 06 FA       .z
                tya                          ; C64F= 98          .
                ora $FA                      ; C650= 05 FA       .z
                tax                          ; C652= AA          *
                ldy #$F0                     ; C653= A0 F0        p
LC655:
                plp                          ; C655= 28          (
                php                          ; C656= 08          .
                bne LC65C                    ; C657= D0 03       P.
                jsr LC66F                    ; C659= 20 6F C6     oF
LC65C:
                jsr LF261                    ; C65C= 20 61 F2     ar
                clc                          ; C65F= 18          .
                tya                          ; C660= 98          .
                adc $0360                    ; C661= 6D 60 03    m`.
                tay                          ; C664= A8          (
                txa                          ; C665= 8A          .
                adc #$10                     ; C666= 69 10       i.
                tax                          ; C668= AA          *
                iny                          ; C669= C8          H
                bne LC655                    ; C66A= D0 E9       Pi
                plp                          ; C66C= 28          (
                plp                          ; C66D= 28          (
                rts                          ; C66E= 60          `

LC66F:
                rol a                        ; C66F= 2A          *
                sta $DA                      ; C670= 85 DA       .Z
                rol a                        ; C672= 2A          *
                rol a                        ; C673= 2A          *
                php                          ; C674= 08          .
                rol $DA                      ; C675= 26 DA       &Z
                ror a                        ; C677= 6A          j
                plp                          ; C678= 28          (
                ror a                        ; C679= 6A          j
                ror a                        ; C67A= 6A          j
                rts                          ; C67B= 60          `

LC67C:
                lda $031B                    ; C67C= AD 1B 03    -..
                cmp #$20                     ; C67F= C9 20       I
                bcc LC691                    ; C681= 90 0E       ..
                jsr LE22C                    ; C683= 20 2C E2     ,b
                ldy #$07                     ; C686= A0 07        .
LC688:
                lda $031C,y                  ; C688= B9 1C 03    9..
                sta ($DE),y                  ; C68B= 91 DE       .^
                dey                          ; C68D= 88          .
                bpl LC688                    ; C68E= 10 F8       .x
                rts                          ; C690= 60          `

LC691:
                asl a                        ; C691= 0A          .
                tax                          ; C692= AA          *
                lsr a                        ; C693= 4A          J
                cmp #$11                     ; C694= C9 11       I.
                bcs LC6A7                    ; C696= B0 0F       0.
                jmp (LE069,x)                ; C698= 7C 69 E0    |i`

LC69B:
                ldx $0361                    ; C69B= AE 61 03    .a.
                beq LC6A3                    ; C69E= F0 03       p.
                jmp LD146                    ; C6A0= 4C 46 D1    LFQ

LC6A3:
                lda $031F                    ; C6A3= AD 1F 03    -..
                clc                          ; C6A6= 18          .
LC6A7:
                jmp (VDUV)                  ; C6A7= 6C 26 02    l&.

LC6AA:
                ldx #$2C                     ; C6AA= A2 2C       ",
LC6AC:
                stz $0300,x                  ; C6AC= 9E 00 03    ...
                dex                          ; C6AF= CA          J
                bpl LC6AC                    ; C6B0= 10 FA       .z
                jsr LE2A2                    ; C6B2= 20 A2 E2     "b
                stx $030A                    ; C6B5= 8E 0A 03    ...
                sty $0309                    ; C6B8= 8C 09 03    ...
                txa                          ; C6BB= 8A          .
                jsr LC780                    ; C6BC= 20 80 C7     .G
                ldy #$03                     ; C6BF= A0 03        .
                sty $0323                    ; C6C1= 8C 23 03    .#.
                iny                          ; C6C4= C8          H
                sty $0321                    ; C6C5= 8C 21 03    .!.
                dec $0322                    ; C6C8= CE 22 03    N".
                dec $0320                    ; C6CB= CE 20 03    N .
                jsr LC71F                    ; C6CE= 20 1F C7     .G
                lda #$08                     ; C6D1= A9 08       ).
                trb STATE                      ; C6D3= 14 D0       .P
                jmp LC47C                    ; C6D5= 4C 7C C4    L|D

LC6D8:
                jsr LCCFA                    ; C6D8= 20 FA CC     zL
                bra LC6ED                    ; C6DB= 80 10       ..

LC6DD:
                stx $034A                    ; C6DD= 8E 4A 03    .J.
                sta $034B                    ; C6E0= 8D 4B 03    .K.
                bpl LC6E9                    ; C6E3= 10 04       ..
                sec                          ; C6E5= 38          8
                sbc $0354                    ; C6E6= ED 54 03    mT.
LC6E9:
                stx $D8                      ; C6E9= 86 D8       .X
                sta $D9                      ; C6EB= 85 D9       .Y
LC6ED:
                ldx $034A                    ; C6ED= AE 4A 03    .J.
                lda $034B                    ; C6F0= AD 4B 03    -K.
                ldy #$0E                     ; C6F3= A0 0E        .
LC6F5:
                pha                          ; C6F5= 48          H
                lda $0355                    ; C6F6= AD 55 03    -U.
                cmp #$07                     ; C6F9= C9 07       I.
                pla                          ; C6FB= 68          h
                bcs LC70D                    ; C6FC= B0 0F       0.
                stx $DA                      ; C6FE= 86 DA       .Z
                lsr a                        ; C700= 4A          J
                ror $DA                      ; C701= 66 DA       fZ
                lsr a                        ; C703= 4A          J
                ror $DA                      ; C704= 66 DA       fZ
                lsr a                        ; C706= 4A          J
                ror $DA                      ; C707= 66 DA       fZ
                ldx $DA                      ; C709= A6 DA       &Z
                bra LC711                    ; C70B= 80 04       ..

LC70D:
                sbc #$74                     ; C70D= E9 74       it
                eor #$20                     ; C70F= 49 20       I
LC711:
                sty CRTC+0                   ; C711= 8C 00 FE    ..~
                sta CRTC+1                   ; C714= 8D 01 FE    ..~
                iny                          ; C717= C8          H
                sty CRTC+0                   ; C718= 8C 00 FE    ..~
                stx CRTC+1                   ; C71B= 8E 01 FE    ..~
                rts                          ; C71E= 60          `

LC71F:
                jsr LC779                    ; C71F= 20 79 C7     yG
                ldx #$02                     ; C722= A2 02       ".
LC724:
                sec                          ; C724= 38          8
                lda $0320,x                  ; C725= BD 20 03    = .
                sbc $031C,x                  ; C728= FD 1C 03    }..
                sta $032C,x                  ; C72B= 9D 2C 03    .,.
                lda $0321,x                  ; C72E= BD 21 03    =!.
                sbc $031D,x                  ; C731= FD 1D 03    }..
                sta $032D,x                  ; C734= 9D 2D 03    .-.
                dex                          ; C737= CA          J
                dex                          ; C738= CA          J
                bpl LC724                    ; C739= 10 E9       .i
                ora $032F                    ; C73B= 0D 2F 03    ./.
                bmi LC779                    ; C73E= 30 39       09
                ldx #$20                     ; C740= A2 20       "
                jsr LD1DE                    ; C742= 20 DE D1     ^Q
                ldx #$1C                     ; C745= A2 1C       ".
                jsr LD1DE                    ; C747= 20 DE D1     ^Q
                lda $031F                    ; C74A= AD 1F 03    -..
                ora $031D                    ; C74D= 0D 1D 03    ...
                bmi LC779                    ; C750= 30 27       0'
                lda $0323                    ; C752= AD 23 03    -#.
                bne LC779                    ; C755= D0 22       P"
                ldx $0355                    ; C757= AE 55 03    .U.
                lda $0321                    ; C75A= AD 21 03    -!.
                sta $DA                      ; C75D= 85 DA       .Z
                lda $0320                    ; C75F= AD 20 03    - .
                lsr $DA                      ; C762= 46 DA       FZ
                ror a                        ; C764= 6A          j
                lsr $DA                      ; C765= 46 DA       FZ
                bne LC779                    ; C767= D0 10       P.
                ror a                        ; C769= 6A          j
                lsr a                        ; C76A= 4A          J
                cmp LE109,x                  ; C76B= DD 09 E1    ].a
                beq LC772                    ; C76E= F0 02       p.
                bpl LC779                    ; C770= 10 07       ..
LC772:
                ldy #$00                     ; C772= A0 00        .
                ldx #$1C                     ; C774= A2 1C       ".
                jsr LC904                    ; C776= 20 04 C9     .I
LC779:
                ldx #$10                     ; C779= A2 10       ".
                ldy #$28                     ; C77B= A0 28        (
                jmp LE2BA                    ; C77D= 4C BA E2    L:b

LC780:
                jsr LC93B                    ; C780= 20 3B C9     ;I
                sta $034C                    ; C783= 8D 4C 03    .L.
                stx $034D                    ; C786= 8E 4D 03    .M.
                rts                          ; C789= 60          `

LC78A:
                ldx #$20                     ; C78A= A2 20       "
                ldy #$0C                     ; C78C= A0 0C        .
                jsr LC91E                    ; C78E= 20 1E C9     .I
                jmp LC4DF                    ; C791= 4C DF C4    L_D

LC794:
                lda $0323                    ; C794= AD 23 03    -#.
                bra LC7BC                    ; C797= 80 23       .#

LC799:
                sta $DA                      ; C799= 85 DA       .Z
                lda $F4                      ; C79B= A5 F4       %t
                pha                          ; C79D= 48          H
                ora #$80                     ; C79E= 09 80       ..
                jsr selectROMA                    ; C7A0= 20 92 E5     .e
                jsr LC7AA                    ; C7A3= 20 AA C7     *G
                pla                          ; C7A6= 68          h
                jmp selectROMA                    ; C7A7= 4C 92 E5    L.e

LC7AA:
                ldx #$7F                     ; C7AA= A2 7F       ".
                stz STATE                      ; C7AC= 64 D0       dP
                lda $0366                    ; C7AE= AD 66 03    -f.
LC7B1:
                stz $02FF,x                  ; C7B1= 9E FF 02    ...
                dex                          ; C7B4= CA          J
                bne LC7B1                    ; C7B5= D0 FA       Pz
                sta $0366                    ; C7B7= 8D 66 03    .f.
                lda $DA                      ; C7BA= A5 DA       %Z

                ; VDU 22 - MODE
                ; -------------
LC7BC:
                stz $028A                    ; C7BC= 9C 8A 02    ...
                stz $028B                    ; C7BF= 9C 8B 02    ...
                tay                          ; C7C2= A8          (
                bmi LC7D5                    ; C7C3= 30 10       0.
                ldx $027F                    ; C7C5= AE 7F 02    ...
                beq LC7D5                    ; C7C8= F0 0B       p.
                lda #$10                     ; C7CA= A9 10       ).
                trb STATE                      ; C7CC= 14 D0       .P
                lda #$03                     ; C7CE= A9 03       ).
                trb ACCCON                    ; C7D0= 1C 34 FE    .4~
                bra LC7DE                    ; C7D3= 80 09       ..

LC7D5:
                lda #$10                     ; C7D5= A9 10       ).
                tsb STATE                      ; C7D7= 04 D0       .P
                lda #$03                     ; C7D9= A9 03       ).
                tsb ACCCON                    ; C7DB= 0C 34 FE    .4~
LC7DE:
                tya                          ; C7DE= 98          .
                and #$07                     ; C7DF= 29 07       ).
                tax                          ; C7E1= AA          *
                stx $0355                    ; C7E2= 8E 55 03    .U.
                lda LE13C,x                  ; C7E5= BD 3C E1    =<a
                sta $0360                    ; C7E8= 8D 60 03    .`.
                lda LE119,x                  ; C7EB= BD 19 E1    =.a
                sta $034F                    ; C7EE= 8D 4F 03    .O.
                lda LE162,x                  ; C7F1= BD 62 E1    =ba
                sta $0361                    ; C7F4= 8D 61 03    .a.
                bne LC7FB                    ; C7F7= D0 02       P.
                lda #$07                     ; C7F9= A9 07       ).
LC7FB:
                asl a                        ; C7FB= 0A          .
                tay                          ; C7FC= A8          (
                lda LE12E,y                  ; C7FD= B9 2E E1    9.a
                sta $0363                    ; C800= 8D 63 03    .c.
LC803:
                asl a                        ; C803= 0A          .
                bpl LC803                    ; C804= 10 FD       .}
                sta $0362                    ; C806= 8D 62 03    .b.
                ldy LE168,x                  ; C809= BC 68 E1    <ha
                sty $0356                    ; C80C= 8C 56 03    .V.
                lda LE174,y                  ; C80F= B9 74 E1    9ta
                php                          ; C812= 08          .
                sei                          ; C813= 78          x
                sta systemVIA.orb            ; C814= 8D 40 FE    .@~
                lda LE170,y                  ; C817= B9 70 E1    9pa
                sta systemVIA.orb            ; C81A= 8D 40 FE    .@~
                plp                          ; C81D= 28          (
                lda LE179,y                  ; C81E= B9 79 E1    9ya
                sta $0354                    ; C821= 8D 54 03    .T.
                lda LE17E,y                  ; C824= B9 7E E1    9~a
                sta $034E                    ; C827= 8D 4E 03    .N.
                lda #$EE                     ; C82A= A9 EE       )n
                trb STATE                      ; C82C= 14 D0       .P
                ldx $0355                    ; C82E= AE 55 03    .U.
                lda LE111,x                  ; C831= BD 11 E1    =.a
                jsr LF250                    ; C834= 20 50 F2     Pr
                php                          ; C837= 08          .
                sei                          ; C838= 78          x
                ldx LE183,y                  ; C839= BE 83 E1    >.a
                ldy #$0B                     ; C83C= A0 0B        .
LC83E:
                lda LE188,x                  ; C83E= BD 88 E1    =.a
                jsr LCF01                    ; C841= 20 01 CF     .O
                dex                          ; C844= CA          J
                dey                          ; C845= 88          .
                bpl LC83E                    ; C846= 10 F6       .v
                plp                          ; C848= 28          (
                jsr LC5C5                    ; C849= 20 C5 C5     EE
                jsr LCF6D                    ; C84C= 20 6D CF     mO
                lda #$AA                     ; C84F= A9 AA       )*
                sta $0367                    ; C851= 8D 67 03    .g.
                sta $0368                    ; C854= 8D 68 03    .h.
                jsr LC6AA                    ; C857= 20 AA C6     *F
                lda $034C                    ; C85A= AD 4C 03    -L.
                ldx $034D                    ; C85D= AE 4D 03    .M.
                sta $0352                    ; C860= 8D 52 03    .R.
                stx $0353                    ; C863= 8E 53 03    .S.

                ; Do a fast hardware CLS of the whole screen
                ; ------------------------------------------
LC866:
                ldx #$00                     ; C866= A2 00       ".
                lda $034E                    ; C868= AD 4E 03    -N.
                stz $0350                    ; C86B= 9C 50 03    .P.
                sta $0351                    ; C86E= 8D 51 03    .Q.
                jsr LC6DD                    ; C871= 20 DD C6     ]F
                ldy #$0C                     ; C874= A0 0C        .
                jsr LC711                    ; C876= 20 11 C7     .G
                stz $0269                    ; C879= 9C 69 02    .i.
                sec                          ; C87C= 38          8
                lda #$80                     ; C87D= A9 80       ).
                sbc $034E                    ; C87F= ED 4E 03    mN.
                tax                          ; C882= AA          *
                ldy #$00                     ; C883= A0 00        .
                jsr LCB84                    ; C885= 20 84 CB     .K
                jmp LC47C                    ; C888= 4C 7C C4    L|D

LC88B:
                jsr LC8CF                    ; Clear paged mode counter
LC88E:
                jsr osbyte76    ; Call KEYV to test Shift & Ctrl keys
                bcc LC895                    ; Ctrl not pressed, exit loop
                bmi LC88B                    ; Shift pressed, loop back
LC895:
                lda STATE                      ; C895= A5 D0       %P
                eor #$04                     ; C897= 49 04       I.
                and #$46                     ; C899= 29 46       )F
                bne LC8D6                    ; C89B= D0 39       P9
                jsr LC8D7                    ; C89D= 20 D7 C8     WH
                lda $0318,y                  ; C8A0= B9 18 03    9..
                cmp $0308,x                  ; C8A3= DD 08 03    ]..
                bne LC8D3                    ; C8A6= D0 2B       P+
                sec                          ; C8A8= 38          8
                iny                          ; C8A9= C8          H
                dey                          ; C8AA= 88          .
                bne LC8B5                    ; C8AB= D0 08       P.
                lda $030A                    ; C8AD= AD 0A 03    -..
                sbc $0308                    ; C8B0= ED 08 03    m..
                bra LC8BB                    ; C8B3= 80 06       ..

LC8B5:
                lda $0309                    ; C8B5= AD 09 03    -..
                sbc $030B                    ; C8B8= ED 0B 03    m..
LC8BB:
                pha                          ; C8BB= 48          H
                lsr a                        ; C8BC= 4A          J
                lsr a                        ; C8BD= 4A          J
                sta $DA                      ; C8BE= 85 DA       .Z
                sec                          ; C8C0= 38          8
                pla                          ; C8C1= 68          h
                sbc $DA                      ; C8C2= E5 DA       eZ
                cmp $0269                    ; C8C4= CD 69 02    Mi.
                bcs LC8D3                    ; C8C7= B0 0A       0.
LC8C9:
                jsr osbyte76                    ; C8C9= 20 30 F2     0r
                sec                          ; C8CC= 38          8
                bpl LC8C9                    ; C8CD= 10 FA       .z

LC8CF:
                stz $0269                    ; Clear paged mode counter
                nop                          ; C8D2= EA          j
LC8D3:
                inc $0269                    ; C8D3= EE 69 02    ni.
LC8D6:
                rts                          ; C8D6= 60          `

LC8D7:
                lda $0366                    ; C8D7= AD 66 03    -f.
                and #$0E                     ; C8DA= 29 0E       ).
                lsr a                        ; C8DC= 4A          J
                tax                          ; C8DD= AA          *
                lda LE204,x                  ; C8DE= BD 04 E2    =.b
                tax                          ; C8E1= AA          *
                and #$01                     ; C8E2= 29 01       ).
                tay                          ; C8E4= A8          (
                rts                          ; C8E5= 60          `

LC8E6:
                ldy #$24                     ; C8E6= A0 24        $
                jsr LD5B7                    ; C8E8= 20 B7 D5     7U
                phy                          ; C8EB= 5A          Z
                phx                          ; C8EC= DA          Z
                jsr LD5CC                    ; C8ED= 20 CC D5     LU
                pla                          ; C8F0= 68          h
                phy                          ; C8F1= 5A          Z
                ldy #$28                     ; C8F2= A0 28        (
                jsr LC8F9                    ; C8F4= 20 F9 C8     yH
                plx                          ; C8F7= FA          z
                pla                          ; C8F8= 68          h
LC8F9:
                pha                          ; C8F9= 48          H
                jsr LC90C                    ; C8FA= 20 0C C9     .I
                plx                          ; C8FD= FA          z
                inx                          ; C8FE= E8          h
                inx                          ; C8FF= E8          h
                bra LC90C                    ; C900= 80 0A       ..

LC902:
                ldy #$28                     ; C902= A0 28        (
LC904:
                lda #$08                     ; C904= A9 08       ).
                bra LC920                    ; C906= 80 18       ..

LC908:
                ldx #$4C                     ; C908= A2 4C       "L
                ldy #$28                     ; C90A= A0 28        (
LC90C:
                lda #$02                     ; C90C= A9 02       ).
                bra LC920                    ; C90E= 80 10       ..

LC910:
                ldx #$08                     ; C910= A2 08       ".
                ldy #$2C                     ; C912= A0 2C        ,
                bra LC91E                    ; C914= 80 08       ..

LC916:
                ldx #$20                     ; C916= A2 20       "
                bra LC91E                    ; C918= 80 04       ..

LC91A:
                ldy #$14                     ; C91A= A0 14        .
LC91C:
                ldx #$24                     ; C91C= A2 24       "$
LC91E:
                lda #$04                     ; C91E= A9 04       ).
LC920:
                pha                          ; C920= 48          H
                lda $0300,x                  ; C921= BD 00 03    =..
                sta $0300,y                  ; C924= 99 00 03    ...
                inx                          ; C927= E8          h
                iny                          ; C928= C8          H
                pla                          ; C929= 68          h
                dec a                        ; C92A= 3A          :
                bne LC920                    ; C92B= D0 F3       Ps
                rts                          ; C92D= 60          `

LC92E:
                pha                          ; C92E= 48          H
                tya                          ; C92F= 98          .
                eor #$FF                     ; C930= 49 FF       I.
                tay                          ; C932= A8          (
                pla                          ; C933= 68          h
                eor #$FF                     ; C934= 49 FF       I.
                iny                          ; C936= C8          H
                bne LC93A                    ; C937= D0 01       P.
                inc a                        ; C939= 1A          .
LC93A:
                rts                          ; C93A= 60          `

LC93B:
                inc a                        ; C93B= 1A          .
LC93C:
                sta $DA                      ; C93C= 85 DA       .Z
                stz $DB                      ; C93E= 64 DB       d[
                lda $034F                    ; C940= AD 4F 03    -O.
LC943:
                lsr a                        ; C943= 4A          J
                bcs LC94C                    ; C944= B0 06       0.
                asl $DA                      ; C946= 06 DA       .Z
                rol $DB                      ; C948= 26 DB       &[
                bra LC943                    ; C94A= 80 F7       .w

LC94C:
                lda $DA                      ; C94C= A5 DA       %Z
                ldx $DB                      ; C94E= A6 DB       &[
                rts                          ; C950= 60          `

LC951:
                ldx #$08                     ; C951= A2 08       ".
                stx $0359                    ; C953= 8E 59 03    .Y.
                lda $035C                    ; C956= AD 5C 03    -\.
                and #$0F                     ; C959= 29 0F       ).
                sta $035A                    ; C95B= 8D 5A 03    .Z.
                rts                          ; C95E= 60          `

LC95F:
                lda #$00                     ; C95F= A9 00       ).
                pha                          ; C961= 48          H
                pha                          ; C962= 48          H
                ldx $032A                    ; C963= AE 2A 03    .*.
                jsr LCC7D                    ; C966= 20 7D CC     }L
                bra LC97F                    ; C969= 80 14       ..

LC96B:
                sec                          ; C96B= 38          8
                lda $034F                    ; C96C= AD 4F 03    -O.
                sbc $032A                    ; C96F= ED 2A 03    m*.
                pha                          ; C972= 48          H
                jsr LE2A2                    ; C973= 20 A2 E2     "b
                phx                          ; C976= DA          Z
                lda #$00                     ; C977= A9 00       ).
                ldx $032A                    ; C979= AE 2A 03    .*.
                jsr LCC5D                    ; C97C= 20 5D CC     ]L
LC97F:
                stx $0350                    ; C97F= 8E 50 03    .P.
                sta $0351                    ; C982= 8D 51 03    .Q.
                plx                          ; C985= FA          z
                ldy #$00                     ; C986= A0 00        .
                jsr LCCB0                    ; C988= 20 B0 CC     0L
                plx                          ; C98B= FA          z
                lda #$00                     ; C98C= A9 00       ).
                jsr LCC5D                    ; C98E= 20 5D CC     ]L
                stx $D8                      ; C991= 86 D8       .X
                sta $D9                      ; C993= 85 D9       .Y
                jsr LE2A2                    ; C995= 20 A2 E2     "b
                jsr LCAAE                    ; C998= 20 AE CA     .J
                bra LC9B8                    ; C99B= 80 1B       ..

LC99D:
                ldy #$00                     ; C99D= A0 00        .
                jsr LCC77                    ; C99F= 20 77 CC     wL
                bra LC9AA                    ; C9A2= 80 06       ..

LC9A4:
                jsr LE2A2                    ; C9A4= 20 A2 E2     "b
                jsr LCC57                    ; C9A7= 20 57 CC     WL
LC9AA:
                stx $0350                    ; C9AA= 8E 50 03    .P.
                sta $0351                    ; C9AD= 8D 51 03    .Q.
                ldx #$00                     ; C9B0= A2 00       ".
                jsr LCCB0                    ; C9B2= 20 B0 CC     0L
                jsr LCAE8                    ; C9B5= 20 E8 CA     hJ
LC9B8:
                ldy #$0C                     ; C9B8= A0 0C        .
                lda $0351                    ; C9BA= AD 51 03    -Q.
                ldx $0350                    ; C9BD= AE 50 03    .P.
                jmp LC6F5                    ; C9C0= 4C F5 C6    LuF

LC9C3:
                jsr LCCA0                    ; C9C3= 20 A0 CC      L
LC9C6:
                sta $DD                      ; C9C6= 85 DD       .]
                stx $DC                      ; C9C8= 86 DC       .\
                jsr LCC2C                    ; C9CA= 20 2C CC     ,L
                lda $0329                    ; C9CD= AD 29 03    -).
                ldx $0328                    ; C9D0= AE 28 03    .(.
                jsr LCC5D                    ; C9D3= 20 5D CC     ]L
                jsr LCC88                    ; C9D6= 20 88 CC     .L
                stx $D8                      ; C9D9= 86 D8       .X
                sta $D9                      ; C9DB= 85 D9       .Y
                lda #$00                     ; C9DD= A9 00       ).
                ldx $032A                    ; C9DF= AE 2A 03    .*.
                jsr LCC7D                    ; C9E2= 20 7D CC     }L
                jsr LCC88                    ; C9E5= 20 88 CC     .L
                stx $DA                      ; C9E8= 86 DA       .Z
                sta $DB                      ; C9EA= 85 DB       .[
                ldy $0328                    ; C9EC= AC 28 03    ,(.
                ldx $0329                    ; C9EF= AE 29 03    .).
                bvc LCA17                    ; C9F2= 50 23       P#
                ldy $E0                      ; C9F4= A4 E0       $`
                ldx $E1                      ; C9F6= A6 E1       &a
                jsr LCBE7                    ; C9F8= 20 E7 CB     gK
                ldy $E0                      ; C9FB= A4 E0       $`
                bcc LCA08                    ; C9FD= 90 09       ..
                ldx #$80                     ; C9FF= A2 80       ".
                stx $DB                      ; CA01= 86 DB       .[
                stz $DA                      ; CA03= 64 DA       dZ
                ldy $032A                    ; CA05= AC 2A 03    ,*.
LCA08:
                ldx #$00                     ; CA08= A2 00       ".
                jsr LCBF3                    ; CA0A= 20 F3 CB     sK
                ldx #$80                     ; CA0D= A2 80       ".
                stx $D9                      ; CA0F= 86 D9       .Y
                stz $D8                      ; CA11= 64 D8       dX
                ldy $DE                      ; CA13= A4 DE       $^
                ldx $DF                      ; CA15= A6 DF       &_
LCA17:
                jsr LCBE7                    ; CA17= 20 E7 CB     gK
                jsr LCC97                    ; CA1A= 20 97 CC     .L
                jsr LCC94                    ; CA1D= 20 94 CC     .L
                jsr LCC57                    ; CA20= 20 57 CC     WL
                stx $D8                      ; CA23= 86 D8       .X
                sta $D9                      ; CA25= 85 D9       .Y
                dec $032B                    ; CA27= CE 2B 03    N+.
                bpl LC9C6                    ; CA2A= 10 9A       ..
                rts                          ; CA2C= 60          `

LCA2D:
                jsr LCCA0                    ; CA2D= 20 A0 CC      L
LCA30:
                jsr LCC2C                    ; CA30= 20 2C CC     ,L
                lda #$00                     ; CA33= A9 00       ).
                ldx $032A                    ; CA35= AE 2A 03    .*.
                jsr LCC5D                    ; CA38= 20 5D CC     ]L
                stx $DA                      ; CA3B= 86 DA       .Z
                sta $DB                      ; CA3D= 85 DB       .[
                jsr LCC57                    ; CA3F= 20 57 CC     WL
                stx $DC                      ; CA42= 86 DC       .\
                sta $DD                      ; CA44= 85 DD       .]
                ldy $0328                    ; CA46= AC 28 03    ,(.
                ldx $0329                    ; CA49= AE 29 03    .).
                bvc LCA73                    ; CA4C= 50 25       P%
                ldy $DE                      ; CA4E= A4 DE       $^
                ldx $DF                      ; CA50= A6 DF       &_
                jsr LCBA8                    ; CA52= 20 A8 CB     (K
                ldy $DE                      ; CA55= A4 DE       $^
                bcc LCA63                    ; CA57= 90 0A       ..
                ldx $034E                    ; CA59= AE 4E 03    .N.
                stx $DB                      ; CA5C= 86 DB       .[
                stz $DA                      ; CA5E= 64 DA       dZ
                ldy $032A                    ; CA60= AC 2A 03    ,*.
LCA63:
                ldx #$00                     ; CA63= A2 00       ".
                jsr LCBB4                    ; CA65= 20 B4 CB     4K
                ldx $034E                    ; CA68= AE 4E 03    .N.
                stx $D9                      ; CA6B= 86 D9       .Y
                stz $D8                      ; CA6D= 64 D8       dX
                ldy $E0                      ; CA6F= A4 E0       $`
                ldx $E1                      ; CA71= A6 E1       &a
LCA73:
                jsr LCBA8                    ; CA73= 20 A8 CB     (K
                jsr LCC94                    ; CA76= 20 94 CC     .L
                dec $032B                    ; CA79= CE 2B 03    N+.
                bpl LCA30                    ; CA7C= 10 B2       .2
LCA7E:
                rts                          ; CA7E= 60          `

LCA7F:
                stx $DC                      ; CA7F= 86 DC       .\
                tax                          ; CA81= AA          *
                sec                          ; CA82= 38          8
                sbc $DC                      ; CA83= E5 DC       e\
                beq LCA7E                    ; CA85= F0 F7       pw
                sta $DD                      ; CA87= 85 DD       .]
                phx                          ; CA89= DA          Z
                jsr LC93C                    ; CA8A= 20 3C C9     <I
                plx                          ; CA8D= FA          z
                lda $0366                    ; CA8E= AD 66 03    -f.
                bit #$08                     ; CA91= 89 08       ..
                bne LCAA0                    ; CA93= D0 0B       P.
                bit #$02                     ; CA95= 89 02       ..
                jsr LCCCA                    ; CA97= 20 CA CC     JL
                ldy $DA                      ; CA9A= A4 DA       $Z
                ldx $DB                      ; CA9C= A6 DB       &[
                bra LCACE                    ; CA9E= 80 2E       ..

LCAA0:
                bit #$04                     ; CAA0= 89 04       ..
                jsr LCCCA                    ; CAA2= 20 CA CC     JL
                lda $034F                    ; CAA5= AD 4F 03    -O.
                sta $032A                    ; CAA8= 8D 2A 03    .*.
                ldy $DD                      ; CAAB= A4 DD       $]
                dey                          ; CAAD= 88          .
LCAAE:
                tya                          ; CAAE= 98          .
                beq LCAC9                    ; CAAF= F0 18       p.
                sty $DC                      ; CAB1= 84 DC       .\
LCAB3:
                jsr LCC57                    ; CAB3= 20 57 CC     WL
                stx $DA                      ; CAB6= 86 DA       .Z
                sta $DB                      ; CAB8= 85 DB       .[
                jsr LCAC9                    ; CABA= 20 C9 CA     IJ
                ldx $DA                      ; CABD= A6 DA       &Z
                stx $D8                      ; CABF= 86 D8       .X
                lda $DB                      ; CAC1= A5 DB       %[
                sta $D9                      ; CAC3= 85 D9       .Y
                dec $DC                      ; CAC5= C6 DC       F\
                bne LCAB3                    ; CAC7= D0 EA       Pj
LCAC9:
                ldx #$00                     ; CAC9= A2 00       ".
                ldy $032A                    ; CACB= AC 2A 03    ,*.
LCACE:
                lda $0328                    ; CACE= AD 28 03    -(.
                pha                          ; CAD1= 48          H
                lda $0329                    ; CAD2= AD 29 03    -).
                pha                          ; CAD5= 48          H
                sty $0328                    ; CAD6= 8C 28 03    .(.
                stx $0329                    ; CAD9= 8E 29 03    .).
                jsr LCAE8                    ; CADC= 20 E8 CA     hJ
                pla                          ; CADF= 68          h
                sta $0329                    ; CAE0= 8D 29 03    .).
                pla                          ; CAE3= 68          h
                sta $0328                    ; CAE4= 8D 28 03    .(.
                rts                          ; CAE7= 60          `

LCAE8:
                ldx $D8                      ; CAE8= A6 D8       &X
                lda $D9                      ; CAEA= A5 D9       %Y
                jsr LCC2C                    ; CAEC= 20 2C CC     ,L
                bra LCB6A                    ; CAEF= 80 79       .y

LCAF1:
                ldx #$77                     ; CAF1= A2 77       "w
                lda #$CC                     ; CAF3= A9 CC       )L
                ldy $032D                    ; CAF5= AC 2D 03    ,-.
                bra LCB01                    ; CAF8= 80 07       ..

LCAFA:
                ldx #$57                     ; CAFA= A2 57       "W
                lda #$CC                     ; CAFC= A9 CC       )L
                ldy $032F                    ; CAFE= AC 2F 03    ,/.
LCB01:
                stx $035D                    ; CB01= 8E 5D 03    .].
                sta $035E                    ; CB04= 8D 5E 03    .^.
                sec                          ; CB07= 38          8
                lda $032D                    ; CB08= AD 2D 03    --.
                sbc $032F                    ; CB0B= ED 2F 03    m/.
                sta $032B                    ; CB0E= 8D 2B 03    .+.
                ldx $032C                    ; CB11= AE 2C 03    .,.
                jsr LCCB0                    ; CB14= 20 B0 CC     0L
                sta $DD                      ; CB17= 85 DD       .]
                stx $DC                      ; CB19= 86 DC       .\
                jsr LCC2C                    ; CB1B= 20 2C CC     ,L
                lda $032B                    ; CB1E= AD 2B 03    -+.
                beq LCB6A                    ; CB21= F0 47       pG
LCB23:
                php                          ; CB23= 08          .
                jsr LC024                    ; CB24= 20 24 C0     $@
                stx $DA                      ; CB27= 86 DA       .Z
                sta $DB                      ; CB29= 85 DB       .[
                stx $DC                      ; CB2B= 86 DC       .\
                sta $DD                      ; CB2D= 85 DD       .]
                plp                          ; CB2F= 28          (
                bvc LCB4F                    ; CB30= 50 1D       P.
                clv                          ; CB32= B8          8
LCB33:
                ldx $DF                      ; CB33= A6 DF       &_
                ldy $DE                      ; CB35= A4 DE       $^
                jsr LCBB4                    ; CB37= 20 B4 CB     4K
                lda $034E                    ; CB3A= AD 4E 03    -N.
                bvs LCB45                    ; CB3D= 70 06       p.
                sta $D9                      ; CB3F= 85 D9       .Y
                stz $D8                      ; CB41= 64 D8       dX
                bra LCB49                    ; CB43= 80 04       ..

LCB45:
                sta $DB                      ; CB45= 85 DB       .[
                stz $DA                      ; CB47= 64 DA       dZ
LCB49:
                ldx $E1                      ; CB49= A6 E1       &a
                ldy $E0                      ; CB4B= A4 E0       $`
                bra LCB5A                    ; CB4D= 80 0B       ..

LCB4F:
                jsr LCC2C                    ; CB4F= 20 2C CC     ,L
                bvs LCB33                    ; CB52= 70 DF       p_
                ldx $0329                    ; CB54= AE 29 03    .).
                ldy $0328                    ; CB57= AC 28 03    ,(.
LCB5A:
                jsr LCBB4                    ; CB5A= 20 B4 CB     4K
                ldx $DC                      ; CB5D= A6 DC       &\
                stx $D8                      ; CB5F= 86 D8       .X
                lda $DD                      ; CB61= A5 DD       %]
                sta $D9                      ; CB63= 85 D9       .Y
                dec $032B                    ; CB65= CE 2B 03    N+.
                bne LCB23                    ; CB68= D0 B9       P9
LCB6A:
                ldx $0329                    ; CB6A= AE 29 03    .).
                ldy $0328                    ; CB6D= AC 28 03    ,(.
                bvc LCB84                    ; CB70= 50 12       P.
                ldx $DF                      ; CB72= A6 DF       &_
                ldy $DE                      ; CB74= A4 DE       $^
                jsr LCB84                    ; CB76= 20 84 CB     .K
                lda $034E                    ; CB79= AD 4E 03    -N.
                sta $D9                      ; CB7C= 85 D9       .Y
                stz $D8                      ; CB7E= 64 D8       dX
                ldx $E1                      ; CB80= A6 E1       &a
                ldy $E0                      ; CB82= A4 E0       $`
LCB84:
                tya                          ; CB84= 98          .
                clc                          ; CB85= 18          .
                adc $D8                      ; CB86= 65 D8       eX
                sta $D8                      ; CB88= 85 D8       .X
                bcs LCB8E                    ; CB8A= B0 02       0.
                dec $D9                      ; CB8C= C6 D9       FY
LCB8E:
                tya                          ; CB8E= 98          .
                eor #$FF                     ; CB8F= 49 FF       I.
                tay                          ; CB91= A8          (
                lsr a                        ; CB92= 4A          J
                lda $0358                    ; CB93= AD 58 03    -X.
                bcs LCB9F                    ; CB96= B0 07       0.
                bra LCB9C                    ; CB98= 80 02       ..

LCB9A:
                sta ($D8),y                  ; CB9A= 91 D8       .X
LCB9C:
                iny                          ; CB9C= C8          H
                sta ($D8),y                  ; CB9D= 91 D8       .X
LCB9F:
                iny                          ; CB9F= C8          H
                bne LCB9A                    ; CBA0= D0 F8       Px
                inc $D9                      ; CBA2= E6 D9       fY
                dex                          ; CBA4= CA          J
                bpl LCB9A                    ; CBA5= 10 F3       .s
                rts                          ; CBA7= 60          `

LCBA8:
                sec                          ; CBA8= 38          8
                tya                          ; CBA9= 98          .
                sbc $032A                    ; CBAA= ED 2A 03    m*.
                tay                          ; CBAD= A8          (
                bcs LCBB4                    ; CBAE= B0 04       0.
                dex                          ; CBB0= CA          J
                bmi LCBE6                    ; CBB1= 30 33       03
                sec                          ; CBB3= 38          8
LCBB4:
                php                          ; CBB4= 08          .
                tya                          ; CBB5= 98          .
                clc                          ; CBB6= 18          .
                adc $DA                      ; CBB7= 65 DA       eZ
                sta $DA                      ; CBB9= 85 DA       .Z
                bcs LCBBF                    ; CBBB= B0 02       0.
                dec $DB                      ; CBBD= C6 DB       F[
LCBBF:
                tya                          ; CBBF= 98          .
                clc                          ; CBC0= 18          .
                adc $D8                      ; CBC1= 65 D8       eX
                sta $D8                      ; CBC3= 85 D8       .X
                bcs LCBC9                    ; CBC5= B0 02       0.
                dec $D9                      ; CBC7= C6 D9       FY
LCBC9:
                tya                          ; CBC9= 98          .
                eor #$FF                     ; CBCA= 49 FF       I.
                tay                          ; CBCC= A8          (
                lsr a                        ; CBCD= 4A          J
                bcs LCBDB                    ; CBCE= B0 0B       0.
                bra LCBD6                    ; CBD0= 80 04       ..

LCBD2:
                lda ($DA),y                  ; CBD2= B1 DA       1Z
                sta ($D8),y                  ; CBD4= 91 D8       .X
LCBD6:
                iny                          ; CBD6= C8          H
                lda ($DA),y                  ; CBD7= B1 DA       1Z
                sta ($D8),y                  ; CBD9= 91 D8       .X
LCBDB:
                iny                          ; CBDB= C8          H
                bne LCBD2                    ; CBDC= D0 F4       Pt
                inc $DB                      ; CBDE= E6 DB       f[
                inc $D9                      ; CBE0= E6 D9       fY
                dex                          ; CBE2= CA          J
                bpl LCBD2                    ; CBE3= 10 ED       .m
LCBE5:
                plp                          ; CBE5= 28          (
LCBE6:
                rts                          ; CBE6= 60          `

LCBE7:
                sec                          ; CBE7= 38          8
                tya                          ; CBE8= 98          .
                sbc $032A                    ; CBE9= ED 2A 03    m*.
                tay                          ; CBEC= A8          (
                bcs LCBF3                    ; CBED= B0 04       0.
                dex                          ; CBEF= CA          J
                bmi LCBE6                    ; CBF0= 30 F4       0t
                sec                          ; CBF2= 38          8
LCBF3:
                php                          ; CBF3= 08          .
                tya                          ; CBF4= 98          .
                eor #$FF                     ; CBF5= 49 FF       I.
                pha                          ; CBF7= 48          H
                sec                          ; CBF8= 38          8
                adc $DA                      ; CBF9= 65 DA       eZ
                sta $DA                      ; CBFB= 85 DA       .Z
                bcs LCC01                    ; CBFD= B0 02       0.
                dec $DB                      ; CBFF= C6 DB       F[
LCC01:
                pla                          ; CC01= 68          h
                sec                          ; CC02= 38          8
                adc $D8                      ; CC03= 65 D8       eX
                sta $D8                      ; CC05= 85 D8       .X
                bcs LCC0B                    ; CC07= B0 02       0.
                dec $D9                      ; CC09= C6 D9       FY
LCC0B:
                tya                          ; CC0B= 98          .
                lsr a                        ; CC0C= 4A          J
                bcs LCC23                    ; CC0D= B0 14       0.
                bne LCC1E                    ; CC0F= D0 0D       P.
LCC11:
                dex                          ; CC11= CA          J
                bmi LCBE5                    ; CC12= 30 D1       0Q
                dec $DB                      ; CC14= C6 DB       F[
                dec $D9                      ; CC16= C6 D9       FY
                bra LCC1E                    ; CC18= 80 04       ..

LCC1A:
                lda ($DA),y                  ; CC1A= B1 DA       1Z
                sta ($D8),y                  ; CC1C= 91 D8       .X
LCC1E:
                dey                          ; CC1E= 88          .
                lda ($DA),y                  ; CC1F= B1 DA       1Z
                sta ($D8),y                  ; CC21= 91 D8       .X
LCC23:
                dey                          ; CC23= 88          .
                bne LCC1A                    ; CC24= D0 F4       Pt
                lda ($DA)                    ; CC26= B2 DA       2Z
                sta ($D8)                    ; CC28= 92 D8       .X
                bra LCC11                    ; CC2A= 80 E5       .e

LCC2C:
                pha                          ; CC2C= 48          H
                txa                          ; CC2D= 8A          .
                clc                          ; CC2E= 18          .
                adc $0328                    ; CC2F= 6D 28 03    m(.
                tax                          ; CC32= AA          *
LCC33:
                pla                          ; CC33= 68          h
                adc $0329                    ; CC34= 6D 29 03    m).
                bvc LCC56                    ; CC37= 50 1D       P.
                stx $E0                      ; CC39= 86 E0       .`
                and #$7F                     ; CC3B= 29 7F       ).
                sta $E1                      ; CC3D= 85 E1       .a
                ora $E0                      ; CC3F= 05 E0       .`
                beq LCC55                    ; CC41= F0 12       p.
                php                          ; CC43= 08          .
                sec                          ; CC44= 38          8
                lda $0328                    ; CC45= AD 28 03    -(.
                sbc $E0                      ; CC48= E5 E0       e`
                sta $DE                      ; CC4A= 85 DE       .^
                lda $0329                    ; CC4C= AD 29 03    -).
                sbc $E1                      ; CC4F= E5 E1       ea
                sta $DF                      ; CC51= 85 DF       ._
                plp                          ; CC53= 28          (
                rts                          ; CC54= 60          `

LCC55:
                clv                          ; CC55= B8          8
LCC56:
                rts                          ; CC56= 60          `

LCC57:
                lda $0353                    ; CC57= AD 53 03    -S.
                ldx $0352                    ; CC5A= AE 52 03    .R.
LCC5D:
                clc                          ; CC5D= 18          .
LCC5E:
                php                          ; CC5E= 08          .
                pha                          ; CC5F= 48          H
                txa                          ; CC60= 8A          .
                adc $D8                      ; CC61= 65 D8       eX
                tax                          ; CC63= AA          *
                pla                          ; CC64= 68          h
                adc $D9                      ; CC65= 65 D9       eY
                bpl LCC6D                    ; CC67= 10 04       ..
                sec                          ; CC69= 38          8
                sbc $0354                    ; CC6A= ED 54 03    mT.
LCC6D:
                cmp $034E                    ; CC6D= CD 4E 03    MN.
                bcs LCC75                    ; CC70= B0 03       0.
                adc $0354                    ; CC72= 6D 54 03    mT.
LCC75:
                plp                          ; CC75= 28          (
                rts                          ; CC76= 60          `

LCC77:
                lda $0353                    ; CC77= AD 53 03    -S.
                ldx $0352                    ; CC7A= AE 52 03    .R.
LCC7D:
                pha                          ; CC7D= 48          H
                txa                          ; CC7E= 8A          .
                eor #$FF                     ; CC7F= 49 FF       I.
                tax                          ; CC81= AA          *
                pla                          ; CC82= 68          h
                eor #$FF                     ; CC83= 49 FF       I.
                sec                          ; CC85= 38          8
                bra LCC5E                    ; CC86= 80 D6       .V

LCC88:
                cmp $034E                    ; CC88= CD 4E 03    MN.
                bne LCC93                    ; CC8B= D0 06       P.
                cpx #$00                     ; CC8D= E0 00       `.
                bne LCC93                    ; CC8F= D0 02       P.
                lda #$80                     ; CC91= A9 80       ).
LCC93:
                rts                          ; CC93= 60          `

LCC94:
                jsr LCAC9                    ; CC94= 20 C9 CA     IJ
LCC97:
                ldx $DC                      ; CC97= A6 DC       &\
                stx $D8                      ; CC99= 86 D8       .X
                lda $DD                      ; CC9B= A5 DD       %]
                sta $D9                      ; CC9D= 85 D9       .Y
                rts                          ; CC9F= 60          `

LCCA0:
                sec                          ; CCA0= 38          8
                lda $032D                    ; CCA1= AD 2D 03    --.
                sbc $032F                    ; CCA4= ED 2F 03    m/.
                sta $032B                    ; CCA7= 8D 2B 03    .+.
                ldx $032C                    ; CCAA= AE 2C 03    .,.
                ldy $032F                    ; CCAD= AC 2F 03    ,/.
LCCB0:
                lda $0318                    ; CCB0= AD 18 03    -..
                pha                          ; CCB3= 48          H
                lda $0319                    ; CCB4= AD 19 03    -..
                pha                          ; CCB7= 48          H
                stx $0318                    ; CCB8= 8E 18 03    ...
                sty $0319                    ; CCBB= 8C 19 03    ...
                jsr LCCFA                    ; CCBE= 20 FA CC     zL
                ply                          ; CCC1= 7A          z
                sty $0319                    ; CCC2= 8C 19 03    ...
                ply                          ; CCC5= 7A          z
                sty $0318                    ; CCC6= 8C 18 03    ...
                rts                          ; CCC9= 60          `

LCCCA:
                beq LCCCF                    ; CCCA= F0 03       p.
                dex                          ; CCCC= CA          J
                stx $DC                      ; CCCD= 86 DC       .\
LCCCF:
                lda $0366                    ; CCCF= AD 66 03    -f.
                and #$0E                     ; CCD2= 29 0E       ).
                tax                          ; CCD4= AA          *
                lda $DC                      ; CCD5= A5 DC       %\
LCCD7:
                jsr LC2C7                    ; CCD7= 20 C7 C2     GB
LCCDA:
                ldx $0318                    ; CCDA= AE 18 03    ...
                cpx $0308                    ; CCDD= EC 08 03    l..
                bmi LCCF8                    ; CCE0= 30 16       0.
                cpx $030A                    ; CCE2= EC 0A 03    l..
                beq LCCE9                    ; CCE5= F0 02       p.
                bpl LCCF8                    ; CCE7= 10 0F       ..
LCCE9:
                ldx $0319                    ; CCE9= AE 19 03    ...
                cpx $030B                    ; CCEC= EC 0B 03    l..
                bmi LCCF8                    ; CCEF= 30 07       0.
                cpx $0309                    ; CCF1= EC 09 03    l..
                bmi LCCFA                    ; CCF4= 30 04       0.
                beq LCCFA                    ; CCF6= F0 02       p.
LCCF8:
                sec                          ; CCF8= 38          8
                rts                          ; CCF9= 60          `

; Set up display address without using BBC lookup table at &E0/1
LCCFA:
                lda $0356                    ; Get memory map type 0-4
                and #$FE                     ; Reduce to 0,0,2,2,4
                tax                          ; Index into jump table
                ldy $0319                    ; Get current line
                jmp (LCD06,x)                ; Jump to calculation setup
LCD06:
                .word LCD21                  ; Memory map 0,1  MODE 0,1,2,3
                .word LCD15                  ; Memory map 2,3  MODE 4,5,6
                .word LCD0C                  ; Memory map 4    MODE 7

LCD0C:
                ldx LE0AF,y                  ; Get offset high byte for start of this line
                lda LE0C8,y                  ; Get offset low byte for start of this line
                clc
                bra LCD29                    ; CD13= 80 14       ..

LCD15:
                lda LE0E1,y                  ; CD15= B9 E1 E0    9a`
                lsr a                        ; CD18= 4A          J
                tax                          ; CD19= AA          *
                tya                          ; CD1A= 98          .
                and #$03                     ; CD1B= 29 03       ).
                lsr a                        ; CD1D= 4A          J
                ror a                        ; CD1E= 6A          j
                bra LCD28                    ; CD1F= 80 07       ..

LCD21:
                ldx LE0E1,y                  ; CD21= BE E1 E0    >a`
                tya                          ; CD24= 98          .
                and #$01                     ; CD25= 29 01       ).
                lsr a                        ; CD27= 4A          J
LCD28:
                ror a                        ; A=A/2 +(128*carry)

LCD29:
                adc $0350                    ; window area start address lo
                sta $D8                      ; store it
                txa
                adc $0351                    ; window start address hi
                tay
                lda $0318                    ; text column
                ldx $034F                    ; bytes per character
                dex
                beq LCD4E                    ; 1 colour, MODE 7
                cpx #$0F
                beq LCD43                    ; 4 colours, MODE 1 or MODE 5
                bcc LCD44                    ; 2 colours, MODE 0,3,4,6
                asl a                        ; 16 colours, MODE 2
LCD43:
                asl a                        ; CD43= 0A          .
LCD44:
                asl a                        ; CD44= 0A          .
                asl a                        ; CD45= 0A          .
                bcc LCD4A                    ; CD46= 90 02       ..
                iny                          ; CD48= C8          H
                iny                          ; CD49= C8          H
LCD4A:
                asl a                        ; CD4A= 0A          .
                bcc LCD4F                    ; CD4B= 90 02       ..
                iny                          ; CD4D= C8          H
LCD4E:
                clc                          ; CD4E= 18          .
LCD4F:
                adc $D8                      ; CD4F= 65 D8       eX
                sta $D8                      ; CD51= 85 D8       .X
                sta $034A                    ; CD53= 8D 4A 03    .J.
                tax                          ; CD56= AA          *
                tya                          ; CD57= 98          .
                adc #$00                     ; CD58= 69 00       i.
                sta $034B                    ; CD5A= 8D 4B 03    .K.
                bpl LCD63                    ; CD5D= 10 04       ..
                sec                          ; CD5F= 38          8
                sbc $0354                    ; CD60= ED 54 03    mT.
LCD63:
                sta $D9                      ; CD63= 85 D9       .Y
                clc                          ; CD65= 18          .
                rts                          ; CD66= 60          `

LCD67:
                inc $0324                    ; CD67= EE 24 03    n$.
                bne LCD6F                    ; CD6A= D0 03       P.
                inc $0325                    ; CD6C= EE 25 03    n%.
LCD6F:
                asl a                        ; CD6F= 0A          .
LCD70:
                bpl LCD67                    ; CD70= 10 F5       .u
                phy                          ; CD72= 5A          Z
                sta $DD                      ; CD73= 85 DD       .]
                ldx #$24                     ; CD75= A2 24       "$
                jsr LDEC8                    ; CD77= 20 C8 DE     H^
                bra LCD7E                    ; CD7A= 80 02       ..

LCD7C:
                bpl LCD81                    ; CD7C= 10 03       ..
LCD7E:
                jsr LDB51                    ; CD7E= 20 51 DB     Q[
LCD81:
                lsr ZMASK                      ; CD81= 46 D1       FQ
                bcc LCD88                    ; CD83= 90 03       ..
                jsr LDA67                    ; CD85= 20 67 DA     gZ
LCD88:
                asl $DD                      ; CD88= 06 DD       .]
                bne LCD7C                    ; CD8A= D0 F0       Pp
                ldx #$28                     ; CD8C= A2 28       "(
                ldy #$24                     ; CD8E= A0 24        $
                jsr LC90C                    ; CD90= 20 0C C9     .I
                ply                          ; CD93= 7A          z
                bra LCDE6                    ; CD94= 80 50       .P

LCD96:
                jsr LE22C                    ; CD96= 20 2C E2     ,b
                stz $0359                    ; CD99= 9C 59 03    .Y.
                lda $035B                    ; CD9C= AD 5B 03    -[.
                and #$0F                     ; CD9F= 29 0F       ).
LCDA1:
                sta $035A                    ; CDA1= 8D 5A 03    .Z.
                ldy #$28                     ; CDA4= A0 28        (
                jsr LC91C                    ; CDA6= 20 1C C9     .I
                ldy #$24                     ; CDA9= A0 24        $
                ldx #$00                     ; CDAB= A2 00       ".
                jsr LCEB4                    ; CDAD= 20 B4 CE     4N
                sta $DC                      ; CDB0= 85 DC       .\
                ldx #$04                     ; CDB2= A2 04       ".
                jsr LCEB4                    ; CDB4= 20 B4 CE     4N
                ror a                        ; CDB7= 6A          j
                trb $DC                      ; CDB8= 14 DC       .\
                ldx #$26                     ; CDBA= A2 26       "&
                ldy #$06                     ; CDBC= A0 06        .
                jsr LCEB4                    ; CDBE= 20 B4 CE     4N
                sta $DD                      ; CDC1= 85 DD       .]
                ldx #$26                     ; CDC3= A2 26       "&
                ldy #$02                     ; CDC5= A0 02        .
                jsr LCEB4                    ; CDC7= 20 B4 CE     4N
                ror a                        ; CDCA= 6A          j
                trb $DD                      ; CDCB= 14 DD       .]
                ldy #$07                     ; CDCD= A0 07        .
LCDCF:
                lda ($DE),y                  ; CDCF= B1 DE       1^
                and $DC                      ; CDD1= 25 DC       %\
                lsr $DD                      ; CDD3= 46 DD       F]
                bcs LCDD9                    ; CDD5= B0 02       0.
                lda #$00                     ; CDD7= A9 00       ).
LCDD9:
                sta $032C,y                  ; CDD9= 99 2C 03    .,.
                dey                          ; CDDC= 88          .
                bpl LCDCF                    ; CDDD= 10 F0       .p
                ldy #$F8                     ; CDDF= A0 F8        x
LCDE1:
                lda $0234,y                  ; CDE1= B9 34 02    94.
                bne LCD70                    ; CDE4= D0 8A       P.
LCDE6:
                ldx $0326                    ; CDE6= AE 26 03    .&.
                bne LCDEE                    ; CDE9= D0 03       P.
                dec $0327                    ; CDEB= CE 27 03    N'.
LCDEE:
                dec $0326                    ; CDEE= CE 26 03    N&.
                iny                          ; CDF1= C8          H
                bne LCDE1                    ; CDF2= D0 ED       Pm
                ldx #$2A                     ; CDF4= A2 2A       "*
                ldy #$26                     ; CDF6= A0 26        &
                jmp LC90C                    ; CDF8= 4C 0C C9    L.I

LCDFB:
                lda #$F8                     ; CDFB= A9 F8       )x
                sta $DE                      ; CDFD= 85 DE       .^
                lda #$BB                     ; CDFF= A9 BB       );
                sta $DF                      ; CE01= 85 DF       ._
                ldx #$08                     ; CE03= A2 08       ".
                stx $0359                    ; CE05= 8E 59 03    .Y.
                lda #$00                     ; CE08= A9 00       ).
                bra LCDA1                    ; CE0A= 80 95       ..

LCE0C:
                jsr LD12D                    ; CE0C= 20 2D D1     -Q
                bcs LCD96                    ; CE0F= B0 85       0.
                ldx $0360                    ; CE11= AE 60 03    .`.
                beq LCE4D                    ; CE14= F0 37       p7
                jsr LE22C                    ; CE16= 20 2C E2     ,b
LCE19:
                ldy #$07                     ; CE19= A0 07        .
                cpx #$03                     ; CE1B= E0 03       `.
                beq LCE53                    ; CE1D= F0 34       p4
                bcs LCE7C                    ; CE1F= B0 5B       0[
LCE21:
                lda ($DE),y                  ; CE21= B1 DE       1^
                ora ZORA                      ; CE23= 05 D2       .R
                eor ZEOR                      ; CE25= 45 D3       ES
                sta ($D8),y                  ; CE27= 91 D8       .X
                dey                          ; CE29= 88          .
                bpl LCE21                    ; CE2A= 10 F5       .u
                rts                          ; CE2C= 60          `

LCE2D:
                lda #$20                     ; CE2D= A9 20       )
                bit $0366                    ; CE2F= 2C 66 03    ,f.
                bne LCE37                    ; CE32= D0 03       P.
                jsr LC29A                    ; CE34= 20 9A C2     .B
LCE37:
                jsr LE2D2                    ; CE37= 20 D2 E2     Rb
                bne LCDFB                    ; CE3A= D0 BF       P?
                ldx $0360                    ; CE3C= AE 60 03    .`.
                beq LCE4B                    ; CE3F= F0 0A       p.
                lda #$00                     ; CE41= A9 00       ).
                sta $DE                      ; CE43= 85 DE       .^
                lda #$B9                     ; CE45= A9 B9       )9
                sta $DF                      ; CE47= 85 DF       ._
                bra LCE19                    ; CE49= 80 CE       .N

LCE4B:
                lda #$20                     ; CE4B= A9 20       )
LCE4D:
                jsr LDDE5                    ; CE4D= 20 E5 DD     e]
                sta ($D8)                    ; CE50= 92 D8       .X
                rts                          ; CE52= 60          `

LCE53:
                lda $D9                      ; CE53= A5 D9       %Y
                ldx $D8                      ; CE55= A6 D8       &X
                jsr LCEE7                    ; CE57= 20 E7 CE     gN
LCE5A:
                lda ($DE),y                  ; CE5A= B1 DE       1^
                and #$0F                     ; CE5C= 29 0F       ).
                tax                          ; CE5E= AA          *
                lda LE013,x                  ; CE5F= BD 13 E0    =.`
                ora ZORA                      ; CE62= 05 D2       .R
                eor ZEOR                      ; CE64= 45 D3       ES
                sta ($E0),y                  ; CE66= 91 E0       .`
                lda ($DE),y                  ; CE68= B1 DE       1^
                lsr a                        ; CE6A= 4A          J
                lsr a                        ; CE6B= 4A          J
                lsr a                        ; CE6C= 4A          J
                lsr a                        ; CE6D= 4A          J
                tax                          ; CE6E= AA          *
                lda LE013,x                  ; CE6F= BD 13 E0    =.`
                ora ZORA                      ; CE72= 05 D2       .R
                eor ZEOR                      ; CE74= 45 D3       ES
                sta ($D8),y                  ; CE76= 91 D8       .X
                dey                          ; CE78= 88          .
                bpl LCE5A                    ; CE79= 10 DF       ._
                rts                          ; CE7B= 60          `

LCE7C:
                lda $D9                      ; CE7C= A5 D9       %Y
                ldx $D8                      ; CE7E= A6 D8       &X
                jsr LCED9                    ; CE80= 20 D9 CE     YN
LCE83:
                lda ($DE),y                  ; CE83= B1 DE       1^
                jsr LCEA9                    ; CE85= 20 A9 CE     )N
                sta ($E0),y                  ; CE88= 91 E0       .`
                lda ($DE),y                  ; CE8A= B1 DE       1^
                lsr a                        ; CE8C= 4A          J
                lsr a                        ; CE8D= 4A          J
                pha                          ; CE8E= 48          H
                jsr LCEA9                    ; CE8F= 20 A9 CE     )N
                sta ($DC),y                  ; CE92= 91 DC       .\
                pla                          ; CE94= 68          h
                lsr a                        ; CE95= 4A          J
                lsr a                        ; CE96= 4A          J
                pha                          ; CE97= 48          H
                jsr LCEA9                    ; CE98= 20 A9 CE     )N
                sta ($DA),y                  ; CE9B= 91 DA       .Z
                pla                          ; CE9D= 68          h
                lsr a                        ; CE9E= 4A          J
                lsr a                        ; CE9F= 4A          J
                jsr LCEA9                    ; CEA0= 20 A9 CE     )N
                sta ($D8),y                  ; CEA3= 91 D8       .X
                dey                          ; CEA5= 88          .
                bpl LCE83                    ; CEA6= 10 DB       .[
                rts                          ; CEA8= 60          `

LCEA9:
                and #$03                     ; CEA9= 29 03       ).
                tax                          ; CEAB= AA          *
                lda LE023,x                  ; CEAC= BD 23 E0    =#`
                ora ZORA                      ; CEAF= 05 D2       .R
                eor ZEOR                      ; CEB1= 45 D3       ES
                rts                          ; CEB3= 60          `

LCEB4:
                sec                          ; CEB4= 38          8
                lda $0300,x                  ; CEB5= BD 00 03    =..
                sbc $0300,y                  ; CEB8= F9 00 03    y..
                sta $DA                      ; CEBB= 85 DA       .Z
                lda $0301,x                  ; CEBD= BD 01 03    =..
                sbc $0301,y                  ; CEC0= F9 01 03    y..
                bmi LCED1                    ; CEC3= 30 0C       0.
                bne LCED5                    ; CEC5= D0 0E       P.
                ldx $DA                      ; CEC7= A6 DA       &Z
                cpx #$08                     ; CEC9= E0 08       `.
                bcs LCED5                    ; CECB= B0 08       0.
                lda LE127,x                  ; CECD= BD 27 E1    ='a
                rts                          ; CED0= 60          `

LCED1:
                lda #$FF                     ; CED1= A9 FF       ).
                sec                          ; CED3= 38          8
                rts                          ; CED4= 60          `

LCED5:
                lda #$00                     ; CED5= A9 00       ).
                clc                          ; CED7= 18          .
                rts                          ; CED8= 60          `

LCED9:
                jsr LCEE7                    ; CED9= 20 E7 CE     gN
                stx $DA                      ; CEDC= 86 DA       .Z
                sta $DB                      ; CEDE= 85 DB       .[
                jsr LCEE7                    ; CEE0= 20 E7 CE     gN
                stx $DC                      ; CEE3= 86 DC       .\
                sta $DD                      ; CEE5= 85 DD       .]
LCEE7:
                pha                          ; CEE7= 48          H
                txa                          ; CEE8= 8A          .
                clc                          ; CEE9= 18          .
                adc #$08                     ; CEEA= 69 08       i.
                tax                          ; CEEC= AA          *
                pla                          ; CEED= 68          h
                bcc LCEF6                    ; CEEE= 90 06       ..
                inc a                        ; CEF0= 1A          .
                bpl LCEF6                    ; CEF1= 10 03       ..
                lda $034E                    ; CEF3= AD 4E 03    -N.
LCEF6:
                stx $E0                      ; CEF6= 86 E0       .`
                sta $E1                      ; CEF8= 85 E1       .a
                rts                          ; CEFA= 60          `

LCEFB:
                lda $031D                    ; CEFB= AD 1D 03    -..
                ldy $031C                    ; CEFE= AC 1C 03    ,..
LCF01:
                cpy #$07                     ; CF01= C0 07       @.
                bcc LCF24                    ; CF03= 90 1F       ..
                bne LCF0A                    ; CF05= D0 03       P.
                adc $0290                    ; CF07= 6D 90 02    m..
LCF0A:
                cpy #$08                     ; CF0A= C0 08       @.
                bne LCF15                    ; CF0C= D0 07       P.
                ora #$00                     ; CF0E= 09 00       ..
                bmi LCF15                    ; CF10= 30 03       0.
                eor $0291                    ; CF12= 4D 91 02    M..
LCF15:
                cpy #$0A                     ; CF15= C0 0A       @.
                bne LCF24                    ; CF17= D0 0B       P.
                sta $035F                    ; CF19= 8D 5F 03    ._.
                jsr LE2D2                    ; CF1C= 20 D2 E2     Rb
                bne LCF2A                    ; CF1F= D0 09       P.
                lda $035F                    ; CF21= AD 5F 03    -_.
LCF24:
                sty CRTC+0                   ; CF24= 8C 00 FE    ..~
                sta CRTC+1                   ; CF27= 8D 01 FE    ..~
LCF2A:
                rts                          ; CF2A= 60          `

LCF2B:
                jsr LE2D2                    ; CF2B= 20 D2 E2     Rb
                bne LCF2A                    ; CF2E= D0 FA       Pz
                lda $031C                    ; CF30= AD 1C 03    -..
                and #$03                     ; CF33= 29 03       ).
                asl a                        ; CF35= 0A          .
                tax                          ; CF36= AA          *
                lda #$20                     ; CF37= A9 20       )
                jmp (LCF3C,x)                ; CF39= 7C 3C CF    |<O

LCF3C:
                .word LCF53                  ; CF3C= 53 CF       S.
                .word LCF50                  ; CF3E= 50 CF       P.
                .word LCF44                  ; CF40= 44 CF       D.
                .word LCF4B                  ; CF42= 4B CF       K.

LCF44:
                lda #$60                     ; CF44= A9 60       )`
                trb $035F                    ; CF46= 1C 5F 03    ._.
                bra LCF50                    ; CF49= 80 05       ..

LCF4B:
                lda #$60                     ; CF4B= A9 60       )`
                tsb $035F                    ; CF4D= 0C 5F 03    ._.
LCF50:
                lda $035F                    ; CF50= AD 5F 03    -_.
LCF53:
                ldy #$0A                     ; CF53= A0 0A        .
                bra LCF24                    ; CF55= 80 CD       .M

LCF57:
                sbc #$01                     ; CF57= E9 01       i.
                asl a                        ; CF59= 0A          .
                asl a                        ; CF5A= 0A          .
                asl a                        ; CF5B= 0A          .
                adc #$07                     ; CF5C= 69 07       i.
                tay                          ; CF5E= A8          (
                ldx #$07                     ; CF5F= A2 07       ".
LCF61:
                lda $031C,x                  ; CF61= BD 1C 03    =..
                sta L8800,y                  ; CF64= 99 00 88    ...
                dey                          ; CF67= 88          .
                dex                          ; CF68= CA          J
                bpl LCF61                    ; CF69= 10 F6       .v
                bra LCF93                    ; CF6B= 80 26       .&

LCF6D:
                lda $0355                    ; CF6D= AD 55 03    -U.
                bne LCF73                    ; CF70= D0 01       P.
                dec a                        ; CF72= 3A          :
LCF73:
                and #$03                     ; CF73= 29 03       ).
                inc a                        ; CF75= 1A          .
                asl a                        ; CF76= 0A          .
                asl a                        ; CF77= 0A          .
                asl a                        ; CF78= 0A          .
                asl a                        ; CF79= 0A          .
                tax                          ; CF7A= AA          *
                ldy #$1C                     ; CF7B= A0 1C        .
LCF7D:
                lda LE1C3,x                  ; CF7D= BD C3 E1    =Ca
                sta L87FF,y                  ; CF80= 99 FF 87    ...
                sta L8803,y                  ; CF83= 99 03 88    ...
                dex                          ; CF86= CA          J
                dey                          ; CF87= 88          .
                tya                          ; CF88= 98          .
                bit #$07                     ; CF89= 89 07       ..
                bne LCF7D                    ; CF8B= D0 F0       Pp
                dey                          ; CF8D= 88          .
                dey                          ; CF8E= 88          .
                dey                          ; CF8F= 88          .
                dey                          ; CF90= 88          .
                bpl LCF7D                    ; CF91= 10 EA       .j
LCF93:
                jmp LC57D                    ; CF93= 4C 7D C5    L}E

LCF96:
                sbc #$0B                     ; CF96= E9 0B       i.
                asl a                        ; CF98= 0A          .
                asl a                        ; CF99= 0A          .
                asl a                        ; CF9A= 0A          .
                adc #$03                     ; CF9B= 69 03       i.
                pha                          ; CF9D= 48          H
                ldx #$07                     ; CF9E= A2 07       ".
LCFA0:
                lda $031C,x                  ; CFA0= BD 1C 03    =..
                and $0360                    ; CFA3= 2D 60 03    -`.
                sta $DA                      ; CFA6= 85 DA       .Z
                lda $0360                    ; CFA8= AD 60 03    -`.
                and #$07                     ; CFAB= 29 07       ).
                adc $DA                      ; CFAD= 65 DA       eZ
                tay                          ; CFAF= A8          (
                lda LE14B,y                  ; CFB0= B9 4B E1    9Ka
                sta $031C,x                  ; CFB3= 9D 1C 03    ...
                dex                          ; CFB6= CA          J
                bpl LCFA0                    ; CFB7= 10 E7       .g
                lda #$55                     ; CFB9= A9 55       )U
                ldx $0355                    ; CFBB= AE 55 03    .U.
                bne LCFC2                    ; CFBE= D0 02       P.
                lda #$33                     ; CFC0= A9 33       )3
LCFC2:
                sta $DA                      ; CFC2= 85 DA       .Z
                ply                          ; CFC4= 7A          z
                ldx #$07                     ; CFC5= A2 07       ".
LCFC7:
                lda $031C,x                  ; CFC7= BD 1C 03    =..
                dex                          ; CFCA= CA          J
                eor $031C,x                  ; CFCB= 5D 1C 03    ]..
                and $DA                      ; CFCE= 25 DA       %Z
                eor $031C,x                  ; CFD0= 5D 1C 03    ]..
                sta L8800,y                  ; CFD3= 99 00 88    ...
                sta L8804,y                  ; CFD6= 99 04 88    ...
                dey                          ; CFD9= 88          .
                dex                          ; CFDA= CA          J
                bpl LCFC7                    ; CFDB= 10 EA       .j
                bra LCF93                    ; CFDD= 80 B4       .4

LCFDF:
                lda $031C                    ; CFDF= AD 1C 03    -..
                sta $0367                    ; CFE2= 8D 67 03    .g.
                rts                          ; CFE5= 60          `

LCFE6:
                lda $031C                    ; CFE6= AD 1C 03    -..
                bne LCFF5                    ; CFE9= D0 0A       P.
                jsr LC910                    ; CFEB= 20 10 C9     .I
                lda STATE                      ; CFEE= A5 D0       %P
                and #$08                     ; CFF0= 29 08       ).
                asl a                        ; CFF2= 0A          .
                bra LD006                    ; CFF3= 80 11       ..

LCFF5:
                lda #$00                     ; CFF5= A9 00       ).
                sta $032C                    ; CFF7= 8D 2C 03    .,.
                sta $032F                    ; CFFA= 8D 2F 03    ./.
                jsr LE2A2                    ; CFFD= 20 A2 E2     "b
                stx $032E                    ; D000= 8E 2E 03    ...
                sty $032D                    ; D003= 8C 2D 03    .-.
LD006:
                sta $DC                      ; D006= 85 DC       .\
                sec                          ; D008= 38          8
                lda $032E                    ; D009= AD 2E 03    -..
                sbc $032C                    ; D00C= ED 2C 03    m,.
                jsr LC93B                    ; D00F= 20 3B C9     ;I
                sta $0328                    ; D012= 8D 28 03    .(.
                stx $0329                    ; D015= 8E 29 03    .).
                ldx $034F                    ; D018= AE 4F 03    .O.
                cpx #$01                     ; D01B= E0 01       `.
                beq LD026                    ; D01D= F0 07       p.
                lda $031E                    ; D01F= AD 1E 03    -..
                beq LD026                    ; D022= F0 02       p.
                ldx #$08                     ; D024= A2 08       ".
LD026:
                stx $032A                    ; D026= 8E 2A 03    .*.
                lda $031D                    ; D029= AD 1D 03    -..
                lsr a                        ; D02C= 4A          J
                php                          ; D02D= 08          .
                rol a                        ; D02E= 2A          *
                plp                          ; D02F= 28          (
                rol a                        ; D030= 2A          *
                asl a                        ; D031= 0A          .
                cmp #$10                     ; D032= C9 10       I.
                bcc LD039                    ; D034= 90 03       ..
                eor $0366                    ; D036= 4D 66 03    Mf.
LD039:
                and #$0E                     ; D039= 29 0E       ).
                ora $DC                      ; D03B= 05 DC       .\
LD03D:
                tax                          ; D03D= AA          *
                lda $0350                    ; D03E= AD 50 03    -P.
                sta $D8                      ; D041= 85 D8       .X
                lda $0351                    ; D043= AD 51 03    -Q.
                sta $D9                      ; D046= 85 D9       .Y
                jsr LD04E                    ; D048= 20 4E D0     NP
                jmp LC6D8                    ; D04B= 4C D8 C6    LXF

LD04E:
                jmp (LE20C,x)                ; D04E= 7C 0C E2    |.b

LD051:
                phx                          ; D051= DA          Z
                jsr LC910                    ; D052= 20 10 C9     .I
                jsr LC908                    ; D055= 20 08 C9     .I
                ldx $034F                    ; D058= AE 4F 03    .O.
                stx $032A                    ; D05B= 8E 2A 03    .*.
                pla                          ; D05E= 68          h
                lsr a                        ; D05F= 4A          J
                eor STATE                      ; D060= 45 D0       EP
                and #$F7                     ; D062= 29 F7       )w
                eor STATE                      ; D064= 45 D0       EP
                asl a                        ; D066= 0A          .
                bra LD03D                    ; D067= 80 D4       .T

LD069:
                stz $0334                    ; D069= 9C 34 03    .4.
                stz $0335                    ; D06C= 9C 35 03    .5.
                jsr LE252                    ; D06F= 20 52 E2     Rb
                stx $0336                    ; D072= 8E 36 03    .6.
                sty $0337                    ; D075= 8C 37 03    .7.
                jsr LE25C                    ; D078= 20 5C E2     \b
                inx                          ; D07B= E8          h
                stx $0338                    ; D07C= 8E 38 03    .8.
                sty $0339                    ; D07F= 8C 39 03    .9.
                ldy #$00                     ; D082= A0 00        .
                lda $031C                    ; D084= AD 1C 03    -..
                jsr LD0E5                    ; D087= 20 E5 D0     eP
                lda $031D                    ; D08A= AD 1D 03    -..
                jsr LD0E5                    ; D08D= 20 E5 D0     eP
                lda $0333                    ; D090= AD 33 03    -3.
                cmp $0331                    ; D093= CD 31 03    M1.
                bcc LD10E                    ; D096= 90 76       .v
                bne LD0A2                    ; D098= D0 08       P.
                lda $0330                    ; D09A= AD 30 03    -0.
                cmp $0332                    ; D09D= CD 32 03    M2.
                bcs LD10E                    ; D0A0= B0 6C       0l
LD0A2:
                lda $0318                    ; D0A2= AD 18 03    -..
                pha                          ; D0A5= 48          H
                lda $0319                    ; D0A6= AD 19 03    -..
                pha                          ; D0A9= 48          H
                ldy $0331                    ; D0AA= AC 31 03    ,1.
LD0AD:
                phy                          ; D0AD= 5A          Z
                lda $0366                    ; D0AE= AD 66 03    -f.
                eor #$08                     ; D0B1= 49 08       I.
                and #$0E                     ; D0B3= 29 0E       ).
                tax                          ; D0B5= AA          *
                tya                          ; D0B6= 98          .
                jsr LC2C7                    ; D0B7= 20 C7 C2     GB
                ldx #$00                     ; D0BA= A2 00       ".
                lda $0338                    ; D0BC= AD 38 03    -8.
                cpy $0331                    ; D0BF= CC 31 03    L1.
                bne LD0C7                    ; D0C2= D0 03       P.
                ldx $0330                    ; D0C4= AE 30 03    .0.
LD0C7:
                cpy $0333                    ; D0C7= CC 33 03    L3.
                beq LD0D3                    ; D0CA= F0 07       p.
                jsr LCA7F                    ; D0CC= 20 7F CA     .J
                ply                          ; D0CF= 7A          z
                iny                          ; D0D0= C8          H
                bra LD0AD                    ; D0D1= 80 DA       .Z

LD0D3:
                lda $0332                    ; D0D3= AD 32 03    -2.
                jsr LCA7F                    ; D0D6= 20 7F CA     .J
                ply                          ; D0D9= 7A          z
                pla                          ; D0DA= 68          h
                sta $0319                    ; D0DB= 8D 19 03    ...
                pla                          ; D0DE= 68          h
                sta $0318                    ; D0DF= 8D 18 03    ...
                jmp LCCFA                    ; D0E2= 4C FA CC    LzL

LD0E5:
                pha                          ; D0E5= 48          H
                and #$03                     ; D0E6= 29 03       ).
                asl a                        ; D0E8= 0A          .
                jsr LD0F0                    ; D0E9= 20 F0 D0     pP
                pla                          ; D0EC= 68          h
                lsr a                        ; D0ED= 4A          J
                ora #$01                     ; D0EE= 09 01       ..
LD0F0:
                tax                          ; D0F0= AA          *
                and #$01                     ; D0F1= 29 01       ).
                pha                          ; D0F3= 48          H
                lda $0334,x                  ; D0F4= BD 34 03    =4.
                plx                          ; D0F7= FA          z
                clc                          ; D0F8= 18          .
                iny                          ; D0F9= C8          H
                adc $031D,y                  ; D0FA= 79 1D 03    y..
                bmi LD109                    ; D0FD= 30 0A       0.
                cmp $0338,x                  ; D0FF= DD 38 03    ]8.
                bcc LD10B                    ; D102= 90 07       ..
                lda $0338,x                  ; D104= BD 38 03    =8.
                bra LD10B                    ; D107= 80 02       ..

LD109:
                lda #$00                     ; D109= A9 00       ).
LD10B:
                sta $032F,y                  ; D10B= 99 2F 03    ./.
LD10E:
                rts                          ; D10E= 60          `

LD10F:
                sec                          ; D10F= 38          8
LD110:
                ldx $031C                    ; D110= AE 1C 03    ...
                ldy #$00                     ; D113= A0 00        .
                bcc LD11A                    ; D115= 90 03       ..
                jmp osbyte09                    ; D117= 4C 92 EC    L.l

LD11A:
                sec                          ; D11A= 38          8
                jmp osbyte0A                    ; D11B= 4C 94 EC    L.l

LD11E:
                lda $0366                    ; D11E= AD 66 03    -f.
                and $031D                    ; D121= 2D 1D 03    -..
                eor $031C                    ; D124= 4D 1C 03    M..
                sta $0366                    ; D127= 8D 66 03    .f.
                lsr a                        ; D12A= 4A          J
                bcs LD145                    ; D12B= B0 18       0.
LD12D:
                pha                          ; D12D= 48          H
                phx                          ; D12E= DA          Z
                jsr LE2D2                    ; D12F= 20 D2 E2     Rb
                sec                          ; D132= 38          8
                bne LD143                    ; D133= D0 0E       P.
                clc                          ; D135= 18          .
                bit $036C                    ; D136= 2C 6C 03    ,l.
                bpl LD143                    ; D139= 10 08       ..
                php                          ; D13B= 08          .
                jsr LC3F6                    ; D13C= 20 F6 C3     vC
                jsr LC25B                    ; D13F= 20 5B C2     [B
                plp                          ; D142= 28          (
LD143:
                plx                          ; D143= FA          z
                pla                          ; D144= 68          h
LD145:
                rts                          ; D145= 60          `

LD146:
                ldx #$20                     ; D146= A2 20       "
                jsr LD1E2                    ; D148= 20 E2 D1     bQ
                lda $031F                    ; D14B= AD 1F 03    -..
                ldy #$05                     ; D14E= A0 05        .
                and #$03                     ; D150= 29 03       ).
                beq LD160                    ; D152= F0 0C       p.
                lsr a                        ; D154= 4A          J
                dey                          ; D155= 88          .
                bcc LD160                    ; D156= 90 08       ..
                tax                          ; D158= AA          *
                ldy $035B,x                  ; D159= BC 5B 03    <[.
                asl a                        ; D15C= 0A          .
                asl a                        ; D15D= 0A          .
                asl a                        ; D15E= 0A          .
                tax                          ; D15F= AA          *
LD160:
                stx $0359                    ; D160= 8E 59 03    .Y.
                tya                          ; D163= 98          .
                and #$0F                     ; D164= 29 0F       ).
                sta $035A                    ; D166= 8D 5A 03    .Z.
                lda $031F                    ; D169= AD 1F 03    -..
                lsr a                        ; D16C= 4A          J
                lsr a                        ; D16D= 4A          J
                and #$FE                     ; D16E= 29 FE       )~
                tax                          ; D170= AA          *
                cmp #$34                     ; D171= C9 34       I4
                bcs LD190                    ; D173= B0 1B       0.
                and #$F3                     ; D175= 29 F3       )s
                cmp #$12                     ; D177= C9 12       I.
                php                          ; D179= 08          .
                beq LD184                    ; D17A= F0 08       p.
                cpx #$2E                     ; D17C= E0 2E       `.
                beq LD184                    ; D17E= F0 04       p.
                cpy #$05                     ; D180= C0 05       @.
                beq LD19D                    ; D182= F0 19       p.
LD184:
                lda $031F                    ; D184= AD 1F 03    -..
                jsr LD193                    ; D187= 20 93 D1     .Q
                plp                          ; D18A= 28          (
                bne LD19E                    ; D18B= D0 11       P.
                jmp LC4DF                    ; D18D= 4C DF C4    L_D

LD190:
                jmp LC6A3                    ; D190= 4C A3 C6    L#F

LD193:
                cpx #$10                     ; D193= E0 10       `.
                bcs LD19A                    ; D195= B0 03       0.
                jmp LD8A9                    ; D197= 4C A9 D8    L)X

LD19A:
                jmp (LE07B,x)                ; D19A= 7C 7B E0    |{`

LD19D:
                pla                          ; D19D= 68          h
LD19E:
                jsr LC91A                    ; D19E= 20 1A C9     .I
                ldy #$24                     ; D1A1= A0 24        $
                jmp LC916                    ; D1A3= 4C 16 C9    L.I

LD1A6:
                ldx #$24                     ; D1A6= A2 24       "$
LD1A8:
                inx                          ; D1A8= E8          h
                inx                          ; D1A9= E8          h
                jsr LD1B5                    ; D1AA= 20 B5 D1     5Q
                dex                          ; D1AD= CA          J
                dex                          ; D1AE= CA          J
                asl a                        ; D1AF= 0A          .
                asl a                        ; D1B0= 0A          .
                ldy #$00                     ; D1B1= A0 00        .
                bra LD1B9                    ; D1B3= 80 04       ..

LD1B5:
                ldy #$02                     ; D1B5= A0 02        .
LD1B7:
                lda #$00                     ; D1B7= A9 00       ).
LD1B9:
                sta $DA                      ; D1B9= 85 DA       .Z
                lda $0300,x                  ; D1BB= BD 00 03    =..
                cmp $0300,y                  ; D1BE= D9 00 03    Y..
                lda $0301,x                  ; D1C1= BD 01 03    =..
                sbc $0301,y                  ; D1C4= F9 01 03    y..
                bmi LD1D9                    ; D1C7= 30 10       0.
                lda $0304,y                  ; D1C9= B9 04 03    9..
                cmp $0300,x                  ; D1CC= DD 00 03    ]..
                lda $0305,y                  ; D1CF= B9 05 03    9..
                sbc $0301,x                  ; D1D2= FD 01 03    }..
                bpl LD1DB                    ; D1D5= 10 04       ..
                inc $DA                      ; D1D7= E6 DA       fZ
LD1D9:
                inc $DA                      ; D1D9= E6 DA       fZ
LD1DB:
                lda $DA                      ; D1DB= A5 DA       %Z
                rts                          ; D1DD= 60          `

LD1DE:
                lda #$FF                     ; D1DE= A9 FF       ).
                bra LD1E5                    ; D1E0= 80 03       ..

LD1E2:
                lda $031F                    ; D1E2= AD 1F 03    -..
LD1E5:
                sta $DA                      ; D1E5= 85 DA       .Z
                ldy #$02                     ; D1E7= A0 02        .
                jsr LD20B                    ; D1E9= 20 0B D2     .R
                jsr LD242                    ; D1EC= 20 42 D2     BR
                ldy #$00                     ; D1EF= A0 00        .
                dex                          ; D1F1= CA          J
                dex                          ; D1F2= CA          J
                jsr LD20B                    ; D1F3= 20 0B D2     .R
                ldy $0361                    ; D1F6= AC 61 03    ,a.
                cpy #$03                     ; D1F9= C0 03       @.
                beq LD202                    ; D1FB= F0 05       p.
                bcs LD205                    ; D1FD= B0 06       0.
                jsr LD242                    ; D1FF= 20 42 D2     BR
LD202:
                jsr LD242                    ; D202= 20 42 D2     BR
LD205:
                lda $0356                    ; D205= AD 56 03    -V.
                bne LD242                    ; D208= D0 38       P8
                rts                          ; D20A= 60          `

LD20B:
                clc                          ; D20B= 18          .
                lda $DA                      ; D20C= A5 DA       %Z
                and #$04                     ; D20E= 29 04       ).
                beq LD21B                    ; D210= F0 09       p.
                lda $0302,x                  ; D212= BD 02 03    =..
                pha                          ; D215= 48          H
                lda $0303,x                  ; D216= BD 03 03    =..
                bra LD229                    ; D219= 80 0E       ..

LD21B:
                lda $0302,x                  ; D21B= BD 02 03    =..
                adc $0310,y                  ; D21E= 79 10 03    y..
                pha                          ; D221= 48          H
                lda $0303,x                  ; D222= BD 03 03    =..
                adc $0311,y                  ; D225= 79 11 03    y..
                clc                          ; D228= 18          .
LD229:
                sta $0311,y                  ; D229= 99 11 03    ...
                adc $030D,y                  ; D22C= 79 0D 03    y..
                sta $0303,x                  ; D22F= 9D 03 03    ...
                pla                          ; D232= 68          h
                sta $0310,y                  ; D233= 99 10 03    ...
                clc                          ; D236= 18          .
                adc $030C,y                  ; D237= 79 0C 03    y..
                sta $0302,x                  ; D23A= 9D 02 03    ...
                bcc LD242                    ; D23D= 90 03       ..
                inc $0303,x                  ; D23F= FE 03 03    ~..
LD242:
                lda $0303,x                  ; D242= BD 03 03    =..
                asl a                        ; D245= 0A          .
                ror $0303,x                  ; D246= 7E 03 03    ~..
                ror $0302,x                  ; D249= 7E 02 03    ~..
                rts                          ; D24C= 60          `

LD24D:
                phx                          ; D24D= DA          Z
                phy                          ; D24E= 5A          Z
                phy                          ; D24F= 5A          Z
                phx                          ; D250= DA          Z
                phy                          ; D251= 5A          Z
                jsr LD280                    ; D252= 20 80 D2     .R
                plx                          ; D255= FA          z
                jsr LD280                    ; D256= 20 80 D2     .R
                plx                          ; D259= FA          z
                ply                          ; D25A= 7A          z
                jsr LDAE8                    ; D25B= 20 E8 DA     hZ
                plx                          ; D25E= FA          z
                jsr LD268                    ; D25F= 20 68 D2     hR
                plx                          ; D262= FA          z
                bra LD268                    ; D263= 80 03       ..

LD265:
                jsr L9B09                    ; D265= 20 09 9B     ..
LD268:
                ldy #$00                     ; D268= A0 00        .
                jsr LD270                    ; D26A= 20 70 D2     pR
                inx                          ; D26D= E8          h
                ldy #$02                     ; D26E= A0 02        .
LD270:
                sec                          ; D270= 38          8
                jsr LD276                    ; D271= 20 76 D2     vR
                inx                          ; D274= E8          h
                iny                          ; D275= C8          H
LD276:
                lda $0300,x                  ; D276= BD 00 03    =..
                sbc $0314,y                  ; D279= F9 14 03    y..
                sta $0300,x                  ; D27C= 9D 00 03    ...
LD27F:
                rts                          ; D27F= 60          `

LD280:
                ldy #$00                     ; D280= A0 00        .
                jsr LD288                    ; D282= 20 88 D2     .R
                inx                          ; D285= E8          h
                ldy #$02                     ; D286= A0 02        .
LD288:
                clc                          ; D288= 18          .
                jsr LD28E                    ; D289= 20 8E D2     .R
                inx                          ; D28C= E8          h
                iny                          ; D28D= C8          H
LD28E:
                lda $0300,x                  ; D28E= BD 00 03    =..
                adc $0314,y                  ; D291= 79 14 03    y..
                sta $0300,x                  ; D294= 9D 00 03    ...
                rts                          ; D297= 60          `

LD298:
                sta $E1                      ; D298= 85 E1       .a
                jsr LD425                    ; D29A= 20 25 D4     %T
                beq LD27F                    ; D29D= F0 E0       p`
                ldy #$14                     ; D29F= A0 14        .
                lda #$20                     ; D2A1= A9 20       )
                ldx #$2C                     ; D2A3= A2 2C       ",
                jsr LD265                    ; D2A5= 20 65 D2     eR
                jsr LD3AA                    ; D2A8= 20 AA D3     *S
                lda #$01                     ; D2AB= A9 01       ).
LD2AD:
                sty $E0                      ; D2AD= 84 E0       .`
                tsb $E0                      ; D2AF= 04 E0       .`
                ldx #$2C                     ; D2B1= A2 2C       ",
                ldy #$28                     ; D2B3= A0 28        (
                jsr LC91E                    ; D2B5= 20 1E C9     .I
                bit $0335                    ; D2B8= 2C 35 03    ,5.
                php                          ; D2BB= 08          .
                ldx #$2C                     ; D2BC= A2 2C       ",
                jsr LD726                    ; D2BE= 20 26 D7     &W
                plp                          ; D2C1= 28          (
                bpl LD2C7                    ; D2C2= 10 03       ..
                jsr LD3AA                    ; D2C4= 20 AA D3     *S
LD2C7:
                ldy $032C                    ; D2C7= AC 2C 03    ,,.
                lda $032D                    ; D2CA= AD 2D 03    --.
                bmi LD2D2                    ; D2CD= 30 03       0.
                jsr LC92E                    ; D2CF= 20 2E C9     .I
LD2D2:
                pha                          ; D2D2= 48          H
                clc                          ; D2D3= 18          .
                tya                          ; D2D4= 98          .
                adc L8830                    ; D2D5= 6D 30 88    m0.
                tay                          ; D2D8= A8          (
                pla                          ; D2D9= 68          h
                adc L8831                    ; D2DA= 6D 31 88    m1.
                bpl LD2AD                    ; D2DD= 10 CE       .N
                inc a                        ; D2DF= 1A          .
                bne LD305                    ; D2E0= D0 23       P#
                iny                          ; D2E2= C8          H
                bne LD305                    ; D2E3= D0 20       P
                lda $E0                      ; D2E5= A5 E0       %`
                beq LD305                    ; D2E7= F0 1C       p.
                lda $032C                    ; D2E9= AD 2C 03    -,.
                cmp $0328                    ; D2EC= CD 28 03    M(.
                beq LD305                    ; D2EF= F0 14       p.
                ldx #$2C                     ; D2F1= A2 2C       ",
                ldy #$28                     ; D2F3= A0 28        (
                lda $0336                    ; D2F5= AD 36 03    -6.
                asl a                        ; D2F8= 0A          .
                eor $0336                    ; D2F9= 4D 36 03    M6.
                bpl LD302                    ; D2FC= 10 04       ..
                inx                          ; D2FE= E8          h
                inx                          ; D2FF= E8          h
                iny                          ; D300= C8          H
                iny                          ; D301= C8          H
LD302:
                jsr LC90C                    ; D302= 20 0C C9     .I
LD305:
                jsr LD425                    ; D305= 20 25 D4     %T
                lda $0329                    ; D308= AD 29 03    -).
                tax                          ; D30B= AA          *
                eor $031C                    ; D30C= 4D 1C 03    M..
                bmi LD329                    ; D30F= 30 18       0.
                ldy #$02                     ; D311= A0 02        .
                jsr LD46F                    ; D313= 20 6F D4     oT
                bne LD324                    ; D316= D0 0C       P.
                ldx $032B                    ; D318= AE 2B 03    .+.
                ldy #$00                     ; D31B= A0 00        .
                jsr LD46F                    ; D31D= 20 6F D4     oT
                beq LD333                    ; D320= F0 11       p.
                eor #$80                     ; D322= 49 80       I.
LD324:
                stx $DA                      ; D324= 86 DA       .Z
                eor $DA                      ; D326= 45 DA       EZ
                tax                          ; D328= AA          *
LD329:
                txa                          ; D329= 8A          .
                and #$80                     ; D32A= 29 80       ).
                beq LD330                    ; D32C= F0 02       p.
                lda #$C0                     ; D32E= A9 C0       )@
LD330:
                tsb $E1                      ; D330= 04 E1       .a
                clc                          ; D332= 18          .
LD333:
                rts                          ; D333= 60          `

LD334:
                lda $E1                      ; D334= A5 E1       %a
                sta L8848                    ; D336= 8D 48 88    .H.
                bit #$03                     ; D339= 89 03       ..
                beq LD333                    ; D33B= F0 F6       pv
                lda #$10                     ; D33D= A9 10       ).
                sta $DC                      ; D33F= 85 DC       .\
                asl a                        ; D341= 0A          .
                sta $DD                      ; D342= 85 DD       .]
                ldx #$1B                     ; D344= A2 1B       ".
                jsr LD34F                    ; D346= 20 4F D3     OS
                asl $DC                      ; D349= 06 DC       .\
                lsr $DD                      ; D34B= 46 DD       F]
                ldx #$28                     ; D34D= A2 28       "(
LD34F:
                lda #$80                     ; D34F= A9 80       ).
                sta $DA                      ; D351= 85 DA       .Z
                lda $0302,x                  ; D353= BD 02 03    =..
                cmp L8832                    ; D356= CD 32 88    M2.
                bne LD333                    ; D359= D0 D8       PX
                lda $0303,x                  ; D35B= BD 03 03    =..
                cmp L8833                    ; D35E= CD 33 88    M3.
                bne LD333                    ; D361= D0 D0       PP
                ldy $0300,x                  ; D363= BC 00 03    <..
                lda $0301,x                  ; D366= BD 01 03    =..
                bpl LD370                    ; D369= 10 05       ..
                lsr $DA                      ; D36B= 46 DA       FZ
                jsr LC92E                    ; D36D= 20 2E C9     .I
LD370:
                cpy L8830                    ; D370= CC 30 88    L0.
                bne LD333                    ; D373= D0 BE       P>
                cmp L8831                    ; D375= CD 31 88    M1.
                bne LD333                    ; D378= D0 B9       P9
                lda $E1                      ; D37A= A5 E1       %a
                bit #$02                     ; D37C= 89 02       ..
                beq LD399                    ; D37E= F0 19       p.
                ldy #$30                     ; D380= A0 30        0
                bit #$01                     ; D382= 89 01       ..
                beq LD388                    ; D384= F0 02       p.
                ldy $DC                      ; D386= A4 DC       $\
LD388:
                tya                          ; D388= 98          .
                lsr a                        ; D389= 4A          J
                lsr a                        ; D38A= 4A          J
                bit $E1                      ; D38B= 24 E1       $a
                bne LD395                    ; D38D= D0 06       P.
                ora $DC                      ; D38F= 05 DC       .\
                tsb $E1                      ; D391= 04 E1       .a
                bra LD399                    ; D393= 80 04       ..

LD395:
                ora $DD                      ; D395= 05 DD       .]
                trb $E1                      ; D397= 14 E1       .a
LD399:
                lda $DA                      ; D399= A5 DA       %Z
                bit $E1                      ; D39B= 24 E1       $a
                beq LD330                    ; D39D= F0 91       p.
                trb $E1                      ; D39F= 14 E1       .a
                lda $E1                      ; D3A1= A5 E1       %a
                sta L8848                    ; D3A3= 8D 48 88    .H.
                sta L8849                    ; D3A6= 8D 49 88    .I.
                rts                          ; D3A9= 60          `

LD3AA:
                lda $032E                    ; D3AA= AD 2E 03    -..
                sta L8832                    ; D3AD= 8D 32 88    .2.
                lda $032F                    ; D3B0= AD 2F 03    -/.
                sta L8833                    ; D3B3= 8D 33 88    .3.
                jsr LD3FC                    ; D3B6= 20 FC D3     |S
                jsr LD513                    ; D3B9= 20 13 D5     .U
                sty L8830                    ; D3BC= 8C 30 88    .0.
                lda L8846                    ; D3BF= AD 46 88    -F.
                lsr a                        ; D3C2= 4A          J
                lda L883D                    ; D3C3= AD 3D 88    -=.
                bcc LD3CE                    ; D3C6= 90 06       ..
                cmp #$80                     ; D3C8= C9 80       I.
                ror a                        ; D3CA= 6A          j
                ror L8830                    ; D3CB= 6E 30 88    n0.
LD3CE:
                sta L8831                    ; D3CE= 8D 31 88    .1.
                rts                          ; D3D1= 60          `

LD3D2:
                stz L8847                    ; D3D2= 9C 47 88    .G.
                stz L8830                    ; D3D5= 9C 30 88    .0.
                stz L8831                    ; D3D8= 9C 31 88    .1.
                stz L8834                    ; D3DB= 9C 34 88    .4.
                stz L8835                    ; D3DE= 9C 35 88    .5.
                lda L8832                    ; D3E1= AD 32 88    -2.
                asl a                        ; D3E4= 0A          .
                sta L8836                    ; D3E5= 8D 36 88    .6.
                lda L8833                    ; D3E8= AD 33 88    -3.
                rol a                        ; D3EB= 2A          *
                sta L8837                    ; D3EC= 8D 37 88    .7.
                lda L8846                    ; D3EF= AD 46 88    -F.
                bit #$02                     ; D3F2= 89 02       ..
                beq LD3FC                    ; D3F4= F0 06       p.
                asl L8836                    ; D3F6= 0E 36 88    .6.
                rol L8837                    ; D3F9= 2E 37 88    .7.
LD3FC:
                lda L8846                    ; D3FC= AD 46 88    -F.
                lsr a                        ; D3FF= 4A          J
                lsr a                        ; D400= 4A          J
                ldy L8832                    ; D401= AC 32 88    ,2.
                lda L8833                    ; D404= AD 33 88    -3.
                jsr LD4C5                    ; D407= 20 C5 D4     ET
                sec                          ; D40A= 38          8
                ldx #$FC                     ; D40B= A2 FC       "|
LD40D:
                lda L873C,x                  ; D40D= BD 3C 87    =<.
                sbc L8744,x                  ; D410= FD 44 87    }D.
                sta L8744,x                  ; D413= 9D 44 87    .D.
                inx                          ; D416= E8          h
                bne LD40D                    ; D417= D0 F4       Pt
                rts                          ; D419= 60          `

LD41A:
                jsr LC91A                    ; D41A= 20 1A C9     .I
                stz $E1                      ; D41D= 64 E1       da
                ldx #$20                     ; D41F= A2 20       "
                jsr LD427                    ; D421= 20 27 D4     'T
                rts                          ; D424= 60          `

LD425:
                ldx #$24                     ; D425= A2 24       "$
LD427:
                ldy #$1B                     ; D427= A0 1B        .
                jsr LC91E                    ; D429= 20 1E C9     .I
                ldx #$1B                     ; D42C= A2 1B       ".
                jsr LD268                    ; D42E= 20 68 D2     hR
                jsr LD486                    ; D431= 20 86 D4     .T
                jsr LD513                    ; D434= 20 13 D5     .U
                ldy #$0C                     ; D437= A0 0C        .
                jsr LD4AB                    ; D439= 20 AB D4     +T
                jsr LD513                    ; D43C= 20 13 D5     .U
                cmp #$20                     ; D43F= C9 20       I
                bcc LD448                    ; D441= 90 05       ..
                pla                          ; D443= 68          h
                pla                          ; D444= 68          h
                pla                          ; D445= 68          h
                pla                          ; D446= 68          h
                rts                          ; D447= 60          `

LD448:
                sty L8844                    ; D448= 8C 44 88    .D.
                sta L8845                    ; D44B= 8D 45 88    .E.
                lda L8846                    ; D44E= AD 46 88    -F.
                bit #$02                     ; D451= 89 02       ..
                beq LD45B                    ; D453= F0 06       p.
                lsr L8845                    ; D455= 4E 45 88    NE.
                ror L8844                    ; D458= 6E 44 88    nD.
LD45B:
                ldy L8844                    ; D45B= AC 44 88    ,D.
                lda L8845                    ; D45E= AD 45 88    -E.
                jsr LC92E                    ; D461= 20 2E C9     .I
                sty L8832                    ; D464= 8C 32 88    .2.
                sta L8833                    ; D467= 8D 33 88    .3.
                ora L8832                    ; D46A= 0D 32 88    .2.
                sec                          ; D46D= 38          8
                rts                          ; D46E= 60          `

LD46F:
                stz $DA                      ; D46F= 64 DA       dZ
                lda $031B,y                  ; D471= B9 1B 03    9..
                cmp $0328,y                  ; D474= D9 28 03    Y(.
                beq LD47B                    ; D477= F0 02       p.
                inc $DA                      ; D479= E6 DA       fZ
LD47B:
                lda $031C,y                  ; D47B= B9 1C 03    9..
                sbc $0329,y                  ; D47E= F9 29 03    y).
                bne LD485                    ; D481= D0 02       P.
                lda $DA                      ; D483= A5 DA       %Z
LD485:
                rts                          ; D485= 60          `

LD486:
                ldx $0355                    ; D486= AE 55 03    .U.
                lda LD4BF,x                  ; D489= BD BF D4    =?T
                sta L8846                    ; D48C= 8D 46 88    .F.
                lsr a                        ; D48F= 4A          J
                pha                          ; D490= 48          H
                ldx #$04                     ; D491= A2 04       ".
LD493:
                stz L8837,x                  ; D493= 9E 37 88    .7.
                dex                          ; D496= CA          J
                bne LD493                    ; D497= D0 FA       Pz
                jsr LD4A0                    ; D499= 20 A0 D4      T
                pla                          ; D49C= 68          h
                lsr a                        ; D49D= 4A          J
                ldx #$02                     ; D49E= A2 02       ".
LD4A0:
                ldy $031B,x                  ; D4A0= BC 1B 03    <..
                lda $031C,x                  ; D4A3= BD 1C 03    =..
                jsr LD4C5                    ; D4A6= 20 C5 D4     ET
                ldy #$10                     ; D4A9= A0 10        .
LD4AB:
                clc                          ; D4AB= 18          .
                ldx #$FC                     ; D4AC= A2 FC       "|
LD4AE:
                lda L873C,x                  ; D4AE= BD 3C 87    =<.
                adc L8830,y                  ; D4B1= 79 30 88    y0.
                sta L873C,x                  ; D4B4= 9D 3C 87    .<.
                sta L8744,x                  ; D4B7= 9D 44 87    .D.
                iny                          ; D4BA= C8          H
                inx                          ; D4BB= E8          h
                bne LD4AE                    ; D4BC= D0 F0       Pp
                rts                          ; D4BE= 60          `

LD4BF:
                .byte $02                    ; D4BF= 02          .
                brk                          ; D4C0= 00          .
                ora ($FF,x)                  ; D4C1= 01 FF       ..
                brk                          ; D4C3= 00          .
;ORA (&8C,x)      :\ D4C4= 01       ..
                .byte $01
LD4C5:
                sty L883C                    ; D4C5= 8C 3C 88
                bcc LD4CE                    ; D4C8= 90 04
                asl L883C                    ; D4CA= 0E 3C 88
                rol a                        ; D4CD= 2A
LD4CE:
                sta L883D                    ; D4CE= 8D 3D 88
                ldy L883C                    ; D4D1= AC 3C 88    ,<.
                tax                          ; D4D4= AA          *
                bpl LD4DA                    ; D4D5= 10 03       ..
                jsr LC92E                    ; D4D7= 20 2E C9     .I
LD4DA:
                sty L883C                    ; D4DA= 8C 3C 88    .<.
                sta L883D                    ; D4DD= 8D 3D 88    .=.
                sty L8840                    ; D4E0= 8C 40 88    .@.
                stz L8842                    ; D4E3= 9C 42 88    .B.
                stz L8843                    ; D4E6= 9C 43 88    .C.
                ldy #$0F                     ; D4E9= A0 0F        .
                lsr a                        ; D4EB= 4A          J
                sta L8841                    ; D4EC= 8D 41 88    .A.
                ror L8840                    ; D4EF= 6E 40 88    n@.
LD4F2:
                bcc LD507                    ; D4F2= 90 13       ..
                clc                          ; D4F4= 18          .
                lda L883C                    ; D4F5= AD 3C 88    -<.
                adc L8842                    ; D4F8= 6D 42 88    mB.
                sta L8842                    ; D4FB= 8D 42 88    .B.
                lda L883D                    ; D4FE= AD 3D 88    -=.
                adc L8843                    ; D501= 6D 43 88    mC.
                sta L8843                    ; D504= 8D 43 88    .C.
LD507:
                ldx #$03                     ; D507= A2 03       ".
LD509:
                ror L8840,x                  ; D509= 7E 40 88    ~@.
                dex                          ; D50C= CA          J
                bpl LD509                    ; D50D= 10 FA       .z
                dey                          ; D50F= 88          .
                bpl LD4F2                    ; D510= 10 E0       .`
                rts                          ; D512= 60          `

LD513:
                ldx #$02                     ; D513= A2 02       ".
LD515:
                stz L883C,x                  ; D515= 9E 3C 88    .<.
                stz $DB,x                    ; D518= 74 DB       t[
                dex                          ; D51A= CA          J
                bpl LD515                    ; D51B= 10 F8       .x
                ldy #$03                     ; D51D= A0 03        .
LD51F:
                lda L8840,y                  ; D51F= B9 40 88    9@.
                sta $DA                      ; D522= 85 DA       .Z
                phy                          ; D524= 5A          Z
                ldy #$03                     ; D525= A0 03        .
LD527:
                phy                          ; D527= 5A          Z
                sec                          ; D528= 38          8
                rol L883C                    ; D529= 2E 3C 88    .<.
                rol L883D                    ; D52C= 2E 3D 88    .=.
                rol L883E                    ; D52F= 2E 3E 88    .>.
                ldx #$01                     ; D532= A2 01       ".
                lda $DB                      ; D534= A5 DB       %[
LD536:
                asl $DA                      ; D536= 06 DA       .Z
                rol a                        ; D538= 2A          *
                rol $DC                      ; D539= 26 DC       &\
                rol $DD                      ; D53B= 26 DD       &]
                dex                          ; D53D= CA          J
                bpl LD536                    ; D53E= 10 F6       .v
                sta $DB                      ; D540= 85 DB       .[
                sec                          ; D542= 38          8
                sbc L883C                    ; D543= ED 3C 88    m<.
                tax                          ; D546= AA          *
                lda $DC                      ; D547= A5 DC       %\
                sbc L883D                    ; D549= ED 3D 88    m=.
                tay                          ; D54C= A8          (
                lda $DD                      ; D54D= A5 DD       %]
                sbc L883E                    ; D54F= ED 3E 88    m>.
                bcc LD55F                    ; D552= 90 0B       ..
                sta $DD                      ; D554= 85 DD       .]
                sty $DC                      ; D556= 84 DC       .\
                stx $DB                      ; D558= 86 DB       .[
                inc L883C                    ; D55A= EE 3C 88    n<.
                bra LD562                    ; D55D= 80 03       ..

LD55F:
                dec L883C                    ; D55F= CE 3C 88    N<.
LD562:
                ply                          ; D562= 7A          z
                dey                          ; D563= 88          .
                bpl LD527                    ; D564= 10 C1       .A
                ply                          ; D566= 7A          z
                dey                          ; D567= 88          .
                bpl LD51F                    ; D568= 10 B5       .5
                lsr L883E                    ; D56A= 4E 3E 88    N>.
                ror L883D                    ; D56D= 6E 3D 88    n=.
                ror L883C                    ; D570= 6E 3C 88    n<.
                stz L883E                    ; D573= 9C 3E 88    .>.
                stz L883F                    ; D576= 9C 3F 88    .?.
                ldy L883C                    ; D579= AC 3C 88    ,<.
                lda L883D                    ; D57C= AD 3D 88    -=.
                rts                          ; D57F= 60          `

LD580:
                jsr LD58D                    ; D580= 20 8D D5     .U
                iny                          ; D583= C8          H
                iny                          ; D584= C8          H
                inx                          ; D585= E8          h
                inx                          ; D586= E8          h
                inc a                        ; D587= 1A          .
                inc a                        ; D588= 1A          .
                inc $DA                      ; D589= E6 DA       fZ
                inc $DA                      ; D58B= E6 DA       fZ
LD58D:
                phx                          ; D58D= DA          Z
                phy                          ; D58E= 5A          Z
                pha                          ; D58F= 48          H
                clc                          ; D590= 18          .
                lda $0300,x                  ; D591= BD 00 03    =..
                adc $0300,y                  ; D594= 79 00 03    y..
                sta $DE                      ; D597= 85 DE       .^
                lda $0301,x                  ; D599= BD 01 03    =..
                adc $0301,y                  ; D59C= 79 01 03    y..
                plx                          ; D59F= FA          z
                pha                          ; D5A0= 48          H
                ldy $DA                      ; D5A1= A4 DA       $Z
                sec                          ; D5A3= 38          8
                lda $DE                      ; D5A4= A5 DE       %^
                sbc $0300,x                  ; D5A6= FD 00 03    }..
                sta $0300,y                  ; D5A9= 99 00 03    ...
                pla                          ; D5AC= 68          h
                sbc $0301,x                  ; D5AD= FD 01 03    }..
                sta $0301,y                  ; D5B0= 99 01 03    ...
                txa                          ; D5B3= 8A          .
                ply                          ; D5B4= 7A          z
                plx                          ; D5B5= FA          z
                rts                          ; D5B6= 60          `

LD5B7:
                sec                          ; D5B7= 38          8
                lda $0302,y                  ; D5B8= B9 02 03    9..
                sbc $0302,x                  ; D5BB= FD 02 03    }..
                sta $DE                      ; D5BE= 85 DE       .^
                lda $0303,y                  ; D5C0= B9 03 03    9..
                sbc $0303,x                  ; D5C3= FD 03 03    }..
                bmi LD5D1                    ; D5C6= 30 09       0.
                ora $DE                      ; D5C8= 05 DE       .^
                bne LD5D5                    ; D5CA= D0 09       P.
LD5CC:
                jsr LD5D6                    ; D5CC= 20 D6 D5     VU
                bpl LD5D5                    ; D5CF= 10 04       ..
LD5D1:
                txa                          ; D5D1= 8A          .
                phy                          ; D5D2= 5A          Z
                plx                          ; D5D3= FA          z
                tay                          ; D5D4= A8          (
LD5D5:
                rts                          ; D5D5= 60          `

LD5D6:
                lda $0300,y                  ; D5D6= B9 00 03    9..
                cmp $0300,x                  ; D5D9= DD 00 03    ]..
                lda $0301,y                  ; D5DC= B9 01 03    9..
                sbc $0301,x                  ; D5DF= FD 01 03    }..
                rts                          ; D5E2= 60          `

LD5E3:
                inc L8847                    ; D5E3= EE 47 88    nG.
LD5E6:
                lda L8847                    ; D5E6= AD 47 88    -G.
                bne LD5FA                    ; D5E9= D0 0F       P.
                lda L8832                    ; D5EB= AD 32 88    -2.
                ora L8833                    ; D5EE= 0D 33 88    .3.
                beq LD5E3                    ; D5F1= F0 F0       pp
                ldx #$00                     ; D5F3= A2 00       ".
                jsr LD644                    ; D5F5= 20 44 D6     DV
                bpl LD643                    ; D5F8= 10 49       .I
LD5FA:
                ldx #$02                     ; D5FA= A2 02       ".
                jsr LD644                    ; D5FC= 20 44 D6     DV
                bpl LD643                    ; D5FF= 10 42       .B
                ldx #$00                     ; D601= A2 00       ".
                jsr LD60A                    ; D603= 20 0A D6     .V
                bpl LD643                    ; D606= 10 3B       .;
                ldx #$02                     ; D608= A2 02       ".
LD60A:
                lda L8830,x                  ; D60A= BD 30 88    =0.
                bne LD612                    ; D60D= D0 03       P.
                dec L8831,x                  ; D60F= DE 31 88    ^1.
LD612:
                dec L8830,x                  ; D612= DE 30 88    ^0.
                txa                          ; D615= 8A          .
                lsr a                        ; D616= 4A          J
                inc a                        ; D617= 1A          .
                bit L8846                    ; D618= 2C 46 88    ,F.
                beq LD620                    ; D61B= F0 03       p.
                jsr LD620                    ; D61D= 20 20 D6      V
LD620:
                jsr LD636                    ; D620= 20 36 D6     6V
                clc                          ; D623= 18          .
                lda L8840                    ; D624= AD 40 88    -@.
                adc L8834,x                  ; D627= 7D 34 88    }4.
                sta L8840                    ; D62A= 8D 40 88    .@.
                lda L8841                    ; D62D= AD 41 88    -A.
                adc L8835,x                  ; D630= 7D 35 88    }5.
                sta L8841                    ; D633= 8D 41 88    .A.
LD636:
                php                          ; D636= 08          .
                lda L8834,x                  ; D637= BD 34 88    =4.
                bne LD63F                    ; D63A= D0 03       P.
                dec L8835,x                  ; D63C= DE 35 88    ^5.
LD63F:
                dec L8834,x                  ; D63F= DE 34 88    ^4.
                plp                          ; D642= 28          (
LD643:
                rts                          ; D643= 60          `

LD644:
                inc L8830,x                  ; D644= FE 30 88    ~0.
                bne LD64C                    ; D647= D0 03       P.
                inc L8831,x                  ; D649= FE 31 88    ~1.
LD64C:
                txa                          ; D64C= 8A          .
                lsr a                        ; D64D= 4A          J
                inc a                        ; D64E= 1A          .
                bit L8846                    ; D64F= 2C 46 88    ,F.
                beq LD657                    ; D652= F0 03       p.
                jsr LD657                    ; D654= 20 57 D6     WV
LD657:
                jsr LD66D                    ; D657= 20 6D D6     mV
                sec                          ; D65A= 38          8
                lda L8840                    ; D65B= AD 40 88    -@.
                sbc L8834,x                  ; D65E= FD 34 88    }4.
                sta L8840                    ; D661= 8D 40 88    .@.
                lda L8841                    ; D664= AD 41 88    -A.
                sbc L8835,x                  ; D667= FD 35 88    }5.
                sta L8841                    ; D66A= 8D 41 88    .A.
LD66D:
                php                          ; D66D= 08          .
                inc L8834,x                  ; D66E= FE 34 88    ~4.
                bne LD676                    ; D671= D0 03       P.
                inc L8835,x                  ; D673= FE 35 88    ~5.
LD676:
                plp                          ; D676= 28          (
                rts                          ; D677= 60          `

                pha                          ; D678= 48          H
                sec                          ; D679= 38          8
                lda $0300,y                  ; D67A= B9 00 03    9..
                sbc $0300,x                  ; D67D= FD 00 03    }..
                pha                          ; D680= 48          H
                lda $0301,y                  ; D681= B9 01 03    9..
                sbc $0301,x                  ; D684= FD 01 03    }..
                ply                          ; D687= 7A          z
                cmp #$80                     ; D688= C9 80       I.
                bcc LD68F                    ; D68A= 90 03       ..
                jsr LC92E                    ; D68C= 20 2E C9     .I
LD68F:
                plx                          ; D68F= FA          z
                sta $0301,x                  ; D690= 9D 01 03    ...
                tya                          ; D693= 98          .
                sta $0300,x                  ; D694= 9D 00 03    ...
                rts                          ; D697= 60          `

LD698:
                ldx #$37                     ; D698= A2 37       "7
                jsr LD723                    ; D69A= 20 23 D7     #W
LD69D:
                bit $030A,x                  ; D69D= 3C 0A 03    <..
                bvs LD6B2                    ; D6A0= 70 10       p.
                rts                          ; D6A2= 60          `

LD6A3:
                ldx #$2C                     ; D6A3= A2 2C       ",
                jsr LD723                    ; D6A5= 20 23 D7     #W
LD6A8:
                bit $030A,x                  ; D6A8= 3C 0A 03    <..
                bvc LD6B2                    ; D6AB= 50 05       P.
                rts                          ; D6AD= 60          `

LD6AE:
                plx                          ; D6AE= FA          z
                jsr LD726                    ; D6AF= 20 26 D7     &W
LD6B2:
                lda $0309,x                  ; D6B2= BD 09 03    =..
                bmi LD6C7                    ; D6B5= 30 10       0.
                ldy #$03                     ; D6B7= A0 03        .
                phx                          ; D6B9= DA          Z
LD6BA:
                lda $0300,x                  ; D6BA= BD 00 03    =..
                cmp L881E,x                  ; D6BD= DD 1E 88    ]..
                bne LD6AE                    ; D6C0= D0 EC       Pl
                inx                          ; D6C2= E8          h
                dey                          ; D6C3= 88          .
                bpl LD6BA                    ; D6C4= 10 F4       .t
                plx                          ; D6C6= FA          z
LD6C7:
                rts                          ; D6C7= 60          `

LD6C8:
                jsr LD6FD                    ; D6C8= 20 FD D6     }V
                lda $030A,x                  ; D6CB= BD 0A 03    =..
                asl a                        ; D6CE= 0A          .
                asl a                        ; D6CF= 0A          .
                lda $030A,x                  ; D6D0= BD 0A 03    =..
                ror a                        ; D6D3= 6A          j
                sta $DA                      ; D6D4= 85 DA       .Z
                clc                          ; D6D6= 18          .
                bpl LD6E8                    ; D6D7= 10 0F       ..
                lda $0302,x                  ; D6D9= BD 02 03    =..
                sbc $0304                    ; D6DC= ED 04 03    m..
                tay                          ; D6DF= A8          (
                lda $0303,x                  ; D6E0= BD 03 03    =..
                sbc $0305                    ; D6E3= ED 05 03    m..
                bra LD6F5                    ; D6E6= 80 0D       ..

LD6E8:
                lda $0300                    ; D6E8= AD 00 03    -..
                sbc $0302,x                  ; D6EB= FD 02 03    }..
                tay                          ; D6EE= A8          (
                lda $0301                    ; D6EF= AD 01 03    -..
                sbc $0303,x                  ; D6F2= FD 03 03    }..
LD6F5:
                jsr LD7A4                    ; D6F5= 20 A4 D7     $W
                jsr LD6FD                    ; D6F8= 20 FD D6     }V
                bra LD755                    ; D6FB= 80 58       .X

LD6FD:
                txa                          ; D6FD= 8A          .
                inc a                        ; D6FE= 1A          .
                pha                          ; D6FF= 48          H
                inc a                        ; D700= 1A          .
                tay                          ; D701= A8          (
                jsr LE2B2                    ; D702= 20 B2 E2     2b
                inx                          ; D705= E8          h
                inx                          ; D706= E8          h
                iny                          ; D707= C8          H
                iny                          ; D708= C8          H
                jsr LE2B2                    ; D709= 20 B2 E2     2b
                plx                          ; D70C= FA          z
                jsr LD711                    ; D70D= 20 11 D7     .W
                dex                          ; D710= CA          J
LD711:
                lda $0308,x                  ; D711= BD 08 03    =..
                eor #$FF                     ; D714= 49 FF       I.
                sta $0308,x                  ; D716= 9D 08 03    ...
                rts                          ; D719= 60          `

LD71A:
                jsr LD726                    ; D71A= 20 26 D7     &W
LD71D:
                lda $0309,x                  ; D71D= BD 09 03    =..
                bpl LD71A                    ; D720= 10 F8       .x
                rts                          ; D722= 60          `

LD723:
                jsr LD71D                    ; D723= 20 1D D7     .W
LD726:
                lda $0309,x                  ; D726= BD 09 03    =..
                bpl LD755                    ; D729= 10 2A       .*
LD72B:
                clc                          ; D72B= 18          .
                lda $0308,x                  ; D72C= BD 08 03    =..
                adc $0304,x                  ; D72F= 7D 04 03    }..
                sta $0308,x                  ; D732= 9D 08 03    ...
                lda $0309,x                  ; D735= BD 09 03    =..
                adc $0305,x                  ; D738= 7D 05 03    }..
                sta $0309,x                  ; D73B= 9D 09 03    ...
                bmi LD743                    ; D73E= 30 03       0.
                jsr LD755                    ; D740= 20 55 D7     UW
LD743:
                phx                          ; D743= DA          Z
                inx                          ; D744= E8          h
                inx                          ; D745= E8          h
                bit $0308,x                  ; D746= 3C 08 03    <..
                bmi LD76E                    ; D749= 30 23       0#
LD74B:
                inc $0300,x                  ; D74B= FE 00 03    ~..
                bne LD753                    ; D74E= D0 03       P.
                inc $0301,x                  ; D750= FE 01 03    ~..
LD753:
                plx                          ; D753= FA          z
                rts                          ; D754= 60          `

LD755:
                sec                          ; D755= 38          8
                lda $0308,x                  ; D756= BD 08 03    =..
                sbc $0306,x                  ; D759= FD 06 03    }..
                sta $0308,x                  ; D75C= 9D 08 03    ...
                lda $0309,x                  ; D75F= BD 09 03    =..
                sbc $0307,x                  ; D762= FD 07 03    }..
                sta $0309,x                  ; D765= 9D 09 03    ...
                phx                          ; D768= DA          Z
                bit $030A,x                  ; D769= 3C 0A 03    <..
                bvc LD74B                    ; D76C= 50 DD       P]
LD76E:
                lda $0300,x                  ; D76E= BD 00 03    =..
                bne LD776                    ; D771= D0 03       P.
                dec $0301,x                  ; D773= DE 01 03    ^..
LD776:
                dec $0300,x                  ; D776= DE 00 03    ^..
                plx                          ; D779= FA          z
                rts                          ; D77A= 60          `

LD77B:
                clc                          ; D77B= 18          .
                lda $030A,x                  ; D77C= BD 0A 03    =..
                sta $DA                      ; D77F= 85 DA       .Z
                bpl LD792                    ; D781= 10 0F       ..
                lda $0302,x                  ; D783= BD 02 03    =..
                sbc $0306                    ; D786= ED 06 03    m..
                tay                          ; D789= A8          (
                lda $0303,x                  ; D78A= BD 03 03    =..
                sbc $0307                    ; D78D= ED 07 03    m..
                bra LD79F                    ; D790= 80 0D       ..

LD792:
                lda $0302                    ; D792= AD 02 03    -..
                sbc $0302,x                  ; D795= FD 02 03    }..
                tay                          ; D798= A8          (
                lda $0303                    ; D799= AD 03 03    -..
                sbc $0303,x                  ; D79C= FD 03 03    }..
LD79F:
                jsr LD7A4                    ; D79F= 20 A4 D7     $W
                bra LD72B                    ; D7A2= 80 87       ..

LD7A4:
                sty $DE                      ; D7A4= 84 DE       .^
                sta $DF                      ; D7A6= 85 DF       ._
                lda $0302,x                  ; D7A8= BD 02 03    =..
                ldy $0303,x                  ; D7AB= BC 03 03    <..
                asl $DA                      ; D7AE= 06 DA       .Z
                bcs LD7BC                    ; D7B0= B0 0A       0.
                adc $DE                      ; D7B2= 65 DE       e^
                sta $0302,x                  ; D7B4= 9D 02 03    ...
                tya                          ; D7B7= 98          .
                adc $DF                      ; D7B8= 65 DF       e_
                bra LD7C4                    ; D7BA= 80 08       ..

LD7BC:
                sbc $DE                      ; D7BC= E5 DE       e^
                sta $0302,x                  ; D7BE= 9D 02 03    ...
                tya                          ; D7C1= 98          .
                sbc $DF                      ; D7C2= E5 DF       e_
LD7C4:
                sta $0303,x                  ; D7C4= 9D 03 03    ...
                lda #$00                     ; D7C7= A9 00       ).
                bit $0309,x                  ; D7C9= 3C 09 03    <..
                bpl LD7CF                    ; D7CC= 10 01       ..
                dec a                        ; D7CE= 3A          :
LD7CF:
                sta $DC                      ; D7CF= 85 DC       .\
                lsr a                        ; D7D1= 4A          J
                sta $DD                      ; D7D2= 85 DD       .]
                ldy #$10                     ; D7D4= A0 10        .
LD7D6:
                lda $DD                      ; D7D6= A5 DD       %]
                asl a                        ; D7D8= 0A          .
                rol $0308,x                  ; D7D9= 3E 08 03    >..
                rol $0309,x                  ; D7DC= 3E 09 03    >..
                rol $DC                      ; D7DF= 26 DC       &\
                rol $DD                      ; D7E1= 26 DD       &]
                asl $DE                      ; D7E3= 06 DE       .^
                rol $DF                      ; D7E5= 26 DF       &_
                bcc LD802                    ; D7E7= 90 19       ..
                clc                          ; D7E9= 18          .
                lda $DC                      ; D7EA= A5 DC       %\
                adc $0304,x                  ; D7EC= 7D 04 03    }..
                sta $DC                      ; D7EF= 85 DC       .\
                lda $DD                      ; D7F1= A5 DD       %]
                adc $0305,x                  ; D7F3= 7D 05 03    }..
                sta $DD                      ; D7F6= 85 DD       .]
                bcc LD802                    ; D7F8= 90 08       ..
                inc $0308,x                  ; D7FA= FE 08 03    ~..
                bne LD802                    ; D7FD= D0 03       P.
                inc $0309,x                  ; D7FF= FE 09 03    ~..
LD802:
                dey                          ; D802= 88          .
                bne LD7D6                    ; D803= D0 D1       PQ
                bit $0309,x                  ; D805= 3C 09 03    <..
                bvc LD815                    ; D808= 50 0B       P.
                lda $DC                      ; D80A= A5 DC       %\
                sta $0308,x                  ; D80C= 9D 08 03    ...
                lda $DD                      ; D80F= A5 DD       %]
                sta $0309,x                  ; D811= 9D 09 03    ...
                rts                          ; D814= 60          `

LD815:
                ldy #$10                     ; D815= A0 10        .
LD817:
                rol $DC                      ; D817= 26 DC       &\
                rol $DD                      ; D819= 26 DD       &]
                rol $0308,x                  ; D81B= 3E 08 03    >..
                rol $0309,x                  ; D81E= 3E 09 03    >..
                sec                          ; D821= 38          8
                lda $0308,x                  ; D822= BD 08 03    =..
                sbc $0306,x                  ; D825= FD 06 03    }..
                sta $DE                      ; D828= 85 DE       .^
                lda $0309,x                  ; D82A= BD 09 03    =..
                sbc $0307,x                  ; D82D= FD 07 03    }..
                bcc LD83A                    ; D830= 90 08       ..
                sta $0309,x                  ; D832= 9D 09 03    ...
                lda $DE                      ; D835= A5 DE       %^
                sta $0308,x                  ; D837= 9D 08 03    ...
LD83A:
                dey                          ; D83A= 88          .
                bne LD817                    ; D83B= D0 DA       PZ
                rol $DC                      ; D83D= 26 DC       &\
                rol $DD                      ; D83F= 26 DD       &]
                sec                          ; D841= 38          8
                lda $0308,x                  ; D842= BD 08 03    =..
                sbc $0306,x                  ; D845= FD 06 03    }..
                sta $0308,x                  ; D848= 9D 08 03    ...
                lda $0309,x                  ; D84B= BD 09 03    =..
                sbc $0307,x                  ; D84E= FD 07 03    }..
                sta $0309,x                  ; D851= 9D 09 03    ...
                lda $0300,x                  ; D854= BD 00 03    =..
                ldy $0301,x                  ; D857= BC 01 03    <..
                asl $DA                      ; D85A= 06 DA       .Z
                bcs LD869                    ; D85C= B0 0B       0.
                sec                          ; D85E= 38          8
                adc $DC                      ; D85F= 65 DC       e\
                sta $0300,x                  ; D861= 9D 00 03    ...
                tya                          ; D864= 98          .
                adc $DD                      ; D865= 65 DD       e]
                bra LD872                    ; D867= 80 09       ..

LD869:
                clc                          ; D869= 18          .
                sbc $DC                      ; D86A= E5 DC       e\
                sta $0300,x                  ; D86C= 9D 00 03    ...
                tya                          ; D86F= 98          .
                sbc $DD                      ; D870= E5 DD       e]
LD872:
                sta $0301,x                  ; D872= 9D 01 03    ...
LD875:
                rts                          ; D875= 60          `

LD876:
                asl $0332                    ; D876= 0E 32 03    .2.
                ldy #$2C                     ; D879= A0 2C        ,
                jsr LC916                    ; D87B= 20 16 C9     .I
                asl $DB                      ; D87E= 06 DB       .[
                bcc LD88F                    ; D880= 90 0D       ..
                jsr LDA26                    ; D882= 20 26 DA     &Z
                beq LD875                    ; D885= F0 EE       pn
                ldx #$00                     ; D887= A2 00       ".
                lda $0332                    ; D889= AD 32 03    -2.
                jsr LDA0F                    ; D88C= 20 0F DA     .Z
LD88F:
                bit $DB                      ; D88F= 24 DB       $[
                bvc LD8A2                    ; D891= 50 0F       P.
                jsr LDA26                    ; D893= 20 26 DA     &Z
                beq LD875                    ; D896= F0 DD       p]
                ldx #$04                     ; D898= A2 04       ".
                lda $0332                    ; D89A= AD 32 03    -2.
                eor #$80                     ; D89D= 49 80       I.
                jsr LDA0F                    ; D89F= 20 0F DA     .Z
LD8A2:
                ldx #$28                     ; D8A2= A2 28       "(
                ldy #$2C                     ; D8A4= A0 2C        ,
                jmp LDAE8                    ; D8A6= 4C E8 DA    LhZ

LD8A9:
                asl a                        ; D8A9= 0A          .
                asl a                        ; D8AA= 0A          .
                sta $DB                      ; D8AB= 85 DB       .[
                and #$C0                     ; D8AD= 29 C0       )@
                eor #$40                     ; D8AF= 49 40       I@
                bne LD8B9                    ; D8B1= D0 06       P.
                lda $0367                    ; D8B3= AD 67 03    -g.
                sta $0368                    ; D8B6= 8D 68 03    .h.
LD8B9:
                jsr LD1A6                    ; D8B9= 20 A6 D1     &Q
                sta $DC                      ; D8BC= 85 DC       .\
                beq LD8C4                    ; D8BE= F0 04       p.
                lda #$80                     ; D8C0= A9 80       ).
                trb $DB                      ; D8C2= 14 DB       .[
LD8C4:
                ldx #$20                     ; D8C4= A2 20       "
                jsr LD1A8                    ; D8C6= 20 A8 D1     (Q
                sta $E0                      ; D8C9= 85 E0       .`
                beq LD8D7                    ; D8CB= F0 0A       p.
                tax                          ; D8CD= AA          *
                lda #$20                     ; D8CE= A9 20       )
                trb $DB                      ; D8D0= 14 DB       .[
                txa                          ; D8D2= 8A          .
                bit $DC                      ; D8D3= 24 DC       $\
LD8D5:
                bne LD875                    ; D8D5= D0 9E       P.
LD8D7:
                ldy #$24                     ; D8D7= A0 24        $
                lda #$20                     ; D8D9= A9 20       )
                ldx #$28                     ; D8DB= A2 28       "(
                jsr L9B09                    ; D8DD= 20 09 9B     ..
                bit $DB                      ; D8E0= 24 DB       $[
                bvs LD8EC                    ; D8E2= 70 08       p.
                lda $032E                    ; D8E4= AD 2E 03    -..
                ora $032F                    ; D8E7= 0D 2F 03    ./.
                beq LD876                    ; D8EA= F0 8A       p.
LD8EC:
                lda $DC                      ; D8EC= A5 DC       %\
                bit #$0C                     ; D8EE= 89 0C       ..
                beq LD900                    ; D8F0= F0 0E       p.
                ldx #$28                     ; D8F2= A2 28       "(
                jsr LD77B                    ; D8F4= 20 7B D7     {W
                ldx #$28                     ; D8F7= A2 28       "(
                jsr LD1A8                    ; D8F9= 20 A8 D1     (Q
                bit $E0                      ; D8FC= 24 E0       $`
                bne LD8D5                    ; D8FE= D0 D5       PU
LD900:
                bit #$03                     ; D900= 89 03       ..
                beq LD90E                    ; D902= F0 0A       p.
                ldx #$28                     ; D904= A2 28       "(
                jsr LD6C8                    ; D906= 20 C8 D6     HV
                ldx #$28                     ; D909= A2 28       "(
                jsr LD1A8                    ; D90B= 20 A8 D1     (Q
LD90E:
                tay                          ; D90E= A8          (
                bne LD8D5                    ; D90F= D0 C4       PD
                ldy #$20                     ; D911= A0 20
                ldx #$22                     ; D913= A2 22       ""
                lda $E0                      ; D915= A5 E0       %`
                beq LD928                    ; D917= F0 0F       p.
                ldy #$04                     ; D919= A0 04        .
                ldx #$06                     ; D91B= A2 06       ".
                bit $0332                    ; D91D= 2C 32 03    ,2.
                bpl LD924                    ; D920= 10 02       ..
                ldx #$02                     ; D922= A2 02       ".
LD924:
                bvc LD928                    ; D924= 50 02       P.
                ldy #$00                     ; D926= A0 00        .
LD928:
                clc                          ; D928= 18          .
                lda $0300,x                  ; D929= BD 00 03    =..
                sbc $032A                    ; D92C= ED 2A 03    m*.
                bcc LD934                    ; D92F= 90 03       ..
                inc a                        ; D931= 1A          .
                eor #$FF                     ; D932= 49 FF       I.
LD934:
                sta $DC                      ; D934= 85 DC       .\
                clc                          ; D936= 18          .
                lda $0300,y                  ; D937= B9 00 03    9..
                sbc $0328                    ; D93A= ED 28 03    m(.
                tax                          ; D93D= AA          *
                lda $0301,y                  ; D93E= B9 01 03    9..
                sbc $0329                    ; D941= ED 29 03    m).
                bmi LD952                    ; D944= 30 0C       0.
                inx                          ; D946= E8          h
                bne LD94A                    ; D947= D0 01       P.
                inc a                        ; D949= 1A          .
LD94A:
                eor #$FF                     ; D94A= 49 FF       I.
                tay                          ; D94C= A8          (
                txa                          ; D94D= 8A          .
                eor #$FF                     ; D94E= 49 FF       I.
                tax                          ; D950= AA          *
                tya                          ; D951= 98          .
LD952:
                sta $DD                      ; D952= 85 DD       .]
                stx $E0                      ; D954= 86 E0       .`
                ldx #$28                     ; D956= A2 28       "(
                jsr LDF41                    ; D958= 20 41 DF     A_
                asl $DB                      ; D95B= 06 DB       .[
                bcs LD989                    ; D95D= B0 2A       0*
LD95F:
                bit $DB                      ; D95F= 24 DB       $[
                bvc LD96E                    ; D961= 50 0B       P.
                lda $E0                      ; D963= A5 E0       %`
                and $DC                      ; D965= 25 DC       %\
                and $DD                      ; D967= 25 DD       %]
                inc a                        ; D969= 1A          .
                beq LD9A0                    ; D96A= F0 34       p4
                bit $DB                      ; D96C= 24 DB       $[
LD96E:
                bpl LD979                    ; D96E= 10 09       ..
                lda $0368                    ; D970= AD 68 03    -h.
                asl a                        ; D973= 0A          .
                rol $0368                    ; D974= 2E 68 03    .h.
                bcc LD989                    ; D977= 90 10       ..
LD979:
                lda ZMASK                      ; D979= A5 D1       %Q
                and ZGORA                      ; D97B= 25 D4       %T
                ora (ZMEMG),y                  ; D97D= 11 D6       .V
                sta $DA                      ; D97F= 85 DA       .Z
                lda ZMASK                      ; D981= A5 D1       %Q
                and ZGEOR                      ; D983= 25 D5       %U
                eor $DA                      ; D985= 45 DA       EZ
                sta (ZMEMG),y                  ; D987= 91 D6       .V
LD989:
                lda $0331                    ; D989= AD 31 03    -1.
                bpl LD9DC                    ; D98C= 10 4E       .N
                inc $DC                      ; D98E= E6 DC       f\
                beq LD9A0                    ; D990= F0 0E       p.
                bit $0332                    ; D992= 2C 32 03    ,2.
                bmi LD9A1                    ; D995= 30 0A       0.
                dey                          ; D997= 88          .
                dex                          ; D998= CA          J
                bpl LD9BF                    ; D999= 10 24       .$
                jsr LDA4C                    ; D99B= 20 4C DA     LZ
                bra LD9BF                    ; D99E= 80 1F       ..

LD9A0:
                rts                          ; D9A0= 60          `

LD9A1:
                iny                          ; D9A1= C8          H
                inx                          ; D9A2= E8          h
                cpx #$08                     ; D9A3= E0 08       `.
                bne LD9BF                    ; D9A5= D0 18       P.
                sec                          ; D9A7= 38          8
                tya                          ; D9A8= 98          .
                sbc #$08                     ; D9A9= E9 08       i.
                clc                          ; D9AB= 18          .
                adc $0352                    ; D9AC= 6D 52 03    mR.
                tay                          ; D9AF= A8          (
                lda ZMEMG+1                      ; D9B0= A5 D7       %W
                adc $0353                    ; D9B2= 6D 53 03    mS.
                bpl LD9BB                    ; D9B5= 10 04       ..
                sec                          ; D9B7= 38          8
                sbc $0354                    ; D9B8= ED 54 03    mT.
LD9BB:
                sta ZMEMG+1                      ; D9BB= 85 D7       .W
                ldx #$00                     ; D9BD= A2 00       ".
LD9BF:
                lda $0369                    ; D9BF= AD 69 03    -i.
                beq LD9C7                    ; D9C2= F0 03       p.
                jsr LDA7C                    ; D9C4= 20 7C DA     |Z
LD9C7:
                clc                          ; D9C7= 18          .
                lda $0330                    ; D9C8= AD 30 03    -0.
                adc $032C                    ; D9CB= 6D 2C 03    m,.
                sta $0330                    ; D9CE= 8D 30 03    .0.
                lda $0331                    ; D9D1= AD 31 03    -1.
                adc $032D                    ; D9D4= 6D 2D 03    m-.
                sta $0331                    ; D9D7= 8D 31 03    .1.
                bmi LD95F                    ; D9DA= 30 83       0.
LD9DC:
                inc $E0                      ; D9DC= E6 E0       f`
                bne LD9E4                    ; D9DE= D0 04       P.
                inc $DD                      ; D9E0= E6 DD       f]
                beq LD9A0                    ; D9E2= F0 BC       p<
LD9E4:
                bit $0332                    ; D9E4= 2C 32 03    ,2.
                bvs LD9F2                    ; D9E7= 70 09       p.
                lsr ZMASK                      ; D9E9= 46 D1       FQ
                bcc LD9F9                    ; D9EB= 90 0C       ..
                jsr LDA67                    ; D9ED= 20 67 DA     gZ
                bra LD9F9                    ; D9F0= 80 07       ..

LD9F2:
                asl ZMASK                      ; D9F2= 06 D1       .Q
                bcc LD9F9                    ; D9F4= 90 03       ..
                jsr LDA34                    ; D9F6= 20 34 DA     4Z
LD9F9:
                sec                          ; D9F9= 38          8
                lda $0330                    ; D9FA= AD 30 03    -0.
                sbc $032E                    ; D9FD= ED 2E 03    m..
                sta $0330                    ; DA00= 8D 30 03    .0.
                lda $0331                    ; DA03= AD 31 03    -1.
                sbc $032F                    ; DA06= ED 2F 03    m/.
                sta $0331                    ; DA09= 8D 31 03    .1.
                jmp LD95F                    ; DA0C= 4C 5F D9    L_Y

LDA0F:
                bmi LDA1A                    ; DA0F= 30 09       0.
                inc $0328,x                  ; DA11= FE 28 03    ~(.
                bne LDA25                    ; DA14= D0 0F       P.
                inc $0329,x                  ; DA16= FE 29 03    ~).
                rts                          ; DA19= 60          `

LDA1A:
                lda $0328,x                  ; DA1A= BD 28 03    =(.
                bne LDA22                    ; DA1D= D0 03       P.
                dec $0329,x                  ; DA1F= DE 29 03    ^).
LDA22:
                dec $0328,x                  ; DA22= DE 28 03    ^(.
LDA25:
                rts                          ; DA25= 60          `

LDA26:
                ldy #$04                     ; DA26= A0 04        .
LDA28:
                lda $0327,y                  ; DA28= B9 27 03    9'.
                cmp $032B,y                  ; DA2B= D9 2B 03    Y+.
                bne LDA33                    ; DA2E= D0 03       P.
                dey                          ; DA30= 88          .
                bne LDA28                    ; DA31= D0 F5       Pu
LDA33:
                rts                          ; DA33= 60          `

LDA34:
                lda $0363                    ; DA34= AD 63 03    -c.
                sta ZMASK                      ; DA37= 85 D1       .Q
                tya                          ; DA39= 98          .
                sbc #$08                     ; DA3A= E9 08       i.
                tay                          ; DA3C= A8          (
                bcs LDA4B                    ; DA3D= B0 0C       0.
                lda ZMEMG+1                      ; DA3F= A5 D7       %W
                dec a                        ; DA41= 3A          :
                cmp $034E                    ; DA42= CD 4E 03    MN.
                bcs LDA49                    ; DA45= B0 02       0.
                lda #$7F                     ; DA47= A9 7F       ).
LDA49:
                sta ZMEMG+1                      ; DA49= 85 D7       .W
LDA4B:
                rts                          ; DA4B= 60          `

LDA4C:
                clc                          ; DA4C= 18          .
                tya                          ; DA4D= 98          .
                adc #$08                     ; DA4E= 69 08       i.
                sec                          ; DA50= 38          8
                sbc $0352                    ; DA51= ED 52 03    mR.
                tay                          ; DA54= A8          (
                lda ZMEMG+1                      ; DA55= A5 D7       %W
                sbc $0353                    ; DA57= ED 53 03    mS.
                cmp $034E                    ; DA5A= CD 4E 03    MN.
                bcs LDA62                    ; DA5D= B0 03       0.
                adc $0354                    ; DA5F= 6D 54 03    mT.
LDA62:
                sta ZMEMG+1                      ; DA62= 85 D7       .W
                ldx #$07                     ; DA64= A2 07       ".
                rts                          ; DA66= 60          `

LDA67:
                lda $0362                    ; DA67= AD 62 03    -b.
                sta ZMASK                      ; DA6A= 85 D1       .Q
LDA6C:
                tya                          ; DA6C= 98          .
                adc #$07                     ; DA6D= 69 07       i.
                tay                          ; DA6F= A8          (
                bcc LDA7B                    ; DA70= 90 09       ..
                inc ZMEMG+1                      ; DA72= E6 D7       fW
                bpl LDA7B                    ; DA74= 10 05       ..
                lda $034E                    ; DA76= AD 4E 03    -N.
                sta ZMEMG+1                      ; DA79= 85 D7       .W
LDA7B:
                rts                          ; DA7B= 60          `

LDA7C:
                phx                          ; DA7C= DA          Z
                txa                          ; DA7D= 8A          .
                ora $0359                    ; DA7E= 0D 59 03    .Y.
                tax                          ; DA81= AA          *
                lda L8820,x                  ; DA82= BD 20 88    = .
                ldx $035A                    ; DA85= AE 5A 03    .Z.
                pha                          ; DA88= 48          H
                ora LE144,x                  ; DA89= 1D 44 E1    .Da
                eor LE145,x                  ; DA8C= 5D 45 E1    ]Ea
                sta ZGORA                      ; DA8F= 85 D4       .T
                pla                          ; DA91= 68          h
                ora LE143,x                  ; DA92= 1D 43 E1    .Ca
                eor LE148,x                  ; DA95= 5D 48 E1    ]Ha
                sta ZGEOR                      ; DA98= 85 D5       .U
                plx                          ; DA9A= FA          z
                rts                          ; DA9B= 60          `

LDA9C:
                lda $0301,y                  ; DA9C= B9 01 03    9..
                pha                          ; DA9F= 48          H
                lda $0300,y                  ; DAA0= B9 00 03    9..
                pha                          ; DAA3= 48          H
                and $0361                    ; DAA4= 2D 61 03    -a.
                clc                          ; DAA7= 18          .
                adc $0361                    ; DAA8= 6D 61 03    ma.
                tay                          ; DAAB= A8          (
                lda LE12E,y                  ; DAAC= B9 2E E1    9.a
                eor LE120,y                  ; DAAF= 59 20 E1    Y a
                sta $DC                      ; DAB2= 85 DC       .\
                lda $0300,x                  ; DAB4= BD 00 03    =..
                and $0361                    ; DAB7= 2D 61 03    -a.
                adc $0361                    ; DABA= 6D 61 03    ma.
                tay                          ; DABD= A8          (
                lda LE120,y                  ; DABE= B9 20 E1    9 a
                sta ZMASK                      ; DAC1= 85 D1       .Q
                sec                          ; DAC3= 38          8
                pla                          ; DAC4= 68          h
                ora $0361                    ; DAC5= 0D 61 03    .a.
                sbc $0300,x                  ; DAC8= FD 00 03    }..
                tay                          ; DACB= A8          (
                pla                          ; DACC= 68          h
                sbc $0301,x                  ; DACD= FD 01 03    }..
                sta $DD                      ; DAD0= 85 DD       .]
                tya                          ; DAD2= 98          .
                ldy $0361                    ; DAD3= AC 61 03    ,a.
                cpy #$03                     ; DAD6= C0 03       @.
                beq LDADF                    ; DAD8= F0 05       p.
                bcc LDAE2                    ; DADA= 90 06       ..
                lsr $DD                      ; DADC= 46 DD       F]
                ror a                        ; DADE= 6A          j
LDADF:
                lsr $DD                      ; DADF= 46 DD       F]
                ror a                        ; DAE1= 6A          j
LDAE2:
                lsr a                        ; DAE2= 4A          J
LDAE3:
                rts                          ; DAE3= 60          `

LDAE4:
                ldx #$42                     ; DAE4= A2 42       "B
                ldy #$46                     ; DAE6= A0 46        F
LDAE8:
                jsr LD5CC                    ; DAE8= 20 CC D5     LU
                stx $DE                      ; DAEB= 86 DE       .^
                sty $DF                      ; DAED= 84 DF       ._
                ldx $DF                      ; DAEF= A6 DF       &_
                ldy #$00                     ; DAF1= A0 00        .
                jsr LD1B7                    ; DAF3= 20 B7 D1     7Q
                beq LDAFF                    ; DAF6= F0 07       p.
                lsr a                        ; DAF8= 4A          J
                beq LDAE3                    ; DAF9= F0 E8       ph
                ldx #$04                     ; DAFB= A2 04       ".
                stx $DF                      ; DAFD= 86 DF       ._
LDAFF:
                ldx $DE                      ; DAFF= A6 DE       &^
                jsr LD1A8                    ; DB01= 20 A8 D1     (Q
                lsr a                        ; DB04= 4A          J
                bne LDAE3                    ; DB05= D0 DC       P\
                lda $0302,x                  ; DB07= BD 02 03    =..
                bcc LDB10                    ; DB0A= 90 04       ..
                ldx #$00                     ; DB0C= A2 00       ".
                stx $DE                      ; DB0E= 86 DE       .^
LDB10:
                jsr LDECB                    ; DB10= 20 CB DE     K^
                ldx $DE                      ; DB13= A6 DE       &^
                ldy $DF                      ; DB15= A4 DF       $_
                jsr LDA9C                    ; DB17= 20 9C DA     .Z
                tax                          ; DB1A= AA          *
                ldy $031A                    ; DB1B= AC 1A 03    ,..
                txa                          ; DB1E= 8A          .
                beq LDB44                    ; DB1F= F0 23       p#
                jsr LDB51                    ; DB21= 20 51 DB     Q[
                bra LDB2E                    ; DB24= 80 08       ..

LDB26:
                lda (ZMEMG),y                  ; DB26= B1 D6       1V
                ora ZGORA                      ; DB28= 05 D4       .T
                eor ZGEOR                      ; DB2A= 45 D5       EU
                sta (ZMEMG),y                  ; DB2C= 91 D6       .V
LDB2E:
                tya                          ; DB2E= 98          .
                clc                          ; DB2F= 18          .
                adc #$08                     ; DB30= 69 08       i.
                tay                          ; DB32= A8          (
                bcc LDB3E                    ; DB33= 90 09       ..
                inc ZMEMG+1                      ; DB35= E6 D7       fW
                bpl LDB3E                    ; DB37= 10 05       ..
                lda $034E                    ; DB39= AD 4E 03    -N.
                sta ZMEMG+1                      ; DB3C= 85 D7       .W
LDB3E:
                dex                          ; DB3E= CA          J
                bne LDB26                    ; DB3F= D0 E5       Pe
                dex                          ; DB41= CA          J
                stx ZMASK                      ; DB42= 86 D1       .Q
LDB44:
                lda $DC                      ; DB44= A5 DC       %\
                trb ZMASK                      ; DB46= 14 D1       .Q
                bra LDB51                    ; DB48= 80 07       ..

LDB4A:
                ldx #$20                     ; DB4A= A2 20       "
LDB4C:
                jsr LDEC3                    ; DB4C= 20 C3 DE     C^
                bne LDB61                    ; DB4F= D0 10       P.
LDB51:
                lda ZMASK                      ; DB51= A5 D1       %Q
                and ZGORA                      ; DB53= 25 D4       %T
                ora (ZMEMG),y                  ; DB55= 11 D6       .V
                sta $DA                      ; DB57= 85 DA       .Z
                lda ZGEOR                      ; DB59= A5 D5       %U
                and ZMASK                      ; DB5B= 25 D1       %Q
                eor $DA                      ; DB5D= 45 DA       EZ
LDB5F:
                sta (ZMEMG),y                  ; DB5F= 91 D6       .V
LDB61:
                rts                          ; DB61= 60          `

                ldx #$2A                     ; DB62= A2 2A       "*
                ldy #$32                     ; DB64= A0 32        2
                jsr LC90C                    ; DB66= 20 0C C9     .I
                ldx #$36                     ; DB69= A2 36       "6
                ldy #$3E                     ; DB6B= A0 3E        >
                jsr LC90C                    ; DB6D= 20 0C C9     .I
                ldx #$2A                     ; DB70= A2 2A       "*
                jsr LD1B5                    ; DB72= 20 B5 D1     5Q
                pha                          ; DB75= 48          H
                ldx #$36                     ; DB76= A2 36       "6
                jsr LD1B5                    ; DB78= 20 B5 D1     5Q
                beq LDB8C                    ; DB7B= F0 0F       p.
                pla                          ; DB7D= 68          h
                bne LDB85                    ; DB7E= D0 05       P.
                lda $0345                    ; DB80= AD 45 03    -E.
                beq LDB86                    ; DB83= F0 01       p.
LDB85:
                rts                          ; DB85= 60          `

LDB86:
                ldx #$28                     ; DB86= A2 28       "(
                ldy #$2C                     ; DB88= A0 2C        ,
                bra LDB93                    ; DB8A= 80 07       ..

LDB8C:
                pla                          ; DB8C= 68          h
                beq LDB96                    ; DB8D= F0 07       p.
                ldx #$34                     ; DB8F= A2 34       "4
                ldy #$38                     ; DB91= A0 38        8
LDB93:
                jmp LDAE8                    ; DB93= 4C E8 DA    LhZ

LDB96:
                ldx #$30                     ; DB96= A2 30       "0
                jsr LDEC8                    ; DB98= 20 C8 DE     H^
                bit $0347                    ; DB9B= 2C 47 03    ,G.
                bmi LDBA9                    ; DB9E= 30 09       0.
                tya                          ; DBA0= 98          .
                sec                          ; DBA1= 38          8
                sbc #$08                     ; DBA2= E9 08       i.
                tay                          ; DBA4= A8          (
                bcs LDBA9                    ; DBA5= B0 02       0.
                dec ZMEMG+1                      ; DBA7= C6 D7       FW
LDBA9:
                lda $0344                    ; DBA9= AD 44 03    -D.
                sta $DD                      ; DBAC= 85 DD       .]
LDBAE:
                lda (ZMEMG),y                  ; DBAE= B1 D6       1V
                ldx $0342                    ; DBB0= AE 42 03    .B.
                beq LDBB9                    ; DBB3= F0 04       p.
LDBB5:
                asl a                        ; DBB5= 0A          .
                dex                          ; DBB6= CA          J
                bne LDBB5                    ; DBB7= D0 FC       P|
LDBB9:
                sta $DA                      ; DBB9= 85 DA       .Z
                sec                          ; DBBB= 38          8
                jsr LDA6C                    ; DBBC= 20 6C DA     lZ
                lda (ZMEMG),y                  ; DBBF= B1 D6       1V
                ldx $0343                    ; DBC1= AE 43 03    .C.
                beq LDBCA                    ; DBC4= F0 04       p.
LDBC6:
                lsr a                        ; DBC6= 4A          J
                dex                          ; DBC7= CA          J
                bne LDBC6                    ; DBC8= D0 FC       P|
LDBCA:
                eor $DA                      ; DBCA= 45 DA       EZ
                and $E1                      ; DBCC= 25 E1       %a
                eor $DA                      ; DBCE= 45 DA       EZ
                ldx $DD                      ; DBD0= A6 DD       &]
                sta L8830,x                  ; DBD2= 9D 30 88    .0.
                dec $DD                      ; DBD5= C6 DD       F]
                bpl LDBAE                    ; DBD7= 10 D5       .U
                ldx #$34                     ; DBD9= A2 34       "4
                ldy #$38                     ; DBDB= A0 38        8
                jsr LDAE8                    ; DBDD= 20 E8 DA     hZ
                lda $0345                    ; DBE0= AD 45 03    -E.
                bne LDBE8                    ; DBE3= D0 03       P.
                jsr LDB86                    ; DBE5= 20 86 DB     .[
LDBE8:
                ldx #$3C                     ; DBE8= A2 3C       "<
                jsr LDEC8                    ; DBEA= 20 C8 DE     H^
                lda $0346                    ; DBED= AD 46 03    -F.
                sta $DA                      ; DBF0= 85 DA       .Z
                ldx $0344                    ; DBF2= AE 44 03    .D.
                beq LDC0C                    ; DBF5= F0 15       p.
                jsr LDC10                    ; DBF7= 20 10 DC     .\
                lda #$FF                     ; DBFA= A9 FF       ).
                sta $DA                      ; DBFC= 85 DA       .Z
                bra LDC05                    ; DBFE= 80 05       ..

LDC00:
                lda L8830,x                  ; DC00= BD 30 88    =0.
                sta (ZMEMG),y                  ; DC03= 91 D6       .V
LDC05:
                sec                          ; DC05= 38          8
                jsr LDA6C                    ; DC06= 20 6C DA     lZ
                dex                          ; DC09= CA          J
                bne LDC00                    ; DC0A= D0 F4       Pt
LDC0C:
                lda $E0                      ; DC0C= A5 E0       %`
                trb $DA                      ; DC0E= 14 DA       .Z
LDC10:
                lda L8830,x                  ; DC10= BD 30 88    =0.
                eor (ZMEMG),y                  ; DC13= 51 D6       QV
                and $DA                      ; DC15= 25 DA       %Z
                eor (ZMEMG),y                  ; DC17= 51 D6       QV
                sta (ZMEMG),y                  ; DC19= 91 D6       .V
                rts                          ; DC1B= 60          `

LDC1C:
                lda $0337                    ; DC1C= AD 37 03    -7.
                inc a                        ; DC1F= 1A          .
                cmp $0336                    ; DC20= CD 36 03    M6.
                beq LDC47                    ; DC23= F0 22       p"
                sta $0337                    ; DC25= 8D 37 03    .7.
                tax                          ; DC28= AA          *
                lda $032E                    ; DC29= AD 2E 03    -..
                sta L8400,x                  ; DC2C= 9D 00 84    ...
                lda $0332                    ; DC2F= AD 32 03    -2.
                sta L8500,x                  ; DC32= 9D 00 85    ...
                lda $032F                    ; DC35= AD 2F 03    -/.
                asl a                        ; DC38= 0A          .
                asl a                        ; DC39= 0A          .
                ora $0333                    ; DC3A= 0D 33 03    .3.
                sta L8600,x                  ; DC3D= 9D 00 86    ...
                lda $0330                    ; DC40= AD 30 03    -0.
                sta L8700,x                  ; DC43= 9D 00 87    ...
LDC46:
                clc                          ; DC46= 18          .
LDC47:
                rts                          ; DC47= 60          `

LDC48:
                sta $032A                    ; DC48= 8D 2A 03    .*.
                ldx #$28                     ; DC4B= A2 28       "(
                jsr LDCB0                    ; DC4D= 20 B0 DC     0\
                bne LDC5C                    ; DC50= D0 0A       P.
LDC52:
                jsr LDC1C                    ; DC52= 20 1C DC     .\
                bcs LDC47                    ; DC55= B0 F0       0p
                jsr L9D57                    ; DC57= 20 57 9D     W.
                bcs LDC46                    ; DC5A= B0 EA       0j
LDC5C:
                jsr LDCC1                    ; DC5C= 20 C1 DC     A\
                jsr L9D57                    ; DC5F= 20 57 9D     W.
                bcs LDC46                    ; DC62= B0 E2       0b
                jsr LDCD7                    ; DC64= 20 D7 DC     W\
                jsr LDCB8                    ; DC67= 20 B8 DC     8\
                bra LDC52                    ; DC6A= 80 E6       .f

LDC6C:
                jsr LDD9F                    ; DC6C= 20 9F DD     .]
                jsr LDCB0                    ; DC6F= 20 B0 DC     0\
                clc                          ; DC72= 18          .
                bra LDC83                    ; DC73= 80 0E       ..

LDC75:
                jsr LDD9F                    ; DC75= 20 9F DD     .]
                jsr LDCC9                    ; DC78= 20 C9 DC     I\
                jsr LDCD2                    ; DC7B= 20 D2 DC     R\
                bne LDC83                    ; DC7E= D0 03       P.
                jsr LDCB8                    ; DC80= 20 B8 DC     8\
LDC83:
                php                          ; DC83= 08          .
                ldx #$2E                     ; DC84= A2 2E       ".
                ldy #$14                     ; DC86= A0 14        .
                jsr LC91E                    ; DC88= 20 1E C9     .I
                plp                          ; DC8B= 28          (
                php                          ; DC8C= 08          .
                beq LDC91                    ; DC8D= F0 02       p.
                ldx #$2E                     ; DC8F= A2 2E       ".
LDC91:
                ldy #$24                     ; DC91= A0 24        $
                jsr LC90C                    ; DC93= 20 0C C9     .I
                ldx #$30                     ; DC96= A2 30       "0
                jsr LC90C                    ; DC98= 20 0C C9     .I
                plp                          ; DC9B= 28          (
                beq LDCA3                    ; DC9C= F0 05       p.
                bcs LDCA4                    ; DC9E= B0 04       0.
                inc $0316                    ; DCA0= EE 16 03    n..
LDCA3:
                rts                          ; DCA3= 60          `

LDCA4:
                lda $0324                    ; DCA4= AD 24 03    -$.
                bne LDCAC                    ; DCA7= D0 03       P.
                dec $0325                    ; DCA9= CE 25 03    N%.
LDCAC:
                dec $0324                    ; DCAC= CE 24 03    N$.
                rts                          ; DCAF= 60          `

LDCB0:
                jsr LDCD2                    ; DCB0= 20 D2 DC     R\
                bne LDD0A                    ; DCB3= D0 55       PU
                jsr LDD0B                    ; DCB5= 20 0B DD     .]
LDCB8:
                ldx #$2E                     ; DCB8= A2 2E       ".
                ldy #$32                     ; DCBA= A0 32        2
                jsr LDAE8                    ; DCBC= 20 E8 DA     hZ
                bra LDD07                    ; DCBF= 80 46       .F

LDCC1:
                jsr LDCC9                    ; DCC1= 20 C9 DC     I\
                ldx #$2C                     ; DCC4= A2 2C       ",
                jsr LDCD9                    ; DCC6= 20 D9 DC     Y\
LDCC9:
                php                          ; DCC9= 08          .
                lda $E1                      ; DCCA= A5 E1       %a
                eor #$08                     ; DCCC= 49 08       I.
                sta $E1                      ; DCCE= 85 E1       .a
                plp                          ; DCD0= 28          (
                rts                          ; DCD1= 60          `

LDCD2:
                ldy #$2E                     ; DCD2= A0 2E        .
                jsr LC91E                    ; DCD4= 20 1E C9     .I
LDCD7:
                ldx #$04                     ; DCD7= A2 04       ".
LDCD9:
                ldy #$34                     ; DCD9= A0 34        4
                jsr LC90C                    ; DCDB= 20 0C C9     .I
                ldx #$34                     ; DCDE= A2 34       "4
                jsr LDD35                    ; DCE0= 20 35 DD     5]
                bne LDD0A                    ; DCE3= D0 25       P%
LDCE5:
                lsr ZMASK                      ; DCE5= 46 D1       FQ
                bcc LDCF1                    ; DCE7= 90 08       ..
LDCE9:
                jsr LDA67                    ; DCE9= 20 67 DA     gZ
                jsr LDD65                    ; DCEC= 20 65 DD     e]
                bcs LDCE9                    ; DCEF= B0 F8       0x
LDCF1:
                jsr LDD85                    ; DCF1= 20 85 DD     .]
                bcs LDCE5                    ; DCF4= B0 EF       0o
                sec                          ; DCF6= 38          8
                lda $0334                    ; DCF7= AD 34 03    -4.
                sbc $DE                      ; DCFA= E5 DE       e^
                sta $0332                    ; DCFC= 8D 32 03    .2.
                lda $0335                    ; DCFF= AD 35 03    -5.
                sbc $DF                      ; DD02= E5 DF       e_
                sta $0333                    ; DD04= 8D 33 03    .3.
LDD07:
                lda #$00                     ; DD07= A9 00       ).
                sec                          ; DD09= 38          8
LDD0A:
                rts                          ; DD0A= 60          `

LDD0B:
                ldx #$00                     ; DD0B= A2 00       ".
                jsr LDD35                    ; DD0D= 20 35 DD     5]
                bne LDD0A                    ; DD10= D0 F8       Px
LDD12:
                asl ZMASK                      ; DD12= 06 D1       .Q
                bcc LDD1E                    ; DD14= 90 08       ..
LDD16:
                jsr LDA34                    ; DD16= 20 34 DA     4Z
                jsr LDD65                    ; DD19= 20 65 DD     e]
                bcs LDD16                    ; DD1C= B0 F8       0x
LDD1E:
                jsr LDD85                    ; DD1E= 20 85 DD     .]
                bcs LDD12                    ; DD21= B0 EF       0o
                lda $0300                    ; DD23= AD 00 03    -..
                adc $DE                      ; DD26= 65 DE       e^
                sta $032E                    ; DD28= 8D 2E 03    ...
                lda $0301                    ; DD2B= AD 01 03    -..
                adc $DF                      ; DD2E= 65 DF       e_
                sta $032F                    ; DD30= 8D 2F 03    ./.
                bra LDD07                    ; DD33= 80 D2       .R

LDD35:
                sec                          ; DD35= 38          8
                lda $032E                    ; DD36= AD 2E 03    -..
                sbc $0300,x                  ; DD39= FD 00 03    }..
                tay                          ; DD3C= A8          (
                lda $032F                    ; DD3D= AD 2F 03    -/.
                sbc $0301,x                  ; DD40= FD 01 03    }..
                bpl LDD48                    ; DD43= 10 03       ..
                jsr LC92E                    ; DD45= 20 2E C9     .I
LDD48:
                sty $DE                      ; DD48= 84 DE       .^
                sta $DF                      ; DD4A= 85 DF       ._
                ldx #$2E                     ; DD4C= A2 2E       ".
                jsr LDEC3                    ; DD4E= 20 C3 DE     C^
                clc                          ; DD51= 18          .
                bne LDD64                    ; DD52= D0 10       P.
                lda (ZMEMG),y                  ; DD54= B1 D6       1V
                eor L8830,x                  ; DD56= 5D 30 88    ]0.
                sta $DA                      ; DD59= 85 DA       .Z
                and ZMASK                      ; DD5B= 25 D1       %Q
                beq LDD61                    ; DD5D= F0 02       p.
                lda #$08                     ; DD5F= A9 08       ).
LDD61:
                eor $E1                      ; DD61= 45 E1       Ea
                sec                          ; DD63= 38          8
LDD64:
                rts                          ; DD64= 60          `

LDD65:
                lda (ZMEMG),y                  ; DD65= B1 D6       1V
                eor L8830,x                  ; DD67= 5D 30 88    ]0.
                sta $DA                      ; DD6A= 85 DA       .Z
                ora $E1                      ; DD6C= 05 E1       .a
                clc                          ; DD6E= 18          .
                bne LDD84                    ; DD6F= D0 13       P.
                lda $DE                      ; DD71= A5 DE       %^
                sbc $0361                    ; DD73= ED 61 03    ma.
                pha                          ; DD76= 48          H
                lda $DF                      ; DD77= A5 DF       %_
                sbc #$00                     ; DD79= E9 00       i.
                bcc LDD83                    ; DD7B= 90 06       ..
                sta $DF                      ; DD7D= 85 DF       ._
                pla                          ; DD7F= 68          h
                sta $DE                      ; DD80= 85 DE       .^
                rts                          ; DD82= 60          `

LDD83:
                pla                          ; DD83= 68          h
LDD84:
                rts                          ; DD84= 60          `

LDD85:
                lda $DA                      ; DD85= A5 DA       %Z
                and ZMASK                      ; DD87= 25 D1       %Q
                beq LDD8D                    ; DD89= F0 02       p.
                lda #$08                     ; DD8B= A9 08       ).
LDD8D:
                eor $E1                      ; DD8D= 45 E1       Ea
                bne LDD9E                    ; DD8F= D0 0D       P.
                lda $DE                      ; DD91= A5 DE       %^
                bne LDD9B                    ; DD93= D0 06       P.
                lda $DF                      ; DD95= A5 DF       %_
                beq LDD9E                    ; DD97= F0 05       p.
                dec $DF                      ; DD99= C6 DF       F_
LDD9B:
                dec $DE                      ; DD9B= C6 DE       F^
                sec                          ; DD9D= 38          8
LDD9E:
                rts                          ; DD9E= 60          `

LDD9F:
                lsr a                        ; DD9F= 4A          J
                lsr a                        ; DDA0= 4A          J
LDDA1:
                and #$08                     ; DDA1= 29 08       ).
                sta $E1                      ; DDA3= 85 E1       .a
                eor #$0F                     ; DDA5= 49 0F       I.
                tax                          ; DDA7= AA          *
                ldy #$07                     ; DDA8= A0 07        .
LDDAA:
                lda L8820,x                  ; DDAA= BD 20 88    = .
                sta L8830,y                  ; DDAD= 99 30 88    .0.
                dex                          ; DDB0= CA          J
                dey                          ; DDB1= 88          .
                bpl LDDAA                    ; DDB2= 10 F6       .v
                ldx #$20                     ; DDB4= A2 20       "
                rts                          ; DDB6= 60          `

LDDB7:
                jsr LC0FA                    ; DDB7= 20 FA C0     z@
                ldx $0361                    ; DDBA= AE 61 03    .a.
                beq LDDE0                    ; DDBD= F0 21       p!
                pha                          ; DDBF= 48          H
                tax                          ; DDC0= AA          *
                jsr LD1DE                    ; DDC1= 20 DE D1     ^Q
                plx                          ; DDC4= FA          z
                jsr LDEC3                    ; DDC5= 20 C3 DE     C^
                bne LDDE0                    ; DDC8= D0 16       P.
                lda (ZMEMG),y                  ; DDCA= B1 D6       1V
                stz $DA                      ; DDCC= 64 DA       dZ
                bra LDDD1                    ; DDCE= 80 01       ..

LDDD0:
                asl a                        ; DDD0= 0A          .
LDDD1:
                asl ZMASK                      ; DDD1= 06 D1       .Q
                bcc LDDD0                    ; DDD3= 90 FB       .{
                asl a                        ; DDD5= 0A          .
                rol $DA                      ; DDD6= 26 DA       &Z
                ldx ZMASK                      ; DDD8= A6 D1       &Q
                bne LDDD1                    ; DDDA= D0 F5       Pu
                lda $DA                      ; DDDC= A5 DA       %Z
                bra LDDE2                    ; DDDE= 80 02       ..

LDDE0:
                lda #$FF                     ; DDE0= A9 FF       ).
LDDE2:
                jmp LC0CA                    ; DDE2= 4C CA C0    LJ@

LDDE5:
                cmp #$23                     ; DDE5= C9 23       I#
                beq LDDF3                    ; DDE7= F0 0A       p.
                cmp #$5F                     ; DDE9= C9 5F       I_
                beq LDDF5                    ; DDEB= F0 08       p.
                cmp #$60                     ; DDED= C9 60       I`
                bne LDDF7                    ; DDEF= D0 06       P.
                eor #$3F                     ; DDF1= 49 3F       I?
LDDF3:
                eor #$43                     ; DDF3= 49 43       IC
LDDF5:
                eor #$3F                     ; DDF5= 49 3F       I?
LDDF7:
                rts                          ; DDF7= 60          `

LDDF8:
                cli                          ; DDF8= 58          X
                bit STATE                      ; DDF9= 24 D0       $P
                bvc LDE03                    ; DDFB= 50 06       P.
                jsr LC0FA                    ; DDFD= 20 FA C0     z@
                jsr LC0D1                    ; DE00= 20 D1 C0     Q@
LDE03:
                ldy $0360                    ; DE03= AC 60 03    ,`.
                bne LDE1F                    ; DE06= D0 17       P.
                lda ($D8)                    ; DE08= B2 D8       2X
                jsr LDDE5                    ; DE0A= 20 E5 DD     e]
                jsr LDDE5                    ; DE0D= 20 E5 DD     e]
LDE10:
                bit STATE                      ; DE10= 24 D0       $P
                bvc LDE1A                    ; DE12= 50 06       P.
                jsr LC0D1                    ; DE14= 20 D1 C0     Q@
                jsr LC0CA                    ; DE17= 20 CA C0     J@
LDE1A:
                ldy $0355                    ; DE1A= AC 55 03    ,U.
                tax                          ; DE1D= AA          *
                rts                          ; DE1E= 60          `

LDE1F:
                jsr LDE56                    ; DE1F= 20 56 DE     V^
                lda $F4                      ; DE22= A5 F4       %t
                pha                          ; DE24= 48          H
                jsr selectTerminalROMAndANDY                    ; DE25= 20 7F E5     .e
                lda #$20                     ; DE28= A9 20       )
                tax                          ; DE2A= AA          *
                jsr LE22C                    ; DE2B= 20 2C E2     ,b
LDE2E:
                ldy #$07                     ; DE2E= A0 07        .
LDE30:
                lda $0328,y                  ; DE30= B9 28 03    9(.
                eor ($DE),y                  ; DE33= 51 DE       Q^
                bne LDE41                    ; DE35= D0 0A       P.
                dey                          ; DE37= 88          .
                bpl LDE30                    ; DE38= 10 F6       .v
                txa                          ; DE3A= 8A          .
LDE3B:
                plx                          ; DE3B= FA          z
                jsr selectROMX                    ; DE3C= 20 81 E5     .e
                bra LDE10                    ; DE3F= 80 CF       .O

LDE41:
                inx                          ; DE41= E8          h
                clc                          ; DE42= 18          .
                lda $DE                      ; DE43= A5 DE       %^
                adc #$08                     ; DE45= 69 08       i.
                sta $DE                      ; DE47= 85 DE       .^
                bcc LDE4D                    ; DE49= 90 02       ..
                inc $DF                      ; DE4B= E6 DF       f_
LDE4D:
                cpx #$7F                     ; DE4D= E0 7F       `.
                beq LDE41                    ; DE4F= F0 F0       pp
                txa                          ; DE51= 8A          .
                bne LDE2E                    ; DE52= D0 DA       PZ
                bra LDE3B                    ; DE54= 80 E5       .e

LDE56:
                ldx $D8                      ; DE56= A6 D8       &X
                lda $D9                      ; DE58= A5 D9       %Y
                jsr LCED9                    ; DE5A= 20 D9 CE     YN
                ldy #$07                     ; DE5D= A0 07        .
LDE5F:
                ldx $0360                    ; DE5F= AE 60 03    .`.
                cpx #$03                     ; DE62= E0 03       `.
                beq LDE6F                    ; DE64= F0 09       p.
                bcs LDE7B                    ; DE66= B0 13       0.
                lda ($D8),y                  ; DE68= B1 D8       1X
                eor $0358                    ; DE6A= 4D 58 03    MX.
                bra LDE91                    ; DE6D= 80 22       ."

LDE6F:
                lda ($D8),y                  ; DE6F= B1 D8       1X
                jsr LDEA2                    ; DE71= 20 A2 DE     "^
                lda ($DA),y                  ; DE74= B1 DA       1Z
                jsr LDEA2                    ; DE76= 20 A2 DE     "^
                bra LDE8F                    ; DE79= 80 14       ..

LDE7B:
                lda ($D8),y                  ; DE7B= B1 D8       1X
                jsr LDE98                    ; DE7D= 20 98 DE     .^
                lda ($DA),y                  ; DE80= B1 DA       1Z
                jsr LDE98                    ; DE82= 20 98 DE     .^
                lda ($DC),y                  ; DE85= B1 DC       1\
                jsr LDE98                    ; DE87= 20 98 DE     .^
                lda ($E0),y                  ; DE8A= B1 E0       1`
                jsr LDE98                    ; DE8C= 20 98 DE     .^
LDE8F:
                lda $DF                      ; DE8F= A5 DF       %_
LDE91:
                sta $0328,y                  ; DE91= 99 28 03    .(.
                dey                          ; DE94= 88          .
                bpl LDE5F                    ; DE95= 10 C8       .H
                rts                          ; DE97= 60          `

LDE98:
                eor $0358                    ; DE98= 4D 58 03    MX.
                jsr LDEB5                    ; DE9B= 20 B5 DE     5^
                and #$03                     ; DE9E= 29 03       ).
                bra LDEAE                    ; DEA0= 80 0C       ..

LDEA2:
                eor $0358                    ; DEA2= 4D 58 03    MX.
                jsr LDEBA                    ; DEA5= 20 BA DE     :^
                and #$0F                     ; DEA8= 29 0F       ).
                asl $DF                      ; DEAA= 06 DF       ._
                asl $DF                      ; DEAC= 06 DF       ._
LDEAE:
                asl $DF                      ; DEAE= 06 DF       ._
                asl $DF                      ; DEB0= 06 DF       ._
                tsb $DF                      ; DEB2= 04 DF       ._
                rts                          ; DEB4= 60          `

LDEB5:
                sta $DE                      ; DEB5= 85 DE       .^
                jsr LDEBE                    ; DEB7= 20 BE DE     >^
LDEBA:
                sta $DE                      ; DEBA= 85 DE       .^
                lsr a                        ; DEBC= 4A          J
                lsr a                        ; DEBD= 4A          J
LDEBE:
                lsr a                        ; DEBE= 4A          J
                lsr a                        ; DEBF= 4A          J
                ora $DE                      ; DEC0= 05 DE       .^
LDEC2:
                rts                          ; DEC2= 60          `

LDEC3:
                jsr LD1A8                    ; DEC3= 20 A8 D1     (Q
                bne LDEC2                    ; DEC6= D0 FA       Pz
LDEC8:
                lda $0302,x                  ; DEC8= BD 02 03    =..
LDECB:
                eor #$FF                     ; DECB= 49 FF       I.
                tay                          ; DECD= A8          (
                and #$07                     ; DECE= 29 07       ).
                sta $DA                      ; DED0= 85 DA       .Z
                tya                          ; DED2= 98          .
                and #$F8                     ; DED3= 29 F8       )x
                lsr a                        ; DED5= 4A          J
                sta ZMEMG+1                      ; DED6= 85 D7       .W
                lsr a                        ; DED8= 4A          J
                lsr a                        ; DED9= 4A          J
                adc ZMEMG+1                      ; DEDA= 65 D7       eW
                lsr a                        ; DEDC= 4A          J
                sta ZMEMG+1                      ; DEDD= 85 D7       .W
                lda #$00                     ; DEDF= A9 00       ).
                ror a                        ; DEE1= 6A          j
                ldy $0356                    ; DEE2= AC 56 03    ,V.
                beq LDEEA                    ; DEE5= F0 03       p.
                lsr ZMEMG+1                      ; DEE7= 46 D7       FW
                ror a                        ; DEE9= 6A          j
LDEEA:
                ora $DA                      ; DEEA= 05 DA       .Z
                adc $0350                    ; DEEC= 6D 50 03    mP.
                sta $031A                    ; DEEF= 8D 1A 03    ...
                lda ZMEMG+1                      ; DEF2= A5 D7       %W
                adc $0351                    ; DEF4= 6D 51 03    mQ.
                sta ZMEMG+1                      ; DEF7= 85 D7       .W
                lda $0301,x                  ; DEF9= BD 01 03    =..
                sta ZMEMG+0                      ; DEFC= 85 D6       .V
                lda $0300,x                  ; DEFE= BD 00 03    =..
LDF01:
                and $0361                    ; DF01= 2D 61 03    -a.
LDF04:
                adc $0361                    ; DF04= 6D 61 03    ma.
                tay                          ; DF07= A8          (
LDF08:
                lda LE12E,y                  ; DF08= B9 2E E1    9.a
                sta ZMASK                      ; DF0B= 85 D1       .Q
                lda $0300,x                  ; DF0D= BD 00 03    =..
LDF10:
                ldy $0361                    ; DF10= AC 61 03    ,a.
                cpy #$03                     ; DF13= C0 03       @.
                beq LDF1C                    ; DF15= F0 05       p.
                bcs LDF1F                    ; DF17= B0 06       0.
                asl a                        ; DF19= 0A          .
                rol ZMEMG+0                      ; DF1A= 26 D6       &V
LDF1C:
                asl a                        ; DF1C= 0A          .
                rol ZMEMG+0                      ; DF1D= 26 D6       &V
LDF1F:
                and #$F8                     ; DF1F= 29 F8       )x
                clc                          ; DF21= 18          .
                adc $031A                    ; DF22= 6D 1A 03    m..
                sta $031A                    ; DF25= 8D 1A 03    ...
                lda ZMEMG+0                      ; DF28= A5 D6       %V
                adc ZMEMG+1                      ; DF2A= 65 D7       eW
                bpl LDF32                    ; DF2C= 10 04       ..
                sec                          ; DF2E= 38          8
                sbc $0354                    ; DF2F= ED 54 03    mT.
LDF32:
                sta ZMEMG+1                      ; DF32= 85 D7       .W
                stz ZMEMG+0                      ; DF34= 64 D6       dV
                ldx $DA                      ; DF36= A6 DA       &Z
                jsr LDA7C                    ; DF38= 20 7C DA     |Z
                ldy $031A                    ; DF3B= AC 1A 03    ,..
LDF3E:
                lda #$00                     ; DF3E= A9 00       ).
                rts                          ; DF40= 60          `

LDF41:
                jsr LDEC8                    ; DF41= 20 C8 DE     H^
                phx                          ; DF44= DA          Z
                ldx #$00                     ; DF45= A2 00       ".
                lda $035A                    ; DF47= AD 5A 03    -Z.
                cmp #$04                     ; DF4A= C9 04       I.
                bcs LDF59                    ; DF4C= B0 0B       0.
                ldx $036A                    ; DF4E= AE 6A 03    .j.
                lda $0359                    ; DF51= AD 59 03    -Y.
                beq LDF59                    ; DF54= F0 03       p.
                ldx $036B                    ; DF56= AE 6B 03    .k.
LDF59:
                stx $0369                    ; DF59= 8E 69 03    .i.
                plx                          ; DF5C= FA          z
                rts                          ; DF5D= 60          `

LDF5E:
                lda #$20                     ; DF5E= A9 20       )
                bit STATE                      ; DF60= 24 D0       $P
                bvc LDF3E                    ; DF62= 50 DA       PZ
                bne LDF3E                    ; DF64= D0 D8       PX
                jsr LDDF8                    ; DF66= 20 F8 DD     x]
                beq LDF77                    ; DF69= F0 0C       p.
                pha                          ; DF6B= 48          H
                jsr LDFD5                    ; DF6C= 20 D5 DF     U_
                bne LDF76                    ; DF6F= D0 05       P.
                lda #$09                     ; DF71= A9 09       ).
                jsr LDFBC                    ; DF73= 20 BC DF     <_
LDF76:
                pla                          ; DF76= 68          h
LDF77:
                rts                          ; DF77= 60          `

LDF78:
                pha                          ; DF78= 48          H
                jsr LDFD5                    ; DF79= 20 D5 DF     U_
                bne LDF76                    ; DF7C= D0 F8       Px
                bvs LDF96                    ; DF7E= 70 16       p.
                lda $035F                    ; DF80= AD 5F 03    -_.
                and #$DF                     ; DF83= 29 DF       )_
                jsr LCF53                    ; DF85= 20 53 CF     SO
                ldx #$18                     ; DF88= A2 18       ".
                ldy #$64                     ; DF8A= A0 64        d
                jsr LC90C                    ; DF8C= 20 0C C9     .I
                jsr LC105                    ; DF8F= 20 05 C1     .A
                lda #$02                     ; DF92= A9 02       ).
                tsb STATE                      ; DF94= 04 D0       .P
LDF96:
                pla                          ; DF96= 68          h
                and #$7F                     ; DF97= 29 7F       ).
                sta $DA                      ; DF99= 85 DA       .Z
                cmp #$0A                     ; DF9B= C9 0A       I.
                bcs LDFAD                    ; DF9D= B0 0E       0.
                lda $0366                    ; DF9F= AD 66 03    -f.
                lsr a                        ; DFA2= 4A          J
                and #$05                     ; DFA3= 29 05       ).
                bit #$04                     ; DFA5= 89 04       ..
                beq LDFBA                    ; DFA7= F0 11       p.
                eor #$07                     ; DFA9= 49 07       I.
                bra LDFBA                    ; DFAB= 80 0D       ..

LDFAD:
                lda $0366                    ; DFAD= AD 66 03    -f.
                lsr a                        ; DFB0= 4A          J
                lsr a                        ; DFB1= 4A          J
                and #$03                     ; DFB2= 29 03       ).
                bit #$02                     ; DFB4= 89 02       ..
                beq LDFBA                    ; DFB6= F0 02       p.
                eor #$01                     ; DFB8= 49 01       I.
LDFBA:
                eor $DA                      ; DFBA= 45 DA       EZ
LDFBC:
                tay                          ; DFBC= A8          (
                lda #$40                     ; DFBD= A9 40       )@
                trb STATE                      ; DFBF= 14 D0       .P
                tya                          ; DFC1= 98          .
LDFC2:
                ldx $036C                    ; DFC2= AE 6C 03    .l.
LDFC5:
                phx                          ; DFC5= DA          Z
LDFC6:
                lsr $036C                    ; DFC6= 4E 6C 03    Nl.
LDFC9:
                jsr LC027                    ; DFC9= 20 27 C0     '@
LDFCC:
                pla                          ; DFCC= 68          h
LDFCD:
                sta $036C                    ; DFCD= 8D 6C 03    .l.
                lda #$40                     ; DFD0= A9 40       )@
                tsb STATE                      ; DFD2= 04 D0       .P
LDFD4:
                rts                          ; DFD4= 60          `

LDFD5:
                ldx $026A                    ; DFD5= AE 6A 02    .j.
LDFD8:
                bne LDFDE                    ; DFD8= D0 04       P.
LDFDA:
                lda #$A0                     ; DFDA= A9 A0       )
LDFDC:
                bit STATE                      ; DFDC= 24 D0       $P
LDFDE:
                rts                          ; DFDE= 60          `

LDFDF:
                ldx #$8E                     ; DFDF= A2 8E       ".  ; select VIEW+ANDY
                jsr selectROMX                    ; DFE1= 20 81 E5     .e
                jsr XBEBE                    ; DFE4= 20 BE BE     >>
                bra LDFF1                    ; DFE7= 80 08       ..

LDFE9:
                ldx #$8E                     ; DFE9= A2 8E       ".
                jsr selectROMX                    ; DFEB= 20 81 E5     .e
                jsr XBA00                    ; DFEE= 20 00 BA     .:
LDFF1:
                jmp selectTerminalROMAndANDY                    ; DFF1= 4C 7F E5    L.e

LDFF4:
                ldx #$8E                     ; DFF4= A2 8E       ".
                jsr selectROMX                    ; DFF6= 20 81 E5     .e
                jsr XBA67                    ; DFF9= 20 67 BA     g:
                bra LDFF1                    ; DFFC= 80 F3       .s

                .text 0,0,13
                .text "Acorn MOS",0,7
                .byte 0,0,0,0   ;space for "xxK"
                
                php                          ; E010= 08          .
;ORA &000D        :\ E011= 0D 0D 00    ...
                .byte $0D
                .byte $0D
LE013:
                .byte $00
                ; ORA ($22),y                ; E014= 11 22       ."
                ; EQUB $33                   ; E016= 33          3
                ; EQUB $44                   ; E017= 44          D
                ; EOR $66,x                  ; E018= 55 66       Uf
                ; EQUB $77                   ; E01A= 77          w
                ; DEY                        ; E01B= 88          .
                ; STA LBBAA,y                ; E01C= 99 AA BB    .*;
                ; CPY LEEDD                  ; E01F= CC DD EE    L]n
                ; EQUB $FF                   ; E022= FF          .
                .byte $11
                .byte $22
                .byte $33
                .byte $44
                .byte $55
                .byte $66
                .byte $77
                .byte $88
                .byte $99
                .byte $AA
                .byte $BB
                .byte $CC
                .byte $DD
                .byte $EE
                .byte $FF
LE023:
                ; BRK                        ; E023= 00          .
                ; EOR $AA,x                  ; E024= 55 AA       U*
                ; EQUB $FF                   ; E026= FF          .
                .byte $00
                .byte $55
                .byte $AA
                .byte $FF

; VDU control code dispatch tables
; ================================
;

; each routine is (address, number of additional VDU bytes)
_:=[(LC035,0)] ; VDU0
_..=[(LC0E2,1)] ; VDU1
_..=[(LC0EA,0)] ; VDU2
_..=[(LC0EA,0)] ; VDU3
_..=[(LC51E,0)] ; VDU4
_..=[(LC52D,0)] ; VDU5
_..=[(LC035,0)] ; VDU6
_..=[(LEFB6,0)] ; VDU7
_..=[(LC29A,0)] ; VDU8
_..=[(LC24C,0)] ; VDU9
_..=[(LC25B,0)] ; VDU10
_..=[(LC2B1,0)] ; VDU11
_..=[(LC44F,0)] ; VDU12
_..=[(LC3F6,0)] ; VDU13
_..=[(LC514,0)] ; VDU14
_..=[(LC528,0)] ; VDU15
_..=[(LC413,0)] ; VDU16
_..=[(LC539,1)] ; VDU17
_..=[(LC564,2)] ; VDU18
_..=[(LC62D,5)] ; VDU19
_..=[(LC5C5,0)] ; VDU20
_..=[(LC519,0)] ; VDU21
_..=[(LC794,1)] ; VDU22
_..=[(LC67C,9)] ; VDU23
_..=[(LC71F,8)] ; VDU24
_..=[(LC69B,5)] ; VDU25
_..=[(LC6AA,0)] ; VDU26
_..=[(LC035,0)] ; VDU27
_..=[(LC3A5,4)] ; VDU28
_..=[(LC78A,4)] ; VDU29
_..=[(LC47C,0)] ; VDU30
_..=[(LC482,2)] ; VDU31
_..=[(LCE2D,0)] ; ???
vdu_routines=_
                
; LSB of routine address
LE027:
                .for i=0,i<len(vdu_routines),i+=1
                .byte <vdu_routines[i][0]
                .next

; If bit 7 set: MSB of routine address
;
; If bit 7 clear:
;
; Top 4 bits are bits 8-11 of routine address (bits 12-15 are %1010,
; so address is $C0xx to $C7xx)
;
; Bottom 4 bits are ORed with $f0 and stored in $26a - -ve bytes left
; in VDU queue.
LE048:
                .for i=0,i<len(vdu_routines),i+=1
                .if vdu_routines[i][1]==0
                .byte >vdu_routines[i][0]
                .else
                .cerror vdu_routines[i][0]<$c000 || vdu_routines[i][0]>$c7ff,format("illegal VDU routine address for VDU %d: $%04x",i,vdu_routines[i][0])
                .cerror vdu_routines[i][1]<0 || vdu_routines[i][1]>15,format("illegal VDU parameter count for VDU %d: %d",i,vdu_routines[i][1])
                .byte (16-vdu_routines[i][1])|(((>vdu_routines[i][0])&$0f)<<4)
                .endif
                .next
                
LE069:
                .word LCEFB      ; E069= FB CE        ..
                .word LCF2B      ; E06B= 2B CF        +.
                .word LCF57      ; E06D= 57 CF        W.
                .word LCF57      ; E06F= 57 CF        W.
                .word LCF57      ; E071= 57 CF        W.
                .word LCF57      ; E073= 57 CF        W.
                .word LCFDF      ; E075= DF CF        ..
                .word LCFE6      ; E077= E6 CF        ..
                .word LD069      ; E079= 69 D0        i.
LE07B:
                .word LD10F      ; E07B= 0F D1        ..
                .word LD110      ; E07D= 10 D1        ..
                .word LCF6D      ; E07F= 6D CF        m.
                .word LCF96      ; E081= 96 CF        ..
                .word LCF96      ; E083= 96 CF        ..
                .word LCF96      ; E085= 96 CF        ..
                .word LCF96      ; E087= 96 CF        ..
                .word LD11E      ; E089= 1E D1        ..
                .word LDB4A      ; E08B= 4A DB        J.
                .word LDC6C      ; E08D= 6C DC
                .word L9BF7      ; E08F= F7 9B
                .word LDC75      ; E091= 75 DC       u\
                .word LC448      ; E093= 48 C4
                .word LDC6C      ; E095= 6C DC
                .word L9BA3      ; E097= A3 9B
                .word LDC75      ; E099= 75 DC       u\
                .word L9CF9      ; E09B= F9 9C
                .word L9CF9      ; E09D= F9 9C
                .word L99A4      ; E09F= A4 99
                .word L9944      ; E0A1= 44 99
                .word L9999      ; E0A3= 99 99
                .word L9935      ; E0A5= 35 99       5.
                .word L9923      ; E0A7= 23 99
                .word LDFDF      ; E0A9= DF DF
                .word LDFE9      ; E0AB= E9 DF       i_
                .word LDFF4      ; E0AD= F4 DF

; Times 40 lookup table, high bytes
LE0AF:
                .for i=0,i<25,i+=1
                .byte >i*40
                .next

; Times 40 lookup table, low bytes
LE0C8:
                .for i=0,i<25,i+=1
                .byte <i*40
                .next

; Times 640 lookup table, high bytes
LE0E1:
                .for i=0,i<32,i+=1
                .byte >i*640
                .next

LE101:
                .byte $1F
                .byte $1F
                .byte $1F                    ; E103= 1F          .
                clc                          ; E104= 18          .
                .byte $1F                    ; E105= 1F          .
                .byte $1F                    ; E106= 1F          .
                clc                          ; E107= 18          .
                clc                          ; E108= 18          .
LE109:
                .byte $4F                    ; E109= 4F          O
                .byte $27                    ; E10A= 27          '
                .byte $13                    ; E10B= 13          .
                .byte $4F                    ; E10C= 4F          O
                .byte $27                    ; E10D= 27          '
                .byte $13                    ; E10E= 13          .
                .byte $27                    ; E10F= 27          '
                .byte $27                    ; E110= 27          '
LE111:
;STZ LF4D8        :\ E111= 9C D8 F4    .Xt
                .byte $9C
                .byte $D8
                .byte $F4
;STZ LC488        :\ E114= 9C 88 C4    ..D
                .byte $9C
                .byte $88
                .byte $C4
                dey                          ; E117= 88          .
                .byte $4B                    ; E118= 4B          K
LE119:
                php                          ; E119= 08          .
                bpl LE13C                    ; E11A= 10 20       .
                php                          ; E11C= 08          .
                php                          ; E11D= 08          .
                bpl LE128                    ; E11E= 10 08       ..
LE120:
                ora ($FF,x)                  ; E120= 01 FF       ..
                eor $FF,x                    ; E122= 55 FF       U.
                .byte $77                    ; E124= 77          w
                .byte $33                    ; E125= 33          3
;ORA (&FF),y      :\ E126= 11 FF       ..
                .byte $11
LE127:
                .byte $FF
LE128:
                .byte $7F                    ; E128= 7F          .
                .byte $3F                    ; E129= 3F          ?
                .byte $1F                    ; E12A= 1F          .
                .byte $0F                    ; E12B= 0F          .
                .byte $07                    ; E12C= 07          .
                .byte $03                    ; E12D= 03          .
LE12E:
                ora ($AA,x)                  ; E12E= 01 AA       .*
LE130:
                eor $88,x                    ; E130= 55 88       U.
                .byte $44                    ; E132= 44          D
                .byte $22                    ; E133= 22          "
                ora ($80),y                  ; E134= 11 80       ..
                rti                          ; E136= 40          @

                jsr $0810                    ; E137= 20 10 08     ..
                tsb $02                      ; E13A= 04 02       ..
LE13C:
                ora ($03,x)                  ; E13C= 01 03       ..
                .byte $0F                    ; E13E= 0F          .
                ora ($01,x)                  ; E13F= 01 01       ..
                .byte $03                    ; E141= 03          .
;ORA (&00,x)      :\ E142= 01 00       ..
                .byte $01
LE143:
                .byte $00
LE144:
                .byte $FF                    ; E144= FF          .
LE145:
                brk                          ; E145= 00          .
                brk                          ; E146= 00          .
                .byte $FF                    ; E147= FF          .
LE148:
                .byte $FF                    ; E148= FF          .
                .byte $FF                    ; E149= FF          .
                .byte $FF                    ; E14A= FF          .
LE14B:
                brk                          ; E14B= 00          .
                brk                          ; E14C= 00          .
                .byte $FF                    ; E14D= FF          .
                brk                          ; E14E= 00          .
                .byte $0F                    ; E14F= 0F          .
;BEQ LE151        :\ E150= F0 FF       p.
                .byte $F0
                .byte $FF
                brk                          ; E152= 00          .
                .byte $03                    ; E153= 03          .
                tsb $300F                    ; E154= 0C 0F 30    ..0
                .byte $33                    ; E157= 33          3
                bit LC03F,x                  ; E158= 3C 3F C0    <?@
                .byte $C3                    ; E15B= C3          C
;CPY LF0CF        :\ E15C= CC CF F0    LOp
                .byte $CC
                .byte $CF
                .byte $F0
                .byte $F3                    ; E15F= F3          s
                .byte $FC                    ; E160= FC          |
                .byte $FF                    ; E161= FF          .
LE162:
                .byte $07                    ; E162= 07          .
                .byte $03                    ; E163= 03          .
;ORA (&00,x)      :\ E164= 01 00       ..
                .byte $01
LE165:
                .byte $00
                .byte $07                    ; E166= 07          .
                .byte $03                    ; E167= 03          .
LE168:
                brk                          ; E168= 00          .
                brk                          ; E169= 00          .
                brk                          ; E16A= 00          .
                ora ($02,x)                  ; E16B= 01 02       ..
                .byte $02                    ; E16D= 02          .
                .byte $03                    ; E16E= 03          .
;TSB &0D          :\ E16F= 04 0D       ..
                .byte $04
LE170:
                .byte $0D
                ora $0D                      ; E171= 05 0D       ..
;ORA &04          :\ E173= 05 04       ..
                .byte $05
LE174:
                .byte $04
                tsb $0C                      ; E175= 04 0C       ..
;TSB &5004        :\ E177= 0C 04 50    ..P
                .byte $0C
                .byte $04
LE179:
                .byte $50
                rti                          ; E17A= 40          @

                plp                          ; E17B= 28          (
;JSR &3004        :\ E17C= 20 04 30     .0
                .byte $20
                .byte $04
LE17E:
                .byte $30
                rti                          ; E17F= 40          @

                cli                          ; E180= 58          X
                rts                          ; E181= 60          `

;JMP (&170B,x)    :\ E182= 7C 0B 17    |..
                .byte $7C
LE183:
                .byte $0B
                .byte $17

                .byte $23                    ; E185= 23          #
                .byte $2F                    ; E186= 2F          /
                .byte $3B                    ; E187= 3B          ;
LE188:
                .byte $7F                    ; E188= 7F          .
;BVC LE1ED        :\ E189= 50 62       Pb
                .byte $50
                .byte $62
                plp                          ; E18B= 28          (
                rol $00                      ; E18C= 26 00       &.
                jsr $0122                    ; E18E= 20 22 01     ".
                .byte $07                    ; E191= 07          .
                .byte $67                    ; E192= 67          g
                php                          ; E193= 08          .
                .byte $7F                    ; E194= 7F          .
;BVC LE1F9        :\ E195= 50 62       Pb
                .byte $50
                .byte $62
                plp                          ; E197= 28          (
                asl $1902,x                  ; E198= 1E 02 19    ...
                .byte $1B                    ; E19B= 1B          .
                ora ($09,x)                  ; E19C= 01 09       ..
                .byte $67                    ; E19E= 67          g
                ora #$3F                     ; E19F= 09 3F       .?
                plp                          ; E1A1= 28          (
                and ($24),y                  ; E1A2= 31 24       1$
                rol $00                      ; E1A4= 26 00       &.
                jsr $0122                    ; E1A6= 20 22 01     ".
                .byte $07                    ; E1A9= 07          .
                .byte $67                    ; E1AA= 67          g
                php                          ; E1AB= 08          .
                .byte $3F                    ; E1AC= 3F          ?
                plp                          ; E1AD= 28          (
                and ($24),y                  ; E1AE= 31 24       1$
                asl $1902,x                  ; E1B0= 1E 02 19    ...
                .byte $1B                    ; E1B3= 1B          .
                ora ($09,x)                  ; E1B4= 01 09       ..
                .byte $67                    ; E1B6= 67          g
                ora #$3F                     ; E1B7= 09 3F       .?
                plp                          ; E1B9= 28          (
                .byte $33                    ; E1BA= 33          3
                bit $1E                      ; E1BB= 24 1E       $.
                .byte $02                    ; E1BD= 02          .
                ora L931B,y                  ; E1BE= 19 1B 93    ...
                ora ($72)                    ; E1C1= 12 72       .r
LE1C3:
                .byte $13                    ; E1C3= 13          .
                tax                          ; E1C4= AA          *
                brk                          ; E1C5= 00          .
                tax                          ; E1C6= AA          *
                brk                          ; E1C7= 00          .
                tax                          ; E1C8= AA          *
                eor $AA,x                    ; E1C9= 55 AA       U*
                eor $FF,x                    ; E1CB= 55 FF       U.
                eor $FF,x                    ; E1CD= 55 FF       U.
                eor $11,x                    ; E1CF= 55 11       U.
                .byte $22                    ; E1D1= 22          "
                .byte $44                    ; E1D2= 44          D
                dey                          ; E1D3= 88          .
                lda $0F                      ; E1D4= A5 0F       %.
                lda $0F                      ; E1D6= A5 0F       %.
                lda $5A                      ; E1D8= A5 5A       %Z
                lda $5A                      ; E1DA= A5 5A       %Z
                beq LE238                    ; E1DC= F0 5A       pZ
                beq LE23A                    ; E1DE= F0 5A       pZ
                sbc $FA,x                    ; E1E0= F5 FA       uz
                sbc $FA,x                    ; E1E2= F5 FA       uz
                .byte $0B                    ; E1E4= 0B          .
                .byte $07                    ; E1E5= 07          .
                .byte $0B                    ; E1E6= 0B          .
                .byte $07                    ; E1E7= 07          .
                .byte $23                    ; E1E8= 23          #
                .byte $13                    ; E1E9= 13          .
                .byte $23                    ; E1EA= 23          #
                .byte $13                    ; E1EB= 13          .
                asl $0E0D                    ; E1EC= 0E 0D 0E    ...
                ora $2F1F                    ; E1EF= 0D 1F 2F    ../
                .byte $1F                    ; E1F2= 1F          .
                .byte $2F                    ; E1F3= 2F          /
;CPY LCC00        :\ E1F4= CC 00 CC    L.L
                .byte $CC
                .byte $00
                .byte $CC
                brk                          ; E1F7= 00          .
                cpy LCC33                    ; E1F8= CC 33 CC    L3L
                .byte $33                    ; E1FB= 33          3
                .byte $FF                    ; E1FC= FF          .
                .byte $33                    ; E1FD= 33          3
                .byte $FF                    ; E1FE= FF          .
                .byte $33                    ; E1FF= 33          3
                .byte $03                    ; E200= 03          .
;TSB LC030        :\ E201= 0C 30 C0    .0@
                .byte $0C
                .byte $30
                .byte $C0
LE204:
                ora ($01,x)                  ; E204= 01 01       ..
                .byte $03                    ; E206= 03          .
                .byte $03                    ; E207= 03          .
                .byte $02                    ; E208= 02          .
                brk                          ; E209= 00          .
                .byte $02                    ; E20A= 02          .
                brk                          ; E20B= 00          .
LE20C:
                .word LC95F     ; E20C= 5F C9        _.
                .word LC96B     ; E20E= 6B C9        k.
                .word LC95F     ; E210= 5F C9        _.
                .word LC96B     ; E212= 6B C9        k.
                .word LC99D     ; E214= 9D C9        ..
                .word LC99D     ; E216= 9D C9        ..
                .word LC9A4     ; E218= A4 C9        ..
                .word LC9A4     ; E21A= A4 C9        ..
                .word LC9C3     ; E21C= C3 C9        ..
                .word LCA2D     ; E21E= 2D CA        -.
                .word LC9C3     ; E220= C3 C9        ..
                .word LCA2D     ; E222= 2D CA        -.
                .word LCAF1     ; E224= F1 CA        ..
                .word LCAF1     ; E226= F1 CA        ..
                .word LCAFA     ; E228= FA CA        ..
                .word LCAFA     ; E22A= FA CA
LE22C:
                asl a                        ; E22C= 0A          .
                rol a                        ; E22D= 2A          *
                rol a                        ; E22E= 2A          *
                tay                          ; E22F= A8          (
                and #$03                     ; E230= 29 03       ).
                rol a                        ; E232= 2A          *
                adc #$88                     ; E233= 69 88       i.
                sta $DF                      ; E235= 85 DF       ._
                tya                          ; E237= 98          .
LE238:
                and #$F8                     ; E238= 29 F8       )x
LE23A:
                sta $DE                      ; E23A= 85 DE       .^
                rts                          ; E23C= 60          `

osbyteA5:
                jsr LF3AB                    ; E23D= 20 AB F3     +s
                bit STATE                      ; E240= 24 D0       $P
                bvc LE252                    ; E242= 50 0E       P.
                jsr LE2AE                    ; E244= 20 AE E2     .b
                jsr LE252                    ; E247= 20 52 E2     Rb
                phx                          ; E24A= DA          Z
                phy                          ; E24B= 5A          Z
                jsr LE2AE                    ; E24C= 20 AE E2     .b
                ply                          ; E24F= 7A          z
                plx                          ; E250= FA          z
                rts                          ; E251= 60          `

LE252:
                jsr LE26D                    ; E252= 20 6D E2     mb
                bit $036C                    ; E255= 2C 6C 03    ,l.
                bpl LE25B                    ; E258= 10 01       ..
                inx                          ; E25A= E8          h
LE25B:
                rts                          ; E25B= 60          `

LE25C:
                sec                          ; E25C= 38          8
                lda $030A                    ; E25D= AD 0A 03    -..
                sbc $0308                    ; E260= ED 08 03    m..
                pha                          ; E263= 48          H
                lda #$00                     ; E264= A9 00       ).
                tay                          ; E266= A8          (
                bra LE279                    ; E267= 80 10       ..

osbyte86: ;E269:
                bit STATE
                bvc osbyteA5       ;branch taken if not cursor editing
LE26D:
                lda #$02                     ; E26D= A9 02       ).
                ldy #$10                     ; E26F= A0 10        .
                ldx #$00                     ; E271= A2 00       ".
                jsr LE28A                    ; E273= 20 8A E2     .b
                pha                          ; E276= 48          H
                lda #$04                     ; E277= A9 04       ).
LE279:
                iny                          ; E279= C8          H
                ldx #$03                     ; E27A= A2 03       ".
                jsr LE28A                    ; E27C= 20 8A E2     .b
                tax                          ; E27F= AA          *
                tay                          ; E280= A8          (
                lda #$08                     ; E281= A9 08       ).
                bit $0366                    ; E283= 2C 66 03    ,f.
                beq LE2AC                    ; E286= F0 24       p$
                ply                          ; E288= 7A          z
                rts                          ; E289= 60          `

LE28A:
                sec                          ; E28A= 38          8
                bit $0366                    ; E28B= 2C 66 03    ,f.
                beq LE29B                    ; E28E= F0 0B       p.
                txa                          ; E290= 8A          .
                eor #$02                     ; E291= 49 02       I.
                tax                          ; E293= AA          *
                lda $0308,x                  ; E294= BD 08 03    =..
                sbc $0308,y                  ; E297= F9 08 03    y..
                rts                          ; E29A= 60          `

LE29B:
                lda $0308,y                  ; E29B= B9 08 03    9..
                sbc $0308,x                  ; E29E= FD 08 03    }..
                rts                          ; E2A1= 60          `

LE2A2:
                ldx $0355                    ; E2A2= AE 55 03    .U.
                ldy LE109,x                  ; E2A5= BC 09 E1    <.a
                phy                          ; E2A8= 5A          Z
                ldy LE101,x                  ; E2A9= BC 01 E1    <.a
LE2AC:
                plx                          ; E2AC= FA          z
                rts                          ; E2AD= 60          `

LE2AE:
                ldx #$18                     ; E2AE= A2 18       ".
                ldy #$64                     ; E2B0= A0 64        d
LE2B2:
                lda #$02                     ; E2B2= A9 02       ).
                bra LE2BC                    ; E2B4= 80 06       ..

LE2B6:
                ldx #$24                     ; E2B6= A2 24       "$
LE2B8:
                ldy #$14                     ; E2B8= A0 14        .
LE2BA:
                lda #$04                     ; E2BA= A9 04       ).
LE2BC:
                pha                          ; E2BC= 48          H
                lda $0300,x                  ; E2BD= BD 00 03    =..
                pha                          ; E2C0= 48          H
                lda $0300,y                  ; E2C1= B9 00 03    9..
                sta $0300,x                  ; E2C4= 9D 00 03    ...
                pla                          ; E2C7= 68          h
                sta $0300,y                  ; E2C8= 99 00 03    ...
                inx                          ; E2CB= E8          h
                iny                          ; E2CC= C8          H
                pla                          ; E2CD= 68          h
                dec a                        ; E2CE= 3A          :
                bne LE2BC                    ; E2CF= D0 EB       Pk
                rts                          ; E2D1= 60          `

LE2D2:
                lda STATE                      ; E2D2= A5 D0       %P
                and #$20                     ; E2D4= 29 20       )
                rts                          ; E2D6= 60          `

; Default vector table
; ====================
defaultVectorTable: .block
                .word LFBED ; USERV=$200
                .word LE565 ; BRKV=$202
                .word LE5FF ; IRQ1V=$204
                .word LE60C ; IRQ2V=$206
                .word LE802 ; CLIV=$208
                .word osbyteEntryPoint ; BYTEV=$20a
                .word oswordEntryPoint ; WORDV=$20c
                .word oswrchEntryPoint ; WRCHV=$20e
                .word osrdchEntryPoint ; RDCHV=$210
fsVectors: .block
                .word E_FILEV ; FILEV=$212
                .word E_ARGSV ; ARGSV=$214
                .word E_BGETV ; BGETV=$216
                .word E_BPUTV ; BPUTV=$218
                .word E_GBPBV ; GBPBV=$21a
                .word E_FINDV ; FINDV=$21c
                .word E_FSCV ; FSCV=$21e
end:
                .bend
                .word rts ; EVENTV=$220
                .word rts ; UPTV=$222
                .word rts ; NETV=$224
                .word rts ; VDUV=$226 
                .word LF74C ; KEYV=$228 
                .word LEA43 ; INSV=$22a 
                .word LE9F8 ; REMV=$22c 
                .word LE97B ; CNPV=$22e 
                .word rts ; IND1V=$230
                .word rts ; IND2V=$232
                .word rts ; IND3V=$234
end:
                .bend
                
                bcc LE310                    ; E30D= 90 01       ..
                .byte $9F                    ; E30F= 9F          .
LE310:
                ora $02A1                    ; E310= 0D A1 02    .!.
                .byte $82                    ; E313= 82          .
                sed                          ; E314= F8          x
                brk                          ; E315= 00          .
                .byte $03                    ; E316= 03          .
                brk                          ; E317= 00          .
                brk                          ; E318= 00          .
                .byte $FF                    ; E319= FF          .
                brk                          ; E31A= 00          .
                brk                          ; E31B= 00          .
                ora ($00,x)                  ; E31C= 01 00       ..
                brk                          ; E31E= 00          .
                brk                          ; E31F= 00          .
                brk                          ; E320= 00          .
                brk                          ; E321= 00          .
                .byte $FF                    ; E322= FF          .
                tsb $04                      ; E323= 04 04       ..
                brk                          ; E325= 00          .
                .byte $FF                    ; E326= FF          .
                .byte $42                    ; E327= 42          B
                ora $1919,y                  ; E328= 19 19 19    ...
                and ($08)                    ; E32B= 32 08       2.
                brk                          ; E32D= 00          .
                brk                          ; E32E= 00          .
                brk                          ; E32F= 00          .
                brk                          ; E330= 00          .
                jsr $0009                    ; E331= 20 09 00     ..
                brk                          ; E334= 00          .
                brk                          ; E335= 00          .
                brk                          ; E336= 00          .
                brk                          ; E337= 00          .
                brk                          ; E338= 00          .
                brk                          ; E339= 00          .
                .byte $03                    ; E33A= 03          .
                bcc LE3A1                    ; E33B= 90 64       .d
                asl $81                      ; E33D= 06 81       ..
                brk                          ; E33F= 00          .
                brk                          ; E340= 00          .
                brk                          ; E341= 00          .
                ora #$1B                     ; E342= 09 1B       ..
                ora ($D0,x)                  ; E344= 01 D0       .P
                cpx #$F0                     ; E346= E0 F0       `p
                ora ($80,x)                  ; E348= 01 80       ..
                bcc LE34C                    ; E34A= 90 00       ..
LE34C:
                brk                          ; E34C= 00          .
                brk                          ; E34D= 00          .
LE34E:
                .byte $FF                    ; E34E= FF          .
                .byte $FF                    ; E34F= FF          .
                .byte $FF                    ; E350= FF          .
                brk                          ; E351= 00          .
                brk                          ; E352= 00          .
                brk                          ; E353= 00          .
                brk                          ; E354= 00          .
                bmi LE358                    ; E355= 30 01       0.
                brk                          ; E357= 00          .
LE358:
                brk                          ; E358= 00          .
                stz $05                      ; E359= 64 05       d.
                .byte $FF                    ; E35B= FF          .
                ora ($0A,x)                  ; E35C= 01 0A       ..
                brk                          ; E35E= 00          .
                brk                          ; E35F= 00          .
                brk                          ; E360= 00          .
                brk                          ; E361= 00          .
                brk                          ; E362= 00          .
                .byte $FF                    ; E363= FF          .

; STARTUP
; =======
resetEntryPoint:                ;e364
                lda #$40        ; $40 = RTI
                sta nmiEntryPoint ; make NMI routine a no-op
                sei
                lda #$53              ;
                sta LFE8E             ; ???
                jsr selectTerminalROM ; Page in ROM 15 and continue
                jmp reset

; Check if a coprocessor is attached to the Tube
; ----------------------------------------------
LE375:
                ldx #$01                     ;
                stx tube.status1
                lda tube.status1                   ;
                eor #$01
                ldx #$81                     ;
                stx tube.status1
                and tube.status1                   ; Cy=0 if no Tube, Cy=1 if Tube
                ror a
                rts

LE389:
                phy                          ; E389= 5A          Z
                phx                          ; E38A= DA          Z
                jsr LE9BB                    ; E38B= 20 BB E9     ;i
                sta $FC                      ; E38E= 85 FC       .|
                jsr selectTerminalROM                    ; E390= 20 90 E5     .e
                jsr L98B7                    ; E393= 20 B7 98     7.
                tya                          ; E396= 98          .
                and $FC                      ; E397= 25 FC       %|
                cmp #$01                     ; E399= C9 01       I.
                plx                          ; E39B= FA          z
                ply                          ; E39C= 7A          z
                jmp selectROMX                    ; E39D= 4C 81 E5    L.e

LE3A0:
                txa                          ; E3A0= 8A          .
LE3A1:
                tay                          ; E3A1= A8          (
                jsr LE389                    ; E3A2= 20 89 E3     .c
                bcc LE3DB                    ; E3A5= 90 34       .4
                jsr isROMValid                    ; E3A7= 20 F7 E3     wc
                bcc LE3DB                    ; E3AA= 90 2F       ./
                ldx $F4                      ; E3AC= A6 F4       &t
                ldy $F4                      ; E3AE= A4 F4       $t
LE3B0:
                iny                          ; E3B0= C8          H
                cpy #$10                     ; E3B1= C0 10       @.
                bcs LE3DF                    ; E3B3= B0 2A       0*
                jsr LE389                    ; E3B5= 20 89 E3     .c
                bcc LE3B0                    ; E3B8= 90 F6       .v
                tya                          ; E3BA= 98          .
                eor #$FF                     ; E3BB= 49 FF       I.
                sta $FA                      ; E3BD= 85 FA       .z
                lda #$7F                     ; E3BF= A9 7F       ).
                sta $FB                      ; E3C1= 85 FB       .{
LE3C3:
                sty ROMSEL                   ; E3C3= 8C 30 FE    .0~
                lda ($FA),y                  ; E3C6= B1 FA       1z
                stx ROMSEL                   ; E3C8= 8E 30 FE    .0~
                cmp ($FA),y                  ; E3CB= D1 FA       Qz
                bne LE3B0                    ; E3CD= D0 E1       Pa
                inc $FA                      ; E3CF= E6 FA       fz
                bne LE3C3                    ; E3D1= D0 F0       Pp
                inc $FB                      ; E3D3= E6 FB       f{
                lda $FB                      ; E3D5= A5 FB       %{
                cmp #$84                     ; E3D7= C9 84       I.
                bcc LE3C3                    ; E3D9= 90 E8       .h
LE3DB:
                ldx $F4                      ; E3DB= A6 F4       &t
                bra LE3EC                    ; E3DD= 80 0D       ..

LE3DF:
                lda L8006                    ; E3DF= AD 06 80    -..
                sta $02A1,x                  ; E3E2= 9D A1 02    .!.
                and #$8F                     ; E3E5= 29 8F       ).
                bne LE3EC                    ; E3E7= D0 03       P.
                stx $024B                    ; E3E9= 8E 4B 02    .K.
LE3EC:
                inx                          ; E3EC= E8          h
                cpx #$10                     ; E3ED= E0 10       `.
                bcc LE3A0                    ; E3EF= 90 AF       ./
                jsr selectTerminalROM                    ; E3F1= 20 90 E5     .e
                jmp L8224                    ; E3F4= 4C 24 82    L$.

;-------------------------------------------------------------------------
;
; Checks a ROM is valid - i.e., has a valid-looking copyright string.
;
; Entry:
;
; X = ROM to check
;
; Exit:
;
; C=0 if ROM invalid; C=1 if ROM valid

isROMValid: .proc ;e3f7
                jsr selectROMX
                ldx #$03
                ldy L8007       ; fetch ROM copyright offset pointer
                clc             ; assume no match
-
                lda L8000,y     ; fetch possible ROM copyright char
                eor LE513,x     ; Z=1 if it matches "\x0(C)"
                bne +           ; branch taken if no match
                iny             ; next copyright byte
                dex             ; count 4 chars
                bpl -
                sec             ; C=1 means a match
+
                rts
                .pend

;-------------------------------------------------------------------------

; End of STARTUP code
; ===================
LE40E:
                sec                          ; Call Break Intercept Vector
                jsr LF349
                ldx #$27                     ; Service call &27 - Break pressed
                jsr makeROMServiceCall
                ldy $0256                    ; Get Exec handle, skip past if closed
                beq LE424
                stz $0256                    ; Clear Exec handle
                lda #$00                     ; Close Exec channel
                jsr OSFIND
LE424:
                sec                          ;
                ror hazel.currentFS
                lda $028D                    ; Soft Break
                beq LE431
                sec                          ;
                ror hazel.libFS
LE431:
                jsr LEE64                    ; Set default ROMFS/TAPEFS settings
                jsr osbyte76                    ; Test Shift and Ctrl keys
                lsr a                        ; Move SHIFT status from b7 to b3
                lsr a
                lsr a
                lsr a
                eor $028F                    ; Toggle with OSBYTE 255 boot status
                and #$08
                tay
                ldx hazel.currentFSROM
                lda $028D                    ; Soft Break, use current filing system
                beq LE454
                jsr selectTerminalROM                    ; E449= 20 90 E5     .e
LE44C:
                phy                          ; E44C= 5A          Z
                jsr L8EA4                    ; E44D= 20 A4 8E     $.
                and #$0F                     ; E450= 29 0F       ).
                ply                          ; E452= 7A          z
                tax                          ; E453= AA          *
LE454:
                bit $02A1,x                  ; E454= 3C A1 02    <!.
                bpl LE478                    ; E457= 10 1F       ..
                jsr selectROMX                    ; E459= 20 81 E5     .e
                cpx #$0F                     ; E45C= E0 0F       `.
                bne LE46C                    ; E45E= D0 0C       P.
                jsr osbyte7A
                inx                          ; E463= E8          h
                beq LE47F                    ; E464= F0 19       p.
                cpx #$63                     ; E466= E0 63       `c
                beq LE47F                    ; E468= F0 15       p.
                bra LE478                    ; E46A= 80 0C       ..

LE46C:
                lda #$03                     ; Filing System selection
                jsr L8003
                tax                          ; E471= AA          *
                jsr selectTerminalROM                    ; E472= 20 90 E5     .e
                txa                          ; E475= 8A          .
                beq LE4A3                    ; E476= F0 2B       p+
LE478:
                ldx #$03                     ; E47A= 20 72 EE     rn
                jsr makeROMServiceCall
                beq LE4A3                    ; E47D= F0 24       p$
LE47F:
                tya                          ; E47F= 98          .
                bne LE499                    ; E480= D0 17       P.
                lda #$8D                     ; E482= A9 8D       ).
                jsr osbyte8C8D                    ; E484= 20 9A ED     .m
                ldx #<starRunBOOT                     ; E487= A2 08       ".
                ldy #>starRunBOOT                     ; E489= A0 F4        t
                dec $0267                    ; E48B= CE 67 02    Ng.
                jsr OSCLI                   ; E48E= 20 F7 FF     w.
                inc $0267                    ; E491= EE 67 02    ng.
                bra LE4A3                    ; E494= 80 0D       ..

LE496:
                inc $0267                    ; E496= EE 67 02    ng.
LE499:
                sec                          ; E499= 38          8
                ror hazel.currentFS
                lda #$00                     ; E49D= A9 00       ).
                tax                          ; E49F= AA          *
                jsr LEDC2                    ; E4A0= 20 C2 ED     Bm
LE4A3:
                lda #$05                     ;
                ldx $0285                    ; *FX5,<current printer>
                jsr osbyteEntryPoint
                lda $028D                    ; If not Soft Break, select default language
                bne LE4BB
                ldx $028C                    ; Get current language ROM
                cpx #$10                     ; <16, normal ROM number, use it
                bcc LE4C2
                cpx #$1F                     ; 16+UTILS ROM, re-enter Supervisor or Tube CLI
                beq LE509
LE4BB:
                jsr selectTerminalROM                    ; Page in ROM 15 - UTILS ROM
                jsr L8E9C                    ; Read configured LANG
                tax
LE4C2:
                clc
osbyte8E: ;LE4C3:
                bit $02A1,x                  ; b6=0, error Not a language
                bvc LE516
                php                          ; E4C8= 08          .
                bcc LE4E1                    ; E4C9= 90 16       ..
                jsr selectROMX                    ; E4CB= 20 81 E5     .e
                lda L8006                    ; E4CE= AD 06 80    -..
                and #$0D                     ; E4D1= 29 0D       ).
                beq LE4DA                    ; E4D3= F0 05       p.
                bit $027A                    ; E4D5= 2C 7A 02    ,z.
                bpl LE52E                    ; E4D8= 10 54       .T
LE4DA:
                phx                          ; E4DA= DA          Z
                ldx #$2A                     ; E4DD= 20 72 EE     rn
                jsr makeROMServiceCall
                plx                          ; E4E0= FA          z
LE4E1:
                stx $028C                    ; E4E1= 8E 8C 02    ...
                jsr selectROMX                    ; E4E4= 20 81 E5     .e
                lda #$80                     ; E4E7= A9 80       ).
                ldy #$08                     ; E4E9= A0 08        .
                jsr LE7A3                    ; E4EB= 20 A3 E7     #g
                sty $FD                      ; E4EE= 84 FD       .}
                jsr OSNEWL                   ; E4F0= 20 E7 FF     g.
                jsr OSNEWL                   ; E4F3= 20 E7 FF     g.
                plp                          ; E4F6= 28          (
                lda #$01                     ; E4F7= A9 01       ).
                bit $027A                    ; E4F9= 2C 7A 02    ,z.
                bmi LE510                    ; E4FC= 30 12       0.
                lda L8006                    ; E4FE= AD 06 80    -..
                and #$0D                     ; E501= 29 0D       ).
                bne LE52E                    ; E503= D0 29       P)
                inc a                        ; E505= 1A          .
                jmp L8000                    ; E506= 4C 00 80    L..

LE509:
                lda #$00                     ; E509= A9 00       ).
                bit $027A                    ; E50B= 2C 7A 02    ,z.
                bpl LE579                    ; E50E= 10 69       .i
LE510:
                jmp tubeHost.copyLanguage

LE513:
                .text ")C("
LE516:
                brk                          ; E516= 00          .
                .text 0,"This is not a language"
LE52E:
                brk
                .text 0,"I cannot run this code",0
osbyteA4:
                ldx #$03                     ; E547= A2 03       ".
                ldy #$07                     ; E549= A0 07        .
                lda ($F0),y                  ; E54B= B1 F0       1p
                tay                          ; E54D= A8          (
LE54E:
                lda ($F0),y                  ; E54E= B1 F0       1p
                cmp LE513,x                  ; E550= DD 13 E5    ].e
                bne LE564                    ; E553= D0 0F       P.
                iny                          ; E555= C8          H
                dex                          ; E556= CA          J
                bpl LE54E                    ; E557= 10 F5       .u
                ldy #$06                     ; E559= A0 06        .
                lda ($F0),y                  ; E55B= B1 F0       1p
                asl a                        ; E55D= 0A          .
                bpl LE516                    ; E55E= 10 B6       .6
                and #$1A                     ; E560= 29 1A       ).
                bne LE52E                    ; E562= D0 CA       PJ
LE564:
                rts                          ; E564= 60          `

LE565:
                ldy #$00                     ; E565= A0 00        .
                jsr LE7A7                    ; E567= 20 A7 E7     'g
                jsr OSNEWL                   ; E56A= 20 E7 FF     g.
                lda $0267                    ; E56D= AD 67 02    -g.
                ror a                        ; E570= 6A          j
                bcs LE579                    ; E571= B0 06       0.
                jsr OSNEWL                   ; E573= 20 E7 FF     g.
                jmp LE496                    ; E576= 4C 96 E4    L.d

LE579:
                jsr selectTerminalROM                    ; E579= 20 90 E5     .e
                jmp L8661                    ; E57C= 4C 61 86    La.

;-------------------------------------------------------------------------
;-------------------------------------------------------------------------
;
; Select paged ROM bank 15 - TERMINAL - with ANDY paged in,
;
; Preserves A/Y
selectTerminalROMAndANDY:   ;e57f
                ldx #$8F
                ; fall through into selectROMX

;-------------------------------------------------------------------------
;-------------------------------------------------------------------------
;
; Select paged ROM bank.
;
; Entry:
;
; X = bank to select.
;
; Preserves A/X/Y/P
selectROMX:   ;e581
                stx $F4
                stx ROMSEL
                rts

;-------------------------------------------------------------------------
;
LE587:
                phy                          ; E587= 5A          Z
                jsr isROMValid                    ; E588= 20 F7 E3     wc
                jsr selectTerminalROM                    ; E58B= 20 90 E5     .e
                ply                          ; E58E= 7A          z
                rts                          ; E58F= 60          `

;-------------------------------------------------------------------------
;
; Select paged ROM bank 15 - TERMINAL.
;
; Preserves X/Y
selectTerminalROM:            ;e590
                lda #$0F
                ; fall through into selectROMA
                
;-------------------------------------------------------------------------
;
; Select paged ROM bank.
;
; A = bank to select.
;
; Preserves A/X/Y/P
selectROMA:                   ;e592
                sta $F4         ;update ROMSEL copy
                sta ROMSEL
                rts

;-------------------------------------------------------------------------

LE598:
                phx                          ; E598= DA          Z
                jsr selectTerminalROMAndANDY                    ; E599= 20 7F E5     .e
                plx                          ; E59C= FA          z
                rts                          ; E59D= 60          `

irqEntryPoint:
                sta $FC                      ; E59E= 85 FC       .|
                pla                          ; E5A0= 68          h
                pha                          ; E5A1= 48          H
                and #$10                     ; E5A2= 29 10       ).
                bne LE5A9                    ; E5A4= D0 03       P.
                jmp (IRQ1V)                  ; E5A6= 6C 04 02    l..

LE5A9:
                phx                          ; E5A9= DA          Z
                tsx                          ; E5AA= BA          :
                lda $0103,x                  ; E5AB= BD 03 01    =..
                cld                          ; E5AE= D8          X
                sec                          ; E5AF= 38          8
                sbc #$01                     ; E5B0= E9 01       i.
                sta $FD                      ; E5B2= 85 FD       .}
                lda $0104,x                  ; E5B4= BD 04 01    =..
                sbc #$00                     ; E5B7= E9 00       i.
                sta $FE                      ; E5B9= 85 FE       .~
                lda $F4                      ; E5BB= A5 F4       %t
                sta $024A                    ; E5BD= 8D 4A 02    .J.
                stx $F0                      ; E5C0= 86 F0       .p
                ldx #$06                     ; E5C4= 20 72 EE     rn
                jsr makeROMServiceCall
                ldx $028C                    ; E5C7= AE 8C 02    ...
                jsr selectROMX                    ; E5CA= 20 81 E5     .e
                plx                          ; E5CD= FA          z
                lda $FC                      ; E5CE= A5 FC       %|
                cli                          ; E5D0= 58          X
                jmp (BRKV)                  ; E5D1= 6C 02 02    l..

LE5D4:
                sec                          ; E5D4= 38          8
                ror $024F                    ; E5D5= 6E 4F 02    nO.
                bit $0250                    ; E5D8= 2C 50 02    ,P.
                bpl LE5E4                    ; E5DB= 10 07       ..
                jsr LED27                    ; E5DD= 20 27 ED     'm
                ldx #$00                     ; E5E0= A2 00       ".
                bcs LE5E6                    ; E5E2= B0 02       0.
LE5E4:
                ldx #$40                     ; E5E4= A2 40       "@
LE5E6:
                jmp LE912                    ; E5E6= 4C 12 E9    L.i

LE5E9:
                ldy ACIA+1                    ; E5E9= AC 09 FE    ,.~
                and #$3A                     ; E5EC= 29 3A       ):
                bne LE628                    ; E5EE= D0 38       P8
                ldx $025C                    ; E5F0= AE 5C 02    .\.
                bne LE5FE                    ; E5F3= D0 09       P.
                inx                          ; E5F5= E8          h
                jsr osbyte99                    ; E5F6= 20 80 EA     .j
                jsr LED27                    ; E5F9= 20 27 ED     'm
                bcc LE5E4                    ; E5FC= 90 E6       .f
LE5FE:
                rts                          ; E5FE= 60          `

LE5FF:
                lda $FC                      ; E5FF= A5 FC       %|
                pha                          ; E601= 48          H
                phx                          ; E602= DA          Z
                phy                          ; E603= 5A          Z
                clv                          ; E604= B8          8
                jsr LE60F                    ; E605= 20 0F E6     .f
                ply                          ; E608= 7A          z
                plx                          ; E609= FA          z
                pla                          ; E60A= 68          h
                rti                          ; E60B= 40          @

LE60C:
                lda $FC                      ; E60C= A5 FC       %|
                rti                          ; E60E= 40          @

LE60F:
                lda ACIA+0                    ; E60F= AD 08 FE    -.~
                bvs LE616                    ; E612= 70 02       p.
                bpl LE672                    ; E614= 10 5C       .\
LE616:
                ldx $EA                      ; E616= A6 EA       &j
                dex                          ; E618= CA          J
                bmi LE64E                    ; E619= 30 33       03
                bvs LE64D                    ; E61B= 70 30       p0
                jsr LF384                    ; E61D= 20 84 F3     .s
                jmp LA45D                    ; E620= 4C 5D A4    L]$

LE623:
                ldy ACIA+1                    ; E623= AC 09 FE    ,.~
                rol a                        ; E626= 2A          *
                asl a                        ; E627= 0A          .
LE628:
                tax                          ; E628= AA          *
                tya                          ; E629= 98          .
                ldy #$07                     ; E62A= A0 07        .
                jmp eventEntryPoint                    ; E62C= 4C 28 EA    L(j

LE62F:
                ldx #$02                     ; E62F= A2 02       ".
                jsr osbyte91                    ; E631= 20 F4 E9     ti
                bcc LE646                    ; E634= 90 10       ..
                lda $0285                    ; E636= AD 85 02    -..
                cmp #$02                     ; E639= C9 02       I.
                bne LE5D4                    ; E63B= D0 97       P.
                inx                          ; E63D= E8          h
                jsr osbyte91                    ; E63E= 20 F4 E9     ti
                ror $02D1                    ; E641= 6E D1 02    nQ.
                bmi LE5D4                    ; E644= 30 8E       0.
LE646:
                sta ACIA+1                    ; E646= 8D 09 FE    ..~
                lda #$E7                     ; E649= A9 E7       )g
                sta $EA                      ; E64B= 85 EA       .j
LE64D:
                rts                          ; E64D= 60          `

LE64E:
                and $0278                    ; E64E= 2D 78 02    -x.
                lsr a                        ; E651= 4A          J
                bcc LE65B                    ; E652= 90 07       ..
                bvs LE65B                    ; E654= 70 05       p.
                ldy $0250                    ; E656= AC 50 02    ,P.
                bmi LE5E9                    ; E659= 30 8E       0.
LE65B:
                lsr a                        ; E65B= 4A          J
                ror a                        ; E65C= 6A          j
                bcs LE623                    ; E65D= B0 C4       0D
                bmi LE62F                    ; E65F= 30 CE       0N
                bvs LE64D                    ; E661= 70 EA       pj
LE663:
                ldx #$05                     ; E665= 20 72 EE     rn
                jsr makeROMServiceCall
                beq LE64D                    ; E668= F0 E3       pc
                pla                          ; E66A= 68          h
                pla                          ; E66B= 68          h
                ply                          ; E66C= 7A          z
                plx                          ; E66D= FA          z
                pla                          ; E66E= 68          h
                jmp (IRQ2V)                  ; E66F= 6C 06 02    l..

LE672:
                lda systemVIA.ifr            ; E672= AD 4D FE    -M~
                bpl LE6B3                    ; E675= 10 3C       .<
                and $0279                    ; E677= 2D 79 02    -y.
                and systemVIA.ier            ; E67A= 2D 4E FE    -N~
                bit #$02                     ; E67D= 89 02       ..
                beq LE6D5                    ; E67F= F0 54       pT
                dec $0240                    ; E681= CE 40 02    N@.
                lda $EA                      ; E684= A5 EA       %j
                bpl LE68A                    ; E686= 10 02       ..
                inc $EA                      ; E688= E6 EA       fj
LE68A:
                lda $0251                    ; E68A= AD 51 02    -Q.
                beq LE6A9                    ; E68D= F0 1A       p.
                dec $0251                    ; E68F= CE 51 02    NQ.
                bne LE6A9                    ; E692= D0 15       P.
                ldx $0252                    ; E694= AE 52 02    .R.
                lda $0248                    ; E697= AD 48 02    -H.
                lsr a                        ; E69A= 4A          J
                bcc LE6A0                    ; E69B= 90 03       ..
                ldx $0253                    ; E69D= AE 53 02    .S.
LE6A0:
                rol a                        ; E6A0= 2A          *
                eor #$01                     ; E6A1= 49 01       I.
                jsr LF250                    ; E6A3= 20 50 F2     Pr
                stx $0251                    ; E6A6= 8E 51 02    .Q.
LE6A9:
                ldy #$04                     ; E6A9= A0 04        .
                jsr eventEntryPoint                    ; E6AB= 20 28 EA     (j
                lda #$02                     ; E6AE= A9 02       ).
                jmp LE78A                    ; E6B0= 4C 8A E7    L.g

LE6B3:
                lda userVIA.ifr              ; E6B3= AD 6D FE    -m~
                bpl LE663                    ; E6B6= 10 AB       .+
                and $0277                    ; E6B8= 2D 77 02    -w.
                and userVIA.ier              ; E6BB= 2D 6E FE    -n~
                ror a                        ; E6BE= 6A          j
                ror a                        ; E6BF= 6A          j
                bcc LE663                    ; E6C0= 90 A1       .!
                ldy $0285                    ; E6C2= AC 85 02    ,..
                dey                          ; E6C5= 88          .
                bne LE663                    ; E6C6= D0 9B       P.
                lda #$02                     ; E6C8= A9 02       ).
                sta userVIA.ifr              ; E6CA= 8D 6D FE    .m~
                sta userVIA.ier              ; E6CD= 8D 6E FE    .n~
                ldx #$03                     ; E6D0= A2 03       ".
                jmp LE8D5                    ; E6D2= 4C D5 E8    LUh

LE6D5:
                bit #$40                     ; E6D5= 89 40       .@
                beq LE74E                    ; E6D7= F0 75       pu
                lda #$40                     ; E6D9= A9 40       )@
                sta systemVIA.ifr            ; E6DB= 8D 4D FE    .M~
                lda $0283                    ; E6DE= AD 83 02    -..
                tax                          ; E6E1= AA          *
                eor #$0F                     ; E6E2= 49 0F       I.
                pha                          ; E6E4= 48          H
                tay                          ; E6E5= A8          (
                sec                          ; E6E6= 38          8
LE6E7:
                lda $0291,x                  ; E6E7= BD 91 02    =..
                adc #$00                     ; E6EA= 69 00       i.
                sta $0291,y                  ; E6EC= 99 91 02    ...
                dex                          ; E6EF= CA          J
                beq LE6F5                    ; E6F0= F0 03       p.
                dey                          ; E6F2= 88          .
                bne LE6E7                    ; E6F3= D0 F2       Pr
LE6F5:
                pla                          ; E6F5= 68          h
                sta $0283                    ; E6F6= 8D 83 02    ...
                ldx #$05                     ; E6F9= A2 05       ".
LE6FB:
                inc $029B,x                  ; E6FB= FE 9B 02    ~..
                bne LE708                    ; E6FE= D0 08       P.
                dex                          ; E700= CA          J
                bne LE6FB                    ; E701= D0 F8       Px
                ldy #$05                     ; E703= A0 05        .
                jsr eventEntryPoint                    ; E705= 20 28 EA     (j
LE708:
                lda $02B1                    ; E708= AD B1 02    -1.
                bne LE715                    ; E70B= D0 08       P.
                lda $02B2                    ; E70D= AD B2 02    -2.
                beq LE718                    ; E710= F0 06       p.
                dec $02B2                    ; E712= CE B2 02    N2.
LE715:
                dec $02B1                    ; E715= CE B1 02    N1.
LE718:
                bit $02CD                    ; E718= 2C CD 02    ,M.
                bpl LE728                    ; E71B= 10 0B       ..
                inc $02CD                    ; E71D= EE CD 02    nM.
                cli                          ; E720= 58          X
                jsr LF416                    ; E721= 20 16 F4     .t
                sei                          ; E724= 78          x
                dec $02CD                    ; E725= CE CD 02    NM.
LE728:
                bit LE34E                    ; E728= 2C 4E E3    ,Nc
                jsr LE60F                    ; E72B= 20 0F E6     .f
                lda $EC                      ; E72E= A5 EC       %l
                ora $ED                      ; E730= 05 ED       .m
                and $0242                    ; E732= 2D 42 02    -B.
                beq LE73B                    ; E735= F0 04       p.
                sec                          ; E737= 38          8
                jsr LF8FF                    ; E738= 20 FF F8     .x
LE73B:
                jsr LE933                    ; E73B= 20 33 E9     3i
                ldy $0243                    ; E73E= AC 43 02    ,C.
                beq LE748                    ; E741= F0 05       p.
                ldx #$15                     ; E745= 20 72 EE     rn
                jsr makeROMServiceCall
LE748:
                bit HADC+0                   ; E748= 2C 18 FE    ,.~
                bvs LE752                    ; E74B= 70 05       p.
                rts                          ; E74D= 60          `

LE74E:
                bit #$10                     ; E74E= 89 10       ..
                beq LE78E                    ; E750= F0 3C       p<
LE752:
                ldx $024C                    ; E752= AE 4C 02    .L.
                beq LE788                    ; E755= F0 31       p1
                lda HADC+2                   ; E757= AD 1A FE    -.~
                sta $02B5,x                  ; E75A= 9D B5 02    .5.
                lda HADC+1                   ; E75D= AD 19 FE    -.~
                sta $02B9,x                  ; E760= 9D B9 02    .9.
                stx $02BE                    ; E763= 8E BE 02    .>.
                ldy #$03                     ; E766= A0 03        .
                jsr eventEntryPoint                    ; E768= 20 28 EA     (j
                dex                          ; E76B= CA          J
                bne LE771                    ; E76C= D0 03       P.
                ldx $024D                    ; E76E= AE 4D 02    .M.
LE771:
                cpx #$05                     ; E771= E0 05       `.
                bcc LE777                    ; E773= 90 02       ..
                ldx #$04                     ; E775= A2 04       ".
LE777:
                stx $024C                    ; E777= 8E 4C 02    .L.
                lda $024E                    ; E77A= AD 4E 02    -N.
                dec a                        ; E77D= 3A          :
                and #$08                     ; E77E= 29 08       ).
                clc                          ; E780= 18          .
                adc $024C                    ; E781= 6D 4C 02    mL.
                dec a                        ; E784= 3A          :
                sta HADC+0                   ; E785= 8D 18 FE    ..~
LE788:
                lda #$10                     ; E788= A9 10       ).
LE78A:
                sta systemVIA.ifr            ; E78A= 8D 4D FE    .M~
                rts                          ; E78D= 60          `

LE78E:
                lsr a                        ; E78E= 4A          J
                bcc LE799                    ; E78F= 90 08       ..
                clc                          ; E791= 18          .
                jsr LF8FF                    ; E792= 20 FF F8     .x
                lda #$01                     ; E795= A9 01       ).
                bra LE78A                    ; E797= 80 F1       .q

LE799:
                jmp LE663                    ; E799= 4C 63 E6    Lcf

osbyte11:                       ;e79c
                sty $02BE                    ; E79C= 8C BE 02    .>.
                bra LE771                    ; E79F= 80 D0       .P

LE7A1:
                lda #$E0                     ; E7A1= A9 E0       )`
LE7A3:
                sta $FE                      ; E7A3= 85 FE       .~
                stz $FD                      ; E7A5= 64 FD       d}
LE7A7:
                iny                          ; E7A7= C8          H
                lda ($FD),y                  ; E7A8= B1 FD       1}
                jsr OSASCI                   ; E7AA= 20 E3 FF     c.
                tax                          ; E7AD= AA          *
                bne LE7A7                    ; E7AE= D0 F7       Pw
                rts                          ; E7B0= 60          `

LE7B1:
                stx $02B1                    ; E7B1= 8E B1 02    .1.
                sty $02B2                    ; E7B4= 8C B2 02    .2.
                ror $E6                      ; E7B7= 66 E6       ff
                cli                          ; E7B9= 58          X
                bra LE7BE                    ; E7BA= 80 02       ..

osrdchEntryPoint:
                stz $E6                      ; E7BC= 64 E6       df
LE7BE:
                phx                          ; E7BE= DA          Z
                phy                          ; E7BF= 5A          Z
                ldy $0256                    ; E7C0= AC 56 02    ,V.
                beq LE7D7                    ; E7C3= F0 12       p.
                sec                          ; E7C5= 38          8
                ror $EB                      ; E7C6= 66 EB       fk
                jsr OSBGET                   ; E7C8= 20 D7 FF     W.
                stz $EB                      ; E7CB= 64 EB       dk
                bcc LE7F3                    ; E7CD= 90 24       .$
                lda #$00                     ; E7CF= A9 00       ).
                stz $0256                    ; E7D1= 9C 56 02    .V.
                jsr OSFIND                   ; E7D4= 20 CE FF     N.
LE7D7:
                lda $FF                      ; E7D7= A5 FF       %.
                asl a                        ; E7D9= 0A          .
                lda #$1B                     ; E7DA= A9 1B       ).
                bcs LE7F3                    ; E7DC= B0 15       0.
                ldx $0241                    ; E7DE= AE 41 02    .A.
                jsr LEAFD                    ; E7E1= 20 FD EA     }j
                bcc LE7F3                    ; E7E4= 90 0D       ..
                bit $E6                      ; E7E6= 24 E6       $f
                bpl LE7D7                    ; E7E8= 10 ED       .m
                lda $02B2                    ; E7EA= AD B2 02    -2.
                ora $02B1                    ; E7ED= 0D B1 02    .1.
                bne LE7D7                    ; E7F0= D0 E5       Pe
                dec a                        ; E7F2= 3A          :
LE7F3:
                ply                          ; E7F3= 7A          z
                plx                          ; E7F4= FA          z
                rts                          ; E7F5= 60          `

LE7F6:
                lda hazel.activeFS
                sta hazel.libFS
                rts                          ; E7FC= 60          `

LE7FD:
                sta TUBE+8                   ; E7FD= 8D E8 FE    .h~
LE800:
                bra LE800                    ; E800= 80 FE       .~

; OSCLI
; =====
LE802:
                jsr selectHAZEL                    ; E802= 20 BA ED     :m
                stx $F2                      ; E805= 86 F2       .r
                sty $F3                      ; E807= 84 F3       .s
                ldy #$00                     ; E809= A0 00        .
LE80B:
                lda ($F2),y                  ; E80B= B1 F2       1r
                sta LDC00,y                  ; E80D= 99 00 DC    ..\
emptyCommandLine=*+1                         ;arbitrary place that's
                                             ;just a 13 byte...
                cmp #$0D                     ; E810= C9 0D       I.
                beq LE818                    ; E812= F0 04       p.
                iny                          ; E814= C8          H
                bne LE80B                    ; E815= D0 F4       Pt
                rts                          ; E817= 60          `

LE818:
                ldy #$DC                     ; E818= A0 DC        \
                ldx #$00                     ; E81A= A2 00       ".
                jsr LF384                    ; E81C= 20 84 F3     .s
                jmp L84FF                    ; E81F= 4C FF 84    L..

                ; OSWRCH
                ; ======
oswrchEntryPoint:
                pha                          ; E822= 48          H
                phx                          ; E823= DA          Z
                phy                          ; E824= 5A          Z
                pha                          ; E825= 48          H
                bit $0260                    ; E826= 2C 60 02    ,`.
                bpl LE833                    ; E829= 10 08       ..
                tay                          ; E82B= A8          (
                lda #$04                     ; E82C= A9 04       ).
                jsr LEB04                    ; E82E= 20 04 EB     .k
                bcs LE8A5                    ; E831= B0 72       0r
LE833:
                lda #$02                     ; E833= A9 02       ).
                bit $027C                    ; E835= 2C 7C 02    ,|.
                bne LE862                    ; E838= D0 28       P(
                pla                          ; E83A= 68          h
                pha                          ; E83B= 48          H
                tax                          ; E83C= AA          *
                lda ACCCON                    ; E83D= AD 34 FE    -4~
                pha                          ; E840= 48          H
                lda #$08                     ; E841= A9 08       ).
                trb ACCCON                    ; E843= 1C 34 FE    .4~
                lda $F4                      ; E846= A5 F4       %t
                pha                          ; E848= 48          H
                lda #$8F                     ; E849= A9 8F       ).
                sta $F4                      ; E84B= 85 F4       .t
                sta ROMSEL                   ; E84D= 8D 30 FE    .0~
                txa                          ; E850= 8A          .
                jsr LC027                    ; E851= 20 27 C0     '@
                pla                          ; E854= 68          h
                sta $F4                      ; E855= 85 F4       .t
                sta ROMSEL                   ; E857= 8D 30 FE    .0~
                pla                          ; E85A= 68          h
                and #$08                     ; E85B= 29 08       ).
                tsb ACCCON                    ; E85D= 0C 34 FE    .4~
                bcs LE869                    ; E860= B0 07       0.
LE862:
                lda #$08                     ; E862= A9 08       ).
                bit $027C                    ; E864= 2C 7C 02    ,|.
                beq LE86E                    ; E867= F0 05       p.
LE869:
                pla                          ; E869= 68          h
                pha                          ; E86A= 48          H
                jsr LE8AA                    ; E86B= 20 AA E8     *h
LE86E:
                lda $027C                    ; E86E= AD 7C 02    -|.
                ror a                        ; E871= 6A          j
                bcc LE88F                    ; E872= 90 1B       ..
                ldy $EA                      ; E874= A4 EA       $j
                dey                          ; E876= 88          .
                bpl LE88F                    ; E877= 10 16       ..
                pla                          ; E879= 68          h
                pha                          ; E87A= 48          H
                php                          ; E87B= 08          .
                sei                          ; E87C= 78          x
                ldx #$02                     ; E87D= A2 02       ".
                pha                          ; E87F= 48          H
                jsr osbyte98                    ; E880= 20 EF E9     oi
                bcc LE888                    ; E883= 90 03       ..
                jsr LE908                    ; E885= 20 08 E9     .i
LE888:
                pla                          ; E888= 68          h
                ldx #$02                     ; E889= A2 02       ".
                jsr LE9A3                    ; E88B= 20 A3 E9     #i
                plp                          ; E88E= 28          (
LE88F:
                lda #$10                     ; E88F= A9 10       ).
                bit $027C                    ; E891= 2C 7C 02    ,|.
                bne LE8A5                    ; E894= D0 0F       P.
                ldy $0257                    ; E896= AC 57 02    ,W.
                beq LE8A5                    ; E899= F0 0A       p.
                pla                          ; E89B= 68          h
                pha                          ; E89C= 48          H
                sec                          ; E89D= 38          8
                ror $EB                      ; E89E= 66 EB       fk
                jsr OSBPUT                   ; E8A0= 20 D4 FF     T.
                lsr $EB                      ; E8A3= 46 EB       Fk
LE8A5:
                pla                          ; E8A5= 68          h
                ply                          ; E8A6= 7A          z
                plx                          ; E8A7= FA          z
                pla                          ; E8A8= 68          h
                rts                          ; E8A9= 60          `

LE8AA:
                bit $027C                    ; E8AA= 2C 7C 02    ,|.
                bvs LE8D4                    ; E8AD= 70 25       p%
                cmp $0286                    ; E8AF= CD 86 02    M..
                bne LE8B9                    ; E8B2= D0 05       P.
                bit $0246                    ; E8B4= 2C 46 02    ,F.
                bpl LE8D4                    ; E8B7= 10 1B       ..
LE8B9:
                php                          ; E8B9= 08          .
                sei                          ; E8BA= 78          x
                tax                          ; E8BB= AA          *
                lda #$04                     ; E8BC= A9 04       ).
                bit $027C                    ; E8BE= 2C 7C 02    ,|.
                bne LE8D3                    ; E8C1= D0 10       P.
                txa                          ; E8C3= 8A          .
                ldx #$03                     ; E8C4= A2 03       ".
                jsr LE9A3                    ; E8C6= 20 A3 E9     #i
                bcs LE8D3                    ; E8C9= B0 08       0.
                bit $02D1                    ; E8CB= 2C D1 02    ,Q.
                bpl LE8D3                    ; E8CE= 10 03       ..
                jsr LE8D5                    ; E8D0= 20 D5 E8     Uh
LE8D3:
                plp                          ; E8D3= 28          (
LE8D4:
                rts                          ; E8D4= 60          `

LE8D5:
                lda $0285                    ; E8D5= AD 85 02    -..
                beq LE959                    ; E8D8= F0 7F       p.
                dec a                        ; E8DA= 3A          :
                bne LE8FD                    ; E8DB= D0 20       P
                jsr osbyte91                    ; E8DD= 20 F4 E9     ti
                ror $02D1                    ; E8E0= 6E D1 02    nQ.
                bmi LE928                    ; E8E3= 30 43       0C
                ldy #$82                     ; E8E5= A0 82        .
                sty userVIA.ier              ; E8E7= 8C 6E FE    .n~
                sta userVIA.ora              ; E8EA= 8D 61 FE    .a~
                lda userVIA.pcr              ; E8ED= AD 6C FE    -l~
                and #$F1                     ; E8F0= 29 F1       )q
                ora #$0C                     ; E8F2= 09 0C       ..
                sta userVIA.pcr              ; E8F4= 8D 6C FE    .l~
                ora #$0E                     ; E8F7= 09 0E       ..
                sta userVIA.pcr              ; E8F9= 8D 6C FE    .l~
                rts                          ; E8FC= 60          `

LE8FD:
                dec a                        ; E8FD= 3A          :
                bne LE929                    ; E8FE= D0 29       P)
                ldy $EA                      ; E900= A4 EA       $j
                dey                          ; E902= 88          .
                bpl LE959                    ; E903= 10 54       .T
                lsr $02D1                    ; E905= 4E D1 02    NQ.
LE908:
                lsr $024F                    ; E908= 4E 4F 02    NO.
LE90B:
                jsr LED27                    ; E90B= 20 27 ED     'm
                bcc LE928                    ; E90E= 90 18       ..
                ldx #$20                     ; E910= A2 20       "
LE912:
                ldy #$9F                     ; E912= A0 9F        .
osbyte9C:
                php                          ; E914= 08          .
                sei                          ; E915= 78          x
                tya                          ; E916= 98          .
                stx $FA                      ; E917= 86 FA       .z
                and $0250                    ; E919= 2D 50 02    -P.
                eor $FA                      ; E91C= 45 FA       Ez
                ldx $0250                    ; E91E= AE 50 02    .P.
LE921:
                sta $0250                    ; E921= 8D 50 02    .P.
                sta ACIA+0                    ; E924= 8D 08 FE    ..~
                plp                          ; E927= 28          (
LE928:
                rts                          ; E928= 60          `

LE929:
                clc                          ; E929= 18          .
                lda #$01                     ; E92A= A9 01       ).
                jsr LE93A                    ; E92C= 20 3A E9     :i
osbyte7B:
                ror $02D1                    ; E92F= 6E D1 02    nQ.
LE932:
                rts                          ; E932= 60          `

LE933:
                bit $02D1                    ; E933= 2C D1 02    ,Q.
                bmi LE932                    ; E936= 30 FA       0z
                lda #$00                     ; E938= A9 00       ).
LE93A:
                ldx #$03                     ; E93A= A2 03       ".
LE93C:
                ldy $0285                    ; E93C= AC 85 02    ,..
                jsr LEB04                    ; E93F= 20 04 EB     .k
                jmp (UPTV)                  ; E942= 6C 22 02    l".

osbyte0F:                       ;e945
                bne LE956                    ; E945= D0 0F       P.
LE947:
                ldx #$08                     ; E947= A2 08       ".
LE949:
                cli                          ; E949= 58          X
                sei                          ; E94A= 78          x
                jsr osbyte15
                dex                          ; E94E= CA          J
                bpl LE949                    ; E94F= 10 F8       .x
osbyte15:                                    ;e951
                cpx #$09                     ; E951= E0 09       `.
                bcc LE959                    ; E953= 90 04       ..
                rts                          ; E955= 60          `

LE956:
                ldx $0241                    ; E956= AE 41 02    .A.
LE959:
                clc                          ; E959= 18          .
LE95A:
                pha                          ; E95A= 48          H
                php                          ; E95B= 08          .
                sei                          ; E95C= 78          x
                bcs LE967                    ; E95D= B0 08       0.
                txa                          ; E95F= 8A          .
                and #$04                     ; E960= 29 04       ).
                beq LE967                    ; E962= F0 03       p.
                jsr LF55D                    ; E964= 20 5D F5     ]u
LE967:
                sec                          ; E967= 38          8
                ror $02CE,x                  ; E968= 7E CE 02    ~N.
                cpx #$02                     ; E96B= E0 02       `.
                bcs LE975                    ; E96D= B0 06       0.
                stz $0268                    ; E96F= 9C 68 02    .h.
                stz $026A                    ; E972= 9C 6A 02    .j.
LE975:
                jsr LED21                    ; E975= 20 21 ED     !m
                plp                          ; E978= 28          (
                pla                          ; E979= 68          h
                rts                          ; E97A= 60          `

LE97B:
                bvc LE984                    ; E97B= 50 07       P.
LE97D:
                lda $02D7,x                  ; E97D= BD D7 02    =W.
                sta $02E0,x                  ; E980= 9D E0 02    .`.
                rts                          ; E983= 60          `

LE984:
                php                          ; E984= 08          .
                sei                          ; E985= 78          x
                php                          ; E986= 08          .
                sec                          ; E987= 38          8
                lda $02E0,x                  ; E988= BD E0 02    =`.
                sbc $02D7,x                  ; E98B= FD D7 02    }W.
                bcs LE994                    ; E98E= B0 04       0.
                sec                          ; E990= 38          8
                sbc LE9DB,x                  ; E991= FD DB E9    }[i
LE994:
                plp                          ; E994= 28          (
                bcc LE99D                    ; E995= 90 06       ..
                clc                          ; E997= 18          .
                adc LE9DB,x                  ; E998= 7D DB E9    }[i
                eor #$FF                     ; E99B= 49 FF       I.
LE99D:
                ldy #$00                     ; E99D= A0 00        .
                tax                          ; E99F= AA          *
                plp                          ; E9A0= 28          (
LE9A1:
                rts                          ; E9A1= 60          `

LE9A2:
                cli                          ; E9A2= 58          X
LE9A3:
                sei                          ; E9A3= 78          x
LE9A4:
                jsr LEA40                    ; E9A4= 20 40 EA     @j
                bcc LE9A1                    ; E9A7= 90 F8       .x
                jsr LF241                    ; E9A9= 20 41 F2     Ar
                pha                          ; E9AC= 48          H
                jsr LF735                    ; E9AD= 20 35 F7     5w
                asl a                        ; E9B0= 0A          .
                pla                          ; E9B1= 68          h
                bcc LE9A2                    ; E9B2= 90 EE       .n
                rts                          ; E9B4= 60          `

;-------------------------------------------------------------------------
;
; OSBYTE $77
;
; D.2-33
;
osbyte77:                       ;e9b5
                jsr LF384                    ; E9B5= 20 84 F3     .s
                jmp L9423                    ; E9B8= 4C 23 94    L#.

LE9BB:
                lda #$00                     ; E9BB= A9 00       ).
                sec                          ; E9BD= 38          8
                ldx #$14                     ; E9BE= A2 14       ".
LE9C0:
                rol a                        ; E9C0= 2A          *
                bne LE9C5                    ; E9C1= D0 02       P.
                inx                          ; E9C3= E8          h
                rol a                        ; E9C4= 2A          *
LE9C5:
                dey                          ; E9C5= 88          .
                bpl LE9C0                    ; E9C6= 10 F8       .x
                rts                          ; E9C8= 60          `

LE9C9:
                .byte $03                    ; E9C9= 03          .
                asl a                        ; E9CA= 0A          .
                php                          ; E9CB= 08          .
                .byte $07                    ; E9CC= 07          .
                .byte $07                    ; E9CD= 07          .
                .byte $07                    ; E9CE= 07          .
                .byte $07                    ; E9CF= 07          .
                .byte $07                    ; E9D0= 07          .
;ORA #&00         :\ E9D1= 09 00       ..
                .byte $09
LE9D2:
                .byte $00
                brk                          ; E9D3= 00          .
                cpy #$C0                     ; E9D4= C0 C0       @@
                bvc LEA38                    ; E9D6= 50 60       P`
                bvs LE95A                    ; E9D8= 70 80       p.
                brk                          ; E9DA= 00          .
LE9DB:
                cpx #$00                     ; E9DB= E0 00       `.
                rti                          ; E9DD= 40          @

                cpy #$F0                     ; E9DE= C0 F0       @p
;BEQ LE9D2        :\ E9E0= F0 F0       pp
                .byte $F0
                .byte $F0
;BEQ LE9A4        :\ E9E2= F0 C0       p@
                .byte $F0
                .byte $C0
LE9E4:
                lda LE9D2,x                  ; E9E4= BD D2 E9    =Ri
                sta $FA                      ; E9E7= 85 FA       .z
                lda LE9C9,x                  ; E9E9= BD C9 E9    =Ii
                sta $FB                      ; E9EC= 85 FB       .{
                rts                          ; E9EE= 60          `

osbyte98:
                bit LE34E                    ; E9EF= 2C 4E E3    ,Nc
                bra LE9F5                    ; E9F2= 80 01       ..

osbyte91:
                clv                          ; E9F4= B8          8
LE9F5:
                jmp (REMV)                  ; E9F5= 6C 2C 02    l,.

LE9F8:
                php                          ; E9F8= 08          .
                sei                          ; E9F9= 78          x
                lda $02D7,x                  ; E9FA= BD D7 02    =W.
                cmp $02E0,x                  ; E9FD= DD E0 02    ]`.
                beq LEA6E                    ; EA00= F0 6C       pl
                tay                          ; EA02= A8          (
                jsr LE9E4                    ; EA03= 20 E4 E9     di
                lda ($FA),y                  ; EA06= B1 FA       1z
                bvs LEA24                    ; EA08= 70 1A       p.
                pha                          ; EA0A= 48          H
                iny                          ; EA0B= C8          H
                tya                          ; EA0C= 98          .
                bne LEA12                    ; EA0D= D0 03       P.
                lda LE9DB,x                  ; EA0F= BD DB E9    =[i
LEA12:
                sta $02D7,x                  ; EA12= 9D D7 02    .W.
                cpx #$02                     ; EA15= E0 02       `.
                bcc LEA23                    ; EA17= 90 0A       ..
                cmp $02E0,x                  ; EA19= DD E0 02    ]`.
                bne LEA23                    ; EA1C= D0 05       P.
                ldy #$00                     ; EA1E= A0 00        .
                jsr eventEntryPoint                    ; EA20= 20 28 EA     (j
LEA23:
                pla                          ; EA23= 68          h
LEA24:
                tay                          ; EA24= A8          (
LEA25:
                plp                          ; EA25= 28          (
                clc                          ; EA26= 18          .
                rts                          ; EA27= 60          `

eventEntryPoint:
                php                          ; EA28= 08          .
                sei                          ; EA29= 78          x
                pha                          ; EA2A= 48          H
                lda $02BF,y                  ; EA2B= B9 BF 02    9?.
                beq LEA6D                    ; EA2E= F0 3D       p=
                tya                          ; EA30= 98          .
                ply                          ; EA31= 7A          z
                phy                          ; EA32= 5A          Z
                jsr LF8BF                    ; EA33= 20 BF F8     ?x
                bra LEA23                    ; EA36= 80 EB       .k

LEA38:
                tya                          ; EA38= 98          .
                ldy #$02                     ; EA39= A0 02        .
                jsr eventEntryPoint                    ; EA3B= 20 28 EA     (j
                tay                          ; EA3E= A8          (
osbyte8A: ;LEA3F:
                tya                          ; EA3F= 98          .
LEA40:
                jmp (INSV)                  ; EA40= 6C 2A 02    l*.

LEA43:
                php                          ; EA43= 08          .
                sei                          ; EA44= 78          x
                pha                          ; EA45= 48          H
                lda $02E0,x                  ; EA46= BD E0 02    =`.
                inc a                        ; EA49= 1A          .
                bne LEA4F                    ; EA4A= D0 03       P.
                lda LE9DB,x                  ; EA4C= BD DB E9    =[i
LEA4F:
                cmp $02D7,x                  ; EA4F= DD D7 02    ]W.
                beq LEA62                    ; EA52= F0 0E       p.
                ldy $02E0,x                  ; EA54= BC E0 02    <`.
                sta $02E0,x                  ; EA57= 9D E0 02    .`.
                jsr LE9E4                    ; EA5A= 20 E4 E9     di
                pla                          ; EA5D= 68          h
                sta ($FA),y                  ; EA5E= 91 FA       .z
                bra LEA25                    ; EA60= 80 C3       .C

LEA62:
                pla                          ; EA62= 68          h
                cpx #$02                     ; EA63= E0 02       `.
                bcs LEA6E                    ; EA65= B0 07       0.
                ldy #$01                     ; EA67= A0 01        .
                jsr eventEntryPoint                    ; EA69= 20 28 EA     (j
                pha                          ; EA6C= 48          H
LEA6D:
                pla                          ; EA6D= 68          h
LEA6E:
                plp                          ; EA6E= 28          (
                sec                          ; EA6F= 38          8
                rts                          ; EA70= 60          `

;-------------------------------------------------------------------------
;
; Check if character is a letter - A-Z or a-z.
;
; Entry:
;
; A = character to test
;
; Exit:
;
; C=0 if character is letter, C=1 otherwise
;
; Preserves: A/X/Y
isLetter: .proc                 ;EA71
                pha
                and #$DF        ;convert to upper case
                cmp #'Z'+1
                bcs +           ;branch taken with C=1 if past Z
                eor #$FF
                cmp #-'A'       ;C=1 if past A
+
                pla
                rts
                .pend

;-------------------------------------------------------------------------

LEA7E:
                ldx #$00                     ; EA7E= A2 00       ".
osbyte99:
                txa                          ; EA80= 8A          .
                and $0245                    ; EA81= 2D 45 02    -E.
                bne osbyte8A                    ; EA84= D0 B9       P9
                tya                          ; EA86= 98          .
                eor $026C                    ; EA87= 4D 6C 02    Ml.
                ora $0275                    ; EA8A= 0D 75 02    .u.
                bne LEA38                    ; EA8D= D0 A9       P)
                lda $0258                    ; EA8F= AD 58 02    -X.
                ror a                        ; EA92= 6A          j
                tya                          ; EA93= 98          .
                bcs LEAA0                    ; EA94= B0 0A       0.
                ldy #$06                     ; EA96= A0 06        .
                jsr eventEntryPoint                    ; EA98= 20 28 EA     (j
                bcc LEAA0                    ; EA9B= 90 03       ..
                jsr osbyte7D                    ; EA9D= 20 57 EC     Wl
LEAA0:
                clc                          ; EAA0= 18          .
                rts                          ; EAA1= 60          `

LEAA2:
                ror a                        ; EAA2= 6A          j
                pla                          ; EAA3= 68          h
                bcs LEABD                    ; EAA4= B0 17       0.
LEAA6:
                tya                          ; EAA6= 98          .
                and #$0F                     ; EAA7= 29 0F       ).
                pha                          ; EAA9= 48          H
                tya                          ; EAAA= 98          .
                lsr a                        ; EAAB= 4A          J
                lsr a                        ; EAAC= 4A          J
                lsr a                        ; EAAD= 4A          J
                lsr a                        ; EAAE= 4A          J
                eor #$04                     ; EAAF= 49 04       I.
                tay                          ; EAB1= A8          (
                lda $0265,y                  ; EAB2= B9 65 02    9e.
                lsr a                        ; EAB5= 4A          J
                beq LEB32                    ; EAB6= F0 7A       pz
                pla                          ; EAB8= 68          h
                clc                          ; EAB9= 18          .
                adc $0265,y                  ; EABA= 79 65 02    ye.
LEABD:
                clc                          ; EABD= 18          .
                rts                          ; EABE= 60          `

LEABF:
                jsr LEFB6                    ; EABF= 20 B6 EF     6o
                plx                          ; EAC2= FA          z
LEAC3:
                jsr osbyte91                    ; EAC3= 20 F4 E9     ti
                bcs LEB28                    ; EAC6= B0 60       0`
                pha                          ; EAC8= 48          H
                cpx #$01                     ; EAC9= E0 01       `.
                bne LEAD3                    ; EACB= D0 06       P.
                jsr LE90B                    ; EACD= 20 0B E9     .i
                sec                          ; EAD0= 38          8
                ldx #$01                     ; EAD1= A2 01       ".
LEAD3:
                pla                          ; EAD3= 68          h
                bcc LEADB                    ; EAD4= 90 05       ..
                ldy $0245                    ; EAD6= AC 45 02    ,E.
                bne LEB27                    ; EAD9= D0 4C       PL
LEADB:
                tay                          ; EADB= A8          (
                bpl LEB27                    ; EADC= 10 49       .I
                and #$0F                     ; EADE= 29 0F       ).
                cmp #$0B                     ; EAE0= C9 0B       I.
                bcc LEAA6                    ; EAE2= 90 C2       .B
                adc #$7B                     ; EAE4= 69 7B       i{
                pha                          ; EAE6= 48          H
                lda $027D                    ; EAE7= AD 7D 02    -}.
                bne LEAA2                    ; EAEA= D0 B6       P6
                lda $027C                    ; EAEC= AD 7C 02    -|.
                ror a                        ; EAEF= 6A          j
                ror a                        ; EAF0= 6A          j
                pla                          ; EAF1= 68          h
                bcs LEAC3                    ; EAF2= B0 CF       0O
                cmp #$87                     ; EAF4= C9 87       I.
                beq LEB29                    ; EAF6= F0 31       p1
                phx                          ; EAF8= DA          Z
                jsr LEB5D                    ; EAF9= 20 5D EB     ]k
                plx                          ; EAFC= FA          z
LEAFD:
                bit $025F                    ; EAFD= 2C 5F 02    ,_.
                bpl LEB07                    ; EB00= 10 05       ..
                lda #$06                     ; EB02= A9 06       ).
LEB04:
                jmp (NETV)                  ; EB04= 6C 24 02    l$.

LEB07:
                lda $0268                    ; EB07= AD 68 02    -h.
                beq LEAC3                    ; EB0A= F0 B7       p7
                txa                          ; EB0C= 8A          .
                and $0245                    ; EB0D= 2D 45 02    -E.
                bne LEAC3                    ; EB10= D0 B1       P1
                lda $F4                      ; EB12= A5 F4       %t
                pha                          ; EB14= 48          H
                jsr LE598                    ; EB15= 20 98 E5     .e
                lda ($F8)                    ; EB18= B2 F8       2x
                plx                          ; EB1A= FA          z
                jsr selectROMX                    ; EB1B= 20 81 E5     .e
                dec $0268                    ; EB1E= CE 68 02    Nh.
                inc $F8                      ; EB21= E6 F8       fx
                bne LEB27                    ; EB23= D0 02       P.
                inc $F9                      ; EB25= E6 F9       fy
LEB27:
                clc                          ; EB27= 18          .
LEB28:
                rts                          ; EB28= 60          `

LEB29:
                phx                          ; EB29= DA          Z
                jsr LEB63                    ; EB2A= 20 63 EB     ck
                beq LEABF                    ; EB2D= F0 90       p.
                plx                          ; EB2F= FA          z
                clc                          ; EB30= 18          .
                rts                          ; EB31= 60          `

LEB32:
                ply                          ; EB32= 7A          z
                bcc LEAC3                    ; EB33= 90 8E       ..
                tya                          ; EB35= 98          .
                sta $02C9                    ; EB36= 8D C9 02    .I.
                lda $F4                      ; EB39= A5 F4       %t
                pha                          ; EB3B= 48          H
                jsr LE598                    ; EB3C= 20 98 E5     .e
                jsr LEB55                    ; EB3F= 20 55 EB     Uk
                sta $0268                    ; EB42= 8D 68 02    .h.
                lda L8000,y                  ; EB45= B9 00 80    9..
                sta $F8                      ; EB48= 85 F8       .x
                lda L8011,y                  ; EB4A= B9 11 80    9..
                sta $F9                      ; EB4D= 85 F9       .y
                pla                          ; EB4F= 68          h
                jsr selectROMA                    ; EB50= 20 92 E5     .e
                bra LEAFD                    ; EB53= 80 A8       .(

LEB55:
                lda L8001,y                  ; EB55= B9 01 80    9..
LEB58:
                sec                          ; EB58= 38          8
                sbc L8000,y                  ; EB59= F9 00 80    y..
                rts                          ; EB5C= 60          `

LEB5D:
                jsr LF3AB                    ; EB5D= 20 AB F3     +s
                jmp LDF78                    ; EB60= 4C 78 DF    Lx_

LEB63:
                jsr LF3AB                    ; EB63= 20 AB F3     +s
                jmp LDF5E                    ; EB66= 4C 5E DF    L^_

; OSBYTE Dispatch Table
; =====================

; TODO structure probably the same as
; https://tobylobster.github.io/mos/mos/S-s15.html#SP1...
                
osbyteAndOSWORDRoutineTable:
                .word osbyte00 ;Display MOS version D.2-18
                .word osbyte01 ;Write user flag D.2-18
                .word osbyte02 ;Specify input stream D.2-18
                .word osbyte03 ;Specify output stream D.2-19
                .word osbyte04 ;Enable/disable cursor editing
                .word osbyte05 ;Write printer driver type D.2-20
                .word osbyte06 ;Write printer ignore character D.2-21
                .word osbyte07 ;Write RS423 receive rate D.2-21
                .word osbyte08 ;Write RS423 transmit rate D.2-22
                .word osbyte09 ;Write duration of first colour D.2-22
                .word osbyte0A ;Write duration of second colour D.2-22
                .word osbyte0B ;Write keyboard auto-repeat delay D.2-22
                .word osbyte0C ;Write keyboard auto-repeat rate D.2-23
                .word osbyte0D ;Disable event D.2-23
                .word osbyte0E ;Enable event D.2-24
                .word osbyte0F ;Flush buffer D.2-24
                .word osbyte10 ;Write number of ADC channels D.2-25
                .word osbyte11 ;Write next ADC channel to be sampled D.2-25
                .word osbyte12 ;Reset soft keys D.2-26
                .word osbyte13 ;Wait for vertical sync D.2-26
                .word osbyte14 ;Restore default font definitions D.2-26
                .word osbyte15 ;Flush selected buffer D.2-27
                .word osbyte16 ;Increment ROM polling semaphore D.2-27
                .word osbyte17 ;Decrement ROM polling semaphore D.2-27
                .word osbyteUnused ; Reserved
                .word osbyte19 ;Restore a group of font definitions D.2-28
                .word osbyte6B ;Write 1MHz bus selection status D.2-29
                .word osbyte6C ;Write usage of main/shadow memory D.2-30
                .word osbyte6D ;Make temporary Filing System permanent D.2-30
                .word osbyteUnused ;Unused
                .word osbyteUnused ;Unused
                .word osbyte70 ;Select main/shadow memory for VDU access D.2-31
                .word osbyte71 ;Select main/shadow memory for display D.2-31
                .word osbyte72 ;Write usage of shadow memory D.2-31
                .word rts      ;Unused
                .word rts      ;Unused
                .word osbyte75 ;Read VDU status D.2-32
                .word osbyte76 ;Reflect keyboard status in keyboard LEDs D.2-33
                .word osbyte77 ;Close all *SPOOL/*SPOOLON or *EXEC files D.2-33
                .word osbyte78 ;Write keys pressed information D.2-33
                .word callKEYV ;Keyboard scan D.2-33
                .word osbyte7A ;Keyboard scan from 16 decimal
                .word osbyte7B ;Inform MOS of printer driver going dormant
                .word osbyte7C ;Clear escape condition
                .word osbyte7D ;Set escape condition
                .word osbyte7E ;Acknowledge escape condition
                .word osbyte7F ;Check for end of file on an opened file
                .word osbyte80 ;Read ADC channel or get buffer status
                .word osbyte81 ;Read key with time limit
                .word osbyte82 ;
                .word osbyte83 ;Read Operating System High Water Mark (OSHWM)
                .word osbyte84 ;Read top of user RAM
                .word osbyte85 ;Read top of user RAM for given mode
                .word osbyte86 ;Read text cursor position
                .word osbyte87 ;Read screen mode and character at text cursor position
                .word osbyte88 ;Execute user code
                .word osbyte89 ;Switch cassette motor relay
                .word osbyte8A ;Insert character code into buffer
                .word osbyte8B ;Write Filing System options
                .word osbyte8C8D ;Select Cassette Filing System
                .word osbyte8C8D ;Select ROM Filing System
                .word osbyte8E   ;Enter language ROM
                .word osbyte8F   ;Issue paged ROM service request
                .word osbyte90 ;Set vertical screen shift and interlace option
                .word osbyte91 ;Get character from buffer
                .word osbyte92 ;Read from FRED (&FC00 – &FCFF)
                .word osbyte93 ;Write to FRED (&FC00 – &FCFF)
                .word osbyte94 ;Read from JIM (&FD00 - &FDFF)
                .word osbyte95 ;Write to JIM (&FD00 - &FDFF)
                .word osbyte96 ;Read from SHEILA (&FE00 - &FEFF)
                .word osbyte97 ;Write to SHEILA (&FE00 - &FEFF)
                .word osbyte98 ;Examine buffer status
                .word osbyte99 ;Insert character code into buffer checking for escape
                .word osbyte9A ;Write video ULA control register
                .word osbyte9B ;Write to video ULA palette register and copy
                .word osbyte9C ;Read/write serial ACIA control register and copy
                .word osbyte9D ;Write byte across Tube
                .word osbyteUnused ;reserved for the speech system
                .word osbyteUnused ;reserved for the speech system
                .word osbyteA0     ;Read VDU variable value
                .word osbyteA1     ;Read CMOS RAM
                .word osbyteA2     ;Write CMOS RAM
                .word osbyteUnused ;reserved for applications software
                .word osbyteA4     ;Check processor type
                .word osbyteA5     ;Read output cursor position
                .word osbyteA6  ;handle osbyte A6-FF
                .word callUSERV ;*LINE - not part of the above table???
oswordRoutineTable:
                .word osword00  ;Read line from input stream to memory
                .word osword01  ;Read system clock
                .word osword02  ;Write system clock
                .word osword03  ;Read interval timer
                .word osword04  ;Write interval timer
                .word osword05  ;Read byte from I/O processor memory
                .word osword06  ;Write byte to I/O processor memory
                .word osword07  ;Generate a sound
                .word osword08  ;Define a sound envelope
                .word osword09  ;Read pixel logical colour
                .word osword0A  ;Read a character definition
                .word osword0B  ;Read the palette
                .word osword0C  ;Write the palette
                .word osword0D ;Read current and previous graphics cursor positions
                .word osword0E ;Read CMOS clock
                .word osword0F ;Write CMOS clock
                
osbyte88: ;LEC37:
                lda #$00

callUSERV:
                jmp (USERV)                  ; EC39= 6C 00 02    l..

osbyte7E:                       ;ec3c
                ldx #$00                     ; EC3C= A2 00       ".
                bit $FF                      ; EC3E= 24 FF       $.
                bpl osbyte7C                    ; EC40= 10 14       ..
                lda $0276                    ; EC42= AD 76 02    -v.
                bne LEC54                    ; EC45= D0 0D       P.
                cli                          ; EC47= 58          X
                stz $0269                    ; EC48= 9C 69 02    .i.
                jsr LF384                    ; EC4B= 20 84 F3     .s
                jsr LA591                    ; EC4E= 20 91 A5     .%
                jsr LE947                    ; EC51= 20 47 E9     Gi
LEC54:
                ldx #$FF                     ; EC54= A2 FF       ".
osbyte7C: ;EC56
                clc                          ; EC56= 18          .
osbyte7D: ;EC57
                ror $FF                      ; EC57= 66 FF       f.
                bit $027A                    ; EC59= 2C 7A 02    ,z.
                bpl LECD9                    ; EC5C= 10 7B       .{
                jmp tubeHost.copyEscapeStatus     ; EC5E= 4C 03 04    L..

osbyte89:
                lda serialRegisterULACopy                    ; EC61= AD 82 02    -..
                tay                          ; EC64= A8          (
                rol a                        ; EC65= 2A          *
                cpx #$01                     ; EC66= E0 01       `.
                ror a                        ; EC68= 6A          j
                bra LEC89                    ; EC69= 80 1E       ..

;-------------------------------------------------------------------------
;
; ;OSBYTE 8 (&08) Write RS423 transmit rate
;
; This call sets the RS423 baud rate for transmitting data. The actual format of
; the data is set using OSBYTE 156/&9C (see below).
;
; Entry parameters :
; X=0 selects 9600 baud
; X=1 selects 75 baud
; X=2 selects 150 baud
; X=3 selects 300 baud
; X=4 selects 1200 baud
; X=5 selects 2400 baud
; X=6 selects 4800 baud
; X=7 selects 9600 baud
; X=8 selects 19200 baud
; Y=0
;                 
; On exit : X=Y=<old serial ACIA control register contents>

osbyte08:
                lda #$38
                ; fall through to OSBYTE &07

;-------------------------------------------------------------------------
;
; OSBYTE 7 (&07) Write RS423 receive rate
;
; This call sets the RS423 baud rate for receiving data. The actual
; format of the data is set using OSBYTE 156/&9C (see below).
;
; Entry parameters :
; X=0 selects 9600 baud
; X=1 selects 75 baud
; X=2 selects 150 baud
; X=3 selects 300 baud
; X=4 selects 1200 baud
; X=5 selects 2400 baud
; X=6 selects 4800 baud
; X=7 selects 9600 baud
; X=8 selects 19200 baud
; Y=0
;                 
; On exit : X=Y=<old serial ACIA control register contents>

osbyte07:                                    ;ec6d
                eor #$3F                     ;if OSBYTE 8,
                                             ;A=%00000111, mask for
                                             ;transmit rate; if OSBYTE
                                             ;8, A=%000111000, mask
                                             ;for receive rate.
                sta $FA                      ;save mask
                ldy serialRegisterULACopy                    ;
                cpx #$09                     ;check for invalid baud rate
                bcs LEC8F                    ;branch taken if invalid
                and serialBaudRatesTable,x   ;get setting in A
                sta $FB                      ;store setting
                tya                          ;
                ora $FA                      ; EC7E= 05 FA       .z
                eor $FA                      ; EC80= 45 FA       Ez
                ora $FB                      ; EC82= 05 FB       .{
                ora #$40                     ; EC84= 09 40       .@
                eor $025D                    ;mask in tape/serial flag set by OSBYTE 205ac
LEC89:
                sta serialRegisterULACopy                    ; EC89= 8D 82 02    ...
                sta SERPROC+0                    ; EC8C= 8D 10 FE    ..~
LEC8F:
                tya                          ; EC8F= 98          .
LEC90:
                tax                          ; EC90= AA          *
                rts                          ; EC91= 60          `

; Y=0 on entry.
                
osbyte09:                       ;ec92
                iny                          ; EC92= C8          H
                clc                          ; EC93= 18          .
osbyte0A:                                    ;ec94
                lda $0252,y                  ; EC94= B9 52 02    9R.
                pha                          ; EC97= 48          H
                txa                          ; EC98= 8A          .
                sta $0252,y                  ; EC99= 99 52 02    .R.
                ply                          ; EC9C= 7A          z
                lda $0251                    ; EC9D= AD 51 02    -Q.
                bne LEC8F                    ; ECA0= D0 ED       Pm
                stx $0251                    ; ECA2= 8E 51 02    .Q.
                lda $0248                    ; ECA5= AD 48 02    -H.
                php                          ; ECA8= 08          .
                ror a                        ; ECA9= 6A          j
                plp                          ; ECAA= 28          (
                rol a                        ; ECAB= 2A          *
                sta $0248                    ; ECAC= 8D 48 02    .H.
                sta VCONTROL                 ; ECAF= 8D 20 FE    . ~
                bra LEC8F                    ; ECB2= 80 DB       .[

;-------------------------------------------------------------------------
;
; OSBYTE &02
;
; D.2-10
                
osbyte02:                       ;ecb4
                txa                          ; ECB4= 8A          .
                and #$01                     ; ECB5= 29 01       ).
                pha                          ; ECB7= 48          H
                lda $0250                    ; ECB8= AD 50 02    -P.
                rol a                        ; ECBB= 2A          *
                cpx #$01                     ; ECBC= E0 01       `.
                ror a                        ; ECBE= 6A          j
                cmp $0250                    ; ECBF= CD 50 02    MP.
                php                          ; ECC2= 08          .
                sta $0250                    ; ECC3= 8D 50 02    .P.
                sta ACIA+0                    ; ECC6= 8D 08 FE    ..~
                jsr LE90B                    ; ECC9= 20 0B E9     .i
                plp                          ; ECCC= 28          (
                beq LECD2                    ; ECCD= F0 03       p.
                bit ACIA+1                    ; ECCF= 2C 09 FE    ,.~
LECD2:
                ldx $0241                    ; ECD2= AE 41 02    .A.
                pla                          ; ECD5= 68          h
                sta $0241                    ; ECD6= 8D 41 02    .A.
LECD9:
                rts                          ; ECD9= 60          `

osbyte0D:                       ;ecda
                tya                          ; ECDA= 98          .
osbyte0E:                                    ;ecda
                cpx #$0A                     ; ECDB= E0 0A       `.
                bcs LEC90                    ; ECDD= B0 B1       01
                ldy $02BF,x                  ; ECDF= BC BF 02    <?.
                sta $02BF,x                  ; ECE2= 9D BF 02    .?.
                bra LEC8F                    ; ECE5= 80 A8       .(

osbyte10:                       ;ece7
                beq LECEC                    ; ECE7= F0 03       p.
                jsr osbyte11
LECEC:
                lda $024D                    ; ECEC= AD 4D 02    -M.
                stx $024D                    ; ECEF= 8E 4D 02    .M.
                tax                          ; ECF2= AA          *
                rts                          ; ECF3= 60          `

osbyte81:                       ;ecf4
                tya                          ; ECF4= 98          .
                bmi LED01                    ; ECF5= 30 0A       0.
                jsr LE7B1                    ; ECF7= 20 B1 E7     1g
                bcs LECFF                    ; ECFA= B0 03       0.
                tax                          ; ECFC= AA          *
LECFD:
                lda #$00                     ; ECFD= A9 00       ).
LECFF:
                tay                          ; ECFF= A8          (
                rts                          ; ED00= 60          `

LED01:
                txa                          ; ED01= 8A          .
                beq LED14                    ; ED02= F0 10       p.
                eor #$7F                     ; ED04= 49 7F       I.
                tax                          ; ED06= AA          *
                jsr callKEYV
                rol a                        ; ED0A= 2A          *
osbyte82:                                    ;ed0b
                ldx #$FF                     ; ED0B= A2 FF       ".
                ldy #$FF                     ; ED0D= A0 FF        .
                bcs LED13                    ; ED0F= B0 02       0.
                inx                          ; ED11= E8          h
                iny                          ; ED12= C8          H
LED13:
                rts                          ; ED13= 60          `

LED14:
                ldx #$FD                     ; ED14= A2 FD       "}
                bra LECFD                    ; ED16= 80 E5       .e

LED18:
                txa                          ; ED18= 8A          .
                eor #$FF                     ; ED19= 49 FF       I.
                tax                          ; ED1B= AA          *
                cpx #$02                     ; ED1C= E0 02       `.
LED1E:
                clv                          ; ED1E= B8          8
                bra LED24                    ; ED1F= 80 03       ..

LED21:
                bit LE34E                    ; ED21= 2C 4E E3    ,Nc
LED24:
                jmp (CNPV)                  ; ED24= 6C 2E 02    l..

LED27:
                sec                          ; ED27= 38          8
                ldx #$01                     ; ED28= A2 01       ".
                jsr LED1E                    ; ED2A= 20 1E ED     .m
                cpy #$01                     ; ED2D= C0 01       @.
                bcs LED34                    ; ED2F= B0 03       0.
                cpx $025B                    ; ED31= EC 5B 02    l[.
LED34:
                rts                          ; ED34= 60          `

osbyte80:                       ;ed35
                bmi LED18                    ; ED35= 30 E1       0a
                beq LED45                    ; ED37= F0 0C       p.
                cpx #$05                     ; ED39= E0 05       `.
                bcs osbyte82                    ; ED3B= B0 CE       0N
                ldy $02B9,x                  ; ED3D= BC B9 02    <9.
                lda $02B5,x                  ; ED40= BD B5 02    =5.
                tax                          ; ED43= AA          *
                rts                          ; ED44= 60          `

LED45:
                lda systemVIA.irb            ; ED45= AD 40 FE    -@~
                ror a                        ; ED48= 6A          j
                ror a                        ; ED49= 6A          j
                ror a                        ; ED4A= 6A          j
                ror a                        ; ED4B= 6A          j
                eor #$FF                     ; ED4C= 49 FF       I.
                and #$03                     ; ED4E= 29 03       ).
                ldy $02BE                    ; ED50= AC BE 02    ,>.
                stx $02BE                    ; ED53= 8E BE 02    .>.
                tax                          ; ED56= AA          *
                rts                          ; ED57= 60          `

;-------------------------------------------------------------------------
;
; OSBYTE $70
;
; D.2-31
;
osbyte70:                       ;ed58
                jsr LED70                    ; ED58= 20 70 ED     pm
                asl a                        ; ED5B= 0A          .
                beq clearACCCCONE
LED5E:
                tsb ACCCON                    ; ED5E= 0C 34 FE    .4~
                rts                          ; ED61= 60          `

clearACCCCONE:
                lda #ACCCON.E
LED64:
                trb ACCCON                    ; ED64= 1C 34 FE    .4~
                rts                          ; ED67= 60          `

osbyte71:                       ;ed68
                jsr LED70                    ; ED68= 20 70 ED     pm
                bne LED5E                    ; ED6B= D0 F1       Pq
                inc a                        ; ED6D= 1A          .
                bra LED64                    ; ED6E= 80 F4       .t

LED70:
                tay                          ; ED70= A8          (
                txa                          ; ED71= 8A          .
                sta $021A,y                  ; ED72= 99 1A 02    ...
                bne LED80                    ; ED75= D0 09       P.
                lda STATE                      ; ED77= A5 D0       %P
                and #STATE.isShadowMode
                beq LED83       ;
LED7D:
                lda #$01                     ; ED7D= A9 01       ).
                rts                          ; ED7F= 60          `

LED80:
                dec a                        ; ED80= 3A          :
                bne LED7D                    ; ED81= D0 FA       Pz
LED83:
                rts                          ; ED83= 60          `

; OSBYTE &6E (110), &6F (111)
; ===========================
; Pass to sideways ROMs
osbyteUnused:                   ;ed84
                ldx #$07                     ; ED86= 20 72 EE     rn
                jsr makeROMServiceCall
                ldx $F0                      ; ED89= A6 F0       &p
                eor #$00                     ; ED8B= 49 00       I.
                rts                          ; ED8D= 60          `

osbyteA1:
                jsr LF384                    ; ED8E= 20 84 F3     .s
                jmp L98B2                    ; ED91= 4C B2 98    L2.

osbyteA2:
                jsr LF384                    ; ED94= 20 84 F3     .s
                jmp L98DC                    ; ED97= 4C DC 98    L\.

; OSBYTE &8C (140) - Select TAPE
; ==============================
osbyte8C8D:; LED9A:
                jsr LEDC0
                lda ACCCON                    ; Save ACCON register
                pha
                jsr selectHAZEL         ; Page Hazel workspace in
                ldx hazel.activeFS
                stx hazel.currentFS
                lda #$0F                     ; Set FS ROM = 15
                sta hazel.currentFSROM
                pla                          ; Restore ACCON
selectMOSOrHAZEL:                                       ;edb0
                and #ACCCON.Y   ;get just the HAZEL/MOS bit
                bne tsbACCCON   ;branch taken if HAZEL at $c000
                lda #ACCCON.Y
                trb ACCCON      ;page in MOS at $c000
                rts

selectHAZEL:
                lda #ACCCON.Y
tsbACCCON:
                tsb ACCCON      ;page in HAZEL at $c000
                rts

; Select ROM or TAPE
; ==================
LEDC0:
                eor #$8C
LEDC2:
                asl a                        ; Set CFS/RFS swicth to 0=CFS or 2=RFS
                sta $0247
                bne LEDCC                    ; Skip past if not RFS
                lda #$04                     ; CFS, clear b2 of status
                trb $E2
LEDCC:
                cpx #$03                     ; EQ=TAPE 300, NE=TAPE 1200
                bra LEDD6

LEDD0:
                jsr LEE64                    ; EDD0= 20 64 EE     dn
                jsr LF1EE                    ; EDD3= 20 EE F1     nq
LEDD6:
                php                          ; Save baud flag in Carry
                lda #$06                     ; Vectors about to change
                jsr callFSCV
                lda $0247                    ; Jump if RFS selected
                bne LEDEE
                ldx #$06                     ; Prepare baud=6 for TAPE300
                plp                          ; Skip past if TAPE300
                beq LEDEB
                lda #$04                     ; TAPE1200, set bit 2 of status
                tsb $E2
                dex                          ; Change to baud=5 for TAPE1200
LEDEB:
                stx $C6                      ; Store baud rate setting
                php
LEDEE:
                stz $CE                      ; Clear byte (unused on BBC)
                plp
                ldx #defaultVectorTable.fsVectors.end-defaultVectorTable.fsVectors ; Prepare to set 7 vectors
LEDF3:
                lda defaultVectorTable.fsVectors-1,x ; Set filing
                                                     ; system vectors
                                                     ; to point to
                                                     ; extended
                                                     ; vectors
                sta FILEV-1,x
                dex
                bne LEDF3
                jsr LF1EE                    ; Set extended vectors
                stz $C2                      ; Set Progress=idle
                ldx #$0F                     ; Send service call &0F - vectors changed

; Send a sideways ROM service call and check for filing system change
; ===================================================================
osbyte8F: .proc                    ;ee03
                phy
                phx                          ; Send service call
                jsr makeROMServiceCall
                plx
                cpx #romServiceCallVectorsClaimed ; If VectorsClaimed,
                                                  ; hook FileSwitch
                                                  ; back in
                beq handleVectorsClaimed
                inc a       ; If claimed, check for
                            ; InitialiseFilingSystem or
                            ; UnrecognisedCommand
                dec a       ;Z=1 if claimed
                beq wasClaimed  ;branch taken if claimed
done:
                plx             ; Return with result in X, EQ=Claimed
                tax
                rts

wasClaimed:
                cpx #romServiceCallInitialiseFilingSystem
                beq +
                cpx #romServiceCallUnrecognisedCommand
                bne done                    ; EE1A= D0 F5       Pu
+

; handle InitialiseFilingSystem ($12) or UnrecognisedCommand ($04)
                
                ply                     ;Y=service call arg
                pha                     ;save A (though actually it's
                                        ;always $00...)
                lda ACCCON
                pha                     ;save ACCCON
                jsr selectHAZEL
                sec
                ror hazel.currentFS ;set currentFS bit 7
LEE29:
                phy             ;save ROM service call argument
                lda #$00                     
                tay                          
                jsr callARGSV   ;A=0, Y=0 - get active FS number
                sta hazel.activeFS ;save active FS number
                bit hazel.currentFS
                bpl LEE3B
                jsr osbyte6D
LEE3B:
                ply                          ; EE3B= 7A          z
                pla                          ; EE3C= 68          h
                jsr selectMOSOrHAZEL
                pla                          ; EE40= 68          h
                tax                          ; EE41= AA          *
                rts                          ; EE42= 60          `

handleVectorsClaimed:
                ply                          ; EE43= 7A          z
                pha                          ; EE44= 48          H
                lda ACCCON                    ; EE45= AD 34 FE    -4~
                pha                          ; EE48= 48          H
                jsr selectHAZEL                    ; EE49= 20 BA ED     :m
                lda FSCV+0
                sta hazel.activeFSCV+0
                lda FSCV+1
                sta hazel.activeFSCV+1
                lda #<fscEntryPoint
                sta FSCV+0
                lda #>fscEntryPoint          
                sta FSCV+1
                bra LEE29                    ; EE62= 80 C5       .E
                .pend

LEE64:
                lda #$A1                     ; EE64= A9 A1       )!
                sta $E3                      ; EE66= 85 E3       .c
                lda #$19                     ; EE68= A9 19       ).
                sta $03D1                    ; EE6A= 8D D1 03    .Q.
                lda #$04                     ; EE6D= A9 04       ).
                tsb $E2                      ; EE6F= 04 E2       .b
                rts                          ; EE71= 60          `
                
;-------------------------------------------------------------------------
; 
; Pass service call around sideways ROMs
;
; Entry:
; X=service call number
; Y=any parameters
;
; Exit:
; X=0 or preserved
; Y=any returned parameters
; EQ=call claimed if called directly
;
makeROMServiceCall: .proc                    ;ee72
                lda $F4         ; Save current ROM
                pha
                lda ACCCON      ; Save current paging state
                pha
                jsr selectHAZEL ; Page in Hazel
                txa             ; Pass service call number to A
                ldx #$0F     ; Start at ROM 15, and always call ROM 15
                bra callServiceEntry
callServiceEntriesLoop:
                bit $02A1,x     ;check if ROM X has a service entry
                bpl nextROM       ;branch taken if no service entry
callServiceEntry:
                jsr selectROMX  ; Page in ROM X
                jsr $8003       ; Call ROM service entry point
                tax             ; X = service call result
                beq done       ;branch taken if service call claimed
                ldx $F4         ; Get ROM number
nextROM:
                dex       ; Step down to next ROM, loop until all done
                bpl callServiceEntriesLoop

done:
                pla                          ; Restore paging state
                jsr selectMOSOrHAZEL
                pla                          ; Restore current ROM
                jsr selectROMA
                txa                          ; Pass claim/noclaim to A
                rts
                .pend

; OSBYTE &6B (107) - Select memory for direct access
; ==============================================
osbyte6B:                       ;ee9e
                ldy #$20                     ; Y=&20 to change 1MHz bit
                bra LEEA4

; OSBYTE &6C (108) - Select memory for direct access
; ==============================================
osbyte6C:
                ldy #$04                     ; Y=&04 to change RAM bit
LEEA4:
                tya                          ; Clear RAM or 1MHz bit
                trb ACCCON
                txa                          ; If X=0, exit with normal RAM/1MHz selected
                beq LEEB0
                lda #$04                     ; BUG! This should be TYA
                tsb ACCCON                    ; Page in shadow RAM
LEEB0:
                rts                          ; X preserved, Y=&04 or &20


; OSBYTE
; ======
osbyteEntryPoint:
                pha                          ; EEB1= 48          H
                php                          ; EEB2= 08          .
                sei                          ; EEB3= 78          x
                sta $EF                      ; EEB4= 85 EF       .o
                stx $F0                      ; EEB6= 86 F0       .p
                sty $F1                      ; EEB8= 84 F1       .q
                ldx #romServiceCallUnrecognisedOSBYTE
                cmp #$6B                     
                bcc osbyte00To6A
                cmp #$A6
                bcc osbyte6BToA5
                cmp #$A6
                bcc LEF0C       ;??? - wait... didn't we just do this?

osbyteA6ToFF:
                clc
osbyteOrUSERV:      ;call OSBYTE A6+ routine if C=0; call USERV if C=1
                lda #$A6
                adc #$00
osbyte6BToA5:
                sbc #$50        ;map $6b-$a5 to $1b-$56
osbyteUseTable:
                asl a           ;table is of words
                sec
callOSBYTEOrOSWORDFromTable:
                sty $F1         ;save Y (possibly again?)
                tay             ;get table offset in Y
                bit $025E                    ; EED4= 2C 5E 02    ,^.
                bpl LEEE0                    ; EED7= 10 07       ..
                txa                          ; EED9= 8A          .
                clv                          ; EEDA= B8          8
                jsr LEB04                    ; EEDB= 20 04 EB     .k
                bvs LEEFA                    ; EEDE= 70 1A       p.
LEEE0:
                lda osbyteAndOSWORDRoutineTable+1,y
                sta $FB
                lda osbyteAndOSWORDRoutineTable,y
                sta $FA                      ; EEE8= 85 FA       .z
                lda $EF                      ; EEEA= A5 EF       %o
                ldy $F1                      ; EEEC= A4 F1       $q
                bcs LEEF4                    ; EEEE= B0 04       0.
                ldy #$00                     ; EEF0= A0 00        .
                lda ($F0)                    ; EEF2= B2 F0       2p
LEEF4:
                sec                          ; EEF4= 38          8
                ldx $F0                      ; EEF5= A6 F0       &p

; on entry to the OSBYTE handlers, C=1, N/Z set as per X.
                
                jsr call00FA                    ; EEF7= 20 DF F8     _x
LEEFA:
                ror a                        ; EEFA= 6A          j
                plp                          ; EEFB= 28          (
                rol a                        ; EEFC= 2A          *
                pla                          ; EEFD= 68          h
                clv                          ; EEFE= B8          8
                rts                          ; EEFF= 60          `

osbyte00To6A:
                ldy #$00        ;Y=0 on entry for this lot
                cmp #$1A        ;OSBYTE <=$19 is table-driven
                bcc osbyteUseTable ;taken if OSBYTE $00-$19
                bra LEF0C       

LEF08:
                ldx #romServiceCallUnrecognisedOSWORD
                pla                          ; EF0A= 68          h
                pla                          ; EF0B= 68          h
LEF0C:
                jsr makeROMServiceCall
                bne LEF15                    ; EF0F= D0 04       P.
                ldx $F0                      ; EF11= A6 F0       &p
                bra LEEFA                    ; EF13= 80 E5       .e

LEF15:
                plp                          ; EF15= 28          (
                pla                          ; EF16= 68          h
                bit LE34E                    ; EF17= 2C 4E E3    ,Nc
                rts                          ; EF1A= 60          `

LEF1B:
                lda $EB                      ; EF1B= A5 EB       %k
                bmi LEF60                    ; EF1D= 30 41       0A
                lda $0257                    ; EF1F= AD 57 02    -W.
                bne LEF60                    ; EF22= D0 3C       P<
                lda #$08                     ; EF24= A9 08       ).
                and $E2                      ; EF26= 25 E2       %b
                bne LEF2E                    ; EF28= D0 04       P.
                lda #$88                     ; EF2A= A9 88       ).
                and $BB                      ; EF2C= 25 BB       %;
LEF2E:
                rts                          ; EF2E= 60          `
                
osword0E:                       ;ef2f
                cmp #$03                     ; EF2F= C9 03       I.
                bcs LEF08                    ; EF31= B0 D5       0U
                jsr LF384                    ; EF33= 20 84 F3     .s
                jmp L97B4                    ; EF36= 4C B4 97    L4.

;-------------------------------------------------------------------------
;
; Entry point for OSWORD.
;
; D.3-3
; 
oswordEntryPoint:
                pha             ;save OSWORD request
                php
                sei
                sta $EF                      ; EF3C= 85 EF       .o
                stx $F0                      ; EF3E= 86 F0       .p
                sty $F1                      ; EF40= 84 F1       .q
                ldx #romServiceCallUnrecognisedOSWORD
                cmp #$E0
                bcs osbyteOrUSERV ;taken if OSWORD $E0 or higher -
                                  ;these go via USERV
                cmp #$10
                bcs LEF0C       ;taken if unknown OSWORD

; adjust request number so it's a suitable index into the
; OSBYTE/OSWORD routine table.
                
                adc #(oswordRoutineTable-osbyteAndOSWORDRoutineTable)/2
                asl a
                bra callOSBYTEOrOSWORDFromTable

osword05:                       ;ef51
                jsr LEF63                    ; EF51= 20 63 EF     co
                lda ($FA)                    ; EF54= B2 FA       2z
                sta ($F0),y                  ; EF56= 91 F0       .p
                rts                          ; EF58= 60          `

osword06:                       ;ef59
                jsr LEF63                    ; EF59= 20 63 EF     co
                lda ($F0),y                  ; EF5C= B1 F0       1p
                sta ($FA)                    ; EF5E= 92 FA       .z
LEF60:
                lda #$00                     ; EF60= A9 00       ).
                rts                          ; EF62= 60          `

LEF63:
                sta $FA                      ; EF63= 85 FA       .z
                iny                          ; EF65= C8          H
                lda ($F0),y                  ; EF66= B1 F0       1p
                sta $FB                      ; EF68= 85 FB       .{
                ldy #$04                     ; EF6A= A0 04        .
ldx03ThenRTS:
                ldx #$03                     ; EF6C= A2 03       ".
                rts                          ; EF6E= 60          `
                
;-------------------------------------------------------------------------
; 
; OSBYTE 0 (&00) Display MOS version
;
; OSBYTE 0 has the effect of performing a BRK instruction and
; displaying the MOS version number.
;
; Entry parameters :
;
; X=0 executes a BRK and displays the OS version
;
; X=1 executes an RTS and returns the Operating system version
;
; On exit : X=<OS version>
;
; D.2-18
;
osbyte00:                       ;ef6f
                bne ldx03ThenRTS ;branch taken if X<>0 - return with
                                 ;X=3

; do a BRK and print MOS version number.
                
                brk                          
                .text $f7,"OS 3.20",0

osword07:
                iny                          ; EF7B= C8          H
                lda ($F0),y                  ; EF7C= B1 F0       1p
                cmp #$20                     ; EF7E= C9 20       I
                bcs LEF08                    ; EF80= B0 86       0.
                dey                          ; EF82= 88          .
                jsr LEFF6                    ; EF83= 20 F6 EF     vo
                ora #$04                     ; EF86= 09 04       ..
                tax                          ; EF88= AA          *
                bcc LEF90                    ; EF89= 90 05       ..
                jsr LE95A                    ; EF8B= 20 5A E9     Zi
                ldy #$01                     ; EF8E= A0 01        .
LEF90:
                jsr LEFF6                    ; EF90= 20 F6 EF     vo
                sta $FA                      ; EF93= 85 FA       .z
                php                          ; EF95= 08          .
                ldy #$06                     ; EF96= A0 06        .
                lda ($F0),y                  ; EF98= B1 F0       1p
                pha                          ; EF9A= 48          H
                ldy #$04                     ; EF9B= A0 04        .
                lda ($F0),y                  ; EF9D= B1 F0       1p
                pha                          ; EF9F= 48          H
                ldy #$02                     ; EFA0= A0 02        .
                lda ($F0),y                  ; EFA2= B1 F0       1p
                rol a                        ; EFA4= 2A          *
                dec a                        ; EFA5= 3A          :
                dec a                        ; EFA6= 3A          :
                asl a                        ; EFA7= 0A          .
                asl a                        ; EFA8= 0A          .
                ora $FA                      ; EFA9= 05 FA       .z
                jsr LE9A3                    ; EFAB= 20 A3 E9     #i
                bcc LEFCE                    ; EFAE= 90 1E       ..
                pla                          ; EFB0= 68          h
                pla                          ; EFB1= 68          h
                plp                          ; EFB2= 28          (
osbyte75:
                ldx STATE                      ; EFB3= A6 D0       &P
                rts                          ; EFB5= 60          `

LEFB6:
                php                          ; EFB6= 08          .
                sei                          ; EFB7= 78          x
                lda $0263                    ; EFB8= AD 63 02    -c.
                and #$07                     ; EFBB= 29 07       ).
                ora #$04                     ; EFBD= 09 04       ..
                tax                          ; EFBF= AA          *
                lda $0264                    ; EFC0= AD 64 02    -d.
                jsr LEA40                    ; EFC3= 20 40 EA     @j
                lda $0266                    ; EFC6= AD 66 02    -f.
                pha                          ; EFC9= 48          H
                lda $0265                    ; EFCA= AD 65 02    -e.
                pha                          ; EFCD= 48          H
LEFCE:
                sec                          ; EFCE= 38          8
                ror $0800,x                  ; EFCF= 7E 00 08    ~..
                pla                          ; EFD2= 68          h
                jsr LEA40                    ; EFD3= 20 40 EA     @j
                pla                          ; EFD6= 68          h
                jsr LEA40                    ; EFD7= 20 40 EA     @j
                plp                          ; EFDA= 28          (
                rts                          ; EFDB= 60          `

osword08:                       ;efdc
                dec a                        ; EFDC= 3A          :
                asl a                        ; EFDD= 0A          .
                asl a                        ; EFDE= 0A          .
                asl a                        ; EFDF= 0A          .
                asl a                        ; EFE0= 0A          .
                ora #$0F                     ; EFE1= 09 0F       ..
                tax                          ; EFE3= AA          *
                lda #$00                     ; EFE4= A9 00       ).
                ldy #$10                     ; EFE6= A0 10        .
LEFE8:
                cpy #$0E                     ; EFE8= C0 0E       @.
                bcs LEFEE                    ; EFEA= B0 02       0.
                lda ($F0),y                  ; EFEC= B1 F0       1p
LEFEE:
                sta $08C0,x                  ; EFEE= 9D C0 08    .@.
                dex                          ; EFF1= CA          J
                dey                          ; EFF2= 88          .
                bne LEFE8                    ; EFF3= D0 F3       Ps
                rts                          ; EFF5= 60          `

LEFF6:
                lda ($F0),y                  ; EFF6= B1 F0       1p
                cmp #$10                     ; EFF8= C9 10       I.
                and #$03                     ; EFFA= 29 03       ).
                iny                          ; EFFC= C8          H
                rts                          ; EFFD= 60          `

osword03:                       ;effe
                ldx #$0F                     ; EFFE= A2 0F       ".
                bra LF005                    ; F000= 80 03       ..

osword01:                       ;f002
                ldx $0283                    ; F002= AE 83 02    ...
LF005:
                ldy #$04                     ; F005= A0 04        .
LF007:
                lda $028D,x                  ; F007= BD 8D 02    =..
                sta ($F0),y                  ; F00A= 91 F0       .p
                inx                          ; F00C= E8          h
                dey                          ; F00D= 88          .
                bpl LF007                    ; F00E= 10 F7       .w
LF010:
                rts                          ; F010= 60          `

osword04:                       ;f011
                lda #$0F                     ; F011= A9 0F       ).
                bra LF01B                    ; F013= 80 06       ..

osword02:                       ;f015
                lda $0283                    ; F015= AD 83 02    -..
                eor #$0F                     ; F018= 49 0F       I.
                clc                          ; F01A= 18          .
LF01B:
                pha                          ; F01B= 48          H
                tax                          ; F01C= AA          *
                ldy #$04                     ; F01D= A0 04        .
LF01F:
                lda ($F0),y                  ; F01F= B1 F0       1p
                sta $028D,x                  ; F021= 9D 8D 02    ...
                inx                          ; F024= E8          h
                dey                          ; F025= 88          .
                bpl LF01F                    ; F026= 10 F7       .w
                pla                          ; F028= 68          h
                bcs LF010                    ; F029= B0 E5       0e
                sta $0283                    ; F02B= 8D 83 02    ...
                rts                          ; F02E= 60          `

; OSWORD &00 - Read Line
; ======================
osword00: ;LF02F:
                ldy #$04                     ; F02F= A0 04        .
LF031:
                lda ($F0),y                  ; F031= B1 F0       1p
                sta $02B1,y                  ; F033= 99 B1 02    .1.
                dey                          ; F036= 88          .
                cpy #$02                     ; F037= C0 02       @.
                bcs LF031                    ; F039= B0 F6       0v
                lda ($F0),y                  ; F03B= B1 F0       1p
                sta $E9                      ; F03D= 85 E9       .i
                dey                          ; F03F= 88          .
                stz $0269                    ; F040= 9C 69 02    .i.
                lda ($F0)                    ; F043= B2 F0       2p
                sta $E8                      ; F045= 85 E8       .h
                cli                          ; F047= 58          X
                bra LF051                    ; F048= 80 07       ..

LF04A:
                lda #$07                     ; F04A= A9 07       ).
LF04C:
                dey                          ; F04C= 88          .
LF04D:
                iny                          ; F04D= C8          H
LF04E:
                jsr OSWRCH                   ; F04E= 20 EE FF     n.
LF051:
                jsr OSRDCH                   ; F051= 20 E0 FF     `.
                bcs LF09F                    ; F054= B0 49       0I
                tax                          ; F056= AA          *
                lda $027C                    ; F057= AD 7C 02    -|.
                ror a                        ; F05A= 6A          j
                ror a                        ; F05B= 6A          j
                txa                          ; F05C= 8A          .
                bcs LF064                    ; F05D= B0 05       0.
                ldx $026A                    ; F05F= AE 6A 02    .j.
                bne LF04E                    ; F062= D0 EA       Pj
LF064:
                cmp #$7F                     ; F064= C9 7F       I.
                bne LF06F                    ; F066= D0 07       P.
                cpy #$00                     ; F068= C0 00       @.
                beq LF051                    ; F06A= F0 E5       pe
                dey                          ; F06C= 88          .
                bra LF04E                    ; F06D= 80 DF       ._

LF06F:
                cmp #$15                     ; F06F= C9 15       I.
                bne LF080                    ; F071= D0 0D       P.
                tya                          ; F073= 98          .
                beq LF051                    ; F074= F0 DB       p[
                lda #$7F                     ; F076= A9 7F       ).
LF078:
                jsr OSWRCH                   ; F078= 20 EE FF     n.
                dey                          ; F07B= 88          .
                bne LF078                    ; F07C= D0 FA       Pz
                bra LF051                    ; F07E= 80 D1       .Q

LF080:
                sta ($E8),y                  ; F080= 91 E8       .h
                cmp #$0D                     ; F082= C9 0D       I.
                beq LF099                    ; F084= F0 13       p.
                cpy $02B3                    ; F086= CC B3 02    L3.
                bcs LF04A                    ; F089= B0 BF       0?
                cmp $02B4                    ; F08B= CD B4 02    M4.
                bcc LF04C                    ; F08E= 90 BC       .<
                cmp $02B5                    ; F090= CD B5 02    M5.
                beq LF04D                    ; F093= F0 B8       p8
                bcc LF04D                    ; F095= 90 B6       .6
                bra LF04C                    ; F097= 80 B3       .3

LF099:
                jsr OSNEWL                   ; F099= 20 E7 FF     g.
                jsr LEB04                    ; F09C= 20 04 EB     .k
LF09F:
                lda $FF                      ; F09F= A5 FF       %.
                rol a                        ; F0A1= 2A          *
                rts                          ; F0A2= 60          `

osbyte03:
                phx                          ; F0A3= DA          Z
                ldx $027C                    ; F0A4= AE 7C 02    .|.
                lda #$0A                     ; F0A7= A9 0A       ).
                jsr LE93C                    ; F0A9= 20 3C E9     <i
                plx                          ; F0AC= FA          z
                lda #$03                     ; F0AD= A9 03       ).
                ldy #$00                     ; F0AF= A0 00        .
                bra osbyte04                 ; F0B1= 80 23       .#

osbyte06:                       ;f0b3
                lsr $0246                    ; F0B3= 4E 46 02    NF.
                bra osbyte01                    ; F0B6= 80 16       ..

osbyte72:                       ;f0b8
                lda #$1F                     ; F0B8= A9 1F       ).
                bra LF0CC                    ; F0BA= 80 10       ..

osbyte05:                       ;f0bc
                cli                          ; F0BC= 58          X
                sei                          ; F0BD= 78          x
                bit $FF                      ; F0BE= 24 FF       $.
                bmi LF0EB                    ; F0C0= 30 29       0)
                bit $02D1                    ; F0C2= 2C D1 02    ,Q.
                bpl osbyte05
                jsr LE93C                    ; F0C7= 20 3C E9     <i
                ldy #$00                     ; F0CA= A0 00        .
LF0CC:
                stz $F1                      ; F0CC= 64 F1       dq

;-------------------------------------------------------------------------
;
; OSBYTE 1 (&01) Write user flag
;
; This call provides a means of writing data to the user flag
; (location &281). The flag is zero by default
;
; Entry parameters:
;
; X=<new value>
; Y=0
;
; On exit : X=<old value>
;
; Note: This call uses OSBYTE 241/&F1 and is left free for user
; applications.
;
; D.2-18
                
osbyte01:                       ;f0ce
                eor #$F0        ;set A=$F1
                bra LF0D9       ;jump to standard MOS variable
                                ;handling

osbyte0C:
                beq LF107                    ; F0D2= F0 33       p3
osbyte0B:                                    ;f0d4
                adc #$CF                     ; F0D4= 69 CF       iO
osbyte04:                                    ;f0d6
                clc                          ; F0D6= 18          .
                adc #$E9                     ; F0D7= 69 E9       ii
LF0D9:
                stx $F0                      ; F0D9= 86 F0       .p
osbyteA6:
                tay             ;
                lda $0190,y     ;get MOS variable value
                tax             ;save old value
                and $F1         ;AND old value with Y
                eor $F0         ;EOR old value with X
                sta $0190,y     ;set new variable value
                lda $0191,y
                tay             ;Y=contents of next location
LF0EB:
                rts                          ; F0EB= 60          `

;-------------------------------------------------------------------------
;
; This table is used to set the serial baud rate.
;
;   - bit 7 is not used (always clear)
;   - bit 6 is not used (always set)
;   - bits 3,4,5 indicate the serial receive baud rate
;   - bits 0,1,2 indicate the serial transmit baud rate
;
;       111 =    75 baud
;       011 =   150 baud
;       101 =   300 baud
;       001 =  1200 baud
;       110 =  2400 baud
;       010 =  4800 baud
;       100 =  9600 baud
;       000 = 19200 baud
;
; ***************************************************************************************
                
serialBaudRatesTable:
                .byte %01100100;$64
                .byte %01111111;$7f
                .byte %01011011;$5b
                .byte %01101101;$6d
                .byte %01001001;$49
                .byte %01110110;$76
                .byte %01010010;$52
                .byte %01100100;$64
                .byte %01000000;$40

osbyte13:                       ;f0f5
                lda $0240                    ; F0F5= AD 40 02    -@.
LF0F8:
                cli                          ; F0F8= 58          X
                sei                          ; F0F9= 78          x
                cmp $0240                    ; F0FA= CD 40 02    M@.
                beq LF0F8                    ; F0FD= F0 F9       py
osbyteA0:
                ldy $0301,x                  ; F0FF= BC 01 03    <..
                lda $0300,x                  ; F102= BD 00 03    =..
                tax                          ; F105= AA          *
                rts                          ; F106= 60          `

LF107:
                jsr LF384                    ; F107= 20 84 F3     .s
                jsr L8B3A                    ; F10A= 20 3A 8B     :.
                sty $0254                    ; F10D= 8C 54 02    .T.
                jsr L8B3F                    ; F110= 20 3F 8B     ?.
                ldx $0255                    ; F113= AE 55 02    .U.
                sty $0255                    ; F116= 8C 55 02    .U.
                rts                          ; F119= 60          `

osbyte12:                                    ;f11a
                sec                          ; F11A= 38          8
                ror $0284                    ; F11B= 6E 84 02    n..
                lda $F4                      ; F11E= A5 F4       %t
                pha                          ; F120= 48          H
                jsr selectTerminalROMAndANDY                    ; F121= 20 7F E5     .e
                ldx #$10                     ; F124= A2 10       ".
LF126:
                lda #$22                     ; F126= A9 22       )"
                sta L8000,x                  ; F128= 9D 00 80    ...
                lda #$80                     ; F12B= A9 80       ).
                sta L8011,x                  ; F12D= 9D 11 80    ...
                dex                          ; F130= CA          J
                bpl LF126                    ; F131= 10 F3       .s
                pla                          ; F133= 68          h
                jsr selectROMA                    ; F134= 20 92 E5     .e
                stz $0268                    ; F137= 9C 68 02    .h.
                stz $0284                    ; F13A= 9C 84 02    ...
                inx                          ; F13D= E8          h
                rts                          ; F13E= 60          `

osword0B:                       ;f13f
                and $0360                    ; F13F= 2D 60 03    -`.
                tax                          ; F142= AA          *
                lda $036F,x                  ; F143= BD 6F 03    =o.
LF146:
                iny                          ; F146= C8          H
LF147:
                sta ($F0),y                  ; F147= 91 F0       .p
                lda #$00                     ; F149= A9 00       ).
                cpy #$04                     ; F14B= C0 04       @.
                bne LF146                    ; F14D= D0 F7       Pw
                rts                          ; F14F= 60          `

osword09:                       ;f150
                jsr LF3AB                    ; F150= 20 AB F3     +s
                ldy #$03                     ; F153= A0 03        .
LF155:
                lda ($F0),y                  ; F155= B1 F0       1p
                sta $0328,y                  ; F157= 99 28 03    .(.
                lda $0310,y                  ; F15A= B9 10 03    9..
                pha                          ; F15D= 48          H
                dey                          ; F15E= 88          .
                bpl LF155                    ; F15F= 10 F4       .t
                lda #$28                     ; F161= A9 28       )(
                jsr LDDB7                    ; F163= 20 B7 DD     7]
                tax                          ; F166= AA          *
                ldy #$00                     ; F167= A0 00        .
LF169:
                pla                          ; F169= 68          h
                sta $0310,y                  ; F16A= 99 10 03    ...
                iny                          ; F16D= C8          H
                cpy #$04                     ; F16E= C0 04       @.
                bne LF169                    ; F170= D0 F7       Pw
                txa                          ; F172= 8A          .
                bra LF147                    ; F173= 80 D2       .R

osword0A:                                    ;f175
                jsr LE22C                    ; F175= 20 2C E2     ,b
                ldy #$00                     ; F178= A0 00        .
                lda $F4                      ; F17A= A5 F4       %t
                pha                          ; F17C= 48          H
                jsr selectTerminalROMAndANDY                    ; F17D= 20 7F E5     .e
LF180:
                lda ($DE),y                  ; F180= B1 DE       1^
                iny                          ; F182= C8          H
                sta ($F0),y                  ; F183= 91 F0       .p
                cpy #$08                     ; F185= C0 08       @.
                bne LF180                    ; F187= D0 F7       Pw
                plx                          ; F189= FA          z
                jmp selectROMX                    ; F18A= 4C 81 E5    L.e

osword0C:                       ;f18d
                jsr LF3AB                    ; F18D= 20 AB F3     +s
                php                          ; F190= 08          .
                and $0360                    ; F191= 2D 60 03    -`.
                tax                          ; F194= AA          *
                iny                          ; F195= C8          H
                lda ($F0),y                  ; F196= B1 F0       1p
                jmp LC639                    ; F198= 4C 39 C6    L9F

osword0D:                       ;f19b
                jsr LF3AB                    ; F19B= 20 AB F3     +s
                lda #$03                     ; F19E= A9 03       ).
                jsr LF1A5                    ; F1A0= 20 A5 F1     %q
                lda #$07                     ; F1A3= A9 07       ).
LF1A5:
                pha                          ; F1A5= 48          H
                jsr LE2B6                    ; F1A6= 20 B6 E2     6b
                jsr LC4DF                    ; F1A9= 20 DF C4     _D
                ldx #$03                     ; F1AC= A2 03       ".
                pla                          ; F1AE= 68          h
                tay                          ; F1AF= A8          (
LF1B0:
                lda $0310,x                  ; F1B0= BD 10 03    =..
                sta ($F0),y                  ; F1B3= 91 F0       .p
                dey                          ; F1B5= 88          .
                dex                          ; F1B6= CA          J
                bpl LF1B0                    ; F1B7= 10 F7       .w
                rts                          ; F1B9= 60          `

; Read address of bottom of screen/top of user memory
; ===================================================
osbyte84:                     ;f1ba
                lda STATE     ; Get VDU status
                bit #STATE.isShadowMode ; If shadow screen, jump to return &8000
                bne LF1D8
LF1C0:
                lda $0355                    ; Get current screen MODE

; Return start of screen for non-shadow MODE in X
; -----------------------------------------------
LF1C3:
                and #$07
                tay
                ldx LE168,y                  ; Get screen map for supplied MODE
                lda LE17E,x                  ; Get address top byte for this screen map
LF1CC:
                ldx #$00                     ; Address=&xx00
                tay
                rts

; Read address bottom of screen for MODE in X
; ===========================================
osbyte85: ;F1D0:
                txa                          ; If MODE &80+n, return &8000
                bmi LF1D8
                ldx $027F                    ; If *SHADOW<>0, jump to return non-shadow address
                bne LF1C3
LF1D8:
                lda #$80                     ; Return &8000
                bra LF1CC

osbyte87: ;F1DC:
                jsr LF3AB                    ; F1DC= 20 AB F3     +s
                jmp LDDF8                    ; F1DF= 4C F8 DD    Lx]

osbyte8B: ;LF1E2:
                asl a                        ; F1E2= 0A          .
osbyte7F:                                    ;f1e3
                and #$01                     ; F1E3= 29 01       ).
callFSCV:                                    ;f1e5
                jmp (FSCV)                  ; F1E5= 6C 1E 02    l..

; OSWORD &0F - Write to RTC
; =========================
osword0F:                       ;f1e8
                jsr LF384                    ; Page in ROM 15
                jmp L9656                    ; Jump to OSWORD &0F routine


; Set TAPE/ROM extended vectors
; =============================
LF1EE:
                ldx #$15
LF1F0:
                lda LF1FA-1,x
                sta extendedVectorSpace+filevIndex*3-1,x
                dex
                bne LF1F0
LF1F9:
                rts

; TAPE/ROM extended vector values
; -------------------------------
LF1FA:
                .word LA08C                  ; FILEV
                .byte 15
                .word L9F29                  ; ARGSV
                .byte 15
                .word LA2EA                  ; BPUTV
                .byte 15
                .word LA34B                  ; BGETV
                .byte 15
                .word LA36D                  ; GBPBV
                .byte 15
                .word LA1F9                  ; FINDV
                .byte 15
                .word L9F8C                  ; FSCV
                .byte 15

; OSBYTE &6x - Make temporary FS permanant
; ========================================
osbyte6D:;f20f
                ldx hazel.activeFS; Copy active FS to current FS
                stx hazel.currentFS
                lda extendedVectorSpace+filevIndex*3+2 ; Copy XFILEV ROM to current FS ROM number
                sta hazel.currentFSROM
                rts

osbyte14:                       ;f21c
                jsr LF384                    ; F21C= 20 84 F3     .s
                jmp L92A4                    ; F21F= 4C A4 92    L$.

osbyte19:                       ;f222
                jsr LF384                    ; F222= 20 84 F3     .s
                jmp L92A8                    ; F225= 4C A8 92    L(.

; OSBYTE &16 - Increment ROM polling semaphore
; ========================================
osbyte16:                       ;f228
                inc $0243                    ; F228= EE 43 02    nC.
                rts                          ; F22B= 60          `

; OSBYTE &17 - Decrement ROM polling semaphore
osbyte17:                       ;f22c
; ========================================
                dec $0243                    ; F22C= CE 43 02    NC.
                rts                          ; F22F= 60          `

; OSBYTE &76 - Set LEDs to keyboard state
; =======================================
osbyte76:
                php                          ; Disable IRQs
                sei
                lda #$40                     ; Turn on LEDs
                jsr LF241
                bmi LF23E                    ; Exit if Escape pending
                clc                          ; Call KEYV to read SHIFT and CTRL
                clv
                jsr callKEYV
; Returns A.b7=CTRL, A.b6=SHIFT, MI=CTRL, VS=SHIFT
LF23E:
                plp                          ; Restore IRQs
                rol a                        ; Set Carry from A bit 7 and return
                rts
; Returns A.b7=SHIFT, CS=CTRL

; Set keyboard LEDs
; -----------------
LF241:
                bcc LF24C                    ; Skip if not called from OSBYTE
                ldy #$07                     ; Turn ShiftLock LED on
                sty systemVIA.orb
                dey                          ; Turn CapsLock LED on
                sty systemVIA.orb
LF24C:
                bit $FF                      ; Test Escape and return
                rts

osbyte9A:
                txa                          ; F24F= 8A          .
LF250:
                php                          ; F250= 08          .
                sei                          ; F251= 78          x
                sta $0248                    ; F252= 8D 48 02    .H.
                sta VCONTROL                 ; F255= 8D 20 FE    . ~
                lda $0253                    ; F258= AD 53 02    -S.
                sta $0251                    ; F25B= 8D 51 02    .Q.
                plp                          ; F25E= 28          (
                rts                          ; F25F= 60          `

osbyte9B:
                txa                          ; F260= 8A          .
LF261:
                eor #$07                     ; F261= 49 07       I.
                php                          ; F263= 08          .
                sei                          ; F264= 78          x
                sta $0249                    ; F265= 8D 49 02    .I.
                sta VPALETTE                 ; F268= 8D 21 FE    .!~
                plp                          ; F26B= 28          (
                rts                          ; F26C= 60          `

LF26D:
                clc                          ; F26D= 18          .
gsinitEntryPoint:
                ror $E4                      ; F26E= 66 E4       fd
                jsr skipSpacesAndCheckForCRInStringInput                    ; F270= 20 FF F2     .r
                iny                          ; F273= C8          H
                cmp #$22                     ; F274= C9 22       I"
                beq LF27A                    ; F276= F0 02       p.
                dey                          ; F278= 88          .
                clc                          ; F279= 18          .
LF27A:
                ror $E4                      ; F27A= 66 E4       fd
                cmp #$0D                     ; F27C= C9 0D       I.
                rts                          ; F27E= 60          `

gsreadEntryPoint:
                lda #$01                     ; F27F= A9 01       ).
                tsb $E4                      ; F281= 04 E4       .d
                jsr LF29C                    ; F283= 20 9C F2     .r
                php                          ; F286= 08          .
                lsr $E4                      ; F287= 46 E4       Fd
                bcc badStringError                    ; F289= 90 04       ..
                rol $E4                      ; F28B= 26 E4       &d
                plp                          ; F28D= 28          (
                rts                          ; F28E= 60          `

badStringError:
                brk                          ; F28F= 00          .
                .text $fd,"Bad string",0
LF29C:
                clc                          ; F29C= 18          .
LF29D:
                stz $E5                      ; F29D= 64 E5       de
                ror $E5                      ; F29F= 66 E5       fe
                lda ($F2),y                  ; F2A1= B1 F2       1r
                cmp #$0D                     ; F2A3= C9 0D       I.
                bne LF2B0                    ; F2A5= D0 09       P.
                bit $E4                      ; F2A7= 24 E4       $d
                bpl LF2CB                    ; F2A9= 10 20       .
LF2AB:
                lda #$01                     ; F2AB= A9 01       ).
                trb $E4                      ; F2AD= 14 E4       .d
                rts                          ; F2AF= 60          `

LF2B0:
                cmp #$20                     ; F2B0= C9 20       I
                bcc LF2AB                    ; F2B2= 90 F7       .w
                bne LF2BC                    ; F2B4= D0 06       P.
                bit $E4                      ; F2B6= 24 E4       $d
                bmi LF2F8                    ; F2B8= 30 3E       0>
                bvc LF2CB                    ; F2BA= 50 0F       P.
LF2BC:
                cmp #$22                     ; F2BC= C9 22       I"
                bne LF2D0                    ; F2BE= D0 10       P.
                bit $E4                      ; F2C0= 24 E4       $d
                bpl LF2F8                    ; F2C2= 10 34       .4
                iny                          ; F2C4= C8          H
                lda ($F2),y                  ; F2C5= B1 F2       1r
                cmp #$22                     ; F2C7= C9 22       I"
                beq LF2F8                    ; F2C9= F0 2D       p-
LF2CB:
                jsr skipSpacesAndCheckForCRInStringInput                    ; F2CB= 20 FF F2     .r
                sec                          ; F2CE= 38          8
                rts                          ; F2CF= 60          `

LF2D0:
                cmp #$7C                     ; F2D0= C9 7C       I|
                bne LF2F8                    ; F2D2= D0 24       P$
                iny                          ; F2D4= C8          H
                lda ($F2),y                  ; F2D5= B1 F2       1r
                cmp #$7C                     ; F2D7= C9 7C       I|
                beq LF2F8                    ; F2D9= F0 1D       p.
                cmp #$22                     ; F2DB= C9 22       I"
                beq LF2F8                    ; F2DD= F0 19       p.
                cmp #$21                     ; F2DF= C9 21       I!
                bne LF2E6                    ; F2E1= D0 03       P.
                iny                          ; F2E3= C8          H
                bra LF29D                    ; F2E4= 80 B7       .7

LF2E6:
                cmp #$20                     ; F2E6= C9 20       I
                bcc LF2AB                    ; F2E8= 90 C1       .A
                cmp #$3F                     ; F2EA= C9 3F       I?
                beq LF2F6                    ; F2EC= F0 08       p.
                jsr LF336                    ; F2EE= 20 36 F3     6s
                bit LE34E                    ; F2F1= 2C 4E E3    ,Nc
                bra LF2F9                    ; F2F4= 80 03       ..

LF2F6:
                lda #$7F                     ; F2F6= A9 7F       ).
LF2F8:
                clv                          ; F2F8= B8          8
LF2F9:
                iny                          ; F2F9= C8          H
                ora $E5                      ; F2FA= 05 E5       .e
                clc                          ; F2FC= 18          .
                rts                          ; F2FD= 60          `

incAndSkipSpaces:
                iny                          ; F2FE= C8          H
skipSpacesAndCheckForCRInStringInput:
                lda (stringInputBufferAddress),y                  ; F2FF= B1 F2       1r
                cmp #' '                     ; F301= C9 20       I
                beq incAndSkipSpaces                    ; F303= F0 F9       py
LF305:
                cmp #13                     ; F305= C9 0D       I.
                rts                          ; F307= 60          `

LF308:
                bcc skipSpacesAndCheckForCRInStringInput                    ; F308= 90 F5       .u
LF30A:
                jsr skipSpacesAndCheckForCRInStringInput                    ; F30A= 20 FF F2     .r
                cmp #$2C                     ; F30D= C9 2C       I,
                bne LF305                    ; F30F= D0 F4       Pt
                iny                          ; F311= C8          H
                rts                          ; F312= 60          `

LF313:
                cmp #$30                     ; F313= C9 30       I0
                beq LF335                    ; F315= F0 1E       p.
                cmp #$40                     ; F317= C9 40       I@
                beq LF335                    ; F319= F0 1A       p.
                bcc LF32F                    ; F31B= 90 12       ..
                cmp #$7F                     ; F31D= C9 7F       I.
                beq LF335                    ; F31F= F0 14       p.
                bcs LF333                    ; F321= B0 10       0.
LF323:
                eor #$30                     ; F323= 49 30       I0
                cmp #$6F                     ; F325= C9 6F       Io
                beq LF32D                    ; F327= F0 04       p.
                cmp #$50                     ; F329= C9 50       IP
                bne LF32F                    ; F32B= D0 02       P.
LF32D:
                eor #$1F                     ; F32D= 49 1F       I.
LF32F:
                cmp #$21                     ; F32F= C9 21       I!
                bcc LF335                    ; F331= 90 02       ..
LF333:
                eor #$10                     ; F333= 49 10       I.
LF335:
                rts                          ; F335= 60          `

LF336:
                cmp #$7F                     ; F336= C9 7F       I.
                beq LF348                    ; F338= F0 0E       p.
                bcs LF323                    ; F33A= B0 E7       0g
                cmp #$60                     ; F33C= C9 60       I`
                bne LF342                    ; F33E= D0 02       P.
                lda #$5F                     ; F340= A9 5F       )_
LF342:
                cmp #$40                     ; F342= C9 40       I@
                bcc LF348                    ; F344= 90 02       ..
                and #$1F                     ; F346= 29 1F       ).
LF348:
                rts                          ; F348= 60          `

LF349:
                lda $0287                    ; F349= AD 87 02    -..
                eor #$4C                     ; F34C= 49 4C       IL
                bne LF363                    ; F34E= D0 13       P.
                jmp $0287                    ; F350= 4C 87 02    L..

osbyte90:
                lda $0290                    ; F353= AD 90 02    -..
                stx $0290                    ; F356= 8E 90 02    ...
                tax                          ; F359= AA          *
                tya                          ; F35A= 98          .
                and #$01                     ; F35B= 29 01       ).
                ldy $0291                    ; F35D= AC 91 02    ,..
                sta $0291                    ; F360= 8D 91 02    ...
LF363:
                rts                          ; F363= 60          `

osbyte95:
                tya                          ; F364= 98          .
                sta $FD00,x                  ; F365= 9D 00 FD    ..}
                rts                          ; F368= 60          `

osbyte97:
                tya                          ; F369= 98          .
                sta $FE00,x                  ; F36A= 9D 00 FE    ..~
                rts                          ; F36D= 60          `

osbyte93:
                tya                          ; F36E= 98          .
                sta $FC00,x                  ; F36F= 9D 00 FC    ..|
                rts                          ; F372= 60          `

LF373:
                ldx #$26                     ; F375= 4C 72 EE    Lrn
                jmp makeROMServiceCall

LF378:
                php                          ; F378= 08          .
                pha                          ; F379= 48          H
                phx                          ; F37A= DA          Z
                tsx                          ; F37B= BA          :
                lda $0104,x                  ; F37C= BD 04 01    =..
                jsr selectROMA                    ; F37F= 20 92 E5     .e
                bra LF3E1                    ; F382= 80 5D       .]

LF384:
                pha                          ; F384= 48          H
                pha                          ; F385= 48          H
                pha                          ; F386= 48          H
                php                          ; F387= 08          .
                pha                          ; F388= 48          H
                phx                          ; F389= DA          Z
                tsx                          ; F38A= BA          :
                lda $0107,x                  ; F38B= BD 07 01    =..
                sta $0104,x                  ; F38E= 9D 04 01    ...
                lda $0108,x                  ; F391= BD 08 01    =..
                sta $0105,x                  ; F394= 9D 05 01    ...
                lda $F4                      ; F397= A5 F4       %t
                sta $0108,x                  ; F399= 9D 08 01    ...
                lda #>LF378-1                ; F39C= A9 F3       )s
                sta $0107,x                  ; F39E= 9D 07 01    ...
                lda #<LF378-1                ; F3A1= A9 77       )w
                sta $0106,x                  ; F3A3= 9D 06 01    ...
                jsr selectTerminalROM      ; F3A6= 20 90 E5     .e
                bra LF3D3                    ; F3A9= 80 28       .(

LF3AB:
                pha                          ; F3AB= 48          H
                pha                          ; F3AC= 48          H
                pha                          ; F3AD= 48          H
                php                          ; F3AE= 08          .
                pha                          ; F3AF= 48          H
                phx                          ; F3B0= DA          Z
                tsx                          ; F3B1= BA          :
                lda $0108,x                  ; F3B2= BD 08 01    =..
                sta $0105,x                  ; F3B5= 9D 05 01    ...
                lda $0107,x                  ; F3B8= BD 07 01    =..
                sta $0104,x                  ; F3BB= 9D 04 01    ...
                lda #>LF3D7-1                ; F3BE= A9 F3       )s
                sta $0107,x                  ; F3C0= 9D 07 01    ...
                lda #<LF3D7-1                ; F3C3= A9 D6       )V
                sta $0106,x                  ; F3C5= 9D 06 01    ...
                lda ACCCON                   ; F3C8= AD 34 FE    -4~
                sta $0108,x                  ; F3CB= 9D 08 01    ...
                lda #$08                     ; F3CE= A9 08       ).
                trb ACCCON                   ; F3D0= 1C 34 FE    .4~
LF3D3:
                plx                          ; F3D3= FA          z
                pla                          ; F3D4= 68          h
                plp                          ; F3D5= 28          (
                rts                          ; F3D6= 60          `

LF3D7:
                php                          ; F3D7= 08          .
                pha                          ; F3D8= 48          H
                phx                          ; F3D9= DA          Z
                tsx                          ; F3DA= BA          :
                lda $0104,x                  ; F3DB= BD 04 01    =..
                jsr selectMOSOrHAZEL                    ; F3DE= 20 B0 ED     0m
LF3E1:
                lda $0103,x                  ; F3E1= BD 03 01    =..
                sta $0104,x                  ; F3E4= 9D 04 01    ...
                plx                          ; F3E7= FA          z
                pla                          ; F3E8= 68          h
                plp                          ; F3E9= 28          (
                plp                          ; F3EA= 28          (
                rts                          ; F3EB= 60          `

vduChrEntryPoint:
                jsr LF3AB                    ; F3EC= 20 AB F3     +s
                ldx $F4                      ; F3EF= A6 F4       &t
                phx                          ; F3F1= DA          Z
                jsr selectTerminalROMAndANDY                    ; F3F2= 20 7F E5     .e
                jsr LC027                    ; F3F5= 20 27 C0     '@
                plx                          ; F3F8= FA          z
                jmp selectROMX                    ; F3F9= 4C 81 E5    L.e

osrdscEntryPoint:
                jsr LF3AB                    ; F3FC= 20 AB F3     +s
                jmp LC018                    ; F3FF= 4C 18 C0    L.@

oswrscEntryPoint:
                jsr LF3AB                    ; F402= 20 AB F3     +s
                jmp LDB5F                    ; F405= 4C 5F DB    L_[

starRunBOOT:
                .text "/!BOOT",13

; Table to convert channel number to the bits required by the chip
soundParameterTable:
                .byte $e0,$c0,$a0,$80
                
LF413:
                jmp LF520                    ; F413= 4C 20 F5    L u

LF416:
                ldx #$00                     ; F416= A2 00       ".
                lda $0838                    ; F418= AD 38 08    -8.
                bne LF421                    ; F41B= D0 04       P.
                inx                          ; F41D= E8          h
                dec $0838                    ; F41E= CE 38 08    N8.
LF421:
                stx $083B                    ; F421= 8E 3B 08    .;.
                ldx #$08                     ; F424= A2 08       ".
LF426:
                dex                          ; F426= CA          J
                lda $0800,x                  ; F427= BD 00 08    =..
                beq LF413                    ; F42A= F0 E7       pg
                lda $02CE,x                  ; F42C= BD CE 02    =N.
                bmi LF436                    ; F42F= 30 05       0.
                lda $0818,x                  ; F431= BD 18 08    =..
                bne LF43E                    ; F434= D0 08       P.
LF436:
                jsr LF528                    ; F436= 20 28 F5     (u
                lda $0818,x                  ; F439= BD 18 08    =..
                beq LF450                    ; F43C= F0 12       p.
LF43E:
                inc a                        ; F43E= 1A          .
                beq LF453                    ; F43F= F0 12       p.
                dec $081C,x                  ; F441= DE 1C 08    ^..
                bne LF453                    ; F444= D0 0D       P.
                lda #$05                     ; F446= A9 05       ).
                sta $081C,x                  ; F448= 9D 1C 08    ...
                dec $0818,x                  ; F44B= DE 18 08    ^..
                bne LF453                    ; F44E= D0 03       P.
LF450:
                jsr LF528                    ; F450= 20 28 F5     (u
LF453:
                lda $0824,x                  ; F453= BD 24 08    =$.
                beq LF45D                    ; F456= F0 05       p.
                dec $0824,x                  ; F458= DE 24 08    ^$.
                bne LF413                    ; F45B= D0 B6       P6
LF45D:
                ldy $0820,x                  ; F45D= BC 20 08    < .
                cpy #$FF                     ; F460= C0 FF       @.
                beq LF413                    ; F462= F0 AF       p/
                lda $08C0,y                  ; F464= B9 C0 08    9@.
                and #$7F                     ; F467= 29 7F       ).
                sta $0824,x                  ; F469= 9D 24 08    .$.
                lda $0808,x                  ; F46C= BD 08 08    =..
                cmp #$04                     ; F46F= C9 04       I.
                beq LF4D0                    ; F471= F0 5D       p]
                clc                          ; F473= 18          .
                adc $0820,x                  ; F474= 7D 20 08    } .
                tay                          ; F477= A8          (
                lda $08CB,y                  ; F478= B9 CB 08    9K.
                sec                          ; F47B= 38          8
                sbc #$3F                     ; F47C= E9 3F       i?
                sta $083A                    ; F47E= 8D 3A 08    .:.
                lda $08C7,y                  ; F481= B9 C7 08    9G.
                sta $0839                    ; F484= 8D 39 08    .9.
                lda $0804,x                  ; F487= BD 04 08    =..
LF48A:
                pha                          ; F48A= 48          H
                clc                          ; F48B= 18          .
                adc $0839                    ; F48C= 6D 39 08    m9.
                bvc LF498                    ; F48F= 50 07       P.
                rol a                        ; F491= 2A          *
                lda #$3F                     ; F492= A9 3F       )?
                bcs LF498                    ; F494= B0 02       0.
                eor #$FF                     ; F496= 49 FF       I.
LF498:
                sta $0804,x                  ; F498= 9D 04 08    ...
                rol a                        ; F49B= 2A          *
                eor $0804,x                  ; F49C= 5D 04 08    ]..
                bpl LF4AA                    ; F49F= 10 09       ..
                lda #$3F                     ; F4A1= A9 3F       )?
                bcc LF4A7                    ; F4A3= 90 02       ..
                eor #$FF                     ; F4A5= 49 FF       I.
LF4A7:
                sta $0804,x                  ; F4A7= 9D 04 08    ...
LF4AA:
                dec $0839                    ; F4AA= CE 39 08    N9.
                lda $0804,x                  ; F4AD= BD 04 08    =..
                sec                          ; F4B0= 38          8
                sbc $083A                    ; F4B1= ED 3A 08    m:.
                eor $0839                    ; F4B4= 4D 39 08    M9.
                bmi LF4C2                    ; F4B7= 30 09       0.
                lda $083A                    ; F4B9= AD 3A 08    -:.
                sta $0804,x                  ; F4BC= 9D 04 08    ...
                inc $0808,x                  ; F4BF= FE 08 08    ~..
LF4C2:
                pla                          ; F4C2= 68          h
                eor $0804,x                  ; F4C3= 5D 04 08    ]..
                and #$F8                     ; F4C6= 29 F8       )x
                beq LF4D0                    ; F4C8= F0 06       p.
                lda $0804,x                  ; F4CA= BD 04 08    =..
                jsr LF599                    ; F4CD= 20 99 F5     .u
LF4D0:
                lda $0810,x                  ; F4D0= BD 10 08    =..
                cmp #$03                     ; F4D3= C9 03       I.
                beq LF520                    ; F4D5= F0 49       pI
                lda $0814,x                  ; F4D7= BD 14 08    =..
                bne LF504                    ; F4DA= D0 28       P(
                inc $0810,x                  ; F4DC= FE 10 08    ~..
                lda $0810,x                  ; F4DF= BD 10 08    =..
                cmp #$03                     ; F4E2= C9 03       I.
                bne LF4F4                    ; F4E4= D0 0E       P.
                ldy $0820,x                  ; F4E6= BC 20 08    < .
                lda $08C0,y                  ; F4E9= B9 C0 08    9@.
                bmi LF520                    ; F4EC= 30 32       02
                stz $0830,x                  ; F4EE= 9E 30 08    .0.
                stz $0810,x                  ; F4F1= 9E 10 08    ...
LF4F4:
                lda $0810,x                  ; F4F4= BD 10 08    =..
                clc                          ; F4F7= 18          .
                adc $0820,x                  ; F4F8= 7D 20 08    } .
                tay                          ; F4FB= A8          (
                lda $08C4,y                  ; F4FC= B9 C4 08    9D.
                sta $0814,x                  ; F4FF= 9D 14 08    ...
                beq LF520                    ; F502= F0 1C       p.
LF504:
                dec $0814,x                  ; F504= DE 14 08    ^..
                lda $0820,x                  ; F507= BD 20 08    = .
                clc                          ; F50A= 18          .
                adc $0810,x                  ; F50B= 7D 10 08    }..
                tay                          ; F50E= A8          (
                lda $08C1,y                  ; F50F= B9 C1 08    9A.
                clc                          ; F512= 18          .
                adc $0830,x                  ; F513= 7D 30 08    }0.
                sta $0830,x                  ; F516= 9D 30 08    .0.
                clc                          ; F519= 18          .
                adc $080C,x                  ; F51A= 7D 0C 08    }..
                jsr LF5D5                    ; F51D= 20 D5 F5     Uu
LF520:
                cpx #$04                     ; F520= E0 04       `.
                beq LF527                    ; F522= F0 03       p.
                jmp LF426                    ; F524= 4C 26 F4    L&t

LF527:
                rts                          ; F527= 60          `

LF528:
                lda $0808,x                  ; F528= BD 08 08    =..
                cmp #$04                     ; F52B= C9 04       I.
                beq LF534                    ; F52D= F0 05       p.
                lda #$03                     ; F52F= A9 03       ).
                sta $0808,x                  ; F531= 9D 08 08    ...
LF534:
                lda $02CE,x                  ; F534= BD CE 02    =N.
                beq LF54D                    ; F537= F0 14       p.
                lda #$00                     ; F539= A9 00       ).
                stz $02CE,x                  ; F53B= 9E CE 02    .N.
                ldy #$04                     ; F53E= A0 04        .
LF540:
                sta $082B,y                  ; F540= 99 2B 08    .+.
                dey                          ; F543= 88          .
                bne LF540                    ; F544= D0 FA       Pz
                stz $0818,x                  ; F546= 9E 18 08    ...
                dey                          ; F549= 88          .
                sty $0838                    ; F54A= 8C 38 08    .8.
LF54D:
                lda $0828,x                  ; F54D= BD 28 08    =(.
                beq LF5B2                    ; F550= F0 60       p`
                lda $083B                    ; F552= AD 3B 08    -;.
                beq LF58B                    ; F555= F0 34       p4
                stz $0828,x                  ; F557= 9E 28 08    .(.
LF55A:
                jmp LF685                    ; F55A= 4C 85 F6    L.v

LF55D:
                jsr LF592                    ; F55D= 20 92 F5     .u
                tya                          ; F560= 98          .
                stz $0818,x                  ; F561= 9E 18 08    ...
                stz $02CE,x                  ; F564= 9E CE 02    .N.
                stz $0800,x                  ; F567= 9E 00 08    ...
                ldy #$03                     ; F56A= A0 03        .
LF56C:
                sta $082C,y                  ; F56C= 99 2C 08    .,.
                dey                          ; F56F= 88          .
                bpl LF56C                    ; F570= 10 FA       .z
                sty $0838                    ; F572= 8C 38 08    .8.
                bra LF5DA                    ; F575= 80 63       .c

LF577:
                php                          ; F577= 08          .
                sei                          ; F578= 78          x
                lda $0808,x                  ; F579= BD 08 08    =..
                cmp #$04                     ; F57C= C9 04       I.
                bne LF58A                    ; F57E= D0 0A       P.
                jsr osbyte98                    ; F580= 20 EF E9     oi
                bcc LF58A                    ; F583= 90 05       ..
                lda #$00                     ; F585= A9 00       ).
                stz $0800,x                  ; F587= 9E 00 08    ...
LF58A:
                plp                          ; F58A= 28          (
LF58B:
                ldy $0820,x                  ; F58B= BC 20 08    < .
                cpy #$FF                     ; F58E= C0 FF       @.
                bne LF604                    ; F590= D0 72       Pr
LF592:
                lda #$04                     ; F592= A9 04       ).
                sta $0808,x                  ; F594= 9D 08 08    ...
                lda #$C0                     ; F597= A9 C0       )@
LF599:
                sta $0804,x                  ; F599= 9D 04 08    ...
                ldy $0262                    ; F59C= AC 62 02    ,b.
                beq LF5A3                    ; F59F= F0 02       p.
                lda #$C0                     ; F5A1= A9 C0       )@
LF5A3:
                sec                          ; F5A3= 38          8
                sbc #$40                     ; F5A4= E9 40       i@
                lsr a                        ; F5A6= 4A          J
                lsr a                        ; F5A7= 4A          J
                lsr a                        ; F5A8= 4A          J
                eor #$0F                     ; F5A9= 49 0F       I.
                ora soundParameterTable-bufferNumberSound0,x                  ; F5AB= 1D 0B F4    ..t
                ora #$10                     ; F5AE= 09 10       ..
                bra LF5E6                    ; F5B0= 80 34       .4

LF5B2:
                jsr osbyte98                    ; F5B2= 20 EF E9     oi
                bcs LF577                    ; F5B5= B0 C0       0@
                and #$03                     ; F5B7= 29 03       ).
                beq LF55A                    ; F5B9= F0 9F       p.
                lda $0838                    ; F5BB= AD 38 08    -8.
                beq LF58B                    ; F5BE= F0 CB       pK
                inc $0828,x                  ; F5C0= FE 28 08    ~(.
                tay                          ; F5C3= A8          (
                bpl LF5D0                    ; F5C4= 10 0A       ..
                jsr osbyte98                    ; F5C6= 20 EF E9     oi
                and #$03                     ; F5C9= 29 03       ).
                sta $0838                    ; F5CB= 8D 38 08    .8.
                bra LF58B                    ; F5CE= 80 BB       .;

LF5D0:
                dec $0838                    ; F5D0= CE 38 08    N8.
                bra LF58B                    ; F5D3= 80 B6       .6

LF5D5:
                cmp $082C,x                  ; F5D5= DD 2C 08    ],.
                beq LF604                    ; F5D8= F0 2A       p*
LF5DA:
                sta $082C,x                  ; F5DA= 9D 2C 08    .,.
                cpx #$04                     ; F5DD= E0 04       `.
                bne LF605                    ; F5DF= D0 24       P$
                and #$0F                     ; F5E1= 29 0F       ).
                ora soundParameterTable-bufferNumberSound0,x                  ; F5E3= 1D 0B F4    ..t
LF5E6:
                php                          ; F5E6= 08          .
LF5E7:
                sei                          ; F5E7= 78          x
                ldy #$FF                     ; F5E8= A0 FF        .
                sty systemVIA.ddra            ; F5EA= 8C 43 FE    .C~
                sta systemVIA.oraNoHandshake            ; F5ED= 8D 4F FE    .O~
                iny                          ; F5F0= C8          H
                sty systemVIA.orb            ; F5F1= 8C 40 FE    .@~
                ldy #$02                     ; F5F4= A0 02        .
LF5F6:
                dey                          ; F5F6= 88          .
                bne LF5F6                    ; F5F7= D0 FD       P}
                ldy #$08                     ; F5F9= A0 08        .
                sty systemVIA.orb            ; F5FB= 8C 40 FE    .@~
                ldy #$04                     ; F5FE= A0 04        .
LF600:
                dey                          ; F600= 88          .
                bne LF600                    ; F601= D0 FD       P}
                plp                          ; F603= 28          (
LF604:
                rts                          ; F604= 60          `

LF605:
                pha                          ; F605= 48          H
                and #$03                     ; F606= 29 03       ).
                sta $083C                    ; F608= 8D 3C 08    .<.
                stz $083D                    ; F60B= 9C 3D 08    .=.
                pla                          ; F60E= 68          h
                lsr a                        ; F60F= 4A          J
                lsr a                        ; F610= 4A          J
LF611:
                cmp #$0C                     ; F611= C9 0C       I.
                bcc LF61C                    ; F613= 90 07       ..
                inc $083D                    ; F615= EE 3D 08    n=.
                sbc #$0C                     ; F618= E9 0C       i.
                bne LF611                    ; F61A= D0 F5       Pu
LF61C:
                tay                          ; F61C= A8          (
                lda $083D                    ; F61D= AD 3D 08    -=.
                pha                          ; F620= 48          H
                lda LF6E4,y                  ; F621= B9 E4 F6    9dv
                sta $083D                    ; F624= 8D 3D 08    .=.
                lda LF6F0,y                  ; F627= B9 F0 F6    9pv
                pha                          ; F62A= 48          H
                and #$03                     ; F62B= 29 03       ).
                sta $083E                    ; F62D= 8D 3E 08    .>.
                pla                          ; F630= 68          h
                lsr a                        ; F631= 4A          J
                lsr a                        ; F632= 4A          J
                lsr a                        ; F633= 4A          J
                lsr a                        ; F634= 4A          J
                sta $083F                    ; F635= 8D 3F 08    .?.
                lda $083D                    ; F638= AD 3D 08    -=.
                ldy $083C                    ; F63B= AC 3C 08    ,<.
                beq LF64C                    ; F63E= F0 0C       p.
LF640:
                sec                          ; F640= 38          8
                sbc $083F                    ; F641= ED 3F 08    m?.
                bcs LF649                    ; F644= B0 03       0.
                dec $083E                    ; F646= CE 3E 08    N>.
LF649:
                dey                          ; F649= 88          .
                bne LF640                    ; F64A= D0 F4       Pt
LF64C:
                sta $083D                    ; F64C= 8D 3D 08    .=.
                pla                          ; F64F= 68          h
                tay                          ; F650= A8          (
                beq LF65C                    ; F651= F0 09       p.
LF653:
                lsr $083E                    ; F653= 4E 3E 08    N>.
                ror $083D                    ; F656= 6E 3D 08    n=.
                dey                          ; F659= 88          .
                bne LF653                    ; F65A= D0 F7       Pw
LF65C:
                lda $083D                    ; F65C= AD 3D 08    -=.
                clc                          ; F65F= 18          .
                adc LE165,x                  ; F660= 7D 65 E1    }ea
                sta $083D                    ; F663= 8D 3D 08    .=.
                bcc LF66B                    ; F666= 90 03       ..
                inc $083E                    ; F668= EE 3E 08    n>.
LF66B:
                and #$0F                     ; F66B= 29 0F       ).
                ora soundParameterTable-bufferNumberSound0,x                  ; F66D= 1D 0B F4    ..t
                php                          ; F670= 08          .
                sei                          ; F671= 78          x
                jsr LF5E6                    ; F672= 20 E6 F5     fu
                lda $083D                    ; F675= AD 3D 08    -=.
                lsr $083E                    ; F678= 4E 3E 08    N>.
                ror a                        ; F67B= 6A          j
                lsr $083E                    ; F67C= 4E 3E 08    N>.
                ror a                        ; F67F= 6A          j
                lsr a                        ; F680= 4A          J
                lsr a                        ; F681= 4A          J
                jmp LF5E7                    ; F682= 4C E7 F5    Lgu

LF685:
                php                          ; F685= 08          .
                sei                          ; F686= 78          x
                jsr osbyte91                    ; F687= 20 F4 E9     ti
                pha                          ; F68A= 48          H
                and #$04                     ; F68B= 29 04       ).
                beq LF6A2                    ; F68D= F0 13       p.
                pla                          ; F68F= 68          h
                ldy $0820,x                  ; F690= BC 20 08    < .
                iny                          ; F693= C8          H
                bne LF699                    ; F694= D0 03       P.
                jsr LF592                    ; F696= 20 92 F5     .u
LF699:
                jsr osbyte91                    ; F699= 20 F4 E9     ti
                jsr osbyte91                    ; F69C= 20 F4 E9     ti
                plp                          ; F69F= 28          (
                bra LF6E0                    ; F6A0= 80 3E       .>

LF6A2:
                pla                          ; F6A2= 68          h
                and #$F8                     ; F6A3= 29 F8       )x
                asl a                        ; F6A5= 0A          .
                bcc LF6B3                    ; F6A6= 90 0B       ..
                eor #$FF                     ; F6A8= 49 FF       I.
                lsr a                        ; F6AA= 4A          J
                sec                          ; F6AB= 38          8
                sbc #$40                     ; F6AC= E9 40       i@
                jsr LF599                    ; F6AE= 20 99 F5     .u
                lda #$FF                     ; F6B1= A9 FF       ).
LF6B3:
                sta $0820,x                  ; F6B3= 9D 20 08    . .
                lda #$05                     ; F6B6= A9 05       ).
                sta $081C,x                  ; F6B8= 9D 1C 08    ...
                lda #$01                     ; F6BB= A9 01       ).
                sta $0824,x                  ; F6BD= 9D 24 08    .$.
                stz $0814,x                  ; F6C0= 9E 14 08    ...
                stz $0808,x                  ; F6C3= 9E 08 08    ...
                stz $0830,x                  ; F6C6= 9E 30 08    .0.
                lda #$FF                     ; F6C9= A9 FF       ).
                sta $0810,x                  ; F6CB= 9D 10 08    ...
                jsr osbyte91                    ; F6CE= 20 F4 E9     ti
                sta $080C,x                  ; F6D1= 9D 0C 08    ...
                jsr osbyte91                    ; F6D4= 20 F4 E9     ti
                plp                          ; F6D7= 28          (
                pha                          ; F6D8= 48          H
                lda $080C,x                  ; F6D9= BD 0C 08    =..
                jsr LF5D5                    ; F6DC= 20 D5 F5     Uu
                pla                          ; F6DF= 68          h
LF6E0:
                sta $0818,x                  ; F6E0= 9D 18 08    ...
                rts                          ; F6E3= 60          `

LF6E4:
;BEQ LF69D        :\ F6E4= F0 B7       p7
                .byte $F0
                .byte $B7
                .byte $82                    ; F6E6= 82          .
                .byte $4F                    ; F6E7= 4F          O
;JSR LC8F3        :\ F6E8= 20 F3 C8     sH
                .byte $20
                .byte $F3
                .byte $C8
                ldy #$7B                     ; F6EB= A0 7B        {
                .byte $57                    ; F6ED= 57          W
                and $16,x                    ; F6EE= 35 16       5.
LF6F0:
                .byte $E7                    ; F6F0= E7          g
                .byte $D7                    ; F6F1= D7          W
                .byte $CB                    ; F6F2= CB          K
                .byte $C3                    ; F6F3= C3          C
                .byte $B7                    ; F6F4= B7          7
                tax                          ; F6F5= AA          *
                ldx #$9A                     ; F6F6= A2 9A       ".
                sta ($8A)                    ; F6F8= 92 8A       ..
                .byte $82                    ; F6FA= 82          .
                ply                          ; F6FB= 7A          z
LF6FC:
                lda #$FF                     ; F6FC= A9 FF       ).
                sta $F5                      ; F6FE= 85 F5       .u
                rts                          ; F700= 60          `

LF701:
                inc $F5                      ; F701= E6 F5       fu
                ldy $F5                      ; F703= A4 F5       $u
                ldx #$0D                     ; F705= A2 0D       ".
LF707:
                php                          ; F707= 08          .
                jsr makeROMServiceCall                    ; F708= 20 72 EE     rn
                plp                          ; F70B= 28          (
                cmp #$01                     ; F70C= C9 01       I.
                tya                          ; F70E= 98          .
                rts                          ; F70F= 60          `

LF710:
                ldx #$0E                     ; F710= A2 0E       ".
                ldy #$FF                     ; F712= A0 FF        .
                jmp LF707                    ; F714= 4C 07 F7    L.w

LF717:
                lda $03CB                    ; F717= AD CB 03    -K.
                sta $F6                      ; F71A= 85 F6       .v
                lda $03CC                    ; F71C= AD CC 03    -L.
                sta $F7                      ; F71F= 85 F7       .w
                lda $F5                      ; F721= A5 F5       %u
                rts                          ; F723= 60          `

LF724:
                ldx #$FF                     ; F724= A2 FF       ".
                lda $EC                      ; F726= A5 EC       %l
                ora $ED                      ; F728= 05 ED       .m
                bne LF732                    ; F72A= D0 06       P.
                lda #$81                     ; F72C= A9 81       ).
                sta systemVIA.ier            ; F72E= 8D 4E FE    .N~
                inx                          ; F731= E8          h
LF732:
                stx $0242                    ; F732= 8E 42 02    .B.
LF735:
                php                          ; F735= 08          .
                lda $025A                    ; F736= AD 5A 02    -Z.
                lsr a                        ; F739= 4A          J
                and #$18                     ; F73A= 29 18       ).
                ora #$06                     ; F73C= 09 06       ..
                sta systemVIA.orb            ; F73E= 8D 40 FE    .@~
                lsr a                        ; F741= 4A          J
                ora #$07                     ; F742= 09 07       ..
                sta systemVIA.orb            ; F744= 8D 40 FE    .@~
                jsr LF91C                    ; F747= 20 1C F9     .y
                pla                          ; F74A= 68          h
                rts                          ; F74B= 60          `

; KEYV handler
; ============
LF74C:
                bvc LF758                    ; F74C= 50 0A       P.
                lda #$01                     ; F74E= A9 01       ).
                sta systemVIA.ier            ; F750= 8D 4E FE    .N~
                bcs LF75D                    ; F753= B0 08       0.
                jmp LF865                    ; F755= 4C 65 F8    Lex

LF758:
                bcc LF760                    ; F758= 90 06       ..
                jmp LF916                    ; F75A= 4C 16 F9    L.y

LF75D:
                inc $0242                    ; F75D= EE 42 02    nB.

; Test Shift & Ctrl keys
; ----------------------
LF760:
                lda $025A                    ; F760= AD 5A 02    -Z.
                and #$B7                     ; F763= 29 B7       )7
                ldx #$00                     ; F765= A2 00       ".
                jsr interrogateKeyboard                    ; F767= 20 80 F8     .x
                bcc LF76E                    ; F76A= 90 02       ..
                stx $FA                      ; F76C= 86 FA       .z
LF76E:
                clv                          ; F76E= B8          8
                bpl LF776                    ; F76F= 10 05       ..
                bit LE34E                    ; F771= 2C 4E E3    ,Nc
                ora #$08                     ; F774= 09 08       ..
LF776:
                inx                          ; F776= E8          h
                jsr interrogateKeyboard                    ; F777= 20 80 F8     .x
                bcc LF735                    ; F77A= 90 B9       .9
                bpl LF780                    ; F77C= 10 02       ..
                ora #$40                     ; F77E= 09 40       .@
LF780:
                sta $025A                    ; F780= 8D 5A 02    .Z.
                ldx $EC                      ; F783= A6 EC       &l
                beq LF7D4                    ; F785= F0 4D       pM
                jsr interrogateKeyboard                    ; F787= 20 80 F8     .x
                bmi LF799                    ; F78A= 30 0D       0.
                cpx $EC                      ; F78C= E4 EC       dl
LF78E:
                stx $EC                      ; F78E= 86 EC       .l
                bne LF7D4                    ; F790= D0 42       PB
                stz $EC                      ; F792= 64 EC       dl
LF794:
                jsr LF875                    ; F794= 20 75 F8     ux
                bra LF7D4                    ; F797= 80 3B       .;

LF799:
                cpx $EC                      ; F799= E4 EC       dl
                bne LF78E                    ; F79B= D0 F1       Pq
                lda $E7                      ; F79D= A5 E7       %g
                beq LF7D4                    ; F79F= F0 33       p3
                dec $E7                      ; F7A1= C6 E7       Fg
                bne LF7D4                    ; F7A3= D0 2F       P/
                lda $02CA                    ; F7A5= AD CA 02    -J.
                sta $E7                      ; F7A8= 85 E7       .g
                lda $0255                    ; F7AA= AD 55 02    -U.
                sta $02CA                    ; F7AD= 8D CA 02    .J.
                lda $025A                    ; F7B0= AD 5A 02    -Z.
                ldx $EC                      ; F7B3= A6 EC       &l
                cpx #$D0                     ; F7B5= E0 D0       `P
                beq LF7CB                    ; F7B7= F0 12       p.
                cpx #$C0                     ; F7B9= E0 C0       `@
                bne LF7D6                    ; F7BB= D0 19       P.
                ora #$A0                     ; F7BD= 09 A0       .
                bit $FA                      ; F7BF= 24 FA       $z
                bpl LF7C7                    ; F7C1= 10 04       ..
                ora #$10                     ; F7C3= 09 10       ..
                eor #$80                     ; F7C5= 49 80       I.
LF7C7:
                eor #$90                     ; F7C7= 49 90       I.
                bra LF7CF                    ; F7C9= 80 04       ..

LF7CB:
                ora #$90                     ; F7CB= 09 90       ..
                eor #$A0                     ; F7CD= 49 A0       I
LF7CF:
                sta $025A                    ; F7CF= 8D 5A 02    .Z.
                stz $E7                      ; F7D2= 64 E7       dg
LF7D4:
                bra LF845                    ; F7D4= 80 6F       .o

LF7D6:
                lda LF801+1,x                ; F7D6= BD 02 F8    =.x ; ?????????
                beq LF7E3                    ; F7D9= F0 08       p.
                cmp #$9D                     ; F7DB= C9 9D       I.
                bne LF7E6                    ; F7DD= D0 07       P.
                eor #$10                     ; F7DF= 49 10       I.
                bra LF7EA                    ; F7E1= 80 07       ..

LF7E3:
                lda $026B                    ; F7E3= AD 6B 02    -k.
LF7E6:
                cmp #$A0                     ; F7E6= C9 A0       I
                bcc LF7F6                    ; F7E8= 90 0C       ..
LF7EA:
                sbc #$31                     ; F7EA= E9 31       i1
                adc $027E                    ; F7EC= 6D 7E 02    m~.
                eor #$80                     ; F7EF= 49 80       I.
                ldx $028E                    ; F7F1= AE 8E 02    ...
                bne LF839                    ; F7F4= D0 43       PC
LF7F6:
                ldx $025A                    ; F7F6= AE 5A 02    .Z.
                stx $FA                      ; F7F9= 86 FA       .z
                rol $FA                      ; F7FB= 26 FA       &z
                bpl LF806                    ; F7FD= 10 07       ..
                ldx $ED                      ; F7FF= A6 ED       &m
LF801:
                bne LF794                    ; F801= D0 91       P.
                jsr LF336                    ; F803= 20 36 F3     6s
LF806:
                rol $FA                      ; F806= 26 FA       &z
                bmi LF811                    ; F808= 30 07       0.
                jsr LF313                    ; F80A= 20 13 F3     .s
                rol $FA                      ; F80D= 26 FA       &z
                bra LF81D                    ; F80F= 80 0C       ..

LF811:
                rol $FA                      ; F811= 26 FA       &z
                bmi LF822                    ; F813= 30 0D       0.
                jsr isLetter                    ; F815= 20 71 EA     qj
                bcs LF822                    ; F818= B0 08       0.
                jsr LF313                    ; F81A= 20 13 F3     .s
LF81D:
                ldx $025A                    ; F81D= AE 5A 02    .Z.
                bpl LF82D                    ; F820= 10 0B       ..
LF822:
                rol $FA                      ; F822= 26 FA       &z
                bpl LF82D                    ; F824= 10 07       ..
                ldx $ED                      ; F826= A6 ED       &m
                bne LF801                    ; F828= D0 D7       PW
                jsr LF313                    ; F82A= 20 13 F3     .s
LF82D:
                cmp $026C                    ; F82D= CD 6C 02    Ml.
                bne LF839                    ; F830= D0 07       P.
                ldx $0275                    ; F832= AE 75 02    .u.
                bne LF839                    ; F835= D0 02       P.
                stz $E7                      ; F837= 64 E7       dg
LF839:
                tay                          ; F839= A8          (
                jsr LF9A6                    ; F83A= 20 A6 F9     &y
                lda $0259                    ; F83D= AD 59 02    -Y.
                bne LF845                    ; F840= D0 03       P.
                jsr LEA7E                    ; F842= 20 7E EA     ~j
LF845:
                ldx $ED                      ; F845= A6 ED       &m
                beq LF852                    ; F847= F0 09       p.
                jsr interrogateKeyboard                    ; F849= 20 80 F8     .x
                stx $ED                      ; F84C= 86 ED       .m
                bmi LF868                    ; F84E= 30 18       0.
                stz $ED                      ; F850= 64 ED       dm
LF852:
                ldy #$EC                     ; F852= A0 EC        l
                jsr LF96C                    ; F854= 20 6C F9     ly
                bmi LF862                    ; F857= 30 09       0.
                lda $EC                      ; F859= A5 EC       %l
                sta $ED                      ; F85B= 85 ED       .m
LF85D:
                stx $EC                      ; F85D= 86 EC       .l
                jsr LF875                    ; F85F= 20 75 F8     ux
LF862:
                jmp LF724                    ; F862= 4C 24 F7    L$w

LF865:
                jsr interrogateKeyboard                    ; F865= 20 80 F8     .x
LF868:
                lda $EC                      ; F868= A5 EC       %l
                bne LF862                    ; F86A= D0 F6       Pv
                ldy #$ED                     ; F86C= A0 ED        m
                jsr LF96C                    ; F86E= 20 6C F9     ly
                bmi LF862                    ; F871= 30 EF       0o
                bra LF85D                    ; F873= 80 E8       .h

LF875:
                ldx #$01                     ; F875= A2 01       ".
                stx $E7                      ; F877= 86 E7       .g
                ldx $0254                    ; F879= AE 54 02    .T.
                stx $02CA                    ; F87C= 8E CA 02    .J.
                rts                          ; F87F= 60          `

;-------------------------------------------------------------------------
;
; Read a single key's state from the keyboard
;
; Entry:
;
; X = key to test
;
; Exit:
;
; X=$80, N=1 if key pressed; X=$00, N=0 if key not pressed
;
; Preserves: A/C
; 
interrogateKeyboard: .proc
                ldy #$03                     ;write to keyboard
                sty systemVIA.orb
                ldy #$7F
                sty systemVIA.ddra           ;bit 7=input, bits 6-0=output
                stx systemVIA.oraNoHandshake ;store key value
                nop
                ldx systemVIA.iraNoHandshake ;read key state
                rts
                .pend

; Default keyboard table
; ======================
LF892:
                .text "q345"
                .byte $84
                .text "8"
                .byte $87
                .text "-^"
                .byte $8C
                .byte $B6
                .byte $B7
;     q345        f4       8        f7       -^      Left       k6       k7
osbyte92:
                ldy $FC00,x
                rts
                .byte $80
                .text "wet7i90_"
                .byte $8E
                .byte $B8
                .byte $B9
;     f0       wet7i90_      Down       k8       k9
osbyte94:
                ldy $FD00,x
                rts
                .text "12dr6uop["
                .byte $8F
                .byte $AB
                .byte $AD
                .byte $9D
;     12dr6uop[        Up       k+       k-     kRet
LF8BF:
                jmp (EVENTV)
                .byte 1
                .text "axfyjk@:"
                .byte $0D
                .byte $AF
                .byte $FF
                .byte $AE
; caps       axfyjk@:       ret       k/     kDel       k.
LF8CF:
                jmp ($FDFE)
                .byte 2
                .text "scghnl;]"
                .byte $7F
                .byte $A3
                .byte $AA
                .byte $AC
; shlk       scghnl;]       del       k#       k*       k,
call00FA:
                jmp ($00FA)
                .byte 0
                .text "z vbm,./"
                .byte $8B
                .byte $B0
                .byte $B1
                .byte $B3
;  tab       z vbm,./      copy       k0       k1       k3
                .byte 0
                .byte 0
                .byte 0
                .byte 27
                .byte $81
                .byte $82
                .byte $83
                .byte $85
                .byte $86
                .byte $88
                .byte $89
                .byte $5C
                .byte $8D
                .byte $B4
                .byte $B5
                .byte $B2
;   esc       f1       f2       f3       f5       f6       f8       f9        \    right       k4       k5       k2
LF8FF:
                bit LE34E                    ; Set V
callKEYV:                                    ;f902
                jmp (KEYV)                  ; Jump to KEYV
osbyte83:
                ldy $0244                    ; F905= AC 44 02    ,D.
                ldx #$00                     ; F908= A2 00       ".
LF90A:
                rts                          ; F90A= 60          `

;-------------------------------------------------------------------------
;
; OSBYTE $78
;
; D.2-33
;
osbyte78:                          ;f90b
                sty $EC                      ; F90B= 84 EC       .l
                stx $ED                      ; F90D= 86 ED       .m
                rts                          ; F90F= 60          `

osbyte7A:
                ldx #$10                     ; F910= A2 10       ".
                clv                          ; F912= B8          8
                sec                          ; F913= 38          8
                bra callKEYV                    ; F914= 80 EC       .l

LF916:
                txa                          ; F916= 8A          .
                bpl LF923                    ; F917= 10 0A       ..
                jsr interrogateKeyboard                    ; F919= 20 80 F8     .x
LF91C:
                lda #$0B                     ; F91C= A9 0B       ).
                sta systemVIA.orb            ; F91E= 8D 40 FE    .@~
                txa                          ; F921= 8A          .
                rts                          ; F922= 60          `

LF923:
                stx $02CB                    ; F923= 8E CB 02    .K.
                lda #$FF                     ; F926= A9 FF       ).
                sta $02CC                    ; F928= 8D CC 02    .L.
                ldx #$0C                     ; F92B= A2 0C       ".
                lda #$7F                     ; F92D= A9 7F       ).
                sta systemVIA.ddra            ; F92F= 8D 43 FE    .C~
                lda #$03                     ; F932= A9 03       ).
                sta systemVIA.orb            ; F934= 8D 40 FE    .@~
LF937:
                lda #$0F                     ; F937= A9 0F       ).
                sta systemVIA.oraNoHandshake            ; F939= 8D 4F FE    .O~
                lda #$01                     ; F93C= A9 01       ).
                sta systemVIA.ifr            ; F93E= 8D 4D FE    .M~
                stx systemVIA.oraNoHandshake            ; F941= 8E 4F FE    .O~
                bit systemVIA.ifr            ; F944= 2C 4D FE    ,M~
                beq LF964                    ; F947= F0 1B       p.
                txa                          ; F949= 8A          .
LF94A:
                clc                          ; F94A= 18          .
                adc #$10                     ; F94B= 69 10       i.
                bmi LF964                    ; F94D= 30 15       0.
                sta systemVIA.oraNoHandshake            ; F94F= 8D 4F FE    .O~
                bit systemVIA.iraNoHandshake            ; F952= 2C 4F FE    ,O~
                bpl LF94A                    ; F955= 10 F3       .s
                cmp $02CB                    ; F957= CD CB 02    MK.
                bcc LF94A                    ; F95A= 90 EE       .n
                cmp $02CC                    ; F95C= CD CC 02    ML.
                bcs LF94A                    ; F95F= B0 E9       0i
                sta $02CC                    ; F961= 8D CC 02    .L.
LF964:
                dex                          ; F964= CA          J
                bpl LF937                    ; F965= 10 D0       .P
                ldx $02CC                    ; F967= AE CC 02    .L.
                bra LF91C                    ; F96A= 80 B0       .0

LF96C:
                ldx #$0C                     ; F96C= A2 0C       ".
LF96E:
                jsr LF9A6                    ; F96E= 20 A6 F9     &y
                lda #$7F                     ; F971= A9 7F       ).
                sta systemVIA.ddra            ; F973= 8D 43 FE    .C~
                lda #$03                     ; F976= A9 03       ).
                sta systemVIA.orb            ; F978= 8D 40 FE    .@~
                lda #$0F                     ; F97B= A9 0F       ).
                sta systemVIA.oraNoHandshake            ; F97D= 8D 4F FE    .O~
                lda #$01                     ; F980= A9 01       ).
                sta systemVIA.ifr            ; F982= 8D 4D FE    .M~
                stx systemVIA.oraNoHandshake            ; F985= 8E 4F FE    .O~
                bit systemVIA.ifr            ; F988= 2C 4D FE    ,M~
                beq LF9AD                    ; F98B= F0 20       p
                txa                          ; F98D= 8A          .
LF98E:
                clc                          ; F98E= 18          .
                adc #$10                     ; F98F= 69 10       i.
                bmi LF9AD                    ; F991= 30 1A       0.
                sta systemVIA.oraNoHandshake            ; F993= 8D 4F FE    .O~
                bit systemVIA.iraNoHandshake            ; F996= 2C 4F FE    ,O~
                bpl LF98E                    ; F999= 10 F3       .s
                pha                          ; F99B= 48          H
LF99C:
                eor $0000,y                  ; F99C= 59 00 00    Y..
                asl a                        ; F99F= 0A          .
                cmp #$01                     ; F9A0= C9 01       I.
                pla                          ; F9A2= 68          h
                bcc LF98E                    ; F9A3= 90 E9       .i
                tax                          ; F9A5= AA          *
LF9A6:
                jsr LF91C                    ; F9A6= 20 1C F9     .y
                cli                          ; F9A9= 58          X
                sei                          ; F9AA= 78          x
                txa                          ; F9AB= 8A          .
                rts                          ; F9AC= 60          `

LF9AD:
                dex                          ; F9AD= CA          J
                bpl LF96E                    ; F9AE= 10 BE       .>
                bra LF9A6                    ; F9B0= 80 F4       .t

osbputEntryPoint:
                jsr LFA97                    ; F9B2= 20 97 FA     .z
                jmp (BPUTV)                  ; F9B5= 6C 18 02    l..

osbgetEntryPoint:
                jsr LFA97                    ; F9B8= 20 97 FA     .z
                jmp (BGETV)                  ; F9BB= 6C 16 02    l..

osgbpbEntryPoint:
                cmp #$05                     ; F9BE= C9 05       I.
                bcs LF9D7                    ; F9C0= B0 15       0.
                cmp #$00                     ; F9C2= C9 00       I.
                beq LF9D7                    ; F9C4= F0 11       p.
                phy                          ; F9C6= 5A          Z
                pha                          ; F9C7= 48          H
                stx $B0                      ; F9C8= 86 B0       .0
                sty $B1                      ; F9CA= 84 B1       .1
                lda ($B0)                    ; F9CC= B2 B0       20
                tay                          ; F9CE= A8          (
                pla                          ; F9CF= 68          h
                jsr LFA97                    ; F9D0= 20 97 FA     .z
LF9D3:
                ply                          ; F9D3= 7A          z
                jmp (GBPBV)                  ; F9D4= 6C 1A 02    l..

LF9D7:
                phy                          ; F9D7= 5A          Z
                phx                          ; F9D8= DA          Z
                pha                          ; F9D9= 48          H
                jsr selectHAZEL                    ; F9DA= 20 BA ED     :m
                lda hazel.currentFS
                jsr selectFS                    ; F9E0= 20 4D FB     M{
                pla                          ; F9E3= 68          h
                plx                          ; F9E4= FA          z
                bra LF9D3                    ; F9E5= 80 EC       .l

; FILESWITCH OSARGS HANDLER
; =========================
osargsEntryPoint:
                cpy #$00                     ; F9E7= C0 00       @.
                bne LFA15                    ; F9E9= D0 2A       P*
                cmp #$04                     ; F9EB= C9 04       I.
                bcs LFA15                    ; F9ED= B0 26       0&
                pha                          ; F9EF= 48          H
                jsr selectHAZEL                    ; Page in Hazel
                pla                          ; F9F3= 68          h
                bne LF9FA                    ; Jump with A<>0
                lda hazel.currentFS      ; OSARGS 0,0 - Read filing system number
                rts

LF9FA:
                dec a                        ; F9FA= 3A          :
                bne LFA0D                    ; F9FB= D0 10       P.
                dec a                        ; OSARGS 1,0 - Read command line address
                sta $02,x                    ; F9FE= 95 02       ..
                sta $03,x                    ; FA00= 95 03       ..
                lda hazel.commandLinePointer+0
                sta $00,x                    ; FA05= 95 00       ..
                lda hazel.commandLinePointer+1
                sta $01,x                    ; FA0A= 95 01       ..
                rts                          ; FA0C= 60          `

LFA0D:
                cmp #$01                     ; FA0D= C9 01       I.
                beq LFA14                    ; OSARGS 2,0 - Read OldNFS flag
                lda hazel.libFS      ; OSARGS 3,0 - Read libfs filing system number
LFA14:
                rts                          ; FA14= 60          `

LFA15:
                jsr LFA97                    ; FA15= 20 97 FA     .z

;-------------------------------------------------------------------------
;
; Call current FS's OSARGS routine, bypassing the FileSwitch stuff.
;
callARGSV:                      ;fa18
                jmp (ARGSV)

;-------------------------------------------------------------------------
;
; Entry point for OSFIND
;
; 
osfindEntryPoint: .proc
                ora #$00        ;A=$00 if a file is to be closed
                beq close       ;branch taken if closing a file
                jsr LFA6E       ;handle something other than a file close
                bra callFINDV

close:
                jsr LFA97                    ; FA24= 20 97 FA     .z
callFINDV:
                jmp (FINDV)                  ; FA27= 6C 1C 02    l..
                .pend
                
;-------------------------------------------------------------------------

osfileEntryPoint:               ;fa2a
                phx                          ; FA2A= DA          Z
                phy                          ; FA2B= 5A          Z
                pha                          ; FA2C= 48          H
                stx stringInputBufferAddress+0
                sty stringInputBufferAddress+1
                ldy #$11                     ; FA31= A0 11        .
LFA33:
                lda ($F2),y                  ; FA33= B1 F2       1r
                sta $02ED,y                  ; FA35= 99 ED 02    .m.
                dey                          ; FA38= 88          .
                bpl LFA33                    ; FA39= 10 F8       .x
                ldx $02ED                    ; FA3B= AE ED 02    .m.
                ldy $02EE                    ; FA3E= AC EE 02    ,n.
                jsr LFA6E                    ; FA41= 20 6E FA     nz
                stx $02ED                    ; FA44= 8E ED 02    .m.
                sty $02EE                    ; FA47= 8C EE 02    .n.
                pla                          ; FA4A= 68          h
                ldx #$ED                     ; FA4B= A2 ED       "m
                ldy #$02                     ; FA4D= A0 02        .
                jsr LFA6B                    ; FA4F= 20 6B FA     kz
                ply                          ; FA52= 7A          z
                sty $F3                      ; FA53= 84 F3       .s
                plx                          ; FA55= FA          z
                stx $F2                      ; FA56= 86 F2       .r
                pha                          ; FA58= 48          H
                ldy #$11                     ; FA59= A0 11        .
LFA5B:
                lda $02ED,y                  ; FA5B= B9 ED 02    9m.
                sta ($F2),y                  ; FA5E= 91 F2       .r
                dey                          ; FA60= 88          .
                cpy #$02                     ; FA61= C0 02       @.
                bcs LFA5B                    ; FA63= B0 F6       0v
                pla                          ; FA65= 68          h
                ldx $F2                      ; FA66= A6 F2       &r
                ldy $F3                      ; FA68= A4 F3       $s
                rts                          ; FA6A= 60          `

LFA6B:
                jmp (FILEV)                  ; FA6B= 6C 12 02    l..

; ??? parse file name, taking into account -FS- syntax?
LFA6E:
                pha                          
                lda stringInputBufferAddress+0
                pha                          
                lda stringInputBufferAddress+1 
                pha                          
                jsr selectHAZEL
                stx stringInputBufferAddress+0
                sty stringInputBufferAddress+1
                ldy #$00                     ; FA7C= A0 00        .
                jsr parseFileNameFS                    ; FA7E= 20 A6 FA     &z
                phy                          ; FA81= 5A          Z
                jsr selectFS                    ; FA82= 20 4D FB     M{
                pla                          ; FA85= 68          h
                clc                          ; FA86= 18          .
                adc $F2                      ; FA87= 65 F2       er
                tax                          ; FA89= AA          *
                ldy $F3                      ; FA8A= A4 F3       $s
                bcc LFA8F                    ; FA8C= 90 01       ..
                iny                          ; FA8E= C8          H
LFA8F:
                pla                          ; FA8F= 68          h
                sta $F3                      ; FA90= 85 F3       .s
                pla                          ; FA92= 68          h
                sta $F2                      ; FA93= 85 F2       .r
                pla                          ; FA95= 68          h
                rts                          ; FA96= 60          `

LFA97:
                phx                          ; FA97= DA          Z
                pha                          ; FA98= 48          H
                jsr selectHAZEL                    ; FA99= 20 BA ED     :m
                jsr LFB23                    ; FA9C= 20 23 FB     #{
                txa                          ; FA9F= 8A          .
                jsr selectFS                    ; FAA0= 20 4D FB     M{
                pla                          ; FAA3= 68          h
                plx                          ; FAA4= FA          z
                rts                          ; FAA5= 60          `

;-------------------------------------------------------------------------
;
; Parse the FS part of a file name, if any, and return the filing
; system to use.
;
; Entry:
;
; (stringInputBufferAddress),y = the string
;
; Exit:
;
; A = FS number to use
;
; (stringInputBufferAddress),y = next char after any tempfs prefix has
; been consumed
parseFileNameFS: .proc
                
                lsr hazel.tempFSFlag
                jsr skipSpacesAndCheckForCRInStringInput
                lda (stringInputBufferAddress),y
                cmp #'-'
                beq parseFSNamePrefix ; branch taken if tempfs syntax
                bit hazel.tempFSFlag
                lda hazel.currentFS
                bvc +
                lda hazel.activeFS
+
                rts

parseFSNamePrefix:
                iny                          ; FABE= C8          H
                ldx #$00                     ; FABF= A2 00       ".
LFAC1:
                lda hazel.fsInfoBlocks,x ;get FS name char
                beq badFilingSystemName
                txa                      ;A=offset in info blocks
                clc
                adc #$08
                sta $B0         ;offset of end of name
                phy
compareFSNameLoop:
                lda (stringInputBufferAddress),y

; validate FS name char. Must be letter or digit.
                
                jsr isLetter
                bcc validFSNameChar           ;branch taken if letter
                cmp #'0'
                bcc notValidFSNameChar       ;branch taken if not digit
                cmp #'9'+1
                bcs notValidFSNameChar       ;branch taken if not digit
validFSNameChar:
                cpx $B0                  
                bcs nextFSInfoBlock ;branch taken if end of FS
                                         ;info block name was reached
                eor hazel.fsInfoBlocks,x
                and #$DF                 ;Z=1 if char matches FS name
                bne nextFSInfoBlock      ;branch taken if not a match
                inx                      ;next fs info block byte
                iny                      ;next input string byte
                bra compareFSNameLoop

nextFSInfoBlock:
                ply                          
                ldx $B0         ;offset of end of name
                inx                          
                inx                          
                inx             ;advance to next entry
                bra LFAC1                    

notValidFSNameChar:

; Matching FS name must be terminated with -. Otherwise, it's bad
; syntax, or perhaps an overly long name.
                
                cmp #'-'
                bne badFilingSystemName
                iny                       ;consume input '-'
                cpx $B0                   
                beq foundFSInfoBlock     ;branch taken if a match due
                                         ;to being right at end of the
                                         ;FS info block name
                lda hazel.fsInfoBlocks,x ;
                cmp #$20
                bne nextFSInfoBlock      ;branch taken if not a match
                                         ;as tthe supplied name was a
                                         ;prefix of this FS's name
foundFSInfoBlock:
                pla
                ldx $B0
                lda hazel.fsInfoBlocks+(fsInfoBlock.fsNumber-(fsInfoBlock.name+size(fsInfoBlock.name))),x
                rts

badFilingSystemName:
                brk
                .text $f8,'Bad filing system name',0
                .pend

;-------------------------------------------------------------------------

LFB23:
                pha                          ; FB23= 48          H
                phy                          ; FB24= 5A          Z
                tya                          ; FB25= 98          .
                ldy #$00                     ; FB26= A0 00        .
LFB28:
                ldx hazel.fsInfoBlocks,y
                beq LFB42                    ; FB2B= F0 15       p.
                cmp hazel.fsInfoBlocks.minHandle,y
                bcc LFB39                    ; FB30= 90 07       ..
                cmp hazel.fsInfoBlocks.maxHandle,y
                bcc LFB47                    ; FB35= 90 10       ..
                beq LFB47                    ; FB37= F0 0E       p.
LFB39:
                pha                          ; FB39= 48          H
                tya                          ; FB3A= 98          .
                clc                          ; FB3B= 18          .
                adc #$0B                     ; FB3C= 69 0B       i.
                tay                          ; FB3E= A8          (
                pla                          ; FB3F= 68          h
                bra LFB28                    ; FB40= 80 E6       .f

LFB42:
                ldx hazel.currentFS
                bra LFB4A                    ; FB45= 80 03       ..

LFB47:
                ldx hazel.fsInfoBlocks.fsNumber,y
LFB4A:
                ply                          ; FB4A= 7A          z
                pla                          ; FB4B= 68          h
                rts                          ; FB4C= 60          `

;-------------------------------------------------------------------------
;
; Select filing system in A.
;
; Entry:
;
; A = FS number
;
selectFS:                               ;fb4d
                cmp hazel.activeFS      ; Check active fs
                beq LFB68               ; Already active fs, return
                phy
                phx
                tay
                dec a
                bne LFB5F       ;taken if not FS 1 (tape)

; ??? - only if trying to select tape FS
                
                lda #$04                     ; FB58= A9 04       ).
                bit $E2                      ; FB5A= 24 E2       $b
                bne LFB5F                    ; FB5C= D0 01       P.
                iny                          ; FB5E= C8          H
LFB5F:
                phy                          ; FB5F= 5A          Z
                ldx #$12                     ; Service call &12 - Select filing system
                jsr makeROMServiceCall
                pla                          ; FB65= 68          h
                plx                          ; FB66= FA          z
                ply                          ; FB67= 7A          z
LFB68:
                rts                          ; FB68= 60          `

; FileSwitch FSC
; ==============
fscEntryPoint:
                pha                          ; FB69= 48          H
                jsr selectHAZEL                    ; FB6A= 20 BA ED     :m
                lsr hazel.tempFSFlag
                pla                          ; FB70= 68          h
                pha                          ; FB71= 48          H
                phx                          ; FB72= DA          Z
                asl a                        ; FB73= 0A          .
                tax                          ; FB74= AA          *
                cmp #$17                     ; FB75= C9 17       I.
                bcs LFB7C                    ; FB77= B0 03       0.
                jmp (LFB81,x)                ; FB79= 7C 81 FB    |.{

; Pass to filing system's FSC
; ---------------------------
LFB7C:
                plx                          ; FB7C= FA          z
LFB7D:
                pla                          ; FB7D= 68          h
                jmp (hazel.activeFSCV)    ; FB7E= 6C DA DF    lZ_

; FileSwitch FSC table
; --------------------
LFB81:
                .word LFBA6     ; &00 &FBA6 - *OPT
                .word LFB9F     ; &01 &FB9F - =EOF
                .word LFBB3     ; &02 &FBB3 - */filename
                .word LFB99     ; &03 &FB99 - *command
                .word LFBB3     ; &04 &FBB3 - *RUN
                .word LFBB8     ; &05 &FBB8 - *CAT
                .word LFB7C     ; &06 &FB7C - New fs taking over - pass to fs FSC
                .word LFB7C     ; &07 &FB7C - Handle request     - pass to fs FSC
                .word LFB7C     ; &08 &FB7C - Enable flag        - pass to fs FSC
                .word LFBB8     ; &09 &FBB8 - *EX
                .word LFBB8     ; &0A &FBB8 - *INFO
                .word LFBE8     ; &0B &FBE8 - *RUN from libfs

; FSC 3 - *command
; ================
LFB99:
                plx                          ; FB99= FA          z
                jsr getCommandLinePointer                    ; FB9A= 20 C1 FB     A{
                bra LFB7D                    ; FB9D= 80 DE       .^

; FSC 1 - =EOF
; ============
LFB9F:
                ply                          ; FB9F= 7A          z
                phy                          ; FBA0= 5A          Z
                jsr LFA97                    ; FBA1= 20 97 FA     .z
                bra LFB7C                    ; FBA4= 80 D6       .V

; FSC 0 - *OPT
; ============
LFBA6:
                bit hazel.tempFSFlag      ; Check temporary fs flag
                bvs LFB7C                    ; Pass to current filing system
                lda hazel.currentFS      ; Get current filing system number
LFBAE:
                jsr selectFS                    ; Select filing system
                bra LFB7C                    ; Pass to filing system

; FSC 2, 4 - *filename, *RUN filename
; ===================================
LFBB3:
                plx
                jsr getCommandLinePointer                    ; Skip '*'s and spaces, set command line address
                phx                          ; Continue on to pass to filing system

; FSC 5, 9, 10 - *CAT, *EX, *INFO
; ===============================
LFBB8:
                plx
                asl hazel.tempFSFlag      ;
                jsr LFA6E                    ; ? Check for temporary fs ?
                bra LFB7D                    ; Pass to filing system's FSC

;-------------------------------------------------------------------------
;
; Get command line pointer.
;
; Entry:
;
; X/Y - pointer to CR-terminated command line string
;
; Exit:
;
; X/Y, (hazel.commandLinePointer) - pointer to first non-space char in
; command line string
getCommandLinePointer: .proc ;fbc1
                stx stringInputBufferAddress+0
                sty stringInputBufferAddress+1

; skip spaces. Stop if terminating CR encountered.
                
                ldy #$FF                     ; FBC5= A0 FF        .
-
                iny
                lda (stringInputBufferAddress),y
                cmp #$0D
                beq +
                cmp #' '
                bne -
                
+

; Hmm. Didn't we just do this bit already?
                
                jsr skipSpacesAndCheckForCRInStringInput

; Store address of first non-space char in the HAZEL command line
; pointer.
                
                tya
                clc
                adc stringInputBufferAddress+0
                sta hazel.commandLinePointer+0
                lda stringInputBufferAddress+1
                adc #$00                     
                sta hazel.commandLinePointer+1
                ldy stringInputBufferAddress+1
                ldx stringInputBufferAddress+0
                rts                          
                .pend

; FSC 11 - RUN from libfs
; =======================
LFBE8:
                lda hazel.libFS      ; Is a libfs set?
                bpl LFBAE                    ; Yes, jump to run from libfs
LFBED:
                brk
                .byte 254
                .text "Bad command"
                brk

                .byte $FF                    ; FBFB= FF          .
                .byte $FF                    ; FBFC= FF          .
                .byte $FF                    ; FBFD= FF          .
                .byte $FF                    ; FBFE= FF          .
                .byte $FF                    ; FBFF= FF          .

                .text "(C) 1984 Acorn Computers Ltd."
                .text "Thanks are due to the following contributors to the BBC Computer (among others too numerous to mention):- "
                .text "David Allen,"
                .text "Clive Angel,"
                .text "David Bell,"
                .text "Paul Bond,"
                .text "Allen Boothroyd,"
                .text "Julian Brown,"
                .text "Tudor Brown,"
                .text "Brian Cockburn,"
                .text "Pete Cockerell,"
                .text "Mark Colton,"
                .text "Chris Curry,"
                .text "Joe Dunn,"
                .text "Paul Freakley,"
                .text "Steve Furber,"
                .text "Martyn Gilbert,"
                .text "John Harrison,"
                .text "Hermann Hauser,"
                .text "Mike Hill,"
                .text "John Horton,"
                .text "Neil Johnson,"
                .text "Richard King,"
                .text "David Kitson,"
                .text "Julian Lomberg,"
                .text "Rob Macmillan,"
                .text "Richard Manby,"
                .text "Peter McKenna,"
                .text "Andrew McKernan,"
                .text "Mick Neil,"
                .text "Ian Niblock,"
                .text "Glen Nicholls,"
                .text "Robert Nokes,"
                .text "Richard Page,"
                .text "Steve Parsons,"
                .text "Ed Phipps,"
                .text "John Radcliffe,"
                .text "Rick Rand,"
                .text "Brian Robertson,"
                .text "Richard Russell,"
                .text "Gordon Sage,"
                .text "Terry Scotcher,"
                .text "David Seal,"
                .text "Paul Swindell,"
                .text "Jon Thackray,"
                .text "Hugo Tyson,"
                .text "Adrian Warner,"
                .text "Jess Wills,"
                .text "Roger Wilson,"
                .text "Graham Winterflood."
                .text "   "

E_USERV: ; ff00
                jsr extendedVectorEntryPoint
E_BRKV: ; ff03
                jsr extendedVectorEntryPoint
E_IRQ1V: ; ff06
                jsr extendedVectorEntryPoint
E_IRQ2V: ; ff09
                jsr extendedVectorEntryPoint
E_CLIV: ; ff0c
                jsr extendedVectorEntryPoint
E_BYTEV: ; ff0f
                jsr extendedVectorEntryPoint
E_WORDV: ; ff12
                jsr extendedVectorEntryPoint
E_WRCHV: ; ff15
                jsr extendedVectorEntryPoint
E_RDCHV: ; ff18
                jsr extendedVectorEntryPoint
E_FILEV: ; ff1b
                jsr extendedVectorEntryPoint
E_ARGSV: ; ff1e
                jsr extendedVectorEntryPoint
E_BGETV: ; ff21
                jsr extendedVectorEntryPoint
E_BPUTV: ; ff24
                jsr extendedVectorEntryPoint
E_GBPBV: ; ff27
                jsr extendedVectorEntryPoint
E_FINDV: ; ff2a
                jsr extendedVectorEntryPoint
E_FSCV: ; ff2d
                jsr extendedVectorEntryPoint
E_EVENTV: ; ff30
                jsr extendedVectorEntryPoint
E_UPTV: ; ff33
                jsr extendedVectorEntryPoint
E_NETV: ; ff36
                jsr extendedVectorEntryPoint
E_VDUV: ; ff39
                jsr extendedVectorEntryPoint
E_KEYV: ; ff3c
                jsr extendedVectorEntryPoint
E_INSV: ; ff3f
                jsr extendedVectorEntryPoint
E_REMV: ; ff42
                jsr extendedVectorEntryPoint
E_CNPV: ; ff45
                jsr extendedVectorEntryPoint
E_IND1V: ; ff48
                jsr extendedVectorEntryPoint
E_IND2V: ; ff4b
                jsr extendedVectorEntryPoint
E_IND3V: ; ff4e
                jsr extendedVectorEntryPoint
                
extendedVectorEntryPoint:
                pha                          ; FF51= 48          H
                pha                          ; FF52= 48          H
                pha                          ; FF53= 48          H
                pha                          ; FF54= 48          H
                pha                          ; FF55= 48          H
                pha                          ; FF56= 48          H
                php                          ; FF57= 08          .
                pha                          ; FF58= 48          H
                phx                          ; FF59= DA          Z
                phy                          ; FF5A= 5A          Z
                tsx                          ; FF5B= BA          :
                lda #$FF                     ; FF5C= A9 FF       ).
                sta $0108,x                  ; FF5E= 9D 08 01    ...
                lda #$8C                     ; FF61= A9 8C       ).
                sta $0107,x                  ; FF63= 9D 07 01    ...
                ldy $010B,x                  ; FF66= BC 0B 01    <..
                lda extendedVectorSpace-2,y                  ; FF69= B9 9D 0D    9..
                sta $0105,x                  ; FF6C= 9D 05 01    ...
                lda extendedVectorSpace-1,y                  ; FF6F= B9 9E 0D    9..
                sta $0106,x                  ; FF72= 9D 06 01    ...
                lda $F4                      ; FF75= A5 F4       %t
                sta $010A,x                  ; FF77= 9D 0A 01    ...
                lda ACCCON                    ; FF7A= AD 34 FE    -4~
                sta $0109,x                  ; FF7D= 9D 09 01    ...
                jsr selectHAZEL                    ; FF80= 20 BA ED     :m
                lda extendedVectorSpace,y                  ; FF83= B9 9F 0D    9..
                jsr selectROMA                    ; FF86= 20 92 E5     .e
                ply                          ; FF89= 7A          z
                plx                          ; FF8A= FA          z
                pla                          ; FF8B= 68          h
                rti                          ; FF8C= 40          @

                php                          ; FF8D= 08          .
                pha                          ; FF8E= 48          H
                phx                          ; FF8F= DA          Z
                tsx                          ; FF90= BA          :
                lda $0102,x                  ; FF91= BD 02 01    =..
                sta $0106,x                  ; FF94= 9D 06 01    ...
                lda $0103,x                  ; FF97= BD 03 01    =..
                sta $0107,x                  ; FF9A= 9D 07 01    ...
                plx                          ; FF9D= FA          z
                pla                          ; FF9E= 68          h
                pla                          ; FF9F= 68          h
                pla                          ; FFA0= 68          h
                jsr selectMOSOrHAZEL                    ; FFA1= 20 B0 ED     0m
                pla                          ; FFA4= 68          h
                jsr selectROMA                    ; FFA5= 20 92 E5     .e
                pla                          ; FFA8= 68          h
                plp                          ; FFA9= 28          (
rts:
                rts                          ; FFAA= 60          `

osbyte96:
                ldy $fe00,x
                rts

osbyte9D:
                txa
                bra OSBPUT

                brk

OSWRSC:
                jmp oswrscEntryPoint ; FFB3
                .byte defaultVectorTable.end-defaultVectorTable
                .word defaultVectorTable
OSRDSC:
                jmp osrdscEntryPoint ; FFB9
VDUCHR:
                jmp vduChrEntryPoint ; FFBC
OSEVEN:
                jmp eventEntryPoint ; FFBF
GSINIT:
                jmp gsinitEntryPoint ; FFC2
GSREAD:
                jmp gsreadEntryPoint ; FFC5
NVRDCH:
                jmp osrdchEntryPoint                    ; FFC8
NVWRCH:
                jmp oswrchEntryPoint                    ; FFCB
OSFIND:
                jmp osfindEntryPoint                    ; FFCE
OSGBPB:
                jmp osgbpbEntryPoint                    ; FFD1
OSBPUT:
                jmp osbputEntryPoint                    ; FFD4
OSBGET:
                jmp osbgetEntryPoint                    ; FFD7
OSARGS:
                jmp osargsEntryPoint ; FFDA
OSFILE:         
                jmp osfileEntryPoint ; FFDD
OSRDCH:
                jmp (RDCHV)                  ; FFE0
OSASCI:
                cmp #$0D                     ; FFE3
                bne OSWRCH                   ; FFE5
OSNEWL:
                lda #$0A                     ; FFE7
                jsr OSWRCH                   ; FFE9
                lda #$0D                     ; FFEC
OSWRCH:
                jmp (WRCHV)                  ; FFEE
OSWORD:
                jmp (WORDV)                  ; FFF1
OSBYTE:
                jmp (BYTEV)                  ; FFF4
OSCLI:
                jmp (CLIV)                  ; FFF7

LFFFA:                                       ; FFFA NMIV
                .word nmiEntryPoint
LFFFC:                                       ; FFFB RESETV
                .word resetEntryPoint
LFFFE:                                       ; FFFE IRQV
                .word irqEntryPoint

                .send mos
                